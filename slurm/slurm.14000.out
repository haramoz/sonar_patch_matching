python hello-world.py
python hyperas_simple.py
python hyperas_contrastive_loss.py
python densenet_siamese_best_run.py
python hyperas_densenet.py
python hyperas_densenet_siamese.py
python densenet_simple.py
python keras_densenet_siamese.py
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_2[0][0]               
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_3[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_4[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 27, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_6[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_7[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_8[0][0]               
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 25, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 25)           0           activation_9[0][0]               
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            26          global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 20s - loss: 0.6452 - acc: 0.7103 - val_loss: 0.5695 - val_acc: 0.8188
Epoch 2/20
 - 16s - loss: 0.5859 - acc: 0.7527 - val_loss: 0.5416 - val_acc: 0.8352
Epoch 3/20
 - 16s - loss: 0.5625 - acc: 0.7634 - val_loss: 0.5257 - val_acc: 0.8300
Epoch 4/20
 - 16s - loss: 0.5451 - acc: 0.7706 - val_loss: 0.5183 - val_acc: 0.8254
Epoch 5/20
 - 16s - loss: 0.5332 - acc: 0.7727 - val_loss: 0.5036 - val_acc: 0.8258
Epoch 6/20
 - 16s - loss: 0.5225 - acc: 0.7765 - val_loss: 0.4970 - val_acc: 0.8278
Epoch 7/20
 - 16s - loss: 0.5131 - acc: 0.7807 - val_loss: 0.4881 - val_acc: 0.8313
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 288/7440 [>.............................] - ETA: 1s
 576/7440 [=>............................] - ETA: 1s
 896/7440 [==>...........................] - ETA: 1s
1216/7440 [===>..........................] - ETA: 1s
1536/7440 [=====>........................] - ETA: 1s
1856/7440 [======>.......................] - ETA: 1s
2176/7440 [=======>......................] - ETA: 0s
2496/7440 [=========>....................] - ETA: 0s
2816/7440 [==========>...................] - ETA: 0s
3136/7440 [===========>..................] - ETA: 0s
3456/7440 [============>.................] - ETA: 0s
3776/7440 [==============>...............] - ETA: 0s
4096/7440 [===============>..............] - ETA: 0s
4416/7440 [================>.............] - ETA: 0s
4736/7440 [==================>...........] - ETA: 0s
5056/7440 [===================>..........] - ETA: 0s
5344/7440 [====================>.........] - ETA: 0s
5664/7440 [=====================>........] - ETA: 0s
5952/7440 [=======================>......] - ETA: 0s
6240/7440 [========================>.....] - ETA: 0s
6528/7440 [=========================>....] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
7104/7440 [===========================>..] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 175us/step
Test accuracy: 0.8313172043010753
Test accuracy 0.6: 0.8063172043010752
auc_score ------------------>  0.883805172563302
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_2[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_12[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_14[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 27, 48, 48)   0           average_pooling2d_3[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_4 (AveragePoo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_4[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 25, 24, 24)   0           average_pooling2d_4[0][0]        
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 25)           0           activation_18[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            26          global_average_pooling2d_2[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 18s - loss: 0.6861 - acc: 0.6134 - val_loss: 0.5691 - val_acc: 0.8419
Epoch 2/20
 - 16s - loss: 0.6204 - acc: 0.7284 - val_loss: 0.5451 - val_acc: 0.8402
Epoch 3/20
 - 16s - loss: 0.5912 - acc: 0.7462 - val_loss: 0.5251 - val_acc: 0.8237
Epoch 4/20
 - 16s - loss: 0.5707 - acc: 0.7593 - val_loss: 0.5183 - val_acc: 0.8263
Epoch 5/20
 - 16s - loss: 0.5546 - acc: 0.7653 - val_loss: 0.5084 - val_acc: 0.8272
Epoch 6/20
 - 16s - loss: 0.5408 - acc: 0.7722 - val_loss: 0.4921 - val_acc: 0.8327
Epoch 00006: early stopping

  32/7440 [..............................] - ETA: 1s
 352/7440 [>.............................] - ETA: 1s
 672/7440 [=>............................] - ETA: 1s
 992/7440 [===>..........................] - ETA: 1s
1312/7440 [====>.........................] - ETA: 1s
1632/7440 [=====>........................] - ETA: 0s
1952/7440 [======>.......................] - ETA: 0s
2272/7440 [========>.....................] - ETA: 0s
2592/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3232/7440 [============>.................] - ETA: 0s
3552/7440 [=============>................] - ETA: 0s
3872/7440 [==============>...............] - ETA: 0s
4192/7440 [===============>..............] - ETA: 0s
4512/7440 [=================>............] - ETA: 0s
4832/7440 [==================>...........] - ETA: 0s
5152/7440 [===================>..........] - ETA: 0s
5472/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6112/7440 [=======================>......] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 168us/step
Test accuracy: 0.8326612903225806
Test accuracy 0.6: 0.8237903225806451
auc_score ------------------>  0.8903111631402473
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_3[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_19[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_20[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling2d_5 (AveragePoo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_5[0][0]        
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_22[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_23[0][0]              
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 27, 48, 48)   0           average_pooling2d_5[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_24[0][0]              
__________________________________________________________________________________________________
average_pooling2d_6 (AveragePoo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_6[0][0]        
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_26[0][0]              
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 25, 24, 24)   0           average_pooling2d_6[0][0]        
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 25)           0           activation_27[0][0]              
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 1)            26          global_average_pooling2d_3[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 18s - loss: 0.7082 - acc: 0.5999 - val_loss: 0.5917 - val_acc: 0.7774
Epoch 2/20
 - 16s - loss: 0.6264 - acc: 0.7200 - val_loss: 0.5643 - val_acc: 0.7999
Epoch 3/20
 - 16s - loss: 0.5904 - acc: 0.7453 - val_loss: 0.5516 - val_acc: 0.7728
Epoch 4/20
 - 16s - loss: 0.5661 - acc: 0.7524 - val_loss: 0.5471 - val_acc: 0.7767
Epoch 5/20
 - 16s - loss: 0.5503 - acc: 0.7580 - val_loss: 0.5589 - val_acc: 0.7587
Epoch 6/20
 - 16s - loss: 0.5382 - acc: 0.7627 - val_loss: 0.5331 - val_acc: 0.7726
Epoch 7/20
 - 16s - loss: 0.5289 - acc: 0.7671 - val_loss: 0.5141 - val_acc: 0.7938
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 352/7440 [>.............................] - ETA: 1s
 672/7440 [=>............................] - ETA: 1s
 992/7440 [===>..........................] - ETA: 1s
1312/7440 [====>.........................] - ETA: 0s
1632/7440 [=====>........................] - ETA: 0s
1952/7440 [======>.......................] - ETA: 0s
2272/7440 [========>.....................] - ETA: 0s
2592/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3232/7440 [============>.................] - ETA: 0s
3552/7440 [=============>................] - ETA: 0s
3872/7440 [==============>...............] - ETA: 0s
4192/7440 [===============>..............] - ETA: 0s
4512/7440 [=================>............] - ETA: 0s
4832/7440 [==================>...........] - ETA: 0s
5152/7440 [===================>..........] - ETA: 0s
5472/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6112/7440 [=======================>......] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 162us/step
Test accuracy: 0.7938172043010753
Test accuracy 0.6: 0.769489247311828
auc_score ------------------>  0.8668462033183026
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_4[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_28[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_29[0][0]              
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_30[0][0]              
__________________________________________________________________________________________________
average_pooling2d_7 (AveragePoo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_7[0][0]        
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_31[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_32[0][0]              
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 27, 48, 48)   0           average_pooling2d_7[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_33[0][0]              
__________________________________________________________________________________________________
average_pooling2d_8 (AveragePoo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_8[0][0]        
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_35[0][0]              
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 25, 24, 24)   0           average_pooling2d_8[0][0]        
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 25)           0           activation_36[0][0]              
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 1)            26          global_average_pooling2d_4[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 18s - loss: 0.6450 - acc: 0.6861 - val_loss: 0.5532 - val_acc: 0.8375
Epoch 2/20
 - 16s - loss: 0.5783 - acc: 0.7512 - val_loss: 0.5148 - val_acc: 0.8531
Epoch 3/20
 - 16s - loss: 0.5559 - acc: 0.7588 - val_loss: 0.5101 - val_acc: 0.8445
Epoch 4/20
 - 16s - loss: 0.5396 - acc: 0.7666 - val_loss: 0.4972 - val_acc: 0.8284
Epoch 5/20
 - 16s - loss: 0.5239 - acc: 0.7713 - val_loss: 0.4964 - val_acc: 0.8172
Epoch 6/20
 - 16s - loss: 0.5127 - acc: 0.7745 - val_loss: 0.4843 - val_acc: 0.8211
Epoch 7/20
 - 16s - loss: 0.5046 - acc: 0.7796 - val_loss: 0.4796 - val_acc: 0.8137
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 352/7440 [>.............................] - ETA: 1s
 672/7440 [=>............................] - ETA: 1s
 992/7440 [===>..........................] - ETA: 1s
1312/7440 [====>.........................] - ETA: 1s
1632/7440 [=====>........................] - ETA: 0s
1952/7440 [======>.......................] - ETA: 0s
2272/7440 [========>.....................] - ETA: 0s
2592/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3264/7440 [============>.................] - ETA: 0s
3616/7440 [=============>................] - ETA: 0s
3968/7440 [===============>..............] - ETA: 0s
4288/7440 [================>.............] - ETA: 0s
4608/7440 [=================>............] - ETA: 0s
4928/7440 [==================>...........] - ETA: 0s
5248/7440 [====================>.........] - ETA: 0s
5568/7440 [=====================>........] - ETA: 0s
5888/7440 [======================>.......] - ETA: 0s
6208/7440 [========================>.....] - ETA: 0s
6528/7440 [=========================>....] - ETA: 0s
6848/7440 [==========================>...] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 160us/step
Test accuracy: 0.8137096774193548
Test accuracy 0.6: 0.8051075268817204
auc_score ------------------>  0.8853383339114348
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_5[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_37[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_38[0][0]              
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_39[0][0]              
__________________________________________________________________________________________________
average_pooling2d_9 (AveragePoo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_9[0][0]        
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_40[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_41[0][0]              
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 27, 48, 48)   0           average_pooling2d_9[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_42[0][0]              
__________________________________________________________________________________________________
average_pooling2d_10 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_10[0][0]       
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_43[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_44[0][0]              
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 25, 24, 24)   0           average_pooling2d_10[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 25)           0           activation_45[0][0]              
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 1)            26          global_average_pooling2d_5[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 18s - loss: 0.6714 - acc: 0.6256 - val_loss: 0.5872 - val_acc: 0.7870
Epoch 2/20
 - 16s - loss: 0.5942 - acc: 0.7447 - val_loss: 0.5393 - val_acc: 0.8530
Epoch 3/20
 - 16s - loss: 0.5661 - acc: 0.7633 - val_loss: 0.5328 - val_acc: 0.8378
Epoch 4/20
 - 16s - loss: 0.5503 - acc: 0.7691 - val_loss: 0.5020 - val_acc: 0.8452
Epoch 5/20
 - 16s - loss: 0.5373 - acc: 0.7736 - val_loss: 0.4925 - val_acc: 0.8426
Epoch 6/20
 - 16s - loss: 0.5250 - acc: 0.7777 - val_loss: 0.4812 - val_acc: 0.8448
Epoch 7/20
 - 16s - loss: 0.5141 - acc: 0.7819 - val_loss: 0.4826 - val_acc: 0.8316
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 352/7440 [>.............................] - ETA: 1s
 672/7440 [=>............................] - ETA: 1s
 992/7440 [===>..........................] - ETA: 1s
1312/7440 [====>.........................] - ETA: 1s
1632/7440 [=====>........................] - ETA: 0s
1952/7440 [======>.......................] - ETA: 0s
2272/7440 [========>.....................] - ETA: 0s
2592/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3232/7440 [============>.................] - ETA: 0s
3552/7440 [=============>................] - ETA: 0s
3872/7440 [==============>...............] - ETA: 0s
4192/7440 [===============>..............] - ETA: 0s
4512/7440 [=================>............] - ETA: 0s
4832/7440 [==================>...........] - ETA: 0s
5152/7440 [===================>..........] - ETA: 0s
5472/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6112/7440 [=======================>......] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 166us/step
Test accuracy: 0.8315860215053763
Test accuracy 0.6: 0.8396505376344086
auc_score ------------------>  0.8968343883685975
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_6 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_6[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_46[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_47[0][0]              
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_48[0][0]              
__________________________________________________________________________________________________
average_pooling2d_11 (AveragePo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_11[0][0]       
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_49[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_50[0][0]              
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 27, 48, 48)   0           average_pooling2d_11[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_51[0][0]              
__________________________________________________________________________________________________
average_pooling2d_12 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_12[0][0]       
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_52[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_53[0][0]              
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 25, 24, 24)   0           average_pooling2d_12[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 25)           0           activation_54[0][0]              
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1)            26          global_average_pooling2d_6[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 19s - loss: 0.6960 - acc: 0.6134 - val_loss: 0.5781 - val_acc: 0.8202
Epoch 2/20
 - 17s - loss: 0.6257 - acc: 0.7214 - val_loss: 0.5571 - val_acc: 0.8270
Epoch 3/20
 - 17s - loss: 0.5892 - acc: 0.7456 - val_loss: 0.5309 - val_acc: 0.8234
Epoch 4/20
 - 17s - loss: 0.5650 - acc: 0.7595 - val_loss: 0.5394 - val_acc: 0.8030
Epoch 5/20
 - 17s - loss: 0.5502 - acc: 0.7646 - val_loss: 0.5209 - val_acc: 0.7974
Epoch 6/20
 - 17s - loss: 0.5398 - acc: 0.7669 - val_loss: 0.5178 - val_acc: 0.7931
Epoch 7/20
 - 17s - loss: 0.5302 - acc: 0.7717 - val_loss: 0.5378 - val_acc: 0.7809
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 352/7440 [>.............................] - ETA: 1s
 672/7440 [=>............................] - ETA: 1s
 992/7440 [===>..........................] - ETA: 1s
1312/7440 [====>.........................] - ETA: 1s
1632/7440 [=====>........................] - ETA: 0s
1952/7440 [======>.......................] - ETA: 0s
2272/7440 [========>.....................] - ETA: 0s
2592/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3232/7440 [============>.................] - ETA: 0s
3552/7440 [=============>................] - ETA: 0s
3872/7440 [==============>...............] - ETA: 0s
4192/7440 [===============>..............] - ETA: 0s
4512/7440 [=================>............] - ETA: 0s
4832/7440 [==================>...........] - ETA: 0s
5152/7440 [===================>..........] - ETA: 0s
5472/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6112/7440 [=======================>......] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6720/7440 [==========================>...] - ETA: 0s
7040/7440 [===========================>..] - ETA: 0s
7360/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 168us/step
Test accuracy: 0.7809139784946236
Test accuracy 0.6: 0.7510752688172043
auc_score ------------------>  0.8540535394265233
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_7 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_7[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_55[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_56 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_56[0][0]              
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_57 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_57[0][0]              
__________________________________________________________________________________________________
average_pooling2d_13 (AveragePo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_13[0][0]       
__________________________________________________________________________________________________
activation_58 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_58[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_59 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_59[0][0]              
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 27, 48, 48)   0           average_pooling2d_13[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_60 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_60[0][0]              
__________________________________________________________________________________________________
average_pooling2d_14 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_14[0][0]       
__________________________________________________________________________________________________
activation_61 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_61[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_62 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_62[0][0]              
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 25, 24, 24)   0           average_pooling2d_14[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_63 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 25)           0           activation_63[0][0]              
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1)            26          global_average_pooling2d_7[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 19s - loss: 0.6780 - acc: 0.6317 - val_loss: 0.5539 - val_acc: 0.8367
Epoch 2/20
 - 17s - loss: 0.6051 - acc: 0.7305 - val_loss: 0.5272 - val_acc: 0.8434
Epoch 3/20
 - 17s - loss: 0.5775 - acc: 0.7460 - val_loss: 0.5188 - val_acc: 0.8383
Epoch 4/20
 - 17s - loss: 0.5589 - acc: 0.7550 - val_loss: 0.5135 - val_acc: 0.8288
Epoch 5/20
 - 17s - loss: 0.5452 - acc: 0.7611 - val_loss: 0.5090 - val_acc: 0.8097
Epoch 6/20
 - 17s - loss: 0.5332 - acc: 0.7651 - val_loss: 0.5027 - val_acc: 0.8147
Epoch 7/20
 - 17s - loss: 0.5245 - acc: 0.7675 - val_loss: 0.5011 - val_acc: 0.8113
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 352/7440 [>.............................] - ETA: 1s
 672/7440 [=>............................] - ETA: 1s
 992/7440 [===>..........................] - ETA: 1s
1312/7440 [====>.........................] - ETA: 1s
1632/7440 [=====>........................] - ETA: 0s
1952/7440 [======>.......................] - ETA: 0s
2272/7440 [========>.....................] - ETA: 0s
2592/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3232/7440 [============>.................] - ETA: 0s
3552/7440 [=============>................] - ETA: 0s
3872/7440 [==============>...............] - ETA: 0s
4192/7440 [===============>..............] - ETA: 0s
4512/7440 [=================>............] - ETA: 0s
4832/7440 [==================>...........] - ETA: 0s
5152/7440 [===================>..........] - ETA: 0s
5472/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6080/7440 [=======================>......] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6656/7440 [=========================>....] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 173us/step
Test accuracy: 0.8112903225806452
Test accuracy 0.6: 0.8057795698924731
auc_score ------------------>  0.875672115273442
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_8 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_8[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_64 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_64[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_65 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_65[0][0]              
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_66 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_66[0][0]              
__________________________________________________________________________________________________
average_pooling2d_15 (AveragePo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_15[0][0]       
__________________________________________________________________________________________________
activation_67 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_67[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_68 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_68[0][0]              
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 27, 48, 48)   0           average_pooling2d_15[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_69 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_69[0][0]              
__________________________________________________________________________________________________
average_pooling2d_16 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_16[0][0]       
__________________________________________________________________________________________________
activation_70 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_70[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_71 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_71[0][0]              
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 25, 24, 24)   0           average_pooling2d_16[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_72 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 25)           0           activation_72[0][0]              
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 1)            26          global_average_pooling2d_8[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 19s - loss: 0.6773 - acc: 0.6370 - val_loss: 0.5706 - val_acc: 0.8453
Epoch 2/20
 - 17s - loss: 0.6157 - acc: 0.7323 - val_loss: 0.5401 - val_acc: 0.8526
Epoch 3/20
 - 17s - loss: 0.5852 - acc: 0.7473 - val_loss: 0.5275 - val_acc: 0.8302
Epoch 4/20
 - 16s - loss: 0.5614 - acc: 0.7611 - val_loss: 0.5121 - val_acc: 0.8234
Epoch 5/20
 - 17s - loss: 0.5437 - acc: 0.7683 - val_loss: 0.5037 - val_acc: 0.8099
Epoch 6/20
 - 16s - loss: 0.5316 - acc: 0.7732 - val_loss: 0.4961 - val_acc: 0.8132
Epoch 7/20
 - 17s - loss: 0.5211 - acc: 0.7763 - val_loss: 0.5029 - val_acc: 0.8013
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 320/7440 [>.............................] - ETA: 1s
 608/7440 [=>............................] - ETA: 1s
 896/7440 [==>...........................] - ETA: 1s
1184/7440 [===>..........................] - ETA: 1s
1472/7440 [====>.........................] - ETA: 1s
1760/7440 [======>.......................] - ETA: 1s
2048/7440 [=======>......................] - ETA: 0s
2336/7440 [========>.....................] - ETA: 0s
2624/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3200/7440 [===========>..................] - ETA: 0s
3488/7440 [=============>................] - ETA: 0s
3776/7440 [==============>...............] - ETA: 0s
4064/7440 [===============>..............] - ETA: 0s
4352/7440 [================>.............] - ETA: 0s
4640/7440 [=================>............] - ETA: 0s
4928/7440 [==================>...........] - ETA: 0s
5216/7440 [====================>.........] - ETA: 0s
5504/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6080/7440 [=======================>......] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6656/7440 [=========================>....] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 176us/step
Test accuracy: 0.8013440860215054
Test accuracy 0.6: 0.7626344086021506
auc_score ------------------>  0.8805868453000347
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_9 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_9[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_73 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_73[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_74 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_74[0][0]              
__________________________________________________________________________________________________
concatenate_25 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_25[0][0]             
__________________________________________________________________________________________________
activation_75 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_75[0][0]              
__________________________________________________________________________________________________
average_pooling2d_17 (AveragePo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_17[0][0]       
__________________________________________________________________________________________________
activation_76 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_76[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_77 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_77[0][0]              
__________________________________________________________________________________________________
concatenate_26 (Concatenate)    (None, 27, 48, 48)   0           average_pooling2d_17[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_26[0][0]             
__________________________________________________________________________________________________
activation_78 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_78[0][0]              
__________________________________________________________________________________________________
average_pooling2d_18 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_18[0][0]       
__________________________________________________________________________________________________
activation_79 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_79[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_80 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_80[0][0]              
__________________________________________________________________________________________________
concatenate_27 (Concatenate)    (None, 25, 24, 24)   0           average_pooling2d_18[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_27[0][0]             
__________________________________________________________________________________________________
activation_81 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_9 (Glo (None, 25)           0           activation_81[0][0]              
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 1)            26          global_average_pooling2d_9[0][0] 
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 20s - loss: 0.6511 - acc: 0.6974 - val_loss: 0.5606 - val_acc: 0.8099
Epoch 2/20
 - 17s - loss: 0.5943 - acc: 0.7459 - val_loss: 0.5443 - val_acc: 0.8574
Epoch 3/20
 - 17s - loss: 0.5690 - acc: 0.7579 - val_loss: 0.5359 - val_acc: 0.8418
Epoch 4/20
 - 17s - loss: 0.5508 - acc: 0.7637 - val_loss: 0.5406 - val_acc: 0.8066
Epoch 5/20
 - 17s - loss: 0.5370 - acc: 0.7689 - val_loss: 0.5271 - val_acc: 0.8191
Epoch 6/20
 - 17s - loss: 0.5272 - acc: 0.7712 - val_loss: 0.5209 - val_acc: 0.8216
Epoch 7/20
 - 17s - loss: 0.5184 - acc: 0.7757 - val_loss: 0.5211 - val_acc: 0.8200
Epoch 00007: early stopping

  32/7440 [..............................] - ETA: 1s
 320/7440 [>.............................] - ETA: 1s
 608/7440 [=>............................] - ETA: 1s
 896/7440 [==>...........................] - ETA: 1s
1184/7440 [===>..........................] - ETA: 1s
1472/7440 [====>.........................] - ETA: 1s
1760/7440 [======>.......................] - ETA: 1s
2048/7440 [=======>......................] - ETA: 0s
2336/7440 [========>.....................] - ETA: 0s
2624/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3200/7440 [===========>..................] - ETA: 0s
3488/7440 [=============>................] - ETA: 0s
3776/7440 [==============>...............] - ETA: 0s
4064/7440 [===============>..............] - ETA: 0s
4352/7440 [================>.............] - ETA: 0s
4640/7440 [=================>............] - ETA: 0s
4928/7440 [==================>...........] - ETA: 0s
5216/7440 [====================>.........] - ETA: 0s
5504/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6080/7440 [=======================>......] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6656/7440 [=========================>....] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 178us/step
Test accuracy: 0.8200268817204301
Test accuracy 0.6: 0.7911290322580645
auc_score ------------------>  0.8693297274251357
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_10 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 18, 96, 96)   324         input_10[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 18, 96, 96)   72          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_82 (Activation)      (None, 18, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   864         activation_82[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_83 (Activation)      (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_83[0][0]              
__________________________________________________________________________________________________
concatenate_28 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 30, 96, 96)   120         concatenate_28[0][0]             
__________________________________________________________________________________________________
activation_84 (Activation)      (None, 30, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 96, 96)   450         activation_84[0][0]              
__________________________________________________________________________________________________
average_pooling2d_19 (AveragePo (None, 15, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 48, 48)   60          average_pooling2d_19[0][0]       
__________________________________________________________________________________________________
activation_85 (Activation)      (None, 15, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   720         activation_85[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_86 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_86[0][0]              
__________________________________________________________________________________________________
concatenate_29 (Concatenate)    (None, 27, 48, 48)   0           average_pooling2d_19[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 27, 48, 48)   108         concatenate_29[0][0]             
__________________________________________________________________________________________________
activation_87 (Activation)      (None, 27, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   351         activation_87[0][0]              
__________________________________________________________________________________________________
average_pooling2d_20 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_20[0][0]       
__________________________________________________________________________________________________
activation_88 (Activation)      (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   624         activation_88[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_89 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_89[0][0]              
__________________________________________________________________________________________________
concatenate_30 (Concatenate)    (None, 25, 24, 24)   0           average_pooling2d_20[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_30[0][0]             
__________________________________________________________________________________________________
activation_90 (Activation)      (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_10 (Gl (None, 25)           0           activation_90[0][0]              
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 1)            26          global_average_pooling2d_10[0][0]
==================================================================================================
Total params: 19,999
Trainable params: 19,455
Non-trainable params: 544
__________________________________________________________________________________________________
Train on 39840 samples, validate on 7440 samples
Epoch 1/20
 - 20s - loss: 0.6361 - acc: 0.6871 - val_loss: 0.5233 - val_acc: 0.8552
Epoch 2/20
 - 17s - loss: 0.5741 - acc: 0.7513 - val_loss: 0.5035 - val_acc: 0.8448
Epoch 3/20
 - 17s - loss: 0.5524 - acc: 0.7617 - val_loss: 0.4928 - val_acc: 0.8316
Epoch 4/20
 - 17s - loss: 0.5329 - acc: 0.7714 - val_loss: 0.4948 - val_acc: 0.8212
Epoch 5/20
 - 17s - loss: 0.5214 - acc: 0.7756 - val_loss: 0.4872 - val_acc: 0.8108
Epoch 6/20
 - 17s - loss: 0.5115 - acc: 0.7801 - val_loss: 0.4699 - val_acc: 0.8198
Epoch 00006: early stopping

  32/7440 [..............................] - ETA: 1s
 320/7440 [>.............................] - ETA: 1s
 608/7440 [=>............................] - ETA: 1s
 896/7440 [==>...........................] - ETA: 1s
1184/7440 [===>..........................] - ETA: 1s
1472/7440 [====>.........................] - ETA: 1s
1760/7440 [======>.......................] - ETA: 1s
2048/7440 [=======>......................] - ETA: 0s
2336/7440 [========>.....................] - ETA: 0s
2624/7440 [=========>....................] - ETA: 0s
2912/7440 [==========>...................] - ETA: 0s
3200/7440 [===========>..................] - ETA: 0s
3488/7440 [=============>................] - ETA: 0s
3776/7440 [==============>...............] - ETA: 0s
4064/7440 [===============>..............] - ETA: 0s
4352/7440 [================>.............] - ETA: 0s
4640/7440 [=================>............] - ETA: 0s
4928/7440 [==================>...........] - ETA: 0s
5216/7440 [====================>.........] - ETA: 0s
5504/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
6080/7440 [=======================>......] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6656/7440 [=========================>....] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 1s 183us/step
Test accuracy: 0.819758064516129
Test accuracy 0.6: 0.8040322580645162
auc_score ------------------>  0.8900633021158515
[0.884, 0.89, 0.867, 0.885, 0.897, 0.854, 0.876, 0.881, 0.869, 0.89]
0.879  0.012
