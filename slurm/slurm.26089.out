python keras_dn_simple_multigpu.py
python keras_dn_simple.py
python custom_gridsearch_dn_siamese.py
python custom_gs_dn_siamese_layers_multi.py -g 1
python custom_gridsearch_dn_siamese_layers_avg.py
Column names are nb_layers_per_block, growth_rate, nb_dense_block, nb_filter, dropout, lr, epochs, opt, reduction, bn, batch_size, fc_dropout, fc_filter, fc_layers
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 35s - loss: 0.4539 - acc: 0.8017 - val_loss: 0.2299 - val_acc: 0.9172
Epoch 2/11
 - 28s - loss: 0.2209 - acc: 0.9144 - val_loss: 0.1344 - val_acc: 0.9585
Epoch 3/11
 - 29s - loss: 0.1422 - acc: 0.9511 - val_loss: 0.0786 - val_acc: 0.9808
Epoch 4/11
 - 29s - loss: 0.0979 - acc: 0.9704 - val_loss: 0.0609 - val_acc: 0.9885
Epoch 5/11
 - 29s - loss: 0.0702 - acc: 0.9807 - val_loss: 0.0469 - val_acc: 0.9892
Epoch 6/11
 - 28s - loss: 0.0575 - acc: 0.9861 - val_loss: 0.0361 - val_acc: 0.9918
Epoch 7/11
 - 29s - loss: 0.0456 - acc: 0.9894 - val_loss: 0.0295 - val_acc: 0.9956
Epoch 8/11
 - 29s - loss: 0.0411 - acc: 0.9905 - val_loss: 0.0244 - val_acc: 0.9964
Epoch 9/11
 - 29s - loss: 0.0323 - acc: 0.9938 - val_loss: 0.0211 - val_acc: 0.9975
Epoch 10/11
 - 29s - loss: 0.0266 - acc: 0.9955 - val_loss: 0.0175 - val_acc: 0.9971
Epoch 11/11
 - 29s - loss: 0.0248 - acc: 0.9957 - val_loss: 0.0146 - val_acc: 0.9982
Test accuracy:0.676
current auc_score ------------------> 0.919
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 31s - loss: 0.4873 - acc: 0.7847 - val_loss: 0.2618 - val_acc: 0.8962
Epoch 2/11
 - 28s - loss: 0.2473 - acc: 0.9007 - val_loss: 0.1618 - val_acc: 0.9425
Epoch 3/11
 - 28s - loss: 0.1630 - acc: 0.9434 - val_loss: 0.1124 - val_acc: 0.9645
Epoch 4/11
 - 28s - loss: 0.1172 - acc: 0.9626 - val_loss: 0.0810 - val_acc: 0.9788
Epoch 5/11
 - 28s - loss: 0.0844 - acc: 0.9759 - val_loss: 0.0534 - val_acc: 0.9876
Epoch 6/11
 - 28s - loss: 0.0659 - acc: 0.9817 - val_loss: 0.0411 - val_acc: 0.9906
Epoch 7/11
 - 29s - loss: 0.0513 - acc: 0.9871 - val_loss: 0.0313 - val_acc: 0.9932
Epoch 8/11
 - 28s - loss: 0.0430 - acc: 0.9905 - val_loss: 0.0246 - val_acc: 0.9951
Epoch 9/11
 - 30s - loss: 0.0360 - acc: 0.9920 - val_loss: 0.0223 - val_acc: 0.9952
Epoch 10/11
 - 29s - loss: 0.0289 - acc: 0.9945 - val_loss: 0.0213 - val_acc: 0.9957
Epoch 11/11
 - 29s - loss: 0.0266 - acc: 0.9949 - val_loss: 0.0184 - val_acc: 0.9969
Test accuracy:0.678
current auc_score ------------------> 0.879
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 33s - loss: 0.4755 - acc: 0.7922 - val_loss: 0.7617 - val_acc: 0.6345
Epoch 2/11
 - 30s - loss: 0.2470 - acc: 0.9002 - val_loss: 0.9827 - val_acc: 0.5732
Epoch 3/11
 - 30s - loss: 0.1668 - acc: 0.9403 - val_loss: 0.8186 - val_acc: 0.6177
Epoch 4/11
 - 30s - loss: 0.1153 - acc: 0.9632 - val_loss: 0.8540 - val_acc: 0.6074

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 5/11
 - 30s - loss: 0.0828 - acc: 0.9766 - val_loss: 0.0683 - val_acc: 0.9817
Epoch 6/11
 - 30s - loss: 0.0693 - acc: 0.9812 - val_loss: 0.0521 - val_acc: 0.9866
Epoch 7/11
 - 30s - loss: 0.0622 - acc: 0.9842 - val_loss: 0.0420 - val_acc: 0.9903
Epoch 8/11
 - 30s - loss: 0.0542 - acc: 0.9864 - val_loss: 0.0393 - val_acc: 0.9905
Epoch 9/11
 - 30s - loss: 0.0489 - acc: 0.9878 - val_loss: 0.0351 - val_acc: 0.9918
Epoch 10/11
 - 30s - loss: 0.0410 - acc: 0.9911 - val_loss: 0.0296 - val_acc: 0.9928
Epoch 11/11
 - 30s - loss: 0.0363 - acc: 0.9935 - val_loss: 0.0292 - val_acc: 0.9928
Test accuracy:0.606
current auc_score ------------------> 0.883
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 32s - loss: 0.4876 - acc: 0.7858 - val_loss: 2.0888 - val_acc: 0.5179
Epoch 2/11
 - 30s - loss: 0.2371 - acc: 0.9066 - val_loss: 0.9576 - val_acc: 0.5884
Epoch 3/11
 - 30s - loss: 0.1487 - acc: 0.9468 - val_loss: 0.7588 - val_acc: 0.6227
Epoch 4/11
 - 29s - loss: 0.1055 - acc: 0.9664 - val_loss: 0.6332 - val_acc: 0.7152
Epoch 5/11
 - 30s - loss: 0.0806 - acc: 0.9761 - val_loss: 0.7935 - val_acc: 0.6783
Epoch 6/11
 - 30s - loss: 0.0630 - acc: 0.9831 - val_loss: 0.8395 - val_acc: 0.6988
Epoch 7/11
 - 29s - loss: 0.0502 - acc: 0.9875 - val_loss: 0.7683 - val_acc: 0.6856

Epoch 00007: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 8/11
 - 29s - loss: 0.0354 - acc: 0.9924 - val_loss: 0.4122 - val_acc: 0.8380
Epoch 9/11
 - 29s - loss: 0.0301 - acc: 0.9947 - val_loss: 0.4675 - val_acc: 0.8233
Epoch 10/11
 - 30s - loss: 0.0277 - acc: 0.9948 - val_loss: 0.0192 - val_acc: 0.9962
Epoch 11/11
 - 30s - loss: 0.0254 - acc: 0.9955 - val_loss: 0.0180 - val_acc: 0.9966
Test accuracy:0.712
current auc_score ------------------> 0.882
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 33s - loss: 0.5015 - acc: 0.7766 - val_loss: 1.0700 - val_acc: 0.5730
Epoch 2/11
 - 30s - loss: 0.2534 - acc: 0.8986 - val_loss: 0.7296 - val_acc: 0.6306
Epoch 3/11
 - 29s - loss: 0.1617 - acc: 0.9432 - val_loss: 0.1022 - val_acc: 0.9670
Epoch 4/11
 - 30s - loss: 0.1135 - acc: 0.9638 - val_loss: 0.0797 - val_acc: 0.9784
Epoch 5/11
 - 29s - loss: 0.0851 - acc: 0.9748 - val_loss: 0.0577 - val_acc: 0.9861
Epoch 6/11
 - 29s - loss: 0.0659 - acc: 0.9823 - val_loss: 0.0434 - val_acc: 0.9901
Epoch 7/11
 - 30s - loss: 0.0533 - acc: 0.9868 - val_loss: 0.0311 - val_acc: 0.9946
Epoch 8/11
 - 31s - loss: 0.0439 - acc: 0.9897 - val_loss: 0.0252 - val_acc: 0.9967
Epoch 9/11
 - 30s - loss: 0.0367 - acc: 0.9923 - val_loss: 0.0229 - val_acc: 0.9957
Epoch 10/11
 - 31s - loss: 0.0326 - acc: 0.9937 - val_loss: 0.0177 - val_acc: 0.9977
Epoch 11/11
 - 30s - loss: 0.0266 - acc: 0.9951 - val_loss: 0.0197 - val_acc: 0.9961
Test accuracy:0.719
current auc_score ------------------> 0.891
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 32s - loss: 0.5247 - acc: 0.7686 - val_loss: 1.7660 - val_acc: 0.5671
Epoch 2/11
 - 29s - loss: 0.2618 - acc: 0.8926 - val_loss: 1.5069 - val_acc: 0.5548
Epoch 3/11
 - 30s - loss: 0.1675 - acc: 0.9390 - val_loss: 0.1156 - val_acc: 0.9681
Epoch 4/11
 - 29s - loss: 0.1179 - acc: 0.9615 - val_loss: 0.0778 - val_acc: 0.9807
Epoch 5/11
 - 29s - loss: 0.0873 - acc: 0.9739 - val_loss: 0.0517 - val_acc: 0.9892
Epoch 6/11
 - 30s - loss: 0.0659 - acc: 0.9823 - val_loss: 0.0409 - val_acc: 0.9910
Epoch 7/11
 - 29s - loss: 0.0538 - acc: 0.9864 - val_loss: 0.0393 - val_acc: 0.9925
Epoch 8/11
 - 30s - loss: 0.0460 - acc: 0.9890 - val_loss: 0.0332 - val_acc: 0.9928
Epoch 9/11
 - 29s - loss: 0.0388 - acc: 0.9914 - val_loss: 0.0274 - val_acc: 0.9947
Epoch 10/11
 - 30s - loss: 0.0333 - acc: 0.9933 - val_loss: 0.0204 - val_acc: 0.9965
Epoch 11/11
 - 30s - loss: 0.0288 - acc: 0.9940 - val_loss: 0.0188 - val_acc: 0.9967
Test accuracy:0.715
current auc_score ------------------> 0.894
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 34s - loss: 0.4998 - acc: 0.7836 - val_loss: 0.2604 - val_acc: 0.9006
Epoch 2/11
 - 29s - loss: 0.2499 - acc: 0.8998 - val_loss: 0.1568 - val_acc: 0.9518
Epoch 3/11
 - 28s - loss: 0.1611 - acc: 0.9431 - val_loss: 0.1190 - val_acc: 0.9726
Epoch 4/11
 - 28s - loss: 0.1090 - acc: 0.9653 - val_loss: 0.0703 - val_acc: 0.9821
Epoch 5/11
 - 28s - loss: 0.0846 - acc: 0.9759 - val_loss: 0.0580 - val_acc: 0.9872
Epoch 6/11
 - 29s - loss: 0.0655 - acc: 0.9823 - val_loss: 0.0451 - val_acc: 0.9907
Epoch 7/11
 - 28s - loss: 0.0510 - acc: 0.9878 - val_loss: 0.0326 - val_acc: 0.9927
Epoch 8/11
 - 28s - loss: 0.0422 - acc: 0.9898 - val_loss: 0.0291 - val_acc: 0.9935
Epoch 9/11
 - 28s - loss: 0.0354 - acc: 0.9925 - val_loss: 0.0274 - val_acc: 0.9935
Epoch 10/11
 - 28s - loss: 0.0305 - acc: 0.9937 - val_loss: 0.0223 - val_acc: 0.9956
Epoch 11/11
 - 28s - loss: 0.0273 - acc: 0.9945 - val_loss: 0.0165 - val_acc: 0.9976
Test accuracy:0.758
current auc_score ------------------> 0.942
Saved model to disk
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 32s - loss: 0.4982 - acc: 0.7759 - val_loss: 1.3022 - val_acc: 0.5373
Epoch 2/11
 - 29s - loss: 0.2444 - acc: 0.9030 - val_loss: 0.6691 - val_acc: 0.6258
Epoch 3/11
 - 29s - loss: 0.1617 - acc: 0.9413 - val_loss: 2.2098 - val_acc: 0.5168
Epoch 4/11
 - 29s - loss: 0.1110 - acc: 0.9657 - val_loss: 2.1505 - val_acc: 0.5270
Epoch 5/11
 - 29s - loss: 0.0820 - acc: 0.9763 - val_loss: 0.5703 - val_acc: 0.7246
Epoch 6/11
 - 28s - loss: 0.0645 - acc: 0.9824 - val_loss: 1.5646 - val_acc: 0.5584
Epoch 7/11
 - 29s - loss: 0.0541 - acc: 0.9859 - val_loss: 0.0305 - val_acc: 0.9935
Epoch 8/11
 - 31s - loss: 0.0429 - acc: 0.9902 - val_loss: 0.0276 - val_acc: 0.9957
Epoch 9/11
 - 30s - loss: 0.0331 - acc: 0.9938 - val_loss: 0.0202 - val_acc: 0.9962
Epoch 10/11
 - 30s - loss: 0.0304 - acc: 0.9938 - val_loss: 0.0177 - val_acc: 0.9962
Epoch 11/11
 - 29s - loss: 0.0262 - acc: 0.9952 - val_loss: 0.0158 - val_acc: 0.9974
Test accuracy:0.649
current auc_score ------------------> 0.890
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 33s - loss: 0.4503 - acc: 0.8051 - val_loss: 0.2698 - val_acc: 0.8881
Epoch 2/11
 - 30s - loss: 0.2359 - acc: 0.9067 - val_loss: 0.1658 - val_acc: 0.9408
Epoch 3/11
 - 29s - loss: 0.1591 - acc: 0.9449 - val_loss: 0.1100 - val_acc: 0.9660
Epoch 4/11
 - 29s - loss: 0.1127 - acc: 0.9638 - val_loss: 0.0813 - val_acc: 0.9773
Epoch 5/11
 - 30s - loss: 0.0816 - acc: 0.9761 - val_loss: 0.0546 - val_acc: 0.9866
Epoch 6/11
 - 30s - loss: 0.0637 - acc: 0.9829 - val_loss: 0.0380 - val_acc: 0.9907
Epoch 7/11
 - 30s - loss: 0.0502 - acc: 0.9872 - val_loss: 0.0400 - val_acc: 0.9901
Epoch 8/11
 - 29s - loss: 0.0398 - acc: 0.9907 - val_loss: 0.0241 - val_acc: 0.9964
Epoch 9/11
 - 29s - loss: 0.0347 - acc: 0.9929 - val_loss: 0.0241 - val_acc: 0.9954
Epoch 10/11
 - 29s - loss: 0.0288 - acc: 0.9943 - val_loss: 0.0175 - val_acc: 0.9974
Epoch 11/11
 - 30s - loss: 0.0254 - acc: 0.9949 - val_loss: 0.0161 - val_acc: 0.9972
Test accuracy:0.723
current auc_score ------------------> 0.856
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 33s - loss: 0.5045 - acc: 0.7736 - val_loss: 2.3708 - val_acc: 0.5073
Epoch 2/11
 - 29s - loss: 0.2553 - acc: 0.8986 - val_loss: 1.0620 - val_acc: 0.5715
Epoch 3/11
 - 29s - loss: 0.1658 - acc: 0.9410 - val_loss: 0.7914 - val_acc: 0.5590
Epoch 4/11
 - 29s - loss: 0.1144 - acc: 0.9644 - val_loss: 0.7059 - val_acc: 0.6565
Epoch 5/11
 - 29s - loss: 0.0828 - acc: 0.9760 - val_loss: 0.7471 - val_acc: 0.6029
Epoch 6/11
 - 29s - loss: 0.0649 - acc: 0.9823 - val_loss: 0.0454 - val_acc: 0.9891
Epoch 7/11
 - 30s - loss: 0.0541 - acc: 0.9863 - val_loss: 0.0367 - val_acc: 0.9921
Epoch 8/11
 - 30s - loss: 0.0430 - acc: 0.9901 - val_loss: 0.0277 - val_acc: 0.9940
Epoch 9/11
 - 29s - loss: 0.0350 - acc: 0.9926 - val_loss: 0.0239 - val_acc: 0.9961
Epoch 10/11
 - 28s - loss: 0.0298 - acc: 0.9939 - val_loss: 0.0173 - val_acc: 0.9974
Epoch 11/11
 - 29s - loss: 0.0273 - acc: 0.9947 - val_loss: 0.0157 - val_acc: 0.9976
Test accuracy:0.704
current auc_score ------------------> 0.868
accuracies:  [0.6755376344086022, 0.6776881720430108, 0.6060483870967742, 0.7116935483870968, 0.7188172043010753, 0.7146505376344086, 0.7580645161290323, 0.6490591397849462, 0.7228494623655914, 0.703763440860215]
aucs:  [0.9189, 0.8793, 0.8828, 0.8823, 0.8915, 0.894, 0.942, 0.8898, 0.8562, 0.8678]
mean and std AUC:  0.89+/-0.023  max:   0.942
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 36s - loss: 0.4648 - acc: 0.7948 - val_loss: 0.2589 - val_acc: 0.8987
Epoch 2/11
 - 32s - loss: 0.2255 - acc: 0.9111 - val_loss: 0.1592 - val_acc: 0.9514
Epoch 3/11
 - 32s - loss: 0.1417 - acc: 0.9530 - val_loss: 0.0967 - val_acc: 0.9740
Epoch 4/11
 - 32s - loss: 0.0961 - acc: 0.9721 - val_loss: 0.0657 - val_acc: 0.9868
Epoch 5/11
 - 32s - loss: 0.0701 - acc: 0.9816 - val_loss: 0.0490 - val_acc: 0.9892
Epoch 6/11
 - 33s - loss: 0.0565 - acc: 0.9859 - val_loss: 0.0377 - val_acc: 0.9928
Epoch 7/11
 - 32s - loss: 0.0449 - acc: 0.9898 - val_loss: 0.0303 - val_acc: 0.9936
Epoch 8/11
 - 33s - loss: 0.0404 - acc: 0.9913 - val_loss: 0.0294 - val_acc: 0.9940
Epoch 9/11
 - 33s - loss: 0.0316 - acc: 0.9940 - val_loss: 0.0212 - val_acc: 0.9962
Epoch 10/11
 - 33s - loss: 0.0273 - acc: 0.9954 - val_loss: 0.0201 - val_acc: 0.9969
Epoch 11/11
 - 32s - loss: 0.0259 - acc: 0.9951 - val_loss: 0.0151 - val_acc: 0.9971
Test accuracy:0.734
current auc_score ------------------> 0.913
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 36s - loss: 0.4823 - acc: 0.7860 - val_loss: 0.6236 - val_acc: 0.6955
Epoch 2/11
 - 34s - loss: 0.2426 - acc: 0.9049 - val_loss: 0.1575 - val_acc: 0.9506
Epoch 3/11
 - 33s - loss: 0.1574 - acc: 0.9472 - val_loss: 0.1013 - val_acc: 0.9729
Epoch 4/11
 - 33s - loss: 0.1080 - acc: 0.9680 - val_loss: 0.0740 - val_acc: 0.9836
Epoch 5/11
 - 33s - loss: 0.0809 - acc: 0.9788 - val_loss: 0.0489 - val_acc: 0.9900
Epoch 6/11
 - 33s - loss: 0.0624 - acc: 0.9844 - val_loss: 0.0427 - val_acc: 0.9920
Epoch 7/11
 - 33s - loss: 0.0520 - acc: 0.9870 - val_loss: 0.0296 - val_acc: 0.9940
Epoch 8/11
 - 33s - loss: 0.0421 - acc: 0.9909 - val_loss: 0.0237 - val_acc: 0.9954
Epoch 9/11
 - 33s - loss: 0.0335 - acc: 0.9936 - val_loss: 0.0201 - val_acc: 0.9965
Epoch 10/11
 - 33s - loss: 0.0287 - acc: 0.9954 - val_loss: 0.0165 - val_acc: 0.9977
Epoch 11/11
 - 33s - loss: 0.0271 - acc: 0.9952 - val_loss: 0.0138 - val_acc: 0.9986
Test accuracy:0.655
current auc_score ------------------> 0.871
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 37s - loss: 0.4595 - acc: 0.7992 - val_loss: 0.2990 - val_acc: 0.8701
Epoch 2/11
 - 33s - loss: 0.2373 - acc: 0.9078 - val_loss: 0.1482 - val_acc: 0.9558
Epoch 3/11
 - 33s - loss: 0.1543 - acc: 0.9463 - val_loss: 0.1004 - val_acc: 0.9720
Epoch 4/11
 - 33s - loss: 0.1060 - acc: 0.9682 - val_loss: 0.0733 - val_acc: 0.9844
Epoch 5/11
 - 33s - loss: 0.0786 - acc: 0.9789 - val_loss: 0.0495 - val_acc: 0.9916
Epoch 6/11
 - 33s - loss: 0.0627 - acc: 0.9847 - val_loss: 0.0399 - val_acc: 0.9932
Epoch 7/11
 - 33s - loss: 0.0487 - acc: 0.9892 - val_loss: 0.0311 - val_acc: 0.9957
Epoch 8/11
 - 33s - loss: 0.0393 - acc: 0.9918 - val_loss: 0.0225 - val_acc: 0.9964
Epoch 9/11
 - 33s - loss: 0.0359 - acc: 0.9919 - val_loss: 0.0191 - val_acc: 0.9967
Epoch 10/11
 - 33s - loss: 0.0305 - acc: 0.9940 - val_loss: 0.0158 - val_acc: 0.9981
Epoch 11/11
 - 33s - loss: 0.0270 - acc: 0.9946 - val_loss: 0.0133 - val_acc: 0.9989
Test accuracy:0.696
current auc_score ------------------> 0.905
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 36s - loss: 0.4761 - acc: 0.7922 - val_loss: 0.2932 - val_acc: 0.8775
Epoch 2/11
 - 33s - loss: 0.2512 - acc: 0.9013 - val_loss: 0.1501 - val_acc: 0.9509
Epoch 3/11
 - 33s - loss: 0.1650 - acc: 0.9437 - val_loss: 0.1115 - val_acc: 0.9676
Epoch 4/11
 - 33s - loss: 0.1096 - acc: 0.9667 - val_loss: 0.0710 - val_acc: 0.9816
Epoch 5/11
 - 33s - loss: 0.0864 - acc: 0.9759 - val_loss: 0.0531 - val_acc: 0.9880
Epoch 6/11
 - 33s - loss: 0.0668 - acc: 0.9832 - val_loss: 0.0428 - val_acc: 0.9895
Epoch 7/11
 - 33s - loss: 0.0524 - acc: 0.9878 - val_loss: 0.0399 - val_acc: 0.9920
Epoch 8/11
 - 33s - loss: 0.0444 - acc: 0.9901 - val_loss: 0.0248 - val_acc: 0.9954
Epoch 9/11
 - 33s - loss: 0.0373 - acc: 0.9921 - val_loss: 0.0210 - val_acc: 0.9962
Epoch 10/11
 - 33s - loss: 0.0332 - acc: 0.9931 - val_loss: 0.0208 - val_acc: 0.9962
Epoch 11/11
 - 33s - loss: 0.0293 - acc: 0.9948 - val_loss: 0.0198 - val_acc: 0.9969
Test accuracy:0.644
current auc_score ------------------> 0.850
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 36s - loss: 0.4884 - acc: 0.7828 - val_loss: 3.0937 - val_acc: 0.5053
Epoch 2/11
 - 33s - loss: 0.2403 - acc: 0.9045 - val_loss: 0.8437 - val_acc: 0.5860
Epoch 3/11
 - 33s - loss: 0.1488 - acc: 0.9501 - val_loss: 0.0994 - val_acc: 0.9735
Epoch 4/11
 - 33s - loss: 0.0988 - acc: 0.9709 - val_loss: 0.0687 - val_acc: 0.9849
Epoch 5/11
 - 33s - loss: 0.0753 - acc: 0.9797 - val_loss: 0.0498 - val_acc: 0.9901
Epoch 6/11
 - 33s - loss: 0.0614 - acc: 0.9843 - val_loss: 0.0345 - val_acc: 0.9931
Epoch 7/11
 - 33s - loss: 0.0486 - acc: 0.9889 - val_loss: 0.0279 - val_acc: 0.9951
Epoch 8/11
 - 33s - loss: 0.0370 - acc: 0.9926 - val_loss: 0.0235 - val_acc: 0.9959
Epoch 9/11
 - 33s - loss: 0.0322 - acc: 0.9935 - val_loss: 0.0180 - val_acc: 0.9985
Epoch 10/11
 - 33s - loss: 0.0296 - acc: 0.9936 - val_loss: 0.0154 - val_acc: 0.9982
Epoch 11/11
 - 33s - loss: 0.0248 - acc: 0.9961 - val_loss: 0.0136 - val_acc: 0.9979
Test accuracy:0.689
current auc_score ------------------> 0.871
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 37s - loss: 0.5029 - acc: 0.7739 - val_loss: 0.2909 - val_acc: 0.8785
Epoch 2/11
 - 33s - loss: 0.2396 - acc: 0.9060 - val_loss: 0.1338 - val_acc: 0.9613
Epoch 3/11
 - 33s - loss: 0.1435 - acc: 0.9531 - val_loss: 0.0882 - val_acc: 0.9800
Epoch 4/11
 - 33s - loss: 0.0982 - acc: 0.9720 - val_loss: 0.0663 - val_acc: 0.9847
Epoch 5/11
 - 33s - loss: 0.0741 - acc: 0.9807 - val_loss: 0.0399 - val_acc: 0.9922
Epoch 6/11
 - 33s - loss: 0.0582 - acc: 0.9865 - val_loss: 0.0375 - val_acc: 0.9931
Epoch 7/11
 - 33s - loss: 0.0460 - acc: 0.9901 - val_loss: 0.0266 - val_acc: 0.9954
Epoch 8/11
 - 33s - loss: 0.0376 - acc: 0.9919 - val_loss: 0.0227 - val_acc: 0.9965
Epoch 9/11
 - 33s - loss: 0.0326 - acc: 0.9934 - val_loss: 0.0182 - val_acc: 0.9967
Epoch 10/11
 - 33s - loss: 0.0272 - acc: 0.9958 - val_loss: 0.0148 - val_acc: 0.9975
Epoch 11/11
 - 33s - loss: 0.0263 - acc: 0.9951 - val_loss: 0.0141 - val_acc: 0.9982
Test accuracy:0.611
current auc_score ------------------> 0.893
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 38s - loss: 0.4822 - acc: 0.7898 - val_loss: 0.2658 - val_acc: 0.8975
Epoch 2/11
 - 34s - loss: 0.2392 - acc: 0.9084 - val_loss: 0.1406 - val_acc: 0.9557
Epoch 3/11
 - 33s - loss: 0.1479 - acc: 0.9502 - val_loss: 0.0963 - val_acc: 0.9760
Epoch 4/11
 - 33s - loss: 0.1083 - acc: 0.9676 - val_loss: 0.0654 - val_acc: 0.9827
Epoch 5/11
 - 34s - loss: 0.0811 - acc: 0.9773 - val_loss: 0.0511 - val_acc: 0.9880
Epoch 6/11
 - 33s - loss: 0.0621 - acc: 0.9842 - val_loss: 0.0448 - val_acc: 0.9905
Epoch 7/11
 - 33s - loss: 0.0511 - acc: 0.9880 - val_loss: 0.0367 - val_acc: 0.9926
Epoch 8/11
 - 34s - loss: 0.0429 - acc: 0.9905 - val_loss: 0.0245 - val_acc: 0.9961
Epoch 9/11
 - 33s - loss: 0.0368 - acc: 0.9919 - val_loss: 0.0217 - val_acc: 0.9971
Epoch 10/11
 - 33s - loss: 0.0288 - acc: 0.9946 - val_loss: 0.0173 - val_acc: 0.9971
Epoch 11/11
 - 33s - loss: 0.0274 - acc: 0.9947 - val_loss: 0.0167 - val_acc: 0.9974
Test accuracy:0.716
current auc_score ------------------> 0.900
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 36s - loss: 0.4464 - acc: 0.8054 - val_loss: 1.8485 - val_acc: 0.4997
Epoch 2/11
 - 33s - loss: 0.2113 - acc: 0.9218 - val_loss: 0.7750 - val_acc: 0.6304
Epoch 3/11
 - 33s - loss: 0.1301 - acc: 0.9579 - val_loss: 0.6354 - val_acc: 0.6793
Epoch 4/11
 - 34s - loss: 0.0922 - acc: 0.9729 - val_loss: 1.3369 - val_acc: 0.5301
Epoch 5/11
 - 33s - loss: 0.0679 - acc: 0.9827 - val_loss: 1.5721 - val_acc: 0.5156
Epoch 6/11
 - 33s - loss: 0.0518 - acc: 0.9890 - val_loss: 0.4787 - val_acc: 0.7877
Epoch 7/11
 - 33s - loss: 0.0429 - acc: 0.9906 - val_loss: 1.8020 - val_acc: 0.5102
Epoch 8/11
 - 33s - loss: 0.0344 - acc: 0.9935 - val_loss: 0.5256 - val_acc: 0.7697
Epoch 9/11
 - 33s - loss: 0.0301 - acc: 0.9948 - val_loss: 0.4808 - val_acc: 0.7853

Epoch 00009: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 10/11
 - 33s - loss: 0.0240 - acc: 0.9961 - val_loss: 0.0144 - val_acc: 0.9985
Epoch 11/11
 - 33s - loss: 0.0204 - acc: 0.9972 - val_loss: 0.0130 - val_acc: 0.9980
Test accuracy:0.662
current auc_score ------------------> 0.905
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 36s - loss: 0.4141 - acc: 0.8226 - val_loss: 0.2128 - val_acc: 0.9248
Epoch 2/11
 - 33s - loss: 0.2009 - acc: 0.9240 - val_loss: 0.1381 - val_acc: 0.9538
Epoch 3/11
 - 33s - loss: 0.1318 - acc: 0.9562 - val_loss: 0.0766 - val_acc: 0.9808
Epoch 4/11
 - 33s - loss: 0.0899 - acc: 0.9735 - val_loss: 0.0549 - val_acc: 0.9885
Epoch 5/11
 - 33s - loss: 0.0645 - acc: 0.9831 - val_loss: 0.0403 - val_acc: 0.9925
Epoch 6/11
 - 33s - loss: 0.0542 - acc: 0.9861 - val_loss: 0.0370 - val_acc: 0.9939
Epoch 7/11
 - 33s - loss: 0.0432 - acc: 0.9900 - val_loss: 0.0258 - val_acc: 0.9959
Epoch 8/11
 - 33s - loss: 0.0371 - acc: 0.9917 - val_loss: 0.0231 - val_acc: 0.9960
Epoch 9/11
 - 33s - loss: 0.0313 - acc: 0.9935 - val_loss: 0.0179 - val_acc: 0.9975
Epoch 10/11
 - 32s - loss: 0.0267 - acc: 0.9953 - val_loss: 0.0174 - val_acc: 0.9976
Epoch 11/11
 - 33s - loss: 0.0224 - acc: 0.9960 - val_loss: 0.0131 - val_acc: 0.9987
Test accuracy:0.592
current auc_score ------------------> 0.868
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 36s - loss: 0.5286 - acc: 0.7627 - val_loss: 0.3537 - val_acc: 0.8376
Epoch 2/11
 - 33s - loss: 0.2716 - acc: 0.8899 - val_loss: 0.1851 - val_acc: 0.9391
Epoch 3/11
 - 33s - loss: 0.1744 - acc: 0.9377 - val_loss: 0.1203 - val_acc: 0.9656
Epoch 4/11
 - 33s - loss: 0.1209 - acc: 0.9612 - val_loss: 0.0810 - val_acc: 0.9807
Epoch 5/11
 - 33s - loss: 0.0933 - acc: 0.9723 - val_loss: 0.0682 - val_acc: 0.9857
Epoch 6/11
 - 33s - loss: 0.0700 - acc: 0.9803 - val_loss: 0.0509 - val_acc: 0.9903
Epoch 7/11
 - 33s - loss: 0.0538 - acc: 0.9875 - val_loss: 0.0380 - val_acc: 0.9932
Epoch 8/11
 - 33s - loss: 0.0457 - acc: 0.9894 - val_loss: 0.0284 - val_acc: 0.9949
Epoch 9/11
 - 33s - loss: 0.0404 - acc: 0.9911 - val_loss: 0.0303 - val_acc: 0.9955
Epoch 10/11
 - 33s - loss: 0.0323 - acc: 0.9939 - val_loss: 0.0191 - val_acc: 0.9975
Epoch 11/11
 - 33s - loss: 0.0273 - acc: 0.9955 - val_loss: 0.0171 - val_acc: 0.9979
Test accuracy:0.674
current auc_score ------------------> 0.910
accuracies:  [0.734005376344086, 0.6549731182795699, 0.6958333333333333, 0.6440860215053763, 0.6889784946236559, 0.6108870967741935, 0.7158602150537634, 0.6620967741935484, 0.5923387096774193, 0.6744623655913978]
aucs:  [0.9135, 0.8711, 0.9048, 0.8497, 0.8709, 0.8931, 0.9003, 0.9055, 0.8684, 0.9102]
mean and std AUC:  0.889+/-0.021  max:   0.9135
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 47s - loss: 0.4669 - acc: 0.8003 - val_loss: 0.9370 - val_acc: 0.5713
Epoch 2/11
 - 44s - loss: 0.2246 - acc: 0.9136 - val_loss: 0.7798 - val_acc: 0.6286
Epoch 3/11
 - 44s - loss: 0.1386 - acc: 0.9538 - val_loss: 0.0807 - val_acc: 0.9782
Epoch 4/11
 - 44s - loss: 0.0986 - acc: 0.9729 - val_loss: 0.0544 - val_acc: 0.9858
Epoch 5/11
 - 43s - loss: 0.0707 - acc: 0.9820 - val_loss: 0.0481 - val_acc: 0.9893
Epoch 6/11
 - 43s - loss: 0.0551 - acc: 0.9879 - val_loss: 0.0342 - val_acc: 0.9931
Epoch 7/11
 - 44s - loss: 0.0440 - acc: 0.9907 - val_loss: 0.0270 - val_acc: 0.9956
Epoch 8/11
 - 44s - loss: 0.0353 - acc: 0.9935 - val_loss: 0.0194 - val_acc: 0.9972
Epoch 9/11
 - 44s - loss: 0.0297 - acc: 0.9951 - val_loss: 0.0189 - val_acc: 0.9966
Epoch 10/11
 - 44s - loss: 0.0288 - acc: 0.9950 - val_loss: 0.0187 - val_acc: 0.9979
Epoch 11/11
 - 44s - loss: 0.0243 - acc: 0.9968 - val_loss: 0.0140 - val_acc: 0.9985
Test accuracy:0.683
current auc_score ------------------> 0.878
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 47s - loss: 0.4480 - acc: 0.8055 - val_loss: 2.6558 - val_acc: 0.5039
Epoch 2/11
 - 44s - loss: 0.2131 - acc: 0.9223 - val_loss: 0.6380 - val_acc: 0.6490
Epoch 3/11
 - 43s - loss: 0.1393 - acc: 0.9552 - val_loss: 0.6948 - val_acc: 0.6463
Epoch 4/11
 - 43s - loss: 0.0997 - acc: 0.9731 - val_loss: 1.2411 - val_acc: 0.5326
Epoch 5/11
 - 43s - loss: 0.0741 - acc: 0.9823 - val_loss: 1.0779 - val_acc: 0.5611

Epoch 00005: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 6/11
 - 43s - loss: 0.0511 - acc: 0.9900 - val_loss: 1.0571 - val_acc: 0.5617
Epoch 00006: early stopping
Test accuracy:0.516
current auc_score ------------------> 0.684
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 46s - loss: 0.5355 - acc: 0.7576 - val_loss: 0.2994 - val_acc: 0.8768
Epoch 2/11
 - 43s - loss: 0.2676 - acc: 0.8929 - val_loss: 0.1828 - val_acc: 0.9458
Epoch 3/11
 - 43s - loss: 0.1635 - acc: 0.9466 - val_loss: 0.1013 - val_acc: 0.9755
Epoch 4/11
 - 43s - loss: 0.1117 - acc: 0.9690 - val_loss: 0.0685 - val_acc: 0.9846
Epoch 5/11
 - 43s - loss: 0.0806 - acc: 0.9804 - val_loss: 0.0568 - val_acc: 0.9881
Epoch 6/11
 - 43s - loss: 0.0627 - acc: 0.9864 - val_loss: 0.0374 - val_acc: 0.9927
Epoch 7/11
 - 44s - loss: 0.0473 - acc: 0.9914 - val_loss: 0.0386 - val_acc: 0.9921
Epoch 8/11
 - 45s - loss: 0.0414 - acc: 0.9921 - val_loss: 0.0285 - val_acc: 0.9951
Epoch 9/11
 - 44s - loss: 0.0385 - acc: 0.9928 - val_loss: 0.0233 - val_acc: 0.9966
Epoch 10/11
 - 44s - loss: 0.0305 - acc: 0.9950 - val_loss: 0.0237 - val_acc: 0.9971
Epoch 11/11
 - 44s - loss: 0.0280 - acc: 0.9952 - val_loss: 0.0194 - val_acc: 0.9971
Test accuracy:0.663
current auc_score ------------------> 0.901
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 47s - loss: 0.4226 - acc: 0.8179 - val_loss: 0.2497 - val_acc: 0.9101
Epoch 2/11
 - 43s - loss: 0.1976 - acc: 0.9292 - val_loss: 0.1428 - val_acc: 0.9646
Epoch 3/11
 - 43s - loss: 0.1229 - acc: 0.9639 - val_loss: 0.0776 - val_acc: 0.9807
Epoch 4/11
 - 43s - loss: 0.0856 - acc: 0.9779 - val_loss: 0.0617 - val_acc: 0.9900
Epoch 5/11
 - 43s - loss: 0.0645 - acc: 0.9852 - val_loss: 0.0373 - val_acc: 0.9931
Epoch 6/11
 - 43s - loss: 0.0525 - acc: 0.9885 - val_loss: 0.0321 - val_acc: 0.9959
Epoch 7/11
 - 43s - loss: 0.0442 - acc: 0.9909 - val_loss: 0.0261 - val_acc: 0.9972
Epoch 8/11
 - 43s - loss: 0.0351 - acc: 0.9941 - val_loss: 0.0247 - val_acc: 0.9971
Epoch 9/11
 - 43s - loss: 0.0291 - acc: 0.9955 - val_loss: 0.0169 - val_acc: 0.9980
Epoch 10/11
 - 43s - loss: 0.0265 - acc: 0.9959 - val_loss: 0.0155 - val_acc: 0.9980
Epoch 11/11
 - 43s - loss: 0.0223 - acc: 0.9973 - val_loss: 0.0143 - val_acc: 0.9984
Test accuracy:0.626
current auc_score ------------------> 0.853
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 46s - loss: 0.4641 - acc: 0.7945 - val_loss: 1.7292 - val_acc: 0.4989
Epoch 2/11
 - 43s - loss: 0.2285 - acc: 0.9132 - val_loss: 0.1569 - val_acc: 0.9467
Epoch 3/11
 - 43s - loss: 0.1486 - acc: 0.9521 - val_loss: 0.1166 - val_acc: 0.9665
Epoch 4/11
 - 43s - loss: 0.1025 - acc: 0.9714 - val_loss: 0.0710 - val_acc: 0.9842
Epoch 5/11
 - 43s - loss: 0.0748 - acc: 0.9813 - val_loss: 0.0470 - val_acc: 0.9912
Epoch 6/11
 - 43s - loss: 0.0579 - acc: 0.9874 - val_loss: 0.0390 - val_acc: 0.9933
Epoch 7/11
 - 43s - loss: 0.0452 - acc: 0.9910 - val_loss: 0.0274 - val_acc: 0.9955
Epoch 8/11
 - 43s - loss: 0.0382 - acc: 0.9934 - val_loss: 0.0258 - val_acc: 0.9965
Epoch 9/11
 - 43s - loss: 0.0319 - acc: 0.9944 - val_loss: 0.0205 - val_acc: 0.9976
Epoch 10/11
 - 43s - loss: 0.0297 - acc: 0.9952 - val_loss: 0.0223 - val_acc: 0.9977
Epoch 11/11
 - 43s - loss: 0.0263 - acc: 0.9963 - val_loss: 0.0182 - val_acc: 0.9980
Test accuracy:0.662
current auc_score ------------------> 0.904
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 48s - loss: 0.4571 - acc: 0.7999 - val_loss: 0.3161 - val_acc: 0.8589
Epoch 2/11
 - 44s - loss: 0.2168 - acc: 0.9177 - val_loss: 0.1488 - val_acc: 0.9621
Epoch 3/11
 - 44s - loss: 0.1392 - acc: 0.9546 - val_loss: 0.1041 - val_acc: 0.9780
Epoch 4/11
 - 44s - loss: 0.0958 - acc: 0.9731 - val_loss: 0.0809 - val_acc: 0.9828
Epoch 5/11
 - 44s - loss: 0.0744 - acc: 0.9811 - val_loss: 0.0533 - val_acc: 0.9920
Epoch 6/11
 - 44s - loss: 0.0576 - acc: 0.9874 - val_loss: 0.0409 - val_acc: 0.9944
Epoch 7/11
 - 44s - loss: 0.0448 - acc: 0.9917 - val_loss: 0.0315 - val_acc: 0.9951
Epoch 8/11
 - 43s - loss: 0.0370 - acc: 0.9934 - val_loss: 0.0247 - val_acc: 0.9966
Epoch 9/11
 - 43s - loss: 0.0305 - acc: 0.9951 - val_loss: 0.0199 - val_acc: 0.9984
Epoch 10/11
 - 44s - loss: 0.0276 - acc: 0.9951 - val_loss: 0.0166 - val_acc: 0.9986
Epoch 11/11
 - 44s - loss: 0.0241 - acc: 0.9964 - val_loss: 0.0141 - val_acc: 0.9991
Test accuracy:0.681
current auc_score ------------------> 0.876
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 46s - loss: 0.4536 - acc: 0.7998 - val_loss: 0.8975 - val_acc: 0.6002
Epoch 2/11
 - 43s - loss: 0.2260 - acc: 0.9145 - val_loss: 0.1712 - val_acc: 0.9468
Epoch 3/11
 - 43s - loss: 0.1438 - acc: 0.9554 - val_loss: 0.0938 - val_acc: 0.9805
Epoch 4/11
 - 44s - loss: 0.0972 - acc: 0.9736 - val_loss: 0.0697 - val_acc: 0.9846
Epoch 5/11
 - 43s - loss: 0.0721 - acc: 0.9821 - val_loss: 0.0526 - val_acc: 0.9906
Epoch 6/11
 - 43s - loss: 0.0581 - acc: 0.9871 - val_loss: 0.0376 - val_acc: 0.9926
Epoch 7/11
 - 43s - loss: 0.0457 - acc: 0.9907 - val_loss: 0.0299 - val_acc: 0.9935
Epoch 8/11
 - 43s - loss: 0.0365 - acc: 0.9940 - val_loss: 0.0259 - val_acc: 0.9959
Epoch 9/11
 - 43s - loss: 0.0341 - acc: 0.9939 - val_loss: 0.0242 - val_acc: 0.9976
Epoch 10/11
 - 43s - loss: 0.0275 - acc: 0.9961 - val_loss: 0.0171 - val_acc: 0.9977
Epoch 11/11
 - 43s - loss: 0.0267 - acc: 0.9962 - val_loss: 0.0160 - val_acc: 0.9979
Test accuracy:0.696
current auc_score ------------------> 0.876
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 46s - loss: 0.4936 - acc: 0.7801 - val_loss: 1.1541 - val_acc: 0.5494
Epoch 2/11
 - 44s - loss: 0.2360 - acc: 0.9077 - val_loss: 1.2449 - val_acc: 0.5521
Epoch 3/11
 - 44s - loss: 0.1493 - acc: 0.9509 - val_loss: 1.0373 - val_acc: 0.6299
Epoch 4/11
 - 44s - loss: 0.1007 - acc: 0.9709 - val_loss: 0.6738 - val_acc: 0.7506
Epoch 5/11
 - 44s - loss: 0.0769 - acc: 0.9805 - val_loss: 0.4233 - val_acc: 0.8363
Epoch 6/11
 - 44s - loss: 0.0559 - acc: 0.9882 - val_loss: 0.0347 - val_acc: 0.9950
Epoch 7/11
 - 43s - loss: 0.0471 - acc: 0.9894 - val_loss: 0.0263 - val_acc: 0.9964
Epoch 8/11
 - 43s - loss: 0.0376 - acc: 0.9933 - val_loss: 0.0209 - val_acc: 0.9979
Epoch 9/11
 - 44s - loss: 0.0304 - acc: 0.9955 - val_loss: 0.0196 - val_acc: 0.9979
Epoch 10/11
 - 44s - loss: 0.0274 - acc: 0.9955 - val_loss: 0.0173 - val_acc: 0.9986
Epoch 11/11
 - 44s - loss: 0.0264 - acc: 0.9964 - val_loss: 0.0173 - val_acc: 0.9979
Test accuracy:0.659
current auc_score ------------------> 0.900
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 47s - loss: 0.4316 - acc: 0.8131 - val_loss: 0.2241 - val_acc: 0.9170
Epoch 2/11
 - 44s - loss: 0.2116 - acc: 0.9228 - val_loss: 0.1593 - val_acc: 0.9502
Epoch 3/11
 - 44s - loss: 0.1381 - acc: 0.9567 - val_loss: 0.1096 - val_acc: 0.9715
Epoch 4/11
 - 44s - loss: 0.0975 - acc: 0.9736 - val_loss: 0.0559 - val_acc: 0.9891
Epoch 5/11
 - 44s - loss: 0.0696 - acc: 0.9832 - val_loss: 0.0432 - val_acc: 0.9933
Epoch 6/11
 - 44s - loss: 0.0533 - acc: 0.9891 - val_loss: 0.0343 - val_acc: 0.9939
Epoch 7/11
 - 44s - loss: 0.0453 - acc: 0.9906 - val_loss: 0.0263 - val_acc: 0.9955
Epoch 8/11
 - 44s - loss: 0.0363 - acc: 0.9933 - val_loss: 0.0206 - val_acc: 0.9979
Epoch 9/11
 - 44s - loss: 0.0321 - acc: 0.9944 - val_loss: 0.0189 - val_acc: 0.9982
Epoch 10/11
 - 44s - loss: 0.0274 - acc: 0.9960 - val_loss: 0.0187 - val_acc: 0.9974
Epoch 11/11
 - 44s - loss: 0.0259 - acc: 0.9958 - val_loss: 0.0145 - val_acc: 0.9980
Test accuracy:0.685
current auc_score ------------------> 0.857
Epochs  11  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/11
 - 47s - loss: 0.4196 - acc: 0.8200 - val_loss: 0.2516 - val_acc: 0.9062
Epoch 2/11
 - 43s - loss: 0.2098 - acc: 0.9209 - val_loss: 0.1406 - val_acc: 0.9639
Epoch 3/11
 - 43s - loss: 0.1384 - acc: 0.9570 - val_loss: 0.0970 - val_acc: 0.9750
Epoch 4/11
 - 43s - loss: 0.0945 - acc: 0.9750 - val_loss: 0.0637 - val_acc: 0.9843
Epoch 5/11
 - 43s - loss: 0.0705 - acc: 0.9836 - val_loss: 0.0504 - val_acc: 0.9912
Epoch 6/11
 - 43s - loss: 0.0537 - acc: 0.9884 - val_loss: 0.0392 - val_acc: 0.9927
Epoch 7/11
 - 43s - loss: 0.0476 - acc: 0.9907 - val_loss: 0.0302 - val_acc: 0.9945
Epoch 8/11
 - 43s - loss: 0.0383 - acc: 0.9927 - val_loss: 0.0255 - val_acc: 0.9967
Epoch 9/11
 - 42s - loss: 0.0307 - acc: 0.9953 - val_loss: 0.0201 - val_acc: 0.9982
Epoch 10/11
 - 43s - loss: 0.0293 - acc: 0.9954 - val_loss: 0.0227 - val_acc: 0.9961
Epoch 11/11
 - 43s - loss: 0.0267 - acc: 0.9959 - val_loss: 0.0177 - val_acc: 0.9979
Test accuracy:0.678
current auc_score ------------------> 0.878
accuracies:  [0.6830645161290323, 0.5155913978494624, 0.6630376344086022, 0.6263440860215054, 0.6623655913978495, 0.6811827956989247, 0.6956989247311828, 0.6586021505376344, 0.6845430107526882, 0.6780913978494624]
aucs:  [0.8776, 0.684, 0.9012, 0.853, 0.9036, 0.8763, 0.8757, 0.8996, 0.8569, 0.8776]
mean and std AUC:  0.861+/-0.061  max:   0.9036
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 31s - loss: 0.5456 - acc: 0.7599 - val_loss: 1.5126 - val_acc: 0.5264
Epoch 2/13
 - 30s - loss: 0.3054 - acc: 0.8729 - val_loss: 0.2158 - val_acc: 0.9283
Epoch 3/13
 - 30s - loss: 0.2115 - acc: 0.9193 - val_loss: 0.1553 - val_acc: 0.9547
Epoch 4/13
 - 31s - loss: 0.1504 - acc: 0.9464 - val_loss: 0.1058 - val_acc: 0.9674
Epoch 5/13
 - 29s - loss: 0.1138 - acc: 0.9643 - val_loss: 0.0896 - val_acc: 0.9767
Epoch 6/13
 - 28s - loss: 0.0907 - acc: 0.9728 - val_loss: 0.0605 - val_acc: 0.9859
Epoch 7/13
 - 28s - loss: 0.0731 - acc: 0.9792 - val_loss: 0.0514 - val_acc: 0.9849
Epoch 8/13
 - 28s - loss: 0.0621 - acc: 0.9831 - val_loss: 0.0378 - val_acc: 0.9921
Epoch 9/13
 - 29s - loss: 0.0522 - acc: 0.9866 - val_loss: 0.0349 - val_acc: 0.9916
Epoch 10/13
 - 29s - loss: 0.0445 - acc: 0.9892 - val_loss: 0.0263 - val_acc: 0.9951
Epoch 11/13
 - 29s - loss: 0.0376 - acc: 0.9910 - val_loss: 0.0322 - val_acc: 0.9932
Epoch 12/13
 - 29s - loss: 0.0341 - acc: 0.9923 - val_loss: 0.0196 - val_acc: 0.9962
Epoch 13/13
 - 29s - loss: 0.0295 - acc: 0.9936 - val_loss: 0.0173 - val_acc: 0.9967
Test accuracy:0.712
current auc_score ------------------> 0.867
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 32s - loss: 0.5159 - acc: 0.7732 - val_loss: 0.3010 - val_acc: 0.8742
Epoch 2/13
 - 29s - loss: 0.2874 - acc: 0.8834 - val_loss: 0.1935 - val_acc: 0.9339
Epoch 3/13
 - 29s - loss: 0.1996 - acc: 0.9240 - val_loss: 0.1270 - val_acc: 0.9620
Epoch 4/13
 - 29s - loss: 0.1466 - acc: 0.9495 - val_loss: 0.0923 - val_acc: 0.9743
Epoch 5/13
 - 29s - loss: 0.1100 - acc: 0.9647 - val_loss: 0.0734 - val_acc: 0.9816
Epoch 6/13
 - 29s - loss: 0.0837 - acc: 0.9750 - val_loss: 0.0479 - val_acc: 0.9888
Epoch 7/13
 - 30s - loss: 0.0661 - acc: 0.9817 - val_loss: 0.0434 - val_acc: 0.9900
Epoch 8/13
 - 30s - loss: 0.0548 - acc: 0.9863 - val_loss: 0.0331 - val_acc: 0.9922
Epoch 9/13
 - 29s - loss: 0.0478 - acc: 0.9880 - val_loss: 0.0337 - val_acc: 0.9942
Epoch 10/13
 - 30s - loss: 0.0404 - acc: 0.9904 - val_loss: 0.0263 - val_acc: 0.9955
Epoch 11/13
 - 30s - loss: 0.0357 - acc: 0.9921 - val_loss: 0.0222 - val_acc: 0.9957
Epoch 12/13
 - 30s - loss: 0.0307 - acc: 0.9938 - val_loss: 0.0204 - val_acc: 0.9959
Epoch 13/13
 - 30s - loss: 0.0289 - acc: 0.9942 - val_loss: 0.0157 - val_acc: 0.9971
Test accuracy:0.701
current auc_score ------------------> 0.890
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 34s - loss: 0.5748 - acc: 0.7448 - val_loss: 0.3829 - val_acc: 0.8199
Epoch 2/13
 - 31s - loss: 0.3243 - acc: 0.8638 - val_loss: 0.2370 - val_acc: 0.9208
Epoch 3/13
 - 29s - loss: 0.2186 - acc: 0.9166 - val_loss: 0.1703 - val_acc: 0.9460
Epoch 4/13
 - 29s - loss: 0.1616 - acc: 0.9440 - val_loss: 0.1340 - val_acc: 0.9656
Epoch 5/13
 - 29s - loss: 0.1231 - acc: 0.9596 - val_loss: 0.0825 - val_acc: 0.9788
Epoch 6/13
 - 29s - loss: 0.0972 - acc: 0.9702 - val_loss: 0.0729 - val_acc: 0.9822
Epoch 7/13
 - 29s - loss: 0.0797 - acc: 0.9772 - val_loss: 0.0621 - val_acc: 0.9863
Epoch 8/13
 - 29s - loss: 0.0659 - acc: 0.9820 - val_loss: 0.0410 - val_acc: 0.9910
Epoch 9/13
 - 29s - loss: 0.0552 - acc: 0.9852 - val_loss: 0.0322 - val_acc: 0.9923
Epoch 10/13
 - 30s - loss: 0.0467 - acc: 0.9887 - val_loss: 0.0312 - val_acc: 0.9936
Epoch 11/13
 - 30s - loss: 0.0423 - acc: 0.9896 - val_loss: 0.0267 - val_acc: 0.9964
Epoch 12/13
 - 29s - loss: 0.0364 - acc: 0.9921 - val_loss: 0.0211 - val_acc: 0.9962
Epoch 13/13
 - 29s - loss: 0.0339 - acc: 0.9927 - val_loss: 0.0180 - val_acc: 0.9972
Test accuracy:0.682
current auc_score ------------------> 0.914
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 32s - loss: 0.5577 - acc: 0.7550 - val_loss: 0.8533 - val_acc: 0.5914
Epoch 2/13
 - 29s - loss: 0.3025 - acc: 0.8729 - val_loss: 0.2191 - val_acc: 0.9278
Epoch 3/13
 - 29s - loss: 0.2097 - acc: 0.9196 - val_loss: 0.1700 - val_acc: 0.9488
Epoch 4/13
 - 29s - loss: 0.1544 - acc: 0.9458 - val_loss: 0.1226 - val_acc: 0.9713
Epoch 5/13
 - 29s - loss: 0.1205 - acc: 0.9603 - val_loss: 0.0817 - val_acc: 0.9818
Epoch 6/13
 - 29s - loss: 0.0938 - acc: 0.9708 - val_loss: 0.0673 - val_acc: 0.9832
Epoch 7/13
 - 29s - loss: 0.0755 - acc: 0.9787 - val_loss: 0.0545 - val_acc: 0.9887
Epoch 8/13
 - 29s - loss: 0.0647 - acc: 0.9812 - val_loss: 0.0477 - val_acc: 0.9896
Epoch 9/13
 - 29s - loss: 0.0537 - acc: 0.9858 - val_loss: 0.0353 - val_acc: 0.9920
Epoch 10/13
 - 29s - loss: 0.0435 - acc: 0.9893 - val_loss: 0.0282 - val_acc: 0.9941
Epoch 11/13
 - 29s - loss: 0.0369 - acc: 0.9912 - val_loss: 0.0239 - val_acc: 0.9950
Epoch 12/13
 - 29s - loss: 0.0340 - acc: 0.9921 - val_loss: 0.0249 - val_acc: 0.9951
Epoch 13/13
 - 29s - loss: 0.0298 - acc: 0.9938 - val_loss: 0.0184 - val_acc: 0.9976
Test accuracy:0.705
current auc_score ------------------> 0.906
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 32s - loss: 0.5350 - acc: 0.7656 - val_loss: 0.4726 - val_acc: 0.7900
Epoch 2/13
 - 29s - loss: 0.2971 - acc: 0.8752 - val_loss: 0.4625 - val_acc: 0.7979
Epoch 3/13
 - 29s - loss: 0.2104 - acc: 0.9197 - val_loss: 0.4409 - val_acc: 0.8186
Epoch 4/13
 - 30s - loss: 0.1570 - acc: 0.9441 - val_loss: 0.3258 - val_acc: 0.8744
Epoch 5/13
 - 29s - loss: 0.1183 - acc: 0.9617 - val_loss: 0.3780 - val_acc: 0.8107
Epoch 6/13
 - 29s - loss: 0.0893 - acc: 0.9741 - val_loss: 0.3087 - val_acc: 0.8756
Epoch 7/13
 - 29s - loss: 0.0746 - acc: 0.9791 - val_loss: 0.2706 - val_acc: 0.9024
Epoch 8/13
 - 29s - loss: 0.0613 - acc: 0.9834 - val_loss: 0.2769 - val_acc: 0.8982
Epoch 9/13
 - 29s - loss: 0.0506 - acc: 0.9871 - val_loss: 0.2555 - val_acc: 0.9118
Epoch 10/13
 - 29s - loss: 0.0432 - acc: 0.9895 - val_loss: 0.2589 - val_acc: 0.9079
Epoch 11/13
 - 29s - loss: 0.0382 - acc: 0.9908 - val_loss: 0.2845 - val_acc: 0.8867
Epoch 12/13
 - 28s - loss: 0.0339 - acc: 0.9921 - val_loss: 0.2693 - val_acc: 0.9012

Epoch 00012: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 13/13
 - 29s - loss: 0.0250 - acc: 0.9957 - val_loss: 0.2373 - val_acc: 0.9154
Test accuracy:0.748
current auc_score ------------------> 0.831
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 32s - loss: 0.5623 - acc: 0.7460 - val_loss: 0.3522 - val_acc: 0.8397
Epoch 2/13
 - 29s - loss: 0.3238 - acc: 0.8611 - val_loss: 0.2315 - val_acc: 0.9079
Epoch 3/13
 - 28s - loss: 0.2286 - acc: 0.9116 - val_loss: 0.1764 - val_acc: 0.9385
Epoch 4/13
 - 29s - loss: 0.1657 - acc: 0.9434 - val_loss: 0.1240 - val_acc: 0.9650
Epoch 5/13
 - 28s - loss: 0.1293 - acc: 0.9569 - val_loss: 0.0874 - val_acc: 0.9790
Epoch 6/13
 - 29s - loss: 0.1009 - acc: 0.9691 - val_loss: 0.0767 - val_acc: 0.9809
Epoch 7/13
 - 29s - loss: 0.0818 - acc: 0.9764 - val_loss: 0.0614 - val_acc: 0.9834
Epoch 8/13
 - 31s - loss: 0.0726 - acc: 0.9798 - val_loss: 0.0417 - val_acc: 0.9908
Epoch 9/13
 - 30s - loss: 0.0553 - acc: 0.9855 - val_loss: 0.0390 - val_acc: 0.9910
Epoch 10/13
 - 30s - loss: 0.0486 - acc: 0.9878 - val_loss: 0.0356 - val_acc: 0.9912
Epoch 11/13
 - 30s - loss: 0.0426 - acc: 0.9901 - val_loss: 0.0271 - val_acc: 0.9946
Epoch 12/13
 - 30s - loss: 0.0370 - acc: 0.9913 - val_loss: 0.0226 - val_acc: 0.9954
Epoch 13/13
 - 30s - loss: 0.0332 - acc: 0.9927 - val_loss: 0.0187 - val_acc: 0.9965
Test accuracy:0.721
current auc_score ------------------> 0.870
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 34s - loss: 0.5703 - acc: 0.7472 - val_loss: 0.3268 - val_acc: 0.8633
Epoch 2/13
 - 30s - loss: 0.3139 - acc: 0.8671 - val_loss: 0.2327 - val_acc: 0.9153
Epoch 3/13
 - 30s - loss: 0.2114 - acc: 0.9175 - val_loss: 0.1545 - val_acc: 0.9470
Epoch 4/13
 - 30s - loss: 0.1557 - acc: 0.9453 - val_loss: 0.1094 - val_acc: 0.9670
Epoch 5/13
 - 30s - loss: 0.1199 - acc: 0.9613 - val_loss: 0.0796 - val_acc: 0.9779
Epoch 6/13
 - 30s - loss: 0.0961 - acc: 0.9712 - val_loss: 0.0596 - val_acc: 0.9852
Epoch 7/13
 - 30s - loss: 0.0779 - acc: 0.9774 - val_loss: 0.0494 - val_acc: 0.9881
Epoch 8/13
 - 30s - loss: 0.0648 - acc: 0.9824 - val_loss: 0.0430 - val_acc: 0.9897
Epoch 9/13
 - 31s - loss: 0.0543 - acc: 0.9853 - val_loss: 0.0358 - val_acc: 0.9916
Epoch 10/13
 - 30s - loss: 0.0446 - acc: 0.9896 - val_loss: 0.0280 - val_acc: 0.9944
Epoch 11/13
 - 31s - loss: 0.0414 - acc: 0.9898 - val_loss: 0.0234 - val_acc: 0.9955
Epoch 12/13
 - 30s - loss: 0.0340 - acc: 0.9923 - val_loss: 0.0237 - val_acc: 0.9950
Epoch 13/13
 - 30s - loss: 0.0314 - acc: 0.9932 - val_loss: 0.0223 - val_acc: 0.9941
Test accuracy:0.678
current auc_score ------------------> 0.877
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 33s - loss: 0.5253 - acc: 0.7687 - val_loss: 0.7437 - val_acc: 0.6127
Epoch 2/13
 - 31s - loss: 0.2884 - acc: 0.8793 - val_loss: 0.1905 - val_acc: 0.9325
Epoch 3/13
 - 30s - loss: 0.1950 - acc: 0.9260 - val_loss: 0.1406 - val_acc: 0.9561
Epoch 4/13
 - 30s - loss: 0.1404 - acc: 0.9511 - val_loss: 0.0934 - val_acc: 0.9767
Epoch 5/13
 - 30s - loss: 0.1063 - acc: 0.9665 - val_loss: 0.0738 - val_acc: 0.9809
Epoch 6/13
 - 30s - loss: 0.0818 - acc: 0.9757 - val_loss: 0.0530 - val_acc: 0.9876
Epoch 7/13
 - 30s - loss: 0.0686 - acc: 0.9808 - val_loss: 0.0484 - val_acc: 0.9891
Epoch 8/13
 - 31s - loss: 0.0552 - acc: 0.9863 - val_loss: 0.0327 - val_acc: 0.9931
Epoch 9/13
 - 30s - loss: 0.0476 - acc: 0.9879 - val_loss: 0.0268 - val_acc: 0.9950
Epoch 10/13
 - 30s - loss: 0.0381 - acc: 0.9912 - val_loss: 0.0242 - val_acc: 0.9951
Epoch 11/13
 - 30s - loss: 0.0371 - acc: 0.9913 - val_loss: 0.0195 - val_acc: 0.9962
Epoch 12/13
 - 31s - loss: 0.0325 - acc: 0.9925 - val_loss: 0.0207 - val_acc: 0.9954
Epoch 13/13
 - 29s - loss: 0.0266 - acc: 0.9946 - val_loss: 0.0175 - val_acc: 0.9959
Test accuracy:0.738
current auc_score ------------------> 0.922
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 33s - loss: 0.6013 - acc: 0.7310 - val_loss: 0.3689 - val_acc: 0.8326
Epoch 2/13
 - 30s - loss: 0.3347 - acc: 0.8564 - val_loss: 0.2519 - val_acc: 0.9070
Epoch 3/13
 - 30s - loss: 0.2284 - acc: 0.9120 - val_loss: 0.1686 - val_acc: 0.9485
Epoch 4/13
 - 30s - loss: 0.1658 - acc: 0.9394 - val_loss: 0.1227 - val_acc: 0.9651
Epoch 5/13
 - 29s - loss: 0.1278 - acc: 0.9576 - val_loss: 0.0944 - val_acc: 0.9740
Epoch 6/13
 - 30s - loss: 0.0971 - acc: 0.9704 - val_loss: 0.0807 - val_acc: 0.9800
Epoch 7/13
 - 29s - loss: 0.0816 - acc: 0.9766 - val_loss: 0.0620 - val_acc: 0.9829
Epoch 8/13
 - 29s - loss: 0.0633 - acc: 0.9825 - val_loss: 0.0420 - val_acc: 0.9913
Epoch 9/13
 - 28s - loss: 0.0547 - acc: 0.9856 - val_loss: 0.0411 - val_acc: 0.9907
Epoch 10/13
 - 29s - loss: 0.0464 - acc: 0.9880 - val_loss: 0.0306 - val_acc: 0.9931
Epoch 11/13
 - 28s - loss: 0.0394 - acc: 0.9906 - val_loss: 0.0250 - val_acc: 0.9942
Epoch 12/13
 - 28s - loss: 0.0334 - acc: 0.9932 - val_loss: 0.0226 - val_acc: 0.9954
Epoch 13/13
 - 28s - loss: 0.0322 - acc: 0.9927 - val_loss: 0.0264 - val_acc: 0.9946
Test accuracy:0.680
current auc_score ------------------> 0.858
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  12  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   1728        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   3024        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 12, 24, 24)   480         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 12, 12, 12)   48          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 12, 12)   1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 24, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 24, 12, 12)   96          concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 12, 12)   2592        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 36, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 36, 12, 12)   144         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 36, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 5184)         0           activation_7[0][0]               
==================================================================================================
Total params: 10,592
Trainable params: 10,248
Non-trainable params: 344
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 5184)         10592       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 10368)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          5308928     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 5,322,081
Trainable params: 5,320,713
Non-trainable params: 1,368
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 32s - loss: 0.5382 - acc: 0.7628 - val_loss: 1.4709 - val_acc: 0.5218
Epoch 2/13
 - 29s - loss: 0.2995 - acc: 0.8755 - val_loss: 0.7380 - val_acc: 0.6368
Epoch 3/13
 - 28s - loss: 0.2069 - acc: 0.9220 - val_loss: 0.7714 - val_acc: 0.6155
Epoch 4/13
 - 28s - loss: 0.1558 - acc: 0.9445 - val_loss: 0.1069 - val_acc: 0.9716
Epoch 5/13
 - 29s - loss: 0.1229 - acc: 0.9602 - val_loss: 0.0838 - val_acc: 0.9793
Epoch 6/13
 - 29s - loss: 0.0974 - acc: 0.9697 - val_loss: 0.0668 - val_acc: 0.9837
Epoch 7/13
 - 29s - loss: 0.0817 - acc: 0.9764 - val_loss: 0.0526 - val_acc: 0.9877
Epoch 8/13
 - 30s - loss: 0.0695 - acc: 0.9801 - val_loss: 0.0460 - val_acc: 0.9893
Epoch 9/13
 - 30s - loss: 0.0579 - acc: 0.9843 - val_loss: 0.0341 - val_acc: 0.9922
Epoch 10/13
 - 30s - loss: 0.0494 - acc: 0.9872 - val_loss: 0.0302 - val_acc: 0.9944
Epoch 11/13
 - 30s - loss: 0.0444 - acc: 0.9891 - val_loss: 0.0252 - val_acc: 0.9947
Epoch 12/13
 - 29s - loss: 0.0387 - acc: 0.9912 - val_loss: 0.0247 - val_acc: 0.9960
Epoch 13/13
 - 30s - loss: 0.0350 - acc: 0.9910 - val_loss: 0.0216 - val_acc: 0.9959
Test accuracy:0.693
current auc_score ------------------> 0.918
accuracies:  [0.7123655913978495, 0.7010752688172043, 0.6815860215053764, 0.7047043010752688, 0.7479838709677419, 0.7212365591397849, 0.6776881720430108, 0.7380376344086022, 0.6797043010752688, 0.693010752688172]
aucs:  [0.8673, 0.8901, 0.9137, 0.9058, 0.831, 0.8698, 0.8773, 0.9223, 0.8581, 0.9185]
mean and std AUC:  0.885+/-0.028  max:   0.9223
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 37s - loss: 0.5233 - acc: 0.7683 - val_loss: 1.2561 - val_acc: 0.5218
Epoch 2/13
 - 33s - loss: 0.2871 - acc: 0.8816 - val_loss: 1.0274 - val_acc: 0.5379
Epoch 3/13
 - 33s - loss: 0.2005 - acc: 0.9269 - val_loss: 0.1609 - val_acc: 0.9562
Epoch 4/13
 - 34s - loss: 0.1509 - acc: 0.9486 - val_loss: 0.1097 - val_acc: 0.9713
Epoch 5/13
 - 33s - loss: 0.1117 - acc: 0.9644 - val_loss: 0.0887 - val_acc: 0.9787
Epoch 6/13
 - 33s - loss: 0.0850 - acc: 0.9755 - val_loss: 0.0689 - val_acc: 0.9857
Epoch 7/13
 - 33s - loss: 0.0710 - acc: 0.9803 - val_loss: 0.0546 - val_acc: 0.9900
Epoch 8/13
 - 33s - loss: 0.0586 - acc: 0.9851 - val_loss: 0.0427 - val_acc: 0.9926
Epoch 9/13
 - 33s - loss: 0.0511 - acc: 0.9880 - val_loss: 0.0364 - val_acc: 0.9944
Epoch 10/13
 - 33s - loss: 0.0480 - acc: 0.9877 - val_loss: 0.0305 - val_acc: 0.9940
Epoch 11/13
 - 33s - loss: 0.0388 - acc: 0.9917 - val_loss: 0.0281 - val_acc: 0.9956
Epoch 12/13
 - 33s - loss: 0.0347 - acc: 0.9927 - val_loss: 0.0258 - val_acc: 0.9950
Epoch 13/13
 - 34s - loss: 0.0318 - acc: 0.9931 - val_loss: 0.0154 - val_acc: 0.9984
Test accuracy:0.689
current auc_score ------------------> 0.925
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 36s - loss: 0.5594 - acc: 0.7471 - val_loss: 0.3459 - val_acc: 0.8443
Epoch 2/13
 - 32s - loss: 0.3065 - acc: 0.8722 - val_loss: 0.2274 - val_acc: 0.9218
Epoch 3/13
 - 32s - loss: 0.2093 - acc: 0.9211 - val_loss: 0.1601 - val_acc: 0.9517
Epoch 4/13
 - 32s - loss: 0.1505 - acc: 0.9478 - val_loss: 0.1128 - val_acc: 0.9694
Epoch 5/13
 - 32s - loss: 0.1131 - acc: 0.9662 - val_loss: 0.0836 - val_acc: 0.9782
Epoch 6/13
 - 32s - loss: 0.0918 - acc: 0.9725 - val_loss: 0.0603 - val_acc: 0.9857
Epoch 7/13
 - 33s - loss: 0.0721 - acc: 0.9796 - val_loss: 0.0444 - val_acc: 0.9915
Epoch 8/13
 - 32s - loss: 0.0578 - acc: 0.9852 - val_loss: 0.0337 - val_acc: 0.9932
Epoch 9/13
 - 32s - loss: 0.0502 - acc: 0.9872 - val_loss: 0.0316 - val_acc: 0.9954
Epoch 10/13
 - 32s - loss: 0.0431 - acc: 0.9905 - val_loss: 0.0240 - val_acc: 0.9954
Epoch 11/13
 - 32s - loss: 0.0353 - acc: 0.9927 - val_loss: 0.0230 - val_acc: 0.9956
Epoch 12/13
 - 32s - loss: 0.0321 - acc: 0.9935 - val_loss: 0.0187 - val_acc: 0.9974
Epoch 13/13
 - 32s - loss: 0.0296 - acc: 0.9937 - val_loss: 0.0174 - val_acc: 0.9971
Test accuracy:0.637
current auc_score ------------------> 0.860
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 35s - loss: 0.5589 - acc: 0.7520 - val_loss: 1.1579 - val_acc: 0.5818
Epoch 2/13
 - 32s - loss: 0.3188 - acc: 0.8654 - val_loss: 0.8035 - val_acc: 0.6133
Epoch 3/13
 - 33s - loss: 0.2154 - acc: 0.9195 - val_loss: 0.6498 - val_acc: 0.6306
Epoch 4/13
 - 32s - loss: 0.1569 - acc: 0.9466 - val_loss: 0.6757 - val_acc: 0.6344
Epoch 5/13
 - 33s - loss: 0.1165 - acc: 0.9630 - val_loss: 0.6558 - val_acc: 0.6392
Epoch 6/13
 - 33s - loss: 0.0941 - acc: 0.9724 - val_loss: 1.0327 - val_acc: 0.6171

Epoch 00006: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 7/13
 - 32s - loss: 0.0708 - acc: 0.9813 - val_loss: 0.7306 - val_acc: 0.6672
Epoch 8/13
 - 32s - loss: 0.0609 - acc: 0.9854 - val_loss: 0.7534 - val_acc: 0.6497
Epoch 9/13
 - 32s - loss: 0.0540 - acc: 0.9872 - val_loss: 0.7801 - val_acc: 0.6441

Epoch 00009: ReduceLROnPlateau reducing learning rate to 9.999999259090306e-06.
Epoch 10/13
 - 32s - loss: 0.0490 - acc: 0.9888 - val_loss: 0.7465 - val_acc: 0.6560
Epoch 11/13
 - 32s - loss: 0.0474 - acc: 0.9898 - val_loss: 0.7087 - val_acc: 0.6568
Epoch 00011: early stopping
Test accuracy:0.601
current auc_score ------------------> 0.658
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 36s - loss: 0.6323 - acc: 0.7108 - val_loss: 1.1768 - val_acc: 0.5675
Epoch 2/13
 - 32s - loss: 0.3613 - acc: 0.8438 - val_loss: 0.2537 - val_acc: 0.9121
Epoch 3/13
 - 32s - loss: 0.2440 - acc: 0.9045 - val_loss: 0.1616 - val_acc: 0.9504
Epoch 4/13
 - 32s - loss: 0.1686 - acc: 0.9427 - val_loss: 0.1265 - val_acc: 0.9629
Epoch 5/13
 - 32s - loss: 0.1293 - acc: 0.9605 - val_loss: 0.0789 - val_acc: 0.9783
Epoch 6/13
 - 32s - loss: 0.0995 - acc: 0.9716 - val_loss: 0.0612 - val_acc: 0.9841
Epoch 7/13
 - 32s - loss: 0.0828 - acc: 0.9771 - val_loss: 0.0536 - val_acc: 0.9858
Epoch 8/13
 - 32s - loss: 0.0639 - acc: 0.9842 - val_loss: 0.0376 - val_acc: 0.9915
Epoch 9/13
 - 32s - loss: 0.0560 - acc: 0.9861 - val_loss: 0.0311 - val_acc: 0.9932
Epoch 10/13
 - 32s - loss: 0.0458 - acc: 0.9898 - val_loss: 0.0262 - val_acc: 0.9951
Epoch 11/13
 - 32s - loss: 0.0405 - acc: 0.9909 - val_loss: 0.0225 - val_acc: 0.9944
Epoch 12/13
 - 32s - loss: 0.0338 - acc: 0.9930 - val_loss: 0.0180 - val_acc: 0.9961
Epoch 13/13
 - 32s - loss: 0.0310 - acc: 0.9934 - val_loss: 0.0174 - val_acc: 0.9964
Test accuracy:0.697
current auc_score ------------------> 0.890
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 35s - loss: 0.5290 - acc: 0.7656 - val_loss: 2.1160 - val_acc: 0.5080
Epoch 2/13
 - 32s - loss: 0.2939 - acc: 0.8757 - val_loss: 0.6479 - val_acc: 0.6491
Epoch 3/13
 - 32s - loss: 0.2019 - acc: 0.9243 - val_loss: 1.0991 - val_acc: 0.5596
Epoch 4/13
 - 32s - loss: 0.1437 - acc: 0.9531 - val_loss: 1.0779 - val_acc: 0.5649
Epoch 5/13
 - 32s - loss: 0.1122 - acc: 0.9661 - val_loss: 0.5291 - val_acc: 0.7209
Epoch 6/13
 - 32s - loss: 0.0872 - acc: 0.9762 - val_loss: 1.5448 - val_acc: 0.5679
Epoch 7/13
 - 32s - loss: 0.0722 - acc: 0.9806 - val_loss: 0.0427 - val_acc: 0.9917
Epoch 8/13
 - 32s - loss: 0.0570 - acc: 0.9856 - val_loss: 0.0374 - val_acc: 0.9926
Epoch 9/13
 - 32s - loss: 0.0474 - acc: 0.9888 - val_loss: 0.0294 - val_acc: 0.9940
Epoch 10/13
 - 32s - loss: 0.0416 - acc: 0.9906 - val_loss: 0.0230 - val_acc: 0.9965
Epoch 11/13
 - 32s - loss: 0.0354 - acc: 0.9929 - val_loss: 0.0234 - val_acc: 0.9959
Epoch 12/13
 - 32s - loss: 0.0342 - acc: 0.9935 - val_loss: 0.0187 - val_acc: 0.9970
Epoch 13/13
 - 32s - loss: 0.0294 - acc: 0.9937 - val_loss: 0.0178 - val_acc: 0.9972
Test accuracy:0.730
current auc_score ------------------> 0.897
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 35s - loss: 0.5261 - acc: 0.7699 - val_loss: 0.6985 - val_acc: 0.6210
Epoch 2/13
 - 33s - loss: 0.2779 - acc: 0.8861 - val_loss: 1.8768 - val_acc: 0.5127
Epoch 3/13
 - 33s - loss: 0.1883 - acc: 0.9313 - val_loss: 0.4562 - val_acc: 0.7914
Epoch 4/13
 - 33s - loss: 0.1329 - acc: 0.9569 - val_loss: 0.0861 - val_acc: 0.9789
Epoch 5/13
 - 33s - loss: 0.1018 - acc: 0.9690 - val_loss: 0.0699 - val_acc: 0.9839
Epoch 6/13
 - 33s - loss: 0.0768 - acc: 0.9787 - val_loss: 0.0459 - val_acc: 0.9917
Epoch 7/13
 - 33s - loss: 0.0611 - acc: 0.9852 - val_loss: 0.0370 - val_acc: 0.9939
Epoch 8/13
 - 33s - loss: 0.0541 - acc: 0.9869 - val_loss: 0.0329 - val_acc: 0.9935
Epoch 9/13
 - 33s - loss: 0.0444 - acc: 0.9895 - val_loss: 0.0260 - val_acc: 0.9947
Epoch 10/13
 - 33s - loss: 0.0362 - acc: 0.9925 - val_loss: 0.0215 - val_acc: 0.9960
Epoch 11/13
 - 32s - loss: 0.0318 - acc: 0.9938 - val_loss: 0.0218 - val_acc: 0.9966
Epoch 12/13
 - 33s - loss: 0.0301 - acc: 0.9939 - val_loss: 0.0162 - val_acc: 0.9972
Epoch 13/13
 - 33s - loss: 0.0282 - acc: 0.9946 - val_loss: 0.0154 - val_acc: 0.9981
Test accuracy:0.696
current auc_score ------------------> 0.928
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 37s - loss: 0.5548 - acc: 0.7499 - val_loss: 0.8408 - val_acc: 0.5978
Epoch 2/13
 - 33s - loss: 0.3179 - acc: 0.8663 - val_loss: 0.9789 - val_acc: 0.5694
Epoch 3/13
 - 33s - loss: 0.2239 - acc: 0.9150 - val_loss: 0.1826 - val_acc: 0.9464
Epoch 4/13
 - 32s - loss: 0.1626 - acc: 0.9434 - val_loss: 0.1312 - val_acc: 0.9651
Epoch 5/13
 - 32s - loss: 0.1245 - acc: 0.9606 - val_loss: 0.0927 - val_acc: 0.9753
Epoch 6/13
 - 32s - loss: 0.0993 - acc: 0.9699 - val_loss: 0.0656 - val_acc: 0.9838
Epoch 7/13
 - 32s - loss: 0.0795 - acc: 0.9780 - val_loss: 0.0596 - val_acc: 0.9857
Epoch 8/13
 - 32s - loss: 0.0668 - acc: 0.9817 - val_loss: 0.0452 - val_acc: 0.9902
Epoch 9/13
 - 32s - loss: 0.0574 - acc: 0.9852 - val_loss: 0.0361 - val_acc: 0.9930
Epoch 10/13
 - 32s - loss: 0.0479 - acc: 0.9888 - val_loss: 0.0292 - val_acc: 0.9944
Epoch 11/13
 - 32s - loss: 0.0405 - acc: 0.9907 - val_loss: 0.0273 - val_acc: 0.9941
Epoch 12/13
 - 33s - loss: 0.0368 - acc: 0.9919 - val_loss: 0.0261 - val_acc: 0.9952
Epoch 13/13
 - 33s - loss: 0.0320 - acc: 0.9934 - val_loss: 0.0217 - val_acc: 0.9950
Test accuracy:0.732
current auc_score ------------------> 0.884
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 35s - loss: 0.4902 - acc: 0.7867 - val_loss: 2.7487 - val_acc: 0.5054
Epoch 2/13
 - 32s - loss: 0.2624 - acc: 0.8944 - val_loss: 1.5590 - val_acc: 0.5257
Epoch 3/13
 - 32s - loss: 0.1726 - acc: 0.9392 - val_loss: 0.6463 - val_acc: 0.6911
Epoch 4/13
 - 32s - loss: 0.1206 - acc: 0.9612 - val_loss: 0.0815 - val_acc: 0.9816
Epoch 5/13
 - 32s - loss: 0.0942 - acc: 0.9724 - val_loss: 0.0591 - val_acc: 0.9874
Epoch 6/13
 - 32s - loss: 0.0738 - acc: 0.9806 - val_loss: 0.0427 - val_acc: 0.9897
Epoch 7/13
 - 32s - loss: 0.0588 - acc: 0.9849 - val_loss: 0.0353 - val_acc: 0.9926
Epoch 8/13
 - 32s - loss: 0.0514 - acc: 0.9879 - val_loss: 0.0301 - val_acc: 0.9936
Epoch 9/13
 - 32s - loss: 0.0412 - acc: 0.9907 - val_loss: 0.0279 - val_acc: 0.9946
Epoch 10/13
 - 32s - loss: 0.0365 - acc: 0.9925 - val_loss: 0.0252 - val_acc: 0.9946
Epoch 11/13
 - 32s - loss: 0.0352 - acc: 0.9923 - val_loss: 0.0203 - val_acc: 0.9959
Epoch 12/13
 - 32s - loss: 0.0295 - acc: 0.9944 - val_loss: 0.0167 - val_acc: 0.9969
Epoch 13/13
 - 32s - loss: 0.0276 - acc: 0.9945 - val_loss: 0.0177 - val_acc: 0.9970
Test accuracy:0.720
current auc_score ------------------> 0.908
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 35s - loss: 0.4873 - acc: 0.7869 - val_loss: 0.2912 - val_acc: 0.8872
Epoch 2/13
 - 32s - loss: 0.2607 - acc: 0.8953 - val_loss: 0.1854 - val_acc: 0.9424
Epoch 3/13
 - 32s - loss: 0.1816 - acc: 0.9333 - val_loss: 0.1210 - val_acc: 0.9677
Epoch 4/13
 - 32s - loss: 0.1355 - acc: 0.9550 - val_loss: 0.1074 - val_acc: 0.9696
Epoch 5/13
 - 32s - loss: 0.1079 - acc: 0.9661 - val_loss: 0.0772 - val_acc: 0.9795
Epoch 6/13
 - 33s - loss: 0.0839 - acc: 0.9766 - val_loss: 0.0667 - val_acc: 0.9839
Epoch 7/13
 - 32s - loss: 0.0692 - acc: 0.9813 - val_loss: 0.0436 - val_acc: 0.9931
Epoch 8/13
 - 32s - loss: 0.0570 - acc: 0.9853 - val_loss: 0.0346 - val_acc: 0.9931
Epoch 9/13
 - 33s - loss: 0.0478 - acc: 0.9885 - val_loss: 0.0269 - val_acc: 0.9952
Epoch 10/13
 - 34s - loss: 0.0417 - acc: 0.9906 - val_loss: 0.0291 - val_acc: 0.9945
Epoch 11/13
 - 34s - loss: 0.0369 - acc: 0.9922 - val_loss: 0.0211 - val_acc: 0.9959
Epoch 12/13
 - 34s - loss: 0.0317 - acc: 0.9940 - val_loss: 0.0197 - val_acc: 0.9970
Epoch 13/13
 - 33s - loss: 0.0279 - acc: 0.9950 - val_loss: 0.0185 - val_acc: 0.9967
Test accuracy:0.654
current auc_score ------------------> 0.894
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  18  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   2592        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   5508        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 15, 24, 24)   780         activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 15, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 15, 12, 12)   60          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 15, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 12, 12)   2430        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 33, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 33, 12, 12)   132         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 33, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 12, 12)   5346        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 51, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 51, 12, 12)   204         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 51, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 7344)         0           activation_7[0][0]               
==================================================================================================
Total params: 18,308
Trainable params: 17,874
Non-trainable params: 434
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 7344)         18308       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 14688)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          7520768     merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 7,541,637
Trainable params: 7,540,179
Non-trainable params: 1,458
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 37s - loss: 0.5638 - acc: 0.7461 - val_loss: 0.4241 - val_acc: 0.7875
Epoch 2/13
 - 34s - loss: 0.3093 - acc: 0.8706 - val_loss: 0.2430 - val_acc: 0.9168
Epoch 3/13
 - 33s - loss: 0.2150 - acc: 0.9172 - val_loss: 0.1724 - val_acc: 0.9528
Epoch 4/13
 - 33s - loss: 0.1556 - acc: 0.9475 - val_loss: 0.1070 - val_acc: 0.9716
Epoch 5/13
 - 33s - loss: 0.1155 - acc: 0.9632 - val_loss: 0.0942 - val_acc: 0.9774
Epoch 6/13
 - 33s - loss: 0.0942 - acc: 0.9718 - val_loss: 0.0622 - val_acc: 0.9856
Epoch 7/13
 - 33s - loss: 0.0717 - acc: 0.9807 - val_loss: 0.0560 - val_acc: 0.9893
Epoch 8/13
 - 33s - loss: 0.0629 - acc: 0.9839 - val_loss: 0.0426 - val_acc: 0.9936
Epoch 9/13
 - 33s - loss: 0.0525 - acc: 0.9878 - val_loss: 0.0328 - val_acc: 0.9930
Epoch 10/13
 - 33s - loss: 0.0443 - acc: 0.9900 - val_loss: 0.0278 - val_acc: 0.9950
Epoch 11/13
 - 33s - loss: 0.0403 - acc: 0.9911 - val_loss: 0.0254 - val_acc: 0.9960
Epoch 12/13
 - 32s - loss: 0.0336 - acc: 0.9929 - val_loss: 0.0209 - val_acc: 0.9955
Epoch 13/13
 - 33s - loss: 0.0296 - acc: 0.9941 - val_loss: 0.0175 - val_acc: 0.9971
Test accuracy:0.723
current auc_score ------------------> 0.910
accuracies:  [0.6887096774193548, 0.6375, 0.6009408602150538, 0.6966397849462366, 0.7295698924731183, 0.696236559139785, 0.7318548387096774, 0.7200268817204301, 0.6538978494623656, 0.7228494623655914]
aucs:  [0.9249, 0.8603, 0.6582, 0.8899, 0.8968, 0.9277, 0.8842, 0.9076, 0.8941, 0.91]
mean and std AUC:  0.875+/-0.075  max:   0.9277
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 46s - loss: 0.4980 - acc: 0.7827 - val_loss: 1.0374 - val_acc: 0.5740
Epoch 2/13
 - 43s - loss: 0.2612 - acc: 0.8971 - val_loss: 0.2222 - val_acc: 0.9273
Epoch 3/13
 - 43s - loss: 0.1835 - acc: 0.9350 - val_loss: 0.2145 - val_acc: 0.9324
Epoch 4/13
 - 45s - loss: 0.1352 - acc: 0.9561 - val_loss: 0.1064 - val_acc: 0.9721
Epoch 5/13
 - 45s - loss: 0.1043 - acc: 0.9692 - val_loss: 0.0903 - val_acc: 0.9778
Epoch 6/13
 - 44s - loss: 0.0822 - acc: 0.9768 - val_loss: 0.0659 - val_acc: 0.9854
Epoch 7/13
 - 45s - loss: 0.0708 - acc: 0.9813 - val_loss: 0.0592 - val_acc: 0.9866
Epoch 8/13
 - 44s - loss: 0.0579 - acc: 0.9858 - val_loss: 0.0493 - val_acc: 0.9906
Epoch 9/13
 - 44s - loss: 0.0504 - acc: 0.9871 - val_loss: 0.0416 - val_acc: 0.9925
Epoch 10/13
 - 44s - loss: 0.0422 - acc: 0.9904 - val_loss: 0.0317 - val_acc: 0.9939
Epoch 11/13
 - 44s - loss: 0.0371 - acc: 0.9920 - val_loss: 0.0231 - val_acc: 0.9961
Epoch 12/13
 - 44s - loss: 0.0317 - acc: 0.9942 - val_loss: 0.0246 - val_acc: 0.9961
Epoch 13/13
 - 45s - loss: 0.0318 - acc: 0.9940 - val_loss: 0.0198 - val_acc: 0.9967
Test accuracy:0.653
current auc_score ------------------> 0.907
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 48s - loss: 0.5205 - acc: 0.7730 - val_loss: 0.3226 - val_acc: 0.8694
Epoch 2/13
 - 44s - loss: 0.2735 - acc: 0.8872 - val_loss: 0.1953 - val_acc: 0.9346
Epoch 3/13
 - 44s - loss: 0.1796 - acc: 0.9362 - val_loss: 0.1364 - val_acc: 0.9645
Epoch 4/13
 - 44s - loss: 0.1318 - acc: 0.9576 - val_loss: 0.1050 - val_acc: 0.9753
Epoch 5/13
 - 44s - loss: 0.0995 - acc: 0.9718 - val_loss: 0.0682 - val_acc: 0.9863
Epoch 6/13
 - 44s - loss: 0.0782 - acc: 0.9798 - val_loss: 0.0537 - val_acc: 0.9912
Epoch 7/13
 - 44s - loss: 0.0640 - acc: 0.9842 - val_loss: 0.0470 - val_acc: 0.9926
Epoch 8/13
 - 44s - loss: 0.0558 - acc: 0.9870 - val_loss: 0.0373 - val_acc: 0.9940
Epoch 9/13
 - 44s - loss: 0.0426 - acc: 0.9920 - val_loss: 0.0241 - val_acc: 0.9966
Epoch 10/13
 - 44s - loss: 0.0392 - acc: 0.9928 - val_loss: 0.0249 - val_acc: 0.9966
Epoch 11/13
 - 44s - loss: 0.0335 - acc: 0.9937 - val_loss: 0.0192 - val_acc: 0.9971
Epoch 12/13
 - 44s - loss: 0.0305 - acc: 0.9940 - val_loss: 0.0181 - val_acc: 0.9976
Epoch 13/13
 - 43s - loss: 0.0296 - acc: 0.9939 - val_loss: 0.0159 - val_acc: 0.9984
Test accuracy:0.691
current auc_score ------------------> 0.893
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 47s - loss: 0.5436 - acc: 0.7602 - val_loss: 0.3398 - val_acc: 0.8584
Epoch 2/13
 - 43s - loss: 0.2914 - acc: 0.8816 - val_loss: 0.2145 - val_acc: 0.9287
Epoch 3/13
 - 43s - loss: 0.2002 - acc: 0.9287 - val_loss: 0.1469 - val_acc: 0.9575
Epoch 4/13
 - 43s - loss: 0.1437 - acc: 0.9539 - val_loss: 0.1097 - val_acc: 0.9735
Epoch 5/13
 - 43s - loss: 0.1058 - acc: 0.9697 - val_loss: 0.0891 - val_acc: 0.9785
Epoch 6/13
 - 43s - loss: 0.0872 - acc: 0.9751 - val_loss: 0.0606 - val_acc: 0.9867
Epoch 7/13
 - 43s - loss: 0.0693 - acc: 0.9823 - val_loss: 0.0445 - val_acc: 0.9907
Epoch 8/13
 - 43s - loss: 0.0557 - acc: 0.9872 - val_loss: 0.0353 - val_acc: 0.9942
Epoch 9/13
 - 43s - loss: 0.0496 - acc: 0.9889 - val_loss: 0.0430 - val_acc: 0.9902
Epoch 10/13
 - 45s - loss: 0.0437 - acc: 0.9906 - val_loss: 0.0264 - val_acc: 0.9959
Epoch 11/13
 - 44s - loss: 0.0376 - acc: 0.9922 - val_loss: 0.0226 - val_acc: 0.9965
Epoch 12/13
 - 44s - loss: 0.0302 - acc: 0.9950 - val_loss: 0.0205 - val_acc: 0.9959
Epoch 13/13
 - 43s - loss: 0.0309 - acc: 0.9942 - val_loss: 0.0174 - val_acc: 0.9984
Test accuracy:0.683
current auc_score ------------------> 0.921
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 45s - loss: 0.5424 - acc: 0.7527 - val_loss: 0.3533 - val_acc: 0.8417
Epoch 2/13
 - 42s - loss: 0.2965 - acc: 0.8797 - val_loss: 0.2746 - val_acc: 0.8941
Epoch 3/13
 - 42s - loss: 0.2023 - acc: 0.9282 - val_loss: 0.1554 - val_acc: 0.9546
Epoch 4/13
 - 42s - loss: 0.1452 - acc: 0.9539 - val_loss: 0.1029 - val_acc: 0.9773
Epoch 5/13
 - 42s - loss: 0.1125 - acc: 0.9671 - val_loss: 0.0711 - val_acc: 0.9848
Epoch 6/13
 - 42s - loss: 0.0880 - acc: 0.9756 - val_loss: 0.0551 - val_acc: 0.9908
Epoch 7/13
 - 43s - loss: 0.0693 - acc: 0.9838 - val_loss: 0.0411 - val_acc: 0.9937
Epoch 8/13
 - 42s - loss: 0.0570 - acc: 0.9873 - val_loss: 0.0398 - val_acc: 0.9937
Epoch 9/13
 - 42s - loss: 0.0492 - acc: 0.9892 - val_loss: 0.0294 - val_acc: 0.9956
Epoch 10/13
 - 43s - loss: 0.0419 - acc: 0.9908 - val_loss: 0.0289 - val_acc: 0.9941
Epoch 11/13
 - 43s - loss: 0.0361 - acc: 0.9933 - val_loss: 0.0231 - val_acc: 0.9960
Epoch 12/13
 - 43s - loss: 0.0313 - acc: 0.9942 - val_loss: 0.0194 - val_acc: 0.9974
Epoch 13/13
 - 43s - loss: 0.0287 - acc: 0.9949 - val_loss: 0.0158 - val_acc: 0.9987
Test accuracy:0.645
current auc_score ------------------> 0.901
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 46s - loss: 0.5486 - acc: 0.7546 - val_loss: 0.6031 - val_acc: 0.6938
Epoch 2/13
 - 45s - loss: 0.3115 - acc: 0.8694 - val_loss: 0.2771 - val_acc: 0.8983
Epoch 3/13
 - 44s - loss: 0.2158 - acc: 0.9199 - val_loss: 0.2099 - val_acc: 0.9369
Epoch 4/13
 - 44s - loss: 0.1558 - acc: 0.9482 - val_loss: 0.1315 - val_acc: 0.9686
Epoch 5/13
 - 44s - loss: 0.1226 - acc: 0.9641 - val_loss: 0.1031 - val_acc: 0.9819
Epoch 6/13
 - 44s - loss: 0.1005 - acc: 0.9713 - val_loss: 0.0721 - val_acc: 0.9848
Epoch 7/13
 - 44s - loss: 0.0802 - acc: 0.9788 - val_loss: 0.0508 - val_acc: 0.9910
Epoch 8/13
 - 44s - loss: 0.0641 - acc: 0.9840 - val_loss: 0.0474 - val_acc: 0.9905
Epoch 9/13
 - 44s - loss: 0.0526 - acc: 0.9883 - val_loss: 0.0386 - val_acc: 0.9926
Epoch 10/13
 - 44s - loss: 0.0477 - acc: 0.9892 - val_loss: 0.0288 - val_acc: 0.9941
Epoch 11/13
 - 43s - loss: 0.0427 - acc: 0.9908 - val_loss: 0.0252 - val_acc: 0.9956
Epoch 12/13
 - 43s - loss: 0.0375 - acc: 0.9925 - val_loss: 0.0226 - val_acc: 0.9962
Epoch 13/13
 - 44s - loss: 0.0329 - acc: 0.9934 - val_loss: 0.0222 - val_acc: 0.9965
Test accuracy:0.649
current auc_score ------------------> 0.901
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 47s - loss: 0.5951 - acc: 0.7307 - val_loss: 0.6118 - val_acc: 0.6530
Epoch 2/13
 - 44s - loss: 0.3357 - acc: 0.8584 - val_loss: 0.2852 - val_acc: 0.8892
Epoch 3/13
 - 44s - loss: 0.2254 - acc: 0.9163 - val_loss: 0.1940 - val_acc: 0.9473
Epoch 4/13
 - 44s - loss: 0.1642 - acc: 0.9456 - val_loss: 0.1174 - val_acc: 0.9699
Epoch 5/13
 - 44s - loss: 0.1270 - acc: 0.9617 - val_loss: 0.0848 - val_acc: 0.9817
Epoch 6/13
 - 44s - loss: 0.1005 - acc: 0.9719 - val_loss: 0.0624 - val_acc: 0.9872
Epoch 7/13
 - 44s - loss: 0.0815 - acc: 0.9781 - val_loss: 0.0461 - val_acc: 0.9911
Epoch 8/13
 - 44s - loss: 0.0687 - acc: 0.9832 - val_loss: 0.0418 - val_acc: 0.9925
Epoch 9/13
 - 44s - loss: 0.0555 - acc: 0.9873 - val_loss: 0.0342 - val_acc: 0.9946
Epoch 10/13
 - 44s - loss: 0.0504 - acc: 0.9892 - val_loss: 0.0293 - val_acc: 0.9955
Epoch 11/13
 - 44s - loss: 0.0467 - acc: 0.9895 - val_loss: 0.0225 - val_acc: 0.9967
Epoch 12/13
 - 45s - loss: 0.0399 - acc: 0.9923 - val_loss: 0.0243 - val_acc: 0.9965
Epoch 13/13
 - 43s - loss: 0.0356 - acc: 0.9925 - val_loss: 0.0181 - val_acc: 0.9967
Test accuracy:0.688
current auc_score ------------------> 0.882
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 47s - loss: 0.5280 - acc: 0.7679 - val_loss: 0.6585 - val_acc: 0.6483
Epoch 2/13
 - 44s - loss: 0.2993 - acc: 0.8764 - val_loss: 0.2507 - val_acc: 0.9138
Epoch 3/13
 - 44s - loss: 0.2091 - acc: 0.9239 - val_loss: 0.1719 - val_acc: 0.9472
Epoch 4/13
 - 44s - loss: 0.1563 - acc: 0.9477 - val_loss: 0.1047 - val_acc: 0.9730
Epoch 5/13
 - 43s - loss: 0.1161 - acc: 0.9644 - val_loss: 0.0800 - val_acc: 0.9847
Epoch 6/13
 - 43s - loss: 0.0905 - acc: 0.9747 - val_loss: 0.0587 - val_acc: 0.9886
Epoch 7/13
 - 43s - loss: 0.0720 - acc: 0.9815 - val_loss: 0.0460 - val_acc: 0.9928
Epoch 8/13
 - 43s - loss: 0.0612 - acc: 0.9849 - val_loss: 0.0359 - val_acc: 0.9940
Epoch 9/13
 - 44s - loss: 0.0528 - acc: 0.9878 - val_loss: 0.0398 - val_acc: 0.9931
Epoch 10/13
 - 44s - loss: 0.0451 - acc: 0.9902 - val_loss: 0.0270 - val_acc: 0.9951
Epoch 11/13
 - 44s - loss: 0.0392 - acc: 0.9916 - val_loss: 0.0263 - val_acc: 0.9970
Epoch 12/13
 - 43s - loss: 0.0365 - acc: 0.9924 - val_loss: 0.0238 - val_acc: 0.9962
Epoch 13/13
 - 43s - loss: 0.0299 - acc: 0.9949 - val_loss: 0.0166 - val_acc: 0.9975
Test accuracy:0.687
current auc_score ------------------> 0.878
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 46s - loss: 0.5067 - acc: 0.7752 - val_loss: 0.5029 - val_acc: 0.7061
Epoch 2/13
 - 44s - loss: 0.2766 - acc: 0.8904 - val_loss: 0.3660 - val_acc: 0.8160
Epoch 3/13
 - 44s - loss: 0.1914 - acc: 0.9324 - val_loss: 0.1659 - val_acc: 0.9601
Epoch 4/13
 - 43s - loss: 0.1415 - acc: 0.9565 - val_loss: 0.1544 - val_acc: 0.9551
Epoch 5/13
 - 44s - loss: 0.1088 - acc: 0.9686 - val_loss: 0.0887 - val_acc: 0.9831
Epoch 6/13
 - 44s - loss: 0.0838 - acc: 0.9787 - val_loss: 0.0781 - val_acc: 0.9822
Epoch 7/13
 - 44s - loss: 0.0681 - acc: 0.9839 - val_loss: 0.0600 - val_acc: 0.9896
Epoch 8/13
 - 43s - loss: 0.0598 - acc: 0.9853 - val_loss: 0.0350 - val_acc: 0.9951
Epoch 9/13
 - 43s - loss: 0.0523 - acc: 0.9888 - val_loss: 0.0318 - val_acc: 0.9946
Epoch 10/13
 - 43s - loss: 0.0448 - acc: 0.9908 - val_loss: 0.0259 - val_acc: 0.9966
Epoch 11/13
 - 43s - loss: 0.0391 - acc: 0.9922 - val_loss: 0.0241 - val_acc: 0.9955
Epoch 12/13
 - 43s - loss: 0.0364 - acc: 0.9926 - val_loss: 0.0184 - val_acc: 0.9977
Epoch 13/13
 - 44s - loss: 0.0299 - acc: 0.9950 - val_loss: 0.0172 - val_acc: 0.9977
Test accuracy:0.678
current auc_score ------------------> 0.918
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 47s - loss: 0.4874 - acc: 0.7898 - val_loss: 0.3102 - val_acc: 0.8808
Epoch 2/13
 - 43s - loss: 0.2611 - acc: 0.8964 - val_loss: 0.1998 - val_acc: 0.9467
Epoch 3/13
 - 44s - loss: 0.1817 - acc: 0.9359 - val_loss: 0.1536 - val_acc: 0.9563
Epoch 4/13
 - 44s - loss: 0.1380 - acc: 0.9552 - val_loss: 0.1018 - val_acc: 0.9783
Epoch 5/13
 - 44s - loss: 0.1020 - acc: 0.9708 - val_loss: 0.0767 - val_acc: 0.9867
Epoch 6/13
 - 43s - loss: 0.0837 - acc: 0.9777 - val_loss: 0.0549 - val_acc: 0.9912
Epoch 7/13
 - 43s - loss: 0.0656 - acc: 0.9838 - val_loss: 0.0498 - val_acc: 0.9930
Epoch 8/13
 - 44s - loss: 0.0551 - acc: 0.9873 - val_loss: 0.0367 - val_acc: 0.9933
Epoch 9/13
 - 43s - loss: 0.0462 - acc: 0.9903 - val_loss: 0.0289 - val_acc: 0.9960
Epoch 10/13
 - 43s - loss: 0.0400 - acc: 0.9923 - val_loss: 0.0248 - val_acc: 0.9970
Epoch 11/13
 - 43s - loss: 0.0386 - acc: 0.9920 - val_loss: 0.0198 - val_acc: 0.9982
Epoch 12/13
 - 43s - loss: 0.0313 - acc: 0.9946 - val_loss: 0.0193 - val_acc: 0.9979
Epoch 13/13
 - 43s - loss: 0.0288 - acc: 0.9945 - val_loss: 0.0163 - val_acc: 0.9982
Test accuracy:0.607
current auc_score ------------------> 0.890
Epochs  13  batch_size:  64  lr:  0.0001  optimizer:  nadam
 es_patience:  4  lr_patience:  3
 batch_size:  64  fc_dropout:  0.5  fc_filter:  512  fc_layers:  1
------------------------ current config for the test -------------------------
Layers:  [2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.4
dense_block  2  reduction_:  0.7  bottleneck:  False
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 24, 24)   1672        activation_4[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 22, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 12, 12)   88          max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 22, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   5940        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 52, 12, 12)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   14040       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 82, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 82, 12, 12)   328         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 82, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 11808)        0           activation_7[0][0]               
==================================================================================================
Total params: 40,416
Trainable params: 39,796
Non-trainable params: 620
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 11808)        40416       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 23616)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          12091904    merge_features[0][0]             
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 12,134,881
Trainable params: 12,133,237
Non-trainable params: 1,644
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/13
 - 46s - loss: 0.4836 - acc: 0.7951 - val_loss: 0.5599 - val_acc: 0.7189
Epoch 2/13
 - 44s - loss: 0.2496 - acc: 0.9018 - val_loss: 0.5864 - val_acc: 0.7108
Epoch 3/13
 - 43s - loss: 0.1706 - acc: 0.9395 - val_loss: 0.4490 - val_acc: 0.7959
Epoch 4/13
 - 44s - loss: 0.1269 - acc: 0.9598 - val_loss: 0.4231 - val_acc: 0.8074
Epoch 5/13
 - 44s - loss: 0.0969 - acc: 0.9721 - val_loss: 0.4071 - val_acc: 0.8169
Epoch 6/13
 - 43s - loss: 0.0772 - acc: 0.9796 - val_loss: 0.4603 - val_acc: 0.7825
Epoch 7/13
 - 44s - loss: 0.0688 - acc: 0.9826 - val_loss: 0.0432 - val_acc: 0.9913
Epoch 8/13
 - 44s - loss: 0.0559 - acc: 0.9874 - val_loss: 0.0356 - val_acc: 0.9937
Epoch 9/13
 - 44s - loss: 0.0466 - acc: 0.9896 - val_loss: 0.0270 - val_acc: 0.9955
Epoch 10/13
 - 44s - loss: 0.0402 - acc: 0.9921 - val_loss: 0.0379 - val_acc: 0.9915
Epoch 11/13
 - 44s - loss: 0.0345 - acc: 0.9935 - val_loss: 0.0203 - val_acc: 0.9970
Epoch 12/13
 - 44s - loss: 0.0317 - acc: 0.9934 - val_loss: 0.0179 - val_acc: 0.9970
Epoch 13/13
 - 45s - loss: 0.0294 - acc: 0.9947 - val_loss: 0.0181 - val_acc: 0.9977
Test accuracy:0.719
current auc_score ------------------> 0.921
accuracies:  [0.6526881720430108, 0.6905913978494623, 0.6826612903225806, 0.6452956989247312, 0.6485215053763441, 0.687768817204301, 0.687231182795699, 0.6782258064516129, 0.6072580645161291, 0.7185483870967742]
aucs:  [0.9069, 0.8926, 0.9213, 0.9013, 0.901, 0.8819, 0.8784, 0.9176, 0.8905, 0.9212]
mean and std AUC:  0.901+/-0.015  max:   0.9213
(['2-2', '12', '2', '16', '0.2', '0.0001', '11', 'nadam', '0.7', 'FALSE', '64', '0.5', '512', '1'], '0.89+/-0.023', 0.942)
(['2-2', '18', '2', '16', '0.2', '0.0001', '11', 'nadam', '0.7', 'FALSE', '64', '0.5', '512', '1'], '0.889+/-0.021', 0.914)
(['2-2', '30', '2', '16', '0.2', '0.0001', '11', 'nadam', '0.7', 'FALSE', '64', '0.5', '512', '1'], '0.861+/-0.061', 0.904)
(['2-2', '12', '2', '16', '0.4', '0.0001', '13', 'nadam', '0.7', 'FALSE', '64', '0.5', '512', '1'], '0.885+/-0.028', 0.922)
(['2-2', '18', '2', '16', '0.4', '0.0001', '13', 'nadam', '0.7', 'FALSE', '64', '0.5', '512', '1'], '0.875+/-0.075', 0.928)
(['2-2', '30', '2', '16', '0.4', '0.0001', '13', 'nadam', '0.7', 'FALSE', '64', '0.5', '512', '1'], '0.901+/-0.015', 0.921)
