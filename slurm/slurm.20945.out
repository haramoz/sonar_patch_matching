python keras_dn_simple_multigpu.py
python keras_dn_simple.py
python custom_gridsearch_dn_siamese.py
python custom_gs_dn_siamese_layers_multi.py -g 1
python custom_gridsearch_dn_siamese_layers_avg.py
Column names are layers_per_block, growth_rate, nb_dense_block, nb_filter, dropout, lr, epochs
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_6[0][0]               
==================================================================================================
Total params: 48,944
Trainable params: 48,288
Non-trainable params: 656
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        48944       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 37,800,753
Trainable params: 37,799,073
Non-trainable params: 1,680
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 26s - loss: 0.4606 - acc: 0.8105 - val_loss: 0.2483 - val_acc: 0.9329
Epoch 2/6
 - 20s - loss: 0.2121 - acc: 0.9406 - val_loss: 0.1422 - val_acc: 0.9769
Epoch 3/6
 - 20s - loss: 0.1312 - acc: 0.9749 - val_loss: 0.0898 - val_acc: 0.9916
Epoch 4/6
 - 20s - loss: 0.1023 - acc: 0.9827 - val_loss: 0.0667 - val_acc: 0.9925
Epoch 5/6
 - 20s - loss: 0.0785 - acc: 0.9902 - val_loss: 0.0568 - val_acc: 0.9966
Epoch 6/6
 - 20s - loss: 0.0699 - acc: 0.9910 - val_loss: 0.0512 - val_acc: 0.9962
Test accuracy:0.549
current auc_score ------------------> 0.859
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_6[0][0]               
==================================================================================================
Total params: 48,944
Trainable params: 48,288
Non-trainable params: 656
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        48944       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 37,800,753
Trainable params: 37,799,073
Non-trainable params: 1,680
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 23s - loss: 0.4697 - acc: 0.8071 - val_loss: 0.2662 - val_acc: 0.9172
Epoch 2/6
 - 20s - loss: 0.2296 - acc: 0.9303 - val_loss: 0.1459 - val_acc: 0.9636
Epoch 3/6
 - 20s - loss: 0.1373 - acc: 0.9705 - val_loss: 0.0914 - val_acc: 0.9917
Epoch 4/6
 - 20s - loss: 0.0936 - acc: 0.9863 - val_loss: 0.0691 - val_acc: 0.9903
Epoch 5/6
 - 20s - loss: 0.0782 - acc: 0.9896 - val_loss: 0.0564 - val_acc: 0.9951
Epoch 6/6
 - 20s - loss: 0.0653 - acc: 0.9926 - val_loss: 0.0517 - val_acc: 0.9949
Test accuracy:0.743
current auc_score ------------------> 0.905
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_6[0][0]               
==================================================================================================
Total params: 48,944
Trainable params: 48,288
Non-trainable params: 656
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        48944       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 37,800,753
Trainable params: 37,799,073
Non-trainable params: 1,680
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 22s - loss: 0.4558 - acc: 0.8170 - val_loss: 0.2669 - val_acc: 0.9086
Epoch 2/6
 - 20s - loss: 0.2128 - acc: 0.9384 - val_loss: 0.1579 - val_acc: 0.9587
Epoch 3/6
 - 20s - loss: 0.1316 - acc: 0.9737 - val_loss: 0.0912 - val_acc: 0.9893
Epoch 4/6
 - 20s - loss: 0.0977 - acc: 0.9847 - val_loss: 0.0727 - val_acc: 0.9951
Epoch 5/6
 - 20s - loss: 0.0750 - acc: 0.9911 - val_loss: 0.0555 - val_acc: 0.9966
Epoch 6/6
 - 20s - loss: 0.0636 - acc: 0.9931 - val_loss: 0.0504 - val_acc: 0.9969
Test accuracy:0.687
current auc_score ------------------> 0.851
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_6[0][0]               
==================================================================================================
Total params: 48,944
Trainable params: 48,288
Non-trainable params: 656
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        48944       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 37,800,753
Trainable params: 37,799,073
Non-trainable params: 1,680
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 23s - loss: 0.4587 - acc: 0.8121 - val_loss: 0.2353 - val_acc: 0.9244
Epoch 2/6
 - 20s - loss: 0.2157 - acc: 0.9376 - val_loss: 0.1338 - val_acc: 0.9775
Epoch 3/6
 - 20s - loss: 0.1435 - acc: 0.9691 - val_loss: 0.0963 - val_acc: 0.9888
Epoch 4/6
 - 20s - loss: 0.1005 - acc: 0.9840 - val_loss: 0.0751 - val_acc: 0.9937
Epoch 5/6
 - 20s - loss: 0.0813 - acc: 0.9895 - val_loss: 0.0594 - val_acc: 0.9949
Epoch 6/6
 - 20s - loss: 0.0685 - acc: 0.9923 - val_loss: 0.0506 - val_acc: 0.9962
Test accuracy:0.654
current auc_score ------------------> 0.872
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_6[0][0]               
==================================================================================================
Total params: 48,944
Trainable params: 48,288
Non-trainable params: 656
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        48944       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 37,800,753
Trainable params: 37,799,073
Non-trainable params: 1,680
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 22s - loss: 0.4973 - acc: 0.7915 - val_loss: 0.2790 - val_acc: 0.9125
Epoch 2/6
 - 19s - loss: 0.2355 - acc: 0.9287 - val_loss: 0.1726 - val_acc: 0.9674
Epoch 3/6
 - 19s - loss: 0.1448 - acc: 0.9709 - val_loss: 0.0968 - val_acc: 0.9867
Epoch 4/6
 - 19s - loss: 0.1044 - acc: 0.9824 - val_loss: 0.0878 - val_acc: 0.9832
Epoch 5/6
 - 19s - loss: 0.0839 - acc: 0.9877 - val_loss: 0.0637 - val_acc: 0.9954
Epoch 6/6
 - 19s - loss: 0.0663 - acc: 0.9921 - val_loss: 0.0500 - val_acc: 0.9956
Test accuracy:0.744
current auc_score ------------------> 0.870
accuracies:  [0.5490591397849462, 0.7426075268817204, 0.6870967741935484, 0.6537634408602151, 0.7443548387096774]
aucs:  [0.8590923083593479, 0.9049472482367904, 0.8512489521910049, 0.871538942363279, 0.8696772025667708]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_6[0][0]               
==================================================================================================
Total params: 74,600
Trainable params: 73,812
Non-trainable params: 788
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        74600       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 44,904,297
Trainable params: 44,902,485
Non-trainable params: 1,812
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 23s - loss: 0.4840 - acc: 0.8053 - val_loss: 0.3415 - val_acc: 0.8804
Epoch 2/6
 - 20s - loss: 0.2338 - acc: 0.9321 - val_loss: 0.1474 - val_acc: 0.9704
Epoch 3/6
 - 20s - loss: 0.1474 - acc: 0.9703 - val_loss: 0.1212 - val_acc: 0.9719
Epoch 4/6
 - 20s - loss: 0.1095 - acc: 0.9829 - val_loss: 0.0815 - val_acc: 0.9917
Epoch 5/6
 - 20s - loss: 0.0859 - acc: 0.9902 - val_loss: 0.0623 - val_acc: 0.9955
Epoch 6/6
 - 19s - loss: 0.0770 - acc: 0.9908 - val_loss: 0.0644 - val_acc: 0.9961
Test accuracy:0.693
current auc_score ------------------> 0.885
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_6[0][0]               
==================================================================================================
Total params: 74,600
Trainable params: 73,812
Non-trainable params: 788
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        74600       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 44,904,297
Trainable params: 44,902,485
Non-trainable params: 1,812
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 23s - loss: 0.4931 - acc: 0.8035 - val_loss: 0.3048 - val_acc: 0.8916
Epoch 2/6
 - 20s - loss: 0.2266 - acc: 0.9353 - val_loss: 0.1484 - val_acc: 0.9729
Epoch 3/6
 - 19s - loss: 0.1403 - acc: 0.9720 - val_loss: 0.0962 - val_acc: 0.9885
Epoch 4/6
 - 20s - loss: 0.1019 - acc: 0.9849 - val_loss: 0.0736 - val_acc: 0.9932
Epoch 5/6
 - 20s - loss: 0.0818 - acc: 0.9909 - val_loss: 0.0677 - val_acc: 0.9955
Epoch 6/6
 - 20s - loss: 0.0710 - acc: 0.9928 - val_loss: 0.0639 - val_acc: 0.9916
Test accuracy:0.815
current auc_score ------------------> 0.930
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_6[0][0]               
==================================================================================================
Total params: 74,600
Trainable params: 73,812
Non-trainable params: 788
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        74600       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 44,904,297
Trainable params: 44,902,485
Non-trainable params: 1,812
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 23s - loss: 0.4412 - acc: 0.8309 - val_loss: 0.3074 - val_acc: 0.8928
Epoch 2/6
 - 20s - loss: 0.2098 - acc: 0.9451 - val_loss: 0.1377 - val_acc: 0.9818
Epoch 3/6
 - 20s - loss: 0.1328 - acc: 0.9769 - val_loss: 0.0897 - val_acc: 0.9883
Epoch 4/6
 - 20s - loss: 0.1032 - acc: 0.9856 - val_loss: 0.0755 - val_acc: 0.9947
Epoch 5/6
 - 20s - loss: 0.0833 - acc: 0.9903 - val_loss: 0.0621 - val_acc: 0.9962
Epoch 6/6
 - 20s - loss: 0.0699 - acc: 0.9933 - val_loss: 0.0572 - val_acc: 0.9955
Test accuracy:0.662
current auc_score ------------------> 0.857
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_6[0][0]               
==================================================================================================
Total params: 74,600
Trainable params: 73,812
Non-trainable params: 788
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        74600       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 44,904,297
Trainable params: 44,902,485
Non-trainable params: 1,812
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 23s - loss: 0.4761 - acc: 0.8133 - val_loss: 0.2635 - val_acc: 0.9218
Epoch 2/6
 - 20s - loss: 0.2245 - acc: 0.9374 - val_loss: 0.1457 - val_acc: 0.9738
Epoch 3/6
 - 20s - loss: 0.1403 - acc: 0.9737 - val_loss: 0.0969 - val_acc: 0.9861
Epoch 4/6
 - 20s - loss: 0.1084 - acc: 0.9839 - val_loss: 0.0742 - val_acc: 0.9946
Epoch 5/6
 - 20s - loss: 0.0867 - acc: 0.9900 - val_loss: 0.0660 - val_acc: 0.9957
Epoch 6/6
 - 20s - loss: 0.0712 - acc: 0.9934 - val_loss: 0.0551 - val_acc: 0.9969
Test accuracy:0.666
current auc_score ------------------> 0.900
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_6[0][0]               
==================================================================================================
Total params: 74,600
Trainable params: 73,812
Non-trainable params: 788
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        74600       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 44,904,297
Trainable params: 44,902,485
Non-trainable params: 1,812
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 23s - loss: 0.4954 - acc: 0.8032 - val_loss: 0.2777 - val_acc: 0.9179
Epoch 2/6
 - 20s - loss: 0.2350 - acc: 0.9307 - val_loss: 0.1551 - val_acc: 0.9726
Epoch 3/6
 - 20s - loss: 0.1492 - acc: 0.9690 - val_loss: 0.1100 - val_acc: 0.9816
Epoch 4/6
 - 20s - loss: 0.1072 - acc: 0.9841 - val_loss: 0.0860 - val_acc: 0.9880
Epoch 5/6
 - 20s - loss: 0.0891 - acc: 0.9886 - val_loss: 0.0716 - val_acc: 0.9955
Epoch 6/6
 - 20s - loss: 0.0732 - acc: 0.9928 - val_loss: 0.0575 - val_acc: 0.9960
Test accuracy:0.758
current auc_score ------------------> 0.891
accuracies:  [0.693010752688172, 0.8151881720430108, 0.6625, 0.6661290322580645, 0.7580645161290323]
aucs:  [0.8854749103942652, 0.929949560642849, 0.8567404468724709, 0.9004320586194935, 0.8911940325471153]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_6[0][0]               
==================================================================================================
Total params: 105,728
Trainable params: 104,808
Non-trainable params: 920
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        105728      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 52,013,313
Trainable params: 52,011,369
Non-trainable params: 1,944
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 24s - loss: 0.4970 - acc: 0.8048 - val_loss: 0.2930 - val_acc: 0.9061
Epoch 2/6
 - 21s - loss: 0.2470 - acc: 0.9302 - val_loss: 0.1601 - val_acc: 0.9657
Epoch 3/6
 - 21s - loss: 0.1531 - acc: 0.9713 - val_loss: 0.1073 - val_acc: 0.9886
Epoch 4/6
 - 21s - loss: 0.1144 - acc: 0.9842 - val_loss: 0.0819 - val_acc: 0.9927
Epoch 5/6
 - 21s - loss: 0.0905 - acc: 0.9907 - val_loss: 0.0664 - val_acc: 0.9945
Epoch 6/6
 - 21s - loss: 0.0783 - acc: 0.9923 - val_loss: 0.0603 - val_acc: 0.9977
Test accuracy:0.688
current auc_score ------------------> 0.884
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_6[0][0]               
==================================================================================================
Total params: 105,728
Trainable params: 104,808
Non-trainable params: 920
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        105728      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 52,013,313
Trainable params: 52,011,369
Non-trainable params: 1,944
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 24s - loss: 0.4795 - acc: 0.8146 - val_loss: 0.2806 - val_acc: 0.9261
Epoch 2/6
 - 21s - loss: 0.2334 - acc: 0.9384 - val_loss: 0.1519 - val_acc: 0.9733
Epoch 3/6
 - 21s - loss: 0.1505 - acc: 0.9708 - val_loss: 0.1048 - val_acc: 0.9871
Epoch 4/6
 - 21s - loss: 0.1144 - acc: 0.9826 - val_loss: 0.0866 - val_acc: 0.9931
Epoch 5/6
 - 21s - loss: 0.0900 - acc: 0.9902 - val_loss: 0.0712 - val_acc: 0.9956
Epoch 6/6
 - 21s - loss: 0.0748 - acc: 0.9933 - val_loss: 0.0809 - val_acc: 0.9891
Test accuracy:0.711
current auc_score ------------------> 0.851
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_6[0][0]               
==================================================================================================
Total params: 105,728
Trainable params: 104,808
Non-trainable params: 920
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        105728      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 52,013,313
Trainable params: 52,011,369
Non-trainable params: 1,944
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 24s - loss: 0.4748 - acc: 0.8220 - val_loss: 0.2794 - val_acc: 0.9243
Epoch 2/6
 - 21s - loss: 0.2269 - acc: 0.9404 - val_loss: 0.1965 - val_acc: 0.9607
Epoch 3/6
 - 21s - loss: 0.1486 - acc: 0.9725 - val_loss: 0.1194 - val_acc: 0.9853
Epoch 4/6
 - 21s - loss: 0.1114 - acc: 0.9857 - val_loss: 0.0894 - val_acc: 0.9925
Epoch 5/6
 - 21s - loss: 0.0924 - acc: 0.9894 - val_loss: 0.0704 - val_acc: 0.9975
Epoch 6/6
 - 21s - loss: 0.0762 - acc: 0.9930 - val_loss: 0.0628 - val_acc: 0.9957
Test accuracy:0.720
current auc_score ------------------> 0.897
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_6[0][0]               
==================================================================================================
Total params: 105,728
Trainable params: 104,808
Non-trainable params: 920
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        105728      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 52,013,313
Trainable params: 52,011,369
Non-trainable params: 1,944
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 24s - loss: 0.5056 - acc: 0.7949 - val_loss: 0.3135 - val_acc: 0.9001
Epoch 2/6
 - 21s - loss: 0.2658 - acc: 0.9238 - val_loss: 0.1759 - val_acc: 0.9694
Epoch 3/6
 - 21s - loss: 0.1691 - acc: 0.9661 - val_loss: 0.1130 - val_acc: 0.9847
Epoch 4/6
 - 21s - loss: 0.1195 - acc: 0.9822 - val_loss: 0.0819 - val_acc: 0.9917
Epoch 5/6
 - 21s - loss: 0.0956 - acc: 0.9888 - val_loss: 0.0698 - val_acc: 0.9952
Epoch 6/6
 - 21s - loss: 0.0813 - acc: 0.9917 - val_loss: 0.0620 - val_acc: 0.9965
Test accuracy:0.649
current auc_score ------------------> 0.871
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_6[0][0]               
==================================================================================================
Total params: 105,728
Trainable params: 104,808
Non-trainable params: 920
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        105728      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_3[0][0]                  
==================================================================================================
Total params: 52,013,313
Trainable params: 52,011,369
Non-trainable params: 1,944
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 24s - loss: 0.5503 - acc: 0.7719 - val_loss: 0.3352 - val_acc: 0.8827
Epoch 2/6
 - 20s - loss: 0.2708 - acc: 0.9204 - val_loss: 0.1746 - val_acc: 0.9710
Epoch 3/6
 - 21s - loss: 0.1641 - acc: 0.9682 - val_loss: 0.1205 - val_acc: 0.9788
Epoch 4/6
 - 21s - loss: 0.1184 - acc: 0.9840 - val_loss: 0.0821 - val_acc: 0.9936
Epoch 5/6
 - 21s - loss: 0.0945 - acc: 0.9891 - val_loss: 0.0731 - val_acc: 0.9930
Epoch 6/6
 - 21s - loss: 0.0815 - acc: 0.9908 - val_loss: 0.0726 - val_acc: 0.9945
Test accuracy:0.661
current auc_score ------------------> 0.857
accuracies:  [0.6881720430107527, 0.7106182795698924, 0.7198924731182795, 0.6490591397849462, 0.6610215053763441]
aucs:  [0.884192247658689, 0.8514607902647705, 0.8971239449647359, 0.8705035264192393, 0.8571701930859058]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_8[0][0]               
==================================================================================================
Total params: 76,560
Trainable params: 75,536
Non-trainable params: 1,024
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        76560       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 51,984,145
Trainable params: 51,982,097
Non-trainable params: 2,048
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 27s - loss: 0.4893 - acc: 0.8082 - val_loss: 0.2837 - val_acc: 0.9147
Epoch 2/6
 - 23s - loss: 0.2459 - acc: 0.9333 - val_loss: 0.1614 - val_acc: 0.9709
Epoch 3/6
 - 23s - loss: 0.1630 - acc: 0.9680 - val_loss: 0.1191 - val_acc: 0.9779
Epoch 4/6
 - 23s - loss: 0.1192 - acc: 0.9831 - val_loss: 0.0896 - val_acc: 0.9916
Epoch 5/6
 - 23s - loss: 0.0993 - acc: 0.9877 - val_loss: 0.0763 - val_acc: 0.9949
Epoch 6/6
 - 23s - loss: 0.0816 - acc: 0.9916 - val_loss: 0.0623 - val_acc: 0.9957
Test accuracy:0.736
current auc_score ------------------> 0.891
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_8[0][0]               
==================================================================================================
Total params: 76,560
Trainable params: 75,536
Non-trainable params: 1,024
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        76560       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 51,984,145
Trainable params: 51,982,097
Non-trainable params: 2,048
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 26s - loss: 0.4919 - acc: 0.8069 - val_loss: 0.2901 - val_acc: 0.9218
Epoch 2/6
 - 23s - loss: 0.2436 - acc: 0.9354 - val_loss: 0.1716 - val_acc: 0.9666
Epoch 3/6
 - 23s - loss: 0.1581 - acc: 0.9711 - val_loss: 0.1124 - val_acc: 0.9898
Epoch 4/6
 - 23s - loss: 0.1204 - acc: 0.9825 - val_loss: 0.0962 - val_acc: 0.9927
Epoch 5/6
 - 23s - loss: 0.0936 - acc: 0.9906 - val_loss: 0.0677 - val_acc: 0.9966
Epoch 6/6
 - 23s - loss: 0.0834 - acc: 0.9918 - val_loss: 0.0636 - val_acc: 0.9965
Test accuracy:0.746
current auc_score ------------------> 0.889
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_8[0][0]               
==================================================================================================
Total params: 76,560
Trainable params: 75,536
Non-trainable params: 1,024
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        76560       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 51,984,145
Trainable params: 51,982,097
Non-trainable params: 2,048
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 27s - loss: 0.5119 - acc: 0.7936 - val_loss: 0.3015 - val_acc: 0.9032
Epoch 2/6
 - 24s - loss: 0.2456 - acc: 0.9320 - val_loss: 0.1723 - val_acc: 0.9680
Epoch 3/6
 - 24s - loss: 0.1617 - acc: 0.9686 - val_loss: 0.1062 - val_acc: 0.9892
Epoch 4/6
 - 24s - loss: 0.1188 - acc: 0.9830 - val_loss: 0.0864 - val_acc: 0.9935
Epoch 5/6
 - 24s - loss: 0.0988 - acc: 0.9883 - val_loss: 0.0806 - val_acc: 0.9936
Epoch 6/6
 - 24s - loss: 0.0830 - acc: 0.9913 - val_loss: 0.0656 - val_acc: 0.9964
Test accuracy:0.728
current auc_score ------------------> 0.885
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_8[0][0]               
==================================================================================================
Total params: 76,560
Trainable params: 75,536
Non-trainable params: 1,024
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        76560       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 51,984,145
Trainable params: 51,982,097
Non-trainable params: 2,048
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 26s - loss: 0.5470 - acc: 0.7820 - val_loss: 0.4558 - val_acc: 0.8286
Epoch 2/6
 - 23s - loss: 0.2777 - acc: 0.9152 - val_loss: 0.1809 - val_acc: 0.9606
Epoch 3/6
 - 23s - loss: 0.1790 - acc: 0.9617 - val_loss: 0.1316 - val_acc: 0.9831
Epoch 4/6
 - 23s - loss: 0.1334 - acc: 0.9782 - val_loss: 0.1019 - val_acc: 0.9896
Epoch 5/6
 - 23s - loss: 0.1046 - acc: 0.9863 - val_loss: 0.0785 - val_acc: 0.9931
Epoch 6/6
 - 23s - loss: 0.0886 - acc: 0.9901 - val_loss: 0.0748 - val_acc: 0.9950
Test accuracy:0.610
current auc_score ------------------> 0.851
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_8[0][0]               
==================================================================================================
Total params: 76,560
Trainable params: 75,536
Non-trainable params: 1,024
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        76560       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 51,984,145
Trainable params: 51,982,097
Non-trainable params: 2,048
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 27s - loss: 0.5023 - acc: 0.8008 - val_loss: 0.3222 - val_acc: 0.9070
Epoch 2/6
 - 24s - loss: 0.2468 - acc: 0.9328 - val_loss: 0.1569 - val_acc: 0.9750
Epoch 3/6
 - 23s - loss: 0.1614 - acc: 0.9690 - val_loss: 0.1107 - val_acc: 0.9886
Epoch 4/6
 - 24s - loss: 0.1164 - acc: 0.9841 - val_loss: 0.0853 - val_acc: 0.9897
Epoch 5/6
 - 23s - loss: 0.0916 - acc: 0.9903 - val_loss: 0.0761 - val_acc: 0.9957
Epoch 6/6
 - 24s - loss: 0.0797 - acc: 0.9929 - val_loss: 0.0651 - val_acc: 0.9972
Test accuracy:0.653
current auc_score ------------------> 0.877
accuracies:  [0.7356182795698925, 0.7459677419354839, 0.728494623655914, 0.6103494623655914, 0.6525537634408602]
aucs:  [0.8913246473580761, 0.8887580572898601, 0.884662750028905, 0.8511107497976645, 0.877001604231703]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 61056)        0           activation_8[0][0]               
==================================================================================================
Total params: 117,024
Trainable params: 115,784
Non-trainable params: 1,240
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 61056)        117024      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 122112)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          62521856    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 62,641,441
Trainable params: 62,639,177
Non-trainable params: 2,264
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 28s - loss: 0.5181 - acc: 0.7973 - val_loss: 0.3175 - val_acc: 0.9101
Epoch 2/6
 - 24s - loss: 0.2648 - acc: 0.9317 - val_loss: 0.1941 - val_acc: 0.9723
Epoch 3/6
 - 24s - loss: 0.1648 - acc: 0.9712 - val_loss: 0.1168 - val_acc: 0.9839
Epoch 4/6
 - 24s - loss: 0.1231 - acc: 0.9847 - val_loss: 0.1032 - val_acc: 0.9930
Epoch 5/6
 - 24s - loss: 0.1035 - acc: 0.9888 - val_loss: 0.0910 - val_acc: 0.9957
Epoch 6/6
 - 24s - loss: 0.0854 - acc: 0.9934 - val_loss: 0.0687 - val_acc: 0.9967
Test accuracy:0.716
current auc_score ------------------> 0.890
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 61056)        0           activation_8[0][0]               
==================================================================================================
Total params: 117,024
Trainable params: 115,784
Non-trainable params: 1,240
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 61056)        117024      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 122112)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          62521856    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 62,641,441
Trainable params: 62,639,177
Non-trainable params: 2,264
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 28s - loss: 0.5345 - acc: 0.7895 - val_loss: 0.3187 - val_acc: 0.9036
Epoch 2/6
 - 24s - loss: 0.2977 - acc: 0.9108 - val_loss: 0.2209 - val_acc: 0.9533
Epoch 3/6
 - 24s - loss: 0.2009 - acc: 0.9594 - val_loss: 0.1403 - val_acc: 0.9802
Epoch 4/6
 - 24s - loss: 0.1549 - acc: 0.9755 - val_loss: 0.1096 - val_acc: 0.9890
Epoch 5/6
 - 24s - loss: 0.1243 - acc: 0.9840 - val_loss: 0.1058 - val_acc: 0.9923
Epoch 6/6
 - 24s - loss: 0.1016 - acc: 0.9896 - val_loss: 0.0775 - val_acc: 0.9955
Test accuracy:0.594
current auc_score ------------------> 0.884
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 61056)        0           activation_8[0][0]               
==================================================================================================
Total params: 117,024
Trainable params: 115,784
Non-trainable params: 1,240
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 61056)        117024      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 122112)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          62521856    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 62,641,441
Trainable params: 62,639,177
Non-trainable params: 2,264
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 28s - loss: 0.5304 - acc: 0.7984 - val_loss: 0.3291 - val_acc: 0.9025
Epoch 2/6
 - 24s - loss: 0.2763 - acc: 0.9257 - val_loss: 0.1800 - val_acc: 0.9627
Epoch 3/6
 - 24s - loss: 0.1834 - acc: 0.9639 - val_loss: 0.1389 - val_acc: 0.9839
Epoch 4/6
 - 24s - loss: 0.1366 - acc: 0.9813 - val_loss: 0.1121 - val_acc: 0.9927
Epoch 5/6
 - 24s - loss: 0.1025 - acc: 0.9910 - val_loss: 0.0850 - val_acc: 0.9964
Epoch 6/6
 - 24s - loss: 0.0873 - acc: 0.9934 - val_loss: 0.0720 - val_acc: 0.9976
Test accuracy:0.729
current auc_score ------------------> 0.889
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 61056)        0           activation_8[0][0]               
==================================================================================================
Total params: 117,024
Trainable params: 115,784
Non-trainable params: 1,240
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 61056)        117024      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 122112)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          62521856    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 62,641,441
Trainable params: 62,639,177
Non-trainable params: 2,264
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 28s - loss: 0.5273 - acc: 0.7939 - val_loss: 0.3008 - val_acc: 0.9140
Epoch 2/6
 - 24s - loss: 0.2792 - acc: 0.9227 - val_loss: 0.1959 - val_acc: 0.9676
Epoch 3/6
 - 24s - loss: 0.1789 - acc: 0.9670 - val_loss: 0.1310 - val_acc: 0.9882
Epoch 4/6
 - 24s - loss: 0.1334 - acc: 0.9823 - val_loss: 0.1037 - val_acc: 0.9921
Epoch 5/6
 - 24s - loss: 0.1081 - acc: 0.9890 - val_loss: 0.0811 - val_acc: 0.9960
Epoch 6/6
 - 24s - loss: 0.0942 - acc: 0.9913 - val_loss: 0.0712 - val_acc: 0.9979
Test accuracy:0.529
current auc_score ------------------> 0.840
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 61056)        0           activation_8[0][0]               
==================================================================================================
Total params: 117,024
Trainable params: 115,784
Non-trainable params: 1,240
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 61056)        117024      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 122112)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          62521856    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 62,641,441
Trainable params: 62,639,177
Non-trainable params: 2,264
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 27s - loss: 0.5542 - acc: 0.7750 - val_loss: 0.3335 - val_acc: 0.9025
Epoch 2/6
 - 24s - loss: 0.2941 - acc: 0.9164 - val_loss: 2.3630 - val_acc: 0.7511
Epoch 3/6
 - 24s - loss: 0.1791 - acc: 0.9679 - val_loss: 0.1278 - val_acc: 0.9897
Epoch 4/6
 - 24s - loss: 0.1317 - acc: 0.9833 - val_loss: 0.0999 - val_acc: 0.9939
Epoch 5/6
 - 24s - loss: 0.1084 - acc: 0.9883 - val_loss: 0.0783 - val_acc: 0.9966
Epoch 6/6
 - 24s - loss: 0.0893 - acc: 0.9933 - val_loss: 0.0706 - val_acc: 0.9960
Test accuracy:0.796
current auc_score ------------------> 0.928
accuracies:  [0.7162634408602151, 0.5939516129032258, 0.7293010752688172, 0.5286290322580646, 0.7961021505376344]
aucs:  [0.8902662518788299, 0.8841894294138051, 0.889408457625159, 0.8397832119320152, 0.9276271100705284]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 71424)        0           activation_8[0][0]               
==================================================================================================
Total params: 166,128
Trainable params: 164,672
Non-trainable params: 1,456
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 71424)        166128      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 142848)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          73138688    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 73,307,377
Trainable params: 73,304,897
Non-trainable params: 2,480
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 30s - loss: 0.5363 - acc: 0.7982 - val_loss: 0.3440 - val_acc: 0.9091
Epoch 2/6
 - 26s - loss: 0.2715 - acc: 0.9334 - val_loss: 0.1897 - val_acc: 0.9676
Epoch 3/6
 - 25s - loss: 0.1686 - acc: 0.9758 - val_loss: 0.1265 - val_acc: 0.9897
Epoch 4/6
 - 25s - loss: 0.1285 - acc: 0.9876 - val_loss: 0.1041 - val_acc: 0.9951
Epoch 5/6
 - 25s - loss: 0.1052 - acc: 0.9917 - val_loss: 0.0944 - val_acc: 0.9946
Epoch 6/6
 - 25s - loss: 0.0905 - acc: 0.9940 - val_loss: 0.0796 - val_acc: 0.9957
Test accuracy:0.683
current auc_score ------------------> 0.866
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 71424)        0           activation_8[0][0]               
==================================================================================================
Total params: 166,128
Trainable params: 164,672
Non-trainable params: 1,456
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 71424)        166128      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 142848)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          73138688    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 73,307,377
Trainable params: 73,304,897
Non-trainable params: 2,480
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 30s - loss: 0.5511 - acc: 0.7865 - val_loss: 0.3481 - val_acc: 0.9032
Epoch 2/6
 - 26s - loss: 0.2965 - acc: 0.9250 - val_loss: 0.2126 - val_acc: 0.9502
Epoch 3/6
 - 26s - loss: 0.1919 - acc: 0.9676 - val_loss: 0.1535 - val_acc: 0.9880
Epoch 4/6
 - 26s - loss: 0.1380 - acc: 0.9847 - val_loss: 0.1015 - val_acc: 0.9933
Epoch 5/6
 - 26s - loss: 0.1143 - acc: 0.9899 - val_loss: 0.0927 - val_acc: 0.9965
Epoch 6/6
 - 26s - loss: 0.1008 - acc: 0.9914 - val_loss: 0.0895 - val_acc: 0.9972
Test accuracy:0.713
current auc_score ------------------> 0.886
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 71424)        0           activation_8[0][0]               
==================================================================================================
Total params: 166,128
Trainable params: 164,672
Non-trainable params: 1,456
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 71424)        166128      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 142848)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          73138688    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 73,307,377
Trainable params: 73,304,897
Non-trainable params: 2,480
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 30s - loss: 0.4971 - acc: 0.8202 - val_loss: 0.2899 - val_acc: 0.9223
Epoch 2/6
 - 27s - loss: 0.2564 - acc: 0.9370 - val_loss: 0.1790 - val_acc: 0.9701
Epoch 3/6
 - 27s - loss: 0.1667 - acc: 0.9753 - val_loss: 0.1598 - val_acc: 0.9790
Epoch 4/6
 - 27s - loss: 0.1275 - acc: 0.9858 - val_loss: 0.1025 - val_acc: 0.9937
Epoch 5/6
 - 27s - loss: 0.1033 - acc: 0.9921 - val_loss: 0.0824 - val_acc: 0.9957
Epoch 6/6
 - 27s - loss: 0.0973 - acc: 0.9911 - val_loss: 0.0732 - val_acc: 0.9981
Test accuracy:0.741
current auc_score ------------------> 0.907
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 71424)        0           activation_8[0][0]               
==================================================================================================
Total params: 166,128
Trainable params: 164,672
Non-trainable params: 1,456
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 71424)        166128      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 142848)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          73138688    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 73,307,377
Trainable params: 73,304,897
Non-trainable params: 2,480
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 30s - loss: 0.5680 - acc: 0.7794 - val_loss: 0.3925 - val_acc: 0.8581
Epoch 2/6
 - 26s - loss: 0.2915 - acc: 0.9250 - val_loss: 0.1907 - val_acc: 0.9703
Epoch 3/6
 - 26s - loss: 0.1933 - acc: 0.9663 - val_loss: 0.1341 - val_acc: 0.9908
Epoch 4/6
 - 26s - loss: 0.1437 - acc: 0.9827 - val_loss: 0.1135 - val_acc: 0.9930
Epoch 5/6
 - 26s - loss: 0.1158 - acc: 0.9887 - val_loss: 0.0933 - val_acc: 0.9964
Epoch 6/6
 - 26s - loss: 0.0997 - acc: 0.9926 - val_loss: 0.0789 - val_acc: 0.9977
Test accuracy:0.690
current auc_score ------------------> 0.858
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 71424)        0           activation_8[0][0]               
==================================================================================================
Total params: 166,128
Trainable params: 164,672
Non-trainable params: 1,456
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 71424)        166128      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 142848)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          73138688    merge_features[0][0]             
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_4[0][0]                  
==================================================================================================
Total params: 73,307,377
Trainable params: 73,304,897
Non-trainable params: 2,480
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 30s - loss: 0.5270 - acc: 0.7993 - val_loss: 0.3305 - val_acc: 0.9103
Epoch 2/6
 - 26s - loss: 0.2707 - acc: 0.9350 - val_loss: 0.2046 - val_acc: 0.9726
Epoch 3/6
 - 26s - loss: 0.1756 - acc: 0.9731 - val_loss: 0.1256 - val_acc: 0.9918
Epoch 4/6
 - 25s - loss: 0.1333 - acc: 0.9857 - val_loss: 0.1070 - val_acc: 0.9927
Epoch 5/6
 - 25s - loss: 0.1070 - acc: 0.9921 - val_loss: 0.0882 - val_acc: 0.9954
Epoch 6/6
 - 25s - loss: 0.0922 - acc: 0.9942 - val_loss: 0.0808 - val_acc: 0.9961
Test accuracy:0.698
current auc_score ------------------> 0.886
accuracies:  [0.6830645161290323, 0.7130376344086021, 0.7411290322580645, 0.6897849462365592, 0.6975806451612904]
aucs:  [0.8656768846109376, 0.8863729910972368, 0.9067189848537403, 0.8580596383975025, 0.8864209735229507]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_10[0][0]              
==================================================================================================
Total params: 106,576
Trainable params: 105,136
Non-trainable params: 1,440
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        106576      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 66,169,937
Trainable params: 66,167,473
Non-trainable params: 2,464
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 32s - loss: 0.5187 - acc: 0.8003 - val_loss: 0.3229 - val_acc: 0.9024
Epoch 2/6
 - 28s - loss: 0.2782 - acc: 0.9256 - val_loss: 0.1844 - val_acc: 0.9656
Epoch 3/6
 - 28s - loss: 0.1814 - acc: 0.9685 - val_loss: 0.1277 - val_acc: 0.9882
Epoch 4/6
 - 27s - loss: 0.1390 - acc: 0.9818 - val_loss: 0.1156 - val_acc: 0.9871
Epoch 5/6
 - 28s - loss: 0.1155 - acc: 0.9874 - val_loss: 0.0919 - val_acc: 0.9897
Epoch 6/6
 - 27s - loss: 0.0946 - acc: 0.9916 - val_loss: 0.0777 - val_acc: 0.9945
Test accuracy:0.717
current auc_score ------------------> 0.871
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_10[0][0]              
==================================================================================================
Total params: 106,576
Trainable params: 105,136
Non-trainable params: 1,440
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        106576      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 66,169,937
Trainable params: 66,167,473
Non-trainable params: 2,464
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 31s - loss: 0.4969 - acc: 0.8163 - val_loss: 0.3113 - val_acc: 0.9084
Epoch 2/6
 - 27s - loss: 0.2541 - acc: 0.9362 - val_loss: 0.1845 - val_acc: 0.9586
Epoch 3/6
 - 27s - loss: 0.1673 - acc: 0.9722 - val_loss: 0.1161 - val_acc: 0.9885
Epoch 4/6
 - 27s - loss: 0.1231 - acc: 0.9866 - val_loss: 0.0939 - val_acc: 0.9935
Epoch 5/6
 - 27s - loss: 0.1004 - acc: 0.9915 - val_loss: 0.0828 - val_acc: 0.9957
Epoch 6/6
 - 27s - loss: 0.0872 - acc: 0.9942 - val_loss: 0.0726 - val_acc: 0.9957
Test accuracy:0.704
current auc_score ------------------> 0.899
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_10[0][0]              
==================================================================================================
Total params: 106,576
Trainable params: 105,136
Non-trainable params: 1,440
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        106576      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 66,169,937
Trainable params: 66,167,473
Non-trainable params: 2,464
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 31s - loss: 0.5154 - acc: 0.8080 - val_loss: 0.2943 - val_acc: 0.9306
Epoch 2/6
 - 27s - loss: 0.2583 - acc: 0.9348 - val_loss: 0.1927 - val_acc: 0.9631
Epoch 3/6
 - 27s - loss: 0.1721 - acc: 0.9700 - val_loss: 0.1292 - val_acc: 0.9861
Epoch 4/6
 - 27s - loss: 0.1321 - acc: 0.9830 - val_loss: 0.1063 - val_acc: 0.9932
Epoch 5/6
 - 27s - loss: 0.1068 - acc: 0.9908 - val_loss: 0.0804 - val_acc: 0.9967
Epoch 6/6
 - 27s - loss: 0.0886 - acc: 0.9940 - val_loss: 0.0749 - val_acc: 0.9976
Test accuracy:0.679
current auc_score ------------------> 0.900
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_10[0][0]              
==================================================================================================
Total params: 106,576
Trainable params: 105,136
Non-trainable params: 1,440
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        106576      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 66,169,937
Trainable params: 66,167,473
Non-trainable params: 2,464
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 31s - loss: 0.5206 - acc: 0.8025 - val_loss: 0.3431 - val_acc: 0.8927
Epoch 2/6
 - 26s - loss: 0.2857 - acc: 0.9217 - val_loss: 0.2116 - val_acc: 0.9622
Epoch 3/6
 - 26s - loss: 0.1924 - acc: 0.9621 - val_loss: 0.1392 - val_acc: 0.9896
Epoch 4/6
 - 27s - loss: 0.1423 - acc: 0.9792 - val_loss: 0.1145 - val_acc: 0.9913
Epoch 5/6
 - 27s - loss: 0.1230 - acc: 0.9850 - val_loss: 0.0929 - val_acc: 0.9937
Epoch 6/6
 - 27s - loss: 0.1002 - acc: 0.9898 - val_loss: 0.0759 - val_acc: 0.9957
Test accuracy:0.664
current auc_score ------------------> 0.907
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_10[0][0]              
==================================================================================================
Total params: 106,576
Trainable params: 105,136
Non-trainable params: 1,440
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        106576      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 66,169,937
Trainable params: 66,167,473
Non-trainable params: 2,464
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 31s - loss: 0.5461 - acc: 0.7866 - val_loss: 0.3406 - val_acc: 0.9005
Epoch 2/6
 - 26s - loss: 0.2881 - acc: 0.9232 - val_loss: 0.2201 - val_acc: 0.9445
Epoch 3/6
 - 26s - loss: 0.1912 - acc: 0.9638 - val_loss: 0.1426 - val_acc: 0.9867
Epoch 4/6
 - 26s - loss: 0.1509 - acc: 0.9782 - val_loss: 0.1233 - val_acc: 0.9823
Epoch 5/6
 - 27s - loss: 0.1278 - acc: 0.9840 - val_loss: 0.1002 - val_acc: 0.9932
Epoch 6/6
 - 26s - loss: 0.1012 - acc: 0.9910 - val_loss: 0.0789 - val_acc: 0.9974
Test accuracy:0.663
current auc_score ------------------> 0.885
accuracies:  [0.7173387096774193, 0.7044354838709678, 0.6786290322580645, 0.6638440860215054, 0.6634408602150538]
aucs:  [0.8712778211353914, 0.8992061943577292, 0.8995879942767949, 0.9073141403630477, 0.884550670597757]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_10[0][0]              
==================================================================================================
Total params: 163,168
Trainable params: 161,416
Non-trainable params: 1,752
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        163168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 80,382,305
Trainable params: 80,379,529
Non-trainable params: 2,776
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 33s - loss: 0.5699 - acc: 0.7758 - val_loss: 0.3741 - val_acc: 0.8953
Epoch 2/6
 - 29s - loss: 0.3156 - acc: 0.9169 - val_loss: 0.2152 - val_acc: 0.9534
Epoch 3/6
 - 29s - loss: 0.2128 - acc: 0.9625 - val_loss: 0.1553 - val_acc: 0.9808
Epoch 4/6
 - 29s - loss: 0.1597 - acc: 0.9789 - val_loss: 0.1231 - val_acc: 0.9923
Epoch 5/6
 - 29s - loss: 0.1272 - acc: 0.9889 - val_loss: 0.1008 - val_acc: 0.9923
Epoch 6/6
 - 29s - loss: 0.1118 - acc: 0.9898 - val_loss: 0.0889 - val_acc: 0.9961
Test accuracy:0.713
current auc_score ------------------> 0.874
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_10[0][0]              
==================================================================================================
Total params: 163,168
Trainable params: 161,416
Non-trainable params: 1,752
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        163168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 80,382,305
Trainable params: 80,379,529
Non-trainable params: 2,776
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 34s - loss: 0.5760 - acc: 0.7803 - val_loss: 0.3451 - val_acc: 0.8976
Epoch 2/6
 - 30s - loss: 0.3040 - acc: 0.9207 - val_loss: 0.2050 - val_acc: 0.9723
Epoch 3/6
 - 30s - loss: 0.2042 - acc: 0.9657 - val_loss: 0.1430 - val_acc: 0.9863
Epoch 4/6
 - 29s - loss: 0.1582 - acc: 0.9805 - val_loss: 0.1322 - val_acc: 0.9857
Epoch 5/6
 - 30s - loss: 0.1328 - acc: 0.9868 - val_loss: 0.0972 - val_acc: 0.9954
Epoch 6/6
 - 29s - loss: 0.1083 - acc: 0.9917 - val_loss: 0.0871 - val_acc: 0.9961
Test accuracy:0.744
current auc_score ------------------> 0.911
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_10[0][0]              
==================================================================================================
Total params: 163,168
Trainable params: 161,416
Non-trainable params: 1,752
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        163168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 80,382,305
Trainable params: 80,379,529
Non-trainable params: 2,776
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 35s - loss: 0.5732 - acc: 0.7850 - val_loss: 0.4717 - val_acc: 0.8150
Epoch 2/6
 - 29s - loss: 0.3111 - acc: 0.9178 - val_loss: 0.2404 - val_acc: 0.9637
Epoch 3/6
 - 30s - loss: 0.2070 - acc: 0.9643 - val_loss: 0.1506 - val_acc: 0.9864
Epoch 4/6
 - 29s - loss: 0.1555 - acc: 0.9811 - val_loss: 0.1131 - val_acc: 0.9950
Epoch 5/6
 - 29s - loss: 0.1279 - acc: 0.9880 - val_loss: 0.0988 - val_acc: 0.9947
Epoch 6/6
 - 30s - loss: 0.1153 - acc: 0.9894 - val_loss: 0.1014 - val_acc: 0.9923
Test accuracy:0.662
current auc_score ------------------> 0.897
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_10[0][0]              
==================================================================================================
Total params: 163,168
Trainable params: 161,416
Non-trainable params: 1,752
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        163168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 80,382,305
Trainable params: 80,379,529
Non-trainable params: 2,776
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 33s - loss: 0.5469 - acc: 0.7930 - val_loss: 0.3425 - val_acc: 0.9025
Epoch 2/6
 - 28s - loss: 0.2904 - acc: 0.9292 - val_loss: 0.2066 - val_acc: 0.9699
Epoch 3/6
 - 28s - loss: 0.2029 - acc: 0.9655 - val_loss: 0.1411 - val_acc: 0.9867
Epoch 4/6
 - 28s - loss: 0.1508 - acc: 0.9822 - val_loss: 0.1122 - val_acc: 0.9918
Epoch 5/6
 - 28s - loss: 0.1273 - acc: 0.9871 - val_loss: 0.0946 - val_acc: 0.9940
Epoch 6/6
 - 28s - loss: 0.1061 - acc: 0.9917 - val_loss: 0.0812 - val_acc: 0.9969
Test accuracy:0.720
current auc_score ------------------> 0.894
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_10[0][0]              
==================================================================================================
Total params: 163,168
Trainable params: 161,416
Non-trainable params: 1,752
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        163168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 80,382,305
Trainable params: 80,379,529
Non-trainable params: 2,776
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 32s - loss: 0.5783 - acc: 0.7812 - val_loss: 0.3879 - val_acc: 0.8843
Epoch 2/6
 - 28s - loss: 0.3163 - acc: 0.9172 - val_loss: 0.2030 - val_acc: 0.9708
Epoch 3/6
 - 27s - loss: 0.2022 - acc: 0.9663 - val_loss: 0.1474 - val_acc: 0.9892
Epoch 4/6
 - 28s - loss: 0.1638 - acc: 0.9769 - val_loss: 0.1198 - val_acc: 0.9921
Epoch 5/6
 - 27s - loss: 0.1381 - acc: 0.9843 - val_loss: 0.1045 - val_acc: 0.9965
Epoch 6/6
 - 28s - loss: 0.1115 - acc: 0.9909 - val_loss: 0.0904 - val_acc: 0.9957
Test accuracy:0.719
current auc_score ------------------> 0.849
accuracies:  [0.7133064516129032, 0.7439516129032258, 0.6616935483870968, 0.7196236559139785, 0.7192204301075269]
aucs:  [0.8739330413920684, 0.9107382356341774, 0.8970749508613713, 0.8943717481789801, 0.8487764842756388]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_10[0][0]              
==================================================================================================
Total params: 231,856
Trainable params: 229,792
Non-trainable params: 2,064
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        231856      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 94,606,769
Trainable params: 94,603,681
Non-trainable params: 3,088
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 36s - loss: 0.5578 - acc: 0.8002 - val_loss: 0.3462 - val_acc: 0.9121
Epoch 2/6
 - 31s - loss: 0.2911 - acc: 0.9367 - val_loss: 0.2097 - val_acc: 0.9686
Epoch 3/6
 - 31s - loss: 0.2004 - acc: 0.9725 - val_loss: 0.1540 - val_acc: 0.9882
Epoch 4/6
 - 31s - loss: 0.1586 - acc: 0.9836 - val_loss: 0.1128 - val_acc: 0.9945
Epoch 5/6
 - 31s - loss: 0.1258 - acc: 0.9914 - val_loss: 0.0983 - val_acc: 0.9981
Epoch 6/6
 - 31s - loss: 0.1077 - acc: 0.9934 - val_loss: 0.0872 - val_acc: 0.9980
Test accuracy:0.690
current auc_score ------------------> 0.880
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_10[0][0]              
==================================================================================================
Total params: 231,856
Trainable params: 229,792
Non-trainable params: 2,064
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        231856      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 94,606,769
Trainable params: 94,603,681
Non-trainable params: 3,088
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 36s - loss: 0.5592 - acc: 0.7982 - val_loss: 0.4769 - val_acc: 0.8438
Epoch 2/6
 - 31s - loss: 0.3113 - acc: 0.9271 - val_loss: 0.2192 - val_acc: 0.9709
Epoch 3/6
 - 31s - loss: 0.2140 - acc: 0.9677 - val_loss: 0.1510 - val_acc: 0.9883
Epoch 4/6
 - 31s - loss: 0.1617 - acc: 0.9826 - val_loss: 0.1202 - val_acc: 0.9926
Epoch 5/6
 - 31s - loss: 0.1329 - acc: 0.9901 - val_loss: 0.1123 - val_acc: 0.9960
Epoch 6/6
 - 31s - loss: 0.1153 - acc: 0.9920 - val_loss: 0.0899 - val_acc: 0.9972
Test accuracy:0.741
current auc_score ------------------> 0.914
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_10[0][0]              
==================================================================================================
Total params: 231,856
Trainable params: 229,792
Non-trainable params: 2,064
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        231856      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 94,606,769
Trainable params: 94,603,681
Non-trainable params: 3,088
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 35s - loss: 0.6126 - acc: 0.7679 - val_loss: 0.3775 - val_acc: 0.8973
Epoch 2/6
 - 30s - loss: 0.3379 - acc: 0.9123 - val_loss: 0.2433 - val_acc: 0.9629
Epoch 3/6
 - 30s - loss: 0.2231 - acc: 0.9647 - val_loss: 0.1692 - val_acc: 0.9838
Epoch 4/6
 - 30s - loss: 0.1686 - acc: 0.9802 - val_loss: 0.1316 - val_acc: 0.9956
Epoch 5/6
 - 30s - loss: 0.1350 - acc: 0.9889 - val_loss: 0.1086 - val_acc: 0.9951
Epoch 6/6
 - 31s - loss: 0.1137 - acc: 0.9926 - val_loss: 0.0901 - val_acc: 0.9969
Test accuracy:0.716
current auc_score ------------------> 0.902
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_10[0][0]              
==================================================================================================
Total params: 231,856
Trainable params: 229,792
Non-trainable params: 2,064
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        231856      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 94,606,769
Trainable params: 94,603,681
Non-trainable params: 3,088
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 35s - loss: 0.5692 - acc: 0.7953 - val_loss: 7.8669 - val_acc: 0.4994
Epoch 2/6
 - 30s - loss: 0.3141 - acc: 0.9273 - val_loss: 8.0997 - val_acc: 0.4966
Epoch 3/6
 - 30s - loss: 0.2219 - acc: 0.9642 - val_loss: 0.1818 - val_acc: 0.9818
Epoch 4/6
 - 31s - loss: 0.1676 - acc: 0.9820 - val_loss: 0.1343 - val_acc: 0.9861
Epoch 5/6
 - 30s - loss: 0.1376 - acc: 0.9876 - val_loss: 0.1191 - val_acc: 0.9928
Epoch 6/6
 - 31s - loss: 0.1150 - acc: 0.9917 - val_loss: 0.0950 - val_acc: 0.9969
Test accuracy:0.741
current auc_score ------------------> 0.890
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_10[0][0]              
==================================================================================================
Total params: 231,856
Trainable params: 229,792
Non-trainable params: 2,064
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        231856      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_5[0][0]                  
==================================================================================================
Total params: 94,606,769
Trainable params: 94,603,681
Non-trainable params: 3,088
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 36s - loss: 0.6206 - acc: 0.7711 - val_loss: 0.3983 - val_acc: 0.8899
Epoch 2/6
 - 32s - loss: 0.3524 - acc: 0.9065 - val_loss: 0.2538 - val_acc: 0.9632
Epoch 3/6
 - 31s - loss: 0.2289 - acc: 0.9623 - val_loss: 0.1724 - val_acc: 0.9851
Epoch 4/6
 - 31s - loss: 0.1806 - acc: 0.9781 - val_loss: 0.1585 - val_acc: 0.9827
Epoch 5/6
 - 31s - loss: 0.1503 - acc: 0.9851 - val_loss: 0.1257 - val_acc: 0.9955
Epoch 6/6
 - 31s - loss: 0.1242 - acc: 0.9911 - val_loss: 0.1012 - val_acc: 0.9971
Test accuracy:0.767
current auc_score ------------------> 0.881
accuracies:  [0.6896505376344086, 0.741263440860215, 0.7155913978494624, 0.7413978494623656, 0.7665322580645161]
aucs:  [0.8798558359347901, 0.9140515522025666, 0.9023914614406291, 0.8896218854780902, 0.8808949734073304]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_14[0][0]              
==================================================================================================
Total params: 173,808
Trainable params: 171,392
Non-trainable params: 2,416
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        173808      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 94,548,721
Trainable params: 94,545,281
Non-trainable params: 3,440
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 42s - loss: 0.5974 - acc: 0.7777 - val_loss: 0.8922 - val_acc: 0.6476
Epoch 2/6
 - 36s - loss: 0.3384 - acc: 0.9140 - val_loss: 1.5568 - val_acc: 0.5176
Epoch 3/6
 - 36s - loss: 0.2352 - acc: 0.9599 - val_loss: 1.9367 - val_acc: 0.5233

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/6
 - 35s - loss: 0.1712 - acc: 0.9836 - val_loss: 2.0068 - val_acc: 0.5241
Epoch 5/6
 - 35s - loss: 0.1527 - acc: 0.9884 - val_loss: 2.0235 - val_acc: 0.5370

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.506
current auc_score ------------------> 0.699
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_14[0][0]              
==================================================================================================
Total params: 173,808
Trainable params: 171,392
Non-trainable params: 2,416
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        173808      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 94,548,721
Trainable params: 94,545,281
Non-trainable params: 3,440
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 43s - loss: 0.5842 - acc: 0.7872 - val_loss: 0.3796 - val_acc: 0.9064
Epoch 2/6
 - 37s - loss: 0.3372 - acc: 0.9184 - val_loss: 0.2330 - val_acc: 0.9664
Epoch 3/6
 - 37s - loss: 0.2273 - acc: 0.9638 - val_loss: 0.1566 - val_acc: 0.9922
Epoch 4/6
 - 37s - loss: 0.1715 - acc: 0.9822 - val_loss: 0.1466 - val_acc: 0.9905
Epoch 5/6
 - 37s - loss: 0.1462 - acc: 0.9871 - val_loss: 0.1102 - val_acc: 0.9965
Epoch 6/6
 - 37s - loss: 0.1224 - acc: 0.9915 - val_loss: 0.0951 - val_acc: 0.9979
Test accuracy:0.746
current auc_score ------------------> 0.881
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_14[0][0]              
==================================================================================================
Total params: 173,808
Trainable params: 171,392
Non-trainable params: 2,416
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        173808      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 94,548,721
Trainable params: 94,545,281
Non-trainable params: 3,440
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 44s - loss: 0.5746 - acc: 0.7917 - val_loss: 0.3707 - val_acc: 0.9005
Epoch 2/6
 - 37s - loss: 0.3255 - acc: 0.9199 - val_loss: 0.2472 - val_acc: 0.9626
Epoch 3/6
 - 37s - loss: 0.2218 - acc: 0.9637 - val_loss: 0.1813 - val_acc: 0.9802
Epoch 4/6
 - 37s - loss: 0.1748 - acc: 0.9791 - val_loss: 0.1312 - val_acc: 0.9922
Epoch 5/6
 - 38s - loss: 0.1439 - acc: 0.9863 - val_loss: 0.1216 - val_acc: 0.9900
Epoch 6/6
 - 37s - loss: 0.1192 - acc: 0.9920 - val_loss: 0.0984 - val_acc: 0.9979
Test accuracy:0.561
current auc_score ------------------> 0.851
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_14[0][0]              
==================================================================================================
Total params: 173,808
Trainable params: 171,392
Non-trainable params: 2,416
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        173808      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 94,548,721
Trainable params: 94,545,281
Non-trainable params: 3,440
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 43s - loss: 0.5797 - acc: 0.7895 - val_loss: 0.4281 - val_acc: 0.8608
Epoch 2/6
 - 36s - loss: 0.3256 - acc: 0.9212 - val_loss: 0.2329 - val_acc: 0.9641
Epoch 3/6
 - 36s - loss: 0.2195 - acc: 0.9667 - val_loss: 0.1863 - val_acc: 0.9778
Epoch 4/6
 - 36s - loss: 0.1725 - acc: 0.9807 - val_loss: 0.1433 - val_acc: 0.9901
Epoch 5/6
 - 37s - loss: 0.1452 - acc: 0.9864 - val_loss: 0.1235 - val_acc: 0.9947
Epoch 6/6
 - 37s - loss: 0.1223 - acc: 0.9912 - val_loss: 0.1068 - val_acc: 0.9950
Test accuracy:0.706
current auc_score ------------------> 0.878
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_14[0][0]              
==================================================================================================
Total params: 173,808
Trainable params: 171,392
Non-trainable params: 2,416
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        173808      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 94,548,721
Trainable params: 94,545,281
Non-trainable params: 3,440
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 44s - loss: 0.5905 - acc: 0.7813 - val_loss: 0.3720 - val_acc: 0.9010
Epoch 2/6
 - 38s - loss: 0.3238 - acc: 0.9197 - val_loss: 0.2379 - val_acc: 0.9656
Epoch 3/6
 - 38s - loss: 0.2195 - acc: 0.9645 - val_loss: 0.1715 - val_acc: 0.9821
Epoch 4/6
 - 38s - loss: 0.1669 - acc: 0.9826 - val_loss: 0.1343 - val_acc: 0.9928
Epoch 5/6
 - 37s - loss: 0.1404 - acc: 0.9879 - val_loss: 0.1150 - val_acc: 0.9942
Epoch 6/6
 - 38s - loss: 0.1220 - acc: 0.9906 - val_loss: 0.0971 - val_acc: 0.9969
Test accuracy:0.690
current auc_score ------------------> 0.924
accuracies:  [0.5060483870967742, 0.7458333333333333, 0.5611559139784946, 0.7061827956989247, 0.6903225806451613]
aucs:  [0.6990972222222221, 0.8805209417273674, 0.8512960313331022, 0.8783533139669326, 0.9243375679269279]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_14[0][0]              
==================================================================================================
Total params: 266,616
Trainable params: 263,660
Non-trainable params: 2,956
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       266616      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 115,875,193
Trainable params: 115,871,213
Non-trainable params: 3,980
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 48s - loss: 0.6545 - acc: 0.7588 - val_loss: 0.4674 - val_acc: 0.8650
Epoch 2/6
 - 42s - loss: 0.3854 - acc: 0.9039 - val_loss: 0.2782 - val_acc: 0.9497
Epoch 3/6
 - 41s - loss: 0.2559 - acc: 0.9621 - val_loss: 0.1956 - val_acc: 0.9857
Epoch 4/6
 - 41s - loss: 0.1991 - acc: 0.9782 - val_loss: 0.1752 - val_acc: 0.9847
Epoch 5/6
 - 41s - loss: 0.1597 - acc: 0.9887 - val_loss: 0.1287 - val_acc: 0.9955
Epoch 6/6
 - 41s - loss: 0.1358 - acc: 0.9920 - val_loss: 0.1109 - val_acc: 0.9975
Test accuracy:0.751
current auc_score ------------------> 0.861
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_14[0][0]              
==================================================================================================
Total params: 266,616
Trainable params: 263,660
Non-trainable params: 2,956
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       266616      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 115,875,193
Trainable params: 115,871,213
Non-trainable params: 3,980
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 47s - loss: 0.6605 - acc: 0.7610 - val_loss: 0.4563 - val_acc: 0.8804
Epoch 2/6
 - 40s - loss: 0.3827 - acc: 0.9053 - val_loss: 0.2991 - val_acc: 0.9561
Epoch 3/6
 - 39s - loss: 0.2739 - acc: 0.9557 - val_loss: 0.2129 - val_acc: 0.9797
Epoch 4/6
 - 39s - loss: 0.2089 - acc: 0.9763 - val_loss: 0.1608 - val_acc: 0.9933
Epoch 5/6
 - 39s - loss: 0.1697 - acc: 0.9861 - val_loss: 0.1524 - val_acc: 0.9859
Epoch 6/6
 - 40s - loss: 0.1513 - acc: 0.9883 - val_loss: 0.1169 - val_acc: 0.9961
Test accuracy:0.665
current auc_score ------------------> 0.878
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_14[0][0]              
==================================================================================================
Total params: 266,616
Trainable params: 263,660
Non-trainable params: 2,956
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       266616      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 115,875,193
Trainable params: 115,871,213
Non-trainable params: 3,980
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 47s - loss: 0.6126 - acc: 0.7837 - val_loss: 3.5597 - val_acc: 0.5044
Epoch 2/6
 - 40s - loss: 0.3502 - acc: 0.9218 - val_loss: 2.6760 - val_acc: 0.5035
Epoch 3/6
 - 40s - loss: 0.2495 - acc: 0.9650 - val_loss: 1.1997 - val_acc: 0.6094
Epoch 4/6
 - 39s - loss: 0.1968 - acc: 0.9796 - val_loss: 1.8622 - val_acc: 0.5584
Epoch 5/6
 - 40s - loss: 0.1612 - acc: 0.9866 - val_loss: 1.1495 - val_acc: 0.6711
Epoch 6/6
 - 39s - loss: 0.1405 - acc: 0.9904 - val_loss: 0.1075 - val_acc: 0.9972
Test accuracy:0.624
current auc_score ------------------> 0.889
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_14[0][0]              
==================================================================================================
Total params: 266,616
Trainable params: 263,660
Non-trainable params: 2,956
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       266616      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 115,875,193
Trainable params: 115,871,213
Non-trainable params: 3,980
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 46s - loss: 0.7282 - acc: 0.7157 - val_loss: 3.2854 - val_acc: 0.5043
Epoch 2/6
 - 40s - loss: 0.4707 - acc: 0.8555 - val_loss: 0.8531 - val_acc: 0.6220
Epoch 3/6
 - 39s - loss: 0.3142 - acc: 0.9380 - val_loss: 1.1907 - val_acc: 0.5980
Epoch 4/6
 - 40s - loss: 0.2311 - acc: 0.9677 - val_loss: 0.1936 - val_acc: 0.9861
Epoch 5/6
 - 39s - loss: 0.1851 - acc: 0.9821 - val_loss: 0.1639 - val_acc: 0.9911
Epoch 6/6
 - 40s - loss: 0.1536 - acc: 0.9886 - val_loss: 0.1463 - val_acc: 0.9942
Test accuracy:0.707
current auc_score ------------------> 0.838
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_14[0][0]              
==================================================================================================
Total params: 266,616
Trainable params: 263,660
Non-trainable params: 2,956
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       266616      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 115,875,193
Trainable params: 115,871,213
Non-trainable params: 3,980
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 48s - loss: 0.5998 - acc: 0.7920 - val_loss: 0.3965 - val_acc: 0.9106
Epoch 2/6
 - 41s - loss: 0.3448 - acc: 0.9235 - val_loss: 0.2603 - val_acc: 0.9565
Epoch 3/6
 - 41s - loss: 0.2381 - acc: 0.9678 - val_loss: 0.1800 - val_acc: 0.9883
Epoch 4/6
 - 41s - loss: 0.1857 - acc: 0.9821 - val_loss: 0.1488 - val_acc: 0.9911
Epoch 5/6
 - 41s - loss: 0.1532 - acc: 0.9891 - val_loss: 0.1195 - val_acc: 0.9967
Epoch 6/6
 - 41s - loss: 0.1259 - acc: 0.9938 - val_loss: 0.1068 - val_acc: 0.9959
Test accuracy:0.683
current auc_score ------------------> 0.911
accuracies:  [0.7506720430107527, 0.6647849462365591, 0.6241935483870967, 0.7067204301075268, 0.6831989247311828]
aucs:  [0.8613353422360966, 0.8780703694068678, 0.8894682188692333, 0.8379944935830731, 0.9114849260030061]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_14[0][0]              
==================================================================================================
Total params: 379,296
Trainable params: 375,800
Non-trainable params: 3,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       379296      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 137,221,537
Trainable params: 137,217,017
Non-trainable params: 4,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 52s - loss: 0.6895 - acc: 0.7553 - val_loss: 0.4794 - val_acc: 0.8681
Epoch 2/6
 - 44s - loss: 0.4215 - acc: 0.8969 - val_loss: 0.3140 - val_acc: 0.9463
Epoch 3/6
 - 44s - loss: 0.2870 - acc: 0.9594 - val_loss: 0.2310 - val_acc: 0.9821
Epoch 4/6
 - 44s - loss: 0.2199 - acc: 0.9780 - val_loss: 0.1747 - val_acc: 0.9907
Epoch 5/6
 - 44s - loss: 0.1839 - acc: 0.9852 - val_loss: 0.1436 - val_acc: 0.9940
Epoch 6/6
 - 44s - loss: 0.1510 - acc: 0.9907 - val_loss: 0.1252 - val_acc: 0.9949
Test accuracy:0.595
current auc_score ------------------> 0.848
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_14[0][0]              
==================================================================================================
Total params: 379,296
Trainable params: 375,800
Non-trainable params: 3,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       379296      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 137,221,537
Trainable params: 137,217,017
Non-trainable params: 4,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 53s - loss: 0.5951 - acc: 0.8094 - val_loss: 0.3932 - val_acc: 0.9029
Epoch 2/6
 - 45s - loss: 0.3416 - acc: 0.9381 - val_loss: 0.2413 - val_acc: 0.9739
Epoch 3/6
 - 45s - loss: 0.2447 - acc: 0.9715 - val_loss: 0.1957 - val_acc: 0.9863
Epoch 4/6
 - 45s - loss: 0.2037 - acc: 0.9817 - val_loss: 0.1622 - val_acc: 0.9939
Epoch 5/6
 - 45s - loss: 0.1663 - acc: 0.9895 - val_loss: 0.1389 - val_acc: 0.9967
Epoch 6/6
 - 45s - loss: 0.1413 - acc: 0.9924 - val_loss: 0.1154 - val_acc: 0.9982
Test accuracy:0.729
current auc_score ------------------> 0.865
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_14[0][0]              
==================================================================================================
Total params: 379,296
Trainable params: 375,800
Non-trainable params: 3,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       379296      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 137,221,537
Trainable params: 137,217,017
Non-trainable params: 4,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 52s - loss: 0.6114 - acc: 0.8027 - val_loss: 3.9348 - val_acc: 0.5035
Epoch 2/6
 - 44s - loss: 0.3537 - acc: 0.9308 - val_loss: 3.0510 - val_acc: 0.5237
Epoch 3/6
 - 44s - loss: 0.2503 - acc: 0.9708 - val_loss: 1.4469 - val_acc: 0.6163
Epoch 4/6
 - 44s - loss: 0.1978 - acc: 0.9839 - val_loss: 1.9785 - val_acc: 0.5735
Epoch 5/6
 - 44s - loss: 0.1742 - acc: 0.9858 - val_loss: 0.1641 - val_acc: 0.9816
Epoch 6/6
 - 44s - loss: 0.1502 - acc: 0.9899 - val_loss: 0.1294 - val_acc: 0.9941
Test accuracy:0.613
current auc_score ------------------> 0.883
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_14[0][0]              
==================================================================================================
Total params: 379,296
Trainable params: 375,800
Non-trainable params: 3,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       379296      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 137,221,537
Trainable params: 137,217,017
Non-trainable params: 4,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 52s - loss: 0.6648 - acc: 0.7690 - val_loss: 0.8256 - val_acc: 0.6536
Epoch 2/6
 - 44s - loss: 0.3950 - acc: 0.9131 - val_loss: 2.3709 - val_acc: 0.5212
Epoch 3/6
 - 44s - loss: 0.2755 - acc: 0.9629 - val_loss: 0.9773 - val_acc: 0.7122

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/6
 - 45s - loss: 0.2113 - acc: 0.9834 - val_loss: 1.0961 - val_acc: 0.7014
Epoch 5/6
 - 44s - loss: 0.1866 - acc: 0.9905 - val_loss: 0.8789 - val_acc: 0.7327

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 6/6
 - 45s - loss: 0.1701 - acc: 0.9944 - val_loss: 0.8947 - val_acc: 0.7230
Test accuracy:0.738
current auc_score ------------------> 0.829
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_14[0][0]              
==================================================================================================
Total params: 379,296
Trainable params: 375,800
Non-trainable params: 3,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       379296      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_7[0][0]                  
==================================================================================================
Total params: 137,221,537
Trainable params: 137,217,017
Non-trainable params: 4,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 53s - loss: 0.6270 - acc: 0.7908 - val_loss: 0.4522 - val_acc: 0.8867
Epoch 2/6
 - 45s - loss: 0.3710 - acc: 0.9265 - val_loss: 0.3043 - val_acc: 0.9479
Epoch 3/6
 - 45s - loss: 0.2633 - acc: 0.9682 - val_loss: 0.1992 - val_acc: 0.9862
Epoch 4/6
 - 45s - loss: 0.1999 - acc: 0.9852 - val_loss: 0.1626 - val_acc: 0.9933
Epoch 5/6
 - 45s - loss: 0.1668 - acc: 0.9902 - val_loss: 0.1355 - val_acc: 0.9967
Epoch 6/6
 - 45s - loss: 0.1413 - acc: 0.9930 - val_loss: 0.1178 - val_acc: 0.9969
Test accuracy:0.690
current auc_score ------------------> 0.863
accuracies:  [0.5952956989247312, 0.728763440860215, 0.6131720430107527, 0.7375, 0.6900537634408602]
aucs:  [0.8482922881257949, 0.8652807766793849, 0.8826427910741126, 0.828740425193664, 0.8627627471383974]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_18[0][0]              
==================================================================================================
Total params: 20,528
Trainable params: 19,392
Non-trainable params: 1,136
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        20528       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 37,772,337
Trainable params: 37,770,177
Non-trainable params: 2,160
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 38s - loss: 0.4922 - acc: 0.7942 - val_loss: 0.2892 - val_acc: 0.9040
Epoch 2/6
 - 32s - loss: 0.2516 - acc: 0.9217 - val_loss: 0.2007 - val_acc: 0.9406
Epoch 3/6
 - 32s - loss: 0.1718 - acc: 0.9581 - val_loss: 0.1150 - val_acc: 0.9799
Epoch 4/6
 - 32s - loss: 0.1224 - acc: 0.9762 - val_loss: 0.0948 - val_acc: 0.9872
Epoch 5/6
 - 32s - loss: 0.0984 - acc: 0.9837 - val_loss: 0.0745 - val_acc: 0.9907
Epoch 6/6
 - 32s - loss: 0.0802 - acc: 0.9888 - val_loss: 0.0554 - val_acc: 0.9956
Test accuracy:0.714
current auc_score ------------------> 0.915
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_18[0][0]              
==================================================================================================
Total params: 20,528
Trainable params: 19,392
Non-trainable params: 1,136
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        20528       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 37,772,337
Trainable params: 37,770,177
Non-trainable params: 2,160
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 37s - loss: 0.4772 - acc: 0.8045 - val_loss: 0.2798 - val_acc: 0.8960
Epoch 2/6
 - 32s - loss: 0.2304 - acc: 0.9324 - val_loss: 0.1585 - val_acc: 0.9602
Epoch 3/6
 - 31s - loss: 0.1505 - acc: 0.9652 - val_loss: 0.1045 - val_acc: 0.9863
Epoch 4/6
 - 31s - loss: 0.1056 - acc: 0.9824 - val_loss: 0.0742 - val_acc: 0.9897
Epoch 5/6
 - 31s - loss: 0.0842 - acc: 0.9884 - val_loss: 0.0660 - val_acc: 0.9920
Epoch 6/6
 - 31s - loss: 0.0767 - acc: 0.9896 - val_loss: 0.0581 - val_acc: 0.9944
Test accuracy:0.690
current auc_score ------------------> 0.875
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_18[0][0]              
==================================================================================================
Total params: 20,528
Trainable params: 19,392
Non-trainable params: 1,136
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        20528       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 37,772,337
Trainable params: 37,770,177
Non-trainable params: 2,160
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 38s - loss: 0.5062 - acc: 0.7937 - val_loss: 0.2774 - val_acc: 0.9075
Epoch 2/6
 - 32s - loss: 0.2516 - acc: 0.9198 - val_loss: 0.1613 - val_acc: 0.9691
Epoch 3/6
 - 32s - loss: 0.1629 - acc: 0.9607 - val_loss: 0.1091 - val_acc: 0.9854
Epoch 4/6
 - 32s - loss: 0.1191 - acc: 0.9775 - val_loss: 0.0810 - val_acc: 0.9926
Epoch 5/6
 - 32s - loss: 0.0940 - acc: 0.9846 - val_loss: 0.0908 - val_acc: 0.9862
Epoch 6/6
 - 32s - loss: 0.0834 - acc: 0.9883 - val_loss: 0.0665 - val_acc: 0.9961
Test accuracy:0.686
current auc_score ------------------> 0.896
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_18[0][0]              
==================================================================================================
Total params: 20,528
Trainable params: 19,392
Non-trainable params: 1,136
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        20528       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 37,772,337
Trainable params: 37,770,177
Non-trainable params: 2,160
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 38s - loss: 0.4981 - acc: 0.7951 - val_loss: 0.3077 - val_acc: 0.8938
Epoch 2/6
 - 32s - loss: 0.2670 - acc: 0.9130 - val_loss: 0.1834 - val_acc: 0.9539
Epoch 3/6
 - 32s - loss: 0.1741 - acc: 0.9550 - val_loss: 0.1126 - val_acc: 0.9824
Epoch 4/6
 - 31s - loss: 0.1295 - acc: 0.9731 - val_loss: 0.1039 - val_acc: 0.9897
Epoch 5/6
 - 31s - loss: 0.1054 - acc: 0.9816 - val_loss: 0.0757 - val_acc: 0.9933
Epoch 6/6
 - 31s - loss: 0.0868 - acc: 0.9864 - val_loss: 0.0607 - val_acc: 0.9944
Test accuracy:0.719
current auc_score ------------------> 0.887
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 36864)        0           activation_18[0][0]              
==================================================================================================
Total params: 20,528
Trainable params: 19,392
Non-trainable params: 1,136
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 36864)        20528       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 73728)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          37749248    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 37,772,337
Trainable params: 37,770,177
Non-trainable params: 2,160
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 38s - loss: 0.5255 - acc: 0.7744 - val_loss: 0.3409 - val_acc: 0.8756
Epoch 2/6
 - 32s - loss: 0.3056 - acc: 0.8932 - val_loss: 0.2247 - val_acc: 0.9335
Epoch 3/6
 - 31s - loss: 0.2039 - acc: 0.9441 - val_loss: 0.1330 - val_acc: 0.9760
Epoch 4/6
 - 31s - loss: 0.1444 - acc: 0.9676 - val_loss: 0.1143 - val_acc: 0.9851
Epoch 5/6
 - 30s - loss: 0.1162 - acc: 0.9788 - val_loss: 0.0908 - val_acc: 0.9888
Epoch 6/6
 - 31s - loss: 0.0962 - acc: 0.9839 - val_loss: 0.0695 - val_acc: 0.9944
Test accuracy:0.655
current auc_score ------------------> 0.890
accuracies:  [0.7135752688172043, 0.6901881720430108, 0.6862903225806452, 0.7186827956989247, 0.6545698924731183]
aucs:  [0.9150200890276332, 0.8746100705283847, 0.8958619493583074, 0.8868540438200948, 0.8896822609550238]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_18[0][0]              
==================================================================================================
Total params: 68,432
Trainable params: 66,480
Non-trainable params: 1,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        68432       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 66,131,793
Trainable params: 66,128,817
Non-trainable params: 2,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 41s - loss: 0.5395 - acc: 0.7931 - val_loss: 0.3445 - val_acc: 0.9032
Epoch 2/6
 - 34s - loss: 0.3061 - acc: 0.9131 - val_loss: 0.2102 - val_acc: 0.9647
Epoch 3/6
 - 34s - loss: 0.2099 - acc: 0.9557 - val_loss: 0.1555 - val_acc: 0.9827
Epoch 4/6
 - 34s - loss: 0.1583 - acc: 0.9751 - val_loss: 0.1324 - val_acc: 0.9893
Epoch 5/6
 - 34s - loss: 0.1305 - acc: 0.9828 - val_loss: 0.0997 - val_acc: 0.9925
Epoch 6/6
 - 34s - loss: 0.1113 - acc: 0.9874 - val_loss: 0.0945 - val_acc: 0.9946
Test accuracy:0.672
current auc_score ------------------> 0.870
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_18[0][0]              
==================================================================================================
Total params: 68,432
Trainable params: 66,480
Non-trainable params: 1,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        68432       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 66,131,793
Trainable params: 66,128,817
Non-trainable params: 2,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 44s - loss: 0.5619 - acc: 0.7716 - val_loss: 0.4656 - val_acc: 0.8513
Epoch 2/6
 - 37s - loss: 0.3315 - acc: 0.8997 - val_loss: 0.2274 - val_acc: 0.9566
Epoch 3/6
 - 37s - loss: 0.2159 - acc: 0.9541 - val_loss: 0.1472 - val_acc: 0.9803
Epoch 4/6
 - 37s - loss: 0.1603 - acc: 0.9751 - val_loss: 0.1650 - val_acc: 0.9754
Epoch 5/6
 - 37s - loss: 0.1286 - acc: 0.9836 - val_loss: 0.1116 - val_acc: 0.9912
Epoch 6/6
 - 37s - loss: 0.1078 - acc: 0.9897 - val_loss: 0.0796 - val_acc: 0.9967
Test accuracy:0.741
current auc_score ------------------> 0.900
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_18[0][0]              
==================================================================================================
Total params: 68,432
Trainable params: 66,480
Non-trainable params: 1,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        68432       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 66,131,793
Trainable params: 66,128,817
Non-trainable params: 2,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 44s - loss: 0.5357 - acc: 0.7957 - val_loss: 0.3175 - val_acc: 0.9127
Epoch 2/6
 - 37s - loss: 0.2820 - acc: 0.9229 - val_loss: 0.1985 - val_acc: 0.9617
Epoch 3/6
 - 37s - loss: 0.1939 - acc: 0.9623 - val_loss: 0.1427 - val_acc: 0.9824
Epoch 4/6
 - 37s - loss: 0.1486 - acc: 0.9783 - val_loss: 0.1086 - val_acc: 0.9877
Epoch 5/6
 - 37s - loss: 0.1188 - acc: 0.9869 - val_loss: 0.0909 - val_acc: 0.9955
Epoch 6/6
 - 37s - loss: 0.1008 - acc: 0.9901 - val_loss: 0.0786 - val_acc: 0.9971
Test accuracy:0.712
current auc_score ------------------> 0.854
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_18[0][0]              
==================================================================================================
Total params: 68,432
Trainable params: 66,480
Non-trainable params: 1,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        68432       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 66,131,793
Trainable params: 66,128,817
Non-trainable params: 2,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 44s - loss: 0.5358 - acc: 0.7958 - val_loss: 0.3551 - val_acc: 0.8990
Epoch 2/6
 - 38s - loss: 0.2961 - acc: 0.9167 - val_loss: 0.2128 - val_acc: 0.9610
Epoch 3/6
 - 37s - loss: 0.2003 - acc: 0.9601 - val_loss: 0.1433 - val_acc: 0.9833
Epoch 4/6
 - 37s - loss: 0.1516 - acc: 0.9772 - val_loss: 0.1141 - val_acc: 0.9908
Epoch 5/6
 - 37s - loss: 0.1221 - acc: 0.9865 - val_loss: 0.0994 - val_acc: 0.9927
Epoch 6/6
 - 37s - loss: 0.1134 - acc: 0.9873 - val_loss: 0.0841 - val_acc: 0.9970
Test accuracy:0.611
current auc_score ------------------> 0.887
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 64512)        0           activation_18[0][0]              
==================================================================================================
Total params: 68,432
Trainable params: 66,480
Non-trainable params: 1,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 64512)        68432       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 129024)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          66060800    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 66,131,793
Trainable params: 66,128,817
Non-trainable params: 2,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 44s - loss: 0.5533 - acc: 0.7823 - val_loss: 0.3436 - val_acc: 0.8921
Epoch 2/6
 - 37s - loss: 0.3016 - acc: 0.9153 - val_loss: 0.2267 - val_acc: 0.9588
Epoch 3/6
 - 37s - loss: 0.2128 - acc: 0.9559 - val_loss: 0.1558 - val_acc: 0.9740
Epoch 4/6
 - 37s - loss: 0.1595 - acc: 0.9739 - val_loss: 0.1153 - val_acc: 0.9864
Epoch 5/6
 - 37s - loss: 0.1280 - acc: 0.9851 - val_loss: 0.1032 - val_acc: 0.9933
Epoch 6/6
 - 37s - loss: 0.1135 - acc: 0.9870 - val_loss: 0.0836 - val_acc: 0.9952
Test accuracy:0.741
current auc_score ------------------> 0.917
accuracies:  [0.6721774193548387, 0.7407258064516129, 0.712231182795699, 0.610752688172043, 0.7411290322580645]
aucs:  [0.8704175699502832, 0.8998537403167997, 0.8537116646433114, 0.886710096542953, 0.9171555960226616]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_18[0][0]              
==================================================================================================
Total params: 145,136
Trainable params: 142,368
Non-trainable params: 2,768
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        145136      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 94,520,049
Trainable params: 94,516,257
Non-trainable params: 3,792
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 51s - loss: 0.6204 - acc: 0.7628 - val_loss: 0.4243 - val_acc: 0.8598
Epoch 2/6
 - 43s - loss: 0.3426 - acc: 0.9116 - val_loss: 0.2309 - val_acc: 0.9676
Epoch 3/6
 - 42s - loss: 0.2347 - acc: 0.9614 - val_loss: 0.1807 - val_acc: 0.9828
Epoch 4/6
 - 42s - loss: 0.1868 - acc: 0.9754 - val_loss: 0.1621 - val_acc: 0.9829
Epoch 5/6
 - 43s - loss: 0.1533 - acc: 0.9842 - val_loss: 0.1230 - val_acc: 0.9918
Epoch 6/6
 - 42s - loss: 0.1283 - acc: 0.9896 - val_loss: 0.1041 - val_acc: 0.9952
Test accuracy:0.754
current auc_score ------------------> 0.893
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_18[0][0]              
==================================================================================================
Total params: 145,136
Trainable params: 142,368
Non-trainable params: 2,768
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        145136      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 94,520,049
Trainable params: 94,516,257
Non-trainable params: 3,792
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 51s - loss: 0.5807 - acc: 0.7893 - val_loss: 0.5283 - val_acc: 0.8125
Epoch 2/6
 - 43s - loss: 0.3330 - acc: 0.9175 - val_loss: 0.2359 - val_acc: 0.9720
Epoch 3/6
 - 43s - loss: 0.2339 - acc: 0.9607 - val_loss: 0.1657 - val_acc: 0.9872
Epoch 4/6
 - 43s - loss: 0.1724 - acc: 0.9813 - val_loss: 0.1349 - val_acc: 0.9923
Epoch 5/6
 - 43s - loss: 0.1401 - acc: 0.9888 - val_loss: 0.1240 - val_acc: 0.9941
Epoch 6/6
 - 43s - loss: 0.1236 - acc: 0.9913 - val_loss: 0.1059 - val_acc: 0.9961
Test accuracy:0.636
current auc_score ------------------> 0.841
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_18[0][0]              
==================================================================================================
Total params: 145,136
Trainable params: 142,368
Non-trainable params: 2,768
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        145136      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 94,520,049
Trainable params: 94,516,257
Non-trainable params: 3,792
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 49s - loss: 0.5940 - acc: 0.7788 - val_loss: 1.6837 - val_acc: 0.5147
Epoch 2/6
 - 41s - loss: 0.3623 - acc: 0.9044 - val_loss: 2.5091 - val_acc: 0.5073
Epoch 3/6
 - 40s - loss: 0.2557 - acc: 0.9533 - val_loss: 1.6101 - val_acc: 0.5594
Epoch 4/6
 - 40s - loss: 0.1974 - acc: 0.9720 - val_loss: 1.0803 - val_acc: 0.6699
Epoch 5/6
 - 40s - loss: 0.1583 - acc: 0.9833 - val_loss: 1.0371 - val_acc: 0.7193
Epoch 6/6
 - 40s - loss: 0.1347 - acc: 0.9884 - val_loss: 1.2949 - val_acc: 0.6505
Test accuracy:0.682
current auc_score ------------------> 0.800
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_18[0][0]              
==================================================================================================
Total params: 145,136
Trainable params: 142,368
Non-trainable params: 2,768
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        145136      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 94,520,049
Trainable params: 94,516,257
Non-trainable params: 3,792
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 50s - loss: 0.5795 - acc: 0.7885 - val_loss: 0.3733 - val_acc: 0.9001
Epoch 2/6
 - 43s - loss: 0.3336 - acc: 0.9152 - val_loss: 0.2305 - val_acc: 0.9654
Epoch 3/6
 - 43s - loss: 0.2219 - acc: 0.9653 - val_loss: 0.1631 - val_acc: 0.9882
Epoch 4/6
 - 43s - loss: 0.1768 - acc: 0.9786 - val_loss: 0.1358 - val_acc: 0.9892
Epoch 5/6
 - 43s - loss: 0.1461 - acc: 0.9859 - val_loss: 0.1157 - val_acc: 0.9937
Epoch 6/6
 - 43s - loss: 0.1311 - acc: 0.9877 - val_loss: 0.1019 - val_acc: 0.9935
Test accuracy:0.754
current auc_score ------------------> 0.906
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_18[0][0]              
==================================================================================================
Total params: 145,136
Trainable params: 142,368
Non-trainable params: 2,768
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        145136      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 94,520,049
Trainable params: 94,516,257
Non-trainable params: 3,792
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 49s - loss: 0.5946 - acc: 0.7775 - val_loss: 1.2635 - val_acc: 0.5422
Epoch 2/6
 - 40s - loss: 0.3666 - acc: 0.8996 - val_loss: 2.6933 - val_acc: 0.5036
Epoch 3/6
 - 40s - loss: 0.2588 - acc: 0.9497 - val_loss: 1.9263 - val_acc: 0.5233

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/6
 - 41s - loss: 0.1907 - acc: 0.9773 - val_loss: 1.1325 - val_acc: 0.6078
Epoch 5/6
 - 41s - loss: 0.1644 - acc: 0.9855 - val_loss: 2.3368 - val_acc: 0.5164
Epoch 6/6
 - 40s - loss: 0.1508 - acc: 0.9890 - val_loss: 1.2929 - val_acc: 0.6055

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Test accuracy:0.663
current auc_score ------------------> 0.612
accuracies:  [0.7541666666666667, 0.635752688172043, 0.6815860215053764, 0.7540322580645161, 0.6626344086021505]
aucs:  [0.8929141013411955, 0.840895117932709, 0.7998587625737079, 0.9064370881026709, 0.612001604231703]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 119808)       0           activation_18[0][0]              
==================================================================================================
Total params: 250,640
Trainable params: 247,056
Non-trainable params: 3,584
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 119808)       250640      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 239616)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          122683904   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 122,937,105
Trainable params: 122,932,497
Non-trainable params: 4,608
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 55s - loss: 0.6160 - acc: 0.7868 - val_loss: 1.2448 - val_acc: 0.6088
Epoch 2/6
 - 46s - loss: 0.3808 - acc: 0.9091 - val_loss: 3.2675 - val_acc: 0.5050
Epoch 3/6
 - 46s - loss: 0.2740 - acc: 0.9568 - val_loss: 0.2065 - val_acc: 0.9844
Epoch 4/6
 - 46s - loss: 0.2137 - acc: 0.9744 - val_loss: 0.1616 - val_acc: 0.9911
Epoch 5/6
 - 46s - loss: 0.1775 - acc: 0.9834 - val_loss: 0.1398 - val_acc: 0.9961
Epoch 6/6
 - 46s - loss: 0.1521 - acc: 0.9871 - val_loss: 0.1271 - val_acc: 0.9954
Test accuracy:0.725
current auc_score ------------------> 0.887
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 119808)       0           activation_18[0][0]              
==================================================================================================
Total params: 250,640
Trainable params: 247,056
Non-trainable params: 3,584
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 119808)       250640      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 239616)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          122683904   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 122,937,105
Trainable params: 122,932,497
Non-trainable params: 4,608
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 56s - loss: 0.6767 - acc: 0.7505 - val_loss: 4.0120 - val_acc: 0.5035
Epoch 2/6
 - 47s - loss: 0.4238 - acc: 0.8876 - val_loss: 2.1565 - val_acc: 0.5077
Epoch 3/6
 - 47s - loss: 0.3020 - acc: 0.9452 - val_loss: 1.8616 - val_acc: 0.5463
Epoch 4/6
 - 47s - loss: 0.2289 - acc: 0.9705 - val_loss: 3.5056 - val_acc: 0.5171
Epoch 5/6
 - 47s - loss: 0.1908 - acc: 0.9806 - val_loss: 5.0459 - val_acc: 0.5058

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/6
 - 47s - loss: 0.1547 - acc: 0.9906 - val_loss: 2.4990 - val_acc: 0.5422
Test accuracy:0.511
current auc_score ------------------> 0.634
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 119808)       0           activation_18[0][0]              
==================================================================================================
Total params: 250,640
Trainable params: 247,056
Non-trainable params: 3,584
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 119808)       250640      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 239616)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          122683904   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 122,937,105
Trainable params: 122,932,497
Non-trainable params: 4,608
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 55s - loss: 0.6585 - acc: 0.7673 - val_loss: 4.7235 - val_acc: 0.5035
Epoch 2/6
 - 46s - loss: 0.3843 - acc: 0.9088 - val_loss: 1.4305 - val_acc: 0.5572
Epoch 3/6
 - 46s - loss: 0.2697 - acc: 0.9593 - val_loss: 4.2701 - val_acc: 0.5043
Epoch 4/6
 - 46s - loss: 0.2044 - acc: 0.9807 - val_loss: 1.5580 - val_acc: 0.6012

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/6
 - 46s - loss: 0.1646 - acc: 0.9909 - val_loss: 2.0775 - val_acc: 0.5555
Epoch 6/6
 - 46s - loss: 0.1488 - acc: 0.9945 - val_loss: 3.3165 - val_acc: 0.5201

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Test accuracy:0.501
current auc_score ------------------> 0.710
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 119808)       0           activation_18[0][0]              
==================================================================================================
Total params: 250,640
Trainable params: 247,056
Non-trainable params: 3,584
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 119808)       250640      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 239616)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          122683904   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 122,937,105
Trainable params: 122,932,497
Non-trainable params: 4,608
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 55s - loss: 0.6452 - acc: 0.7745 - val_loss: 0.4370 - val_acc: 0.8844
Epoch 2/6
 - 47s - loss: 0.3864 - acc: 0.9076 - val_loss: 0.2814 - val_acc: 0.9645
Epoch 3/6
 - 47s - loss: 0.2678 - acc: 0.9606 - val_loss: 0.2022 - val_acc: 0.9866
Epoch 4/6
 - 47s - loss: 0.2083 - acc: 0.9783 - val_loss: 0.1686 - val_acc: 0.9925
Epoch 5/6
 - 47s - loss: 0.1758 - acc: 0.9849 - val_loss: 0.1430 - val_acc: 0.9966
Epoch 6/6
 - 47s - loss: 0.1510 - acc: 0.9886 - val_loss: 0.1208 - val_acc: 0.9940
Test accuracy:0.769
current auc_score ------------------> 0.889
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 119808)       0           activation_18[0][0]              
==================================================================================================
Total params: 250,640
Trainable params: 247,056
Non-trainable params: 3,584
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 119808)       250640      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 239616)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          122683904   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 122,937,105
Trainable params: 122,932,497
Non-trainable params: 4,608
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 55s - loss: 0.6135 - acc: 0.7919 - val_loss: 0.8809 - val_acc: 0.6608
Epoch 2/6
 - 46s - loss: 0.3726 - acc: 0.9148 - val_loss: 0.2690 - val_acc: 0.9667
Epoch 3/6
 - 46s - loss: 0.2672 - acc: 0.9604 - val_loss: 0.1981 - val_acc: 0.9901
Epoch 4/6
 - 46s - loss: 0.2089 - acc: 0.9786 - val_loss: 0.1770 - val_acc: 0.9892
Epoch 5/6
 - 46s - loss: 0.1770 - acc: 0.9850 - val_loss: 0.1446 - val_acc: 0.9942
Epoch 6/6
 - 46s - loss: 0.1533 - acc: 0.9888 - val_loss: 0.1191 - val_acc: 0.9955
Test accuracy:0.779
current auc_score ------------------> 0.928
accuracies:  [0.7247311827956989, 0.511021505376344, 0.5012096774193548, 0.7693548387096775, 0.7787634408602151]
aucs:  [0.886721803098624, 0.633646303040814, 0.7100909425945195, 0.8891613914903458, 0.9282328520638226]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_18[0][0]              
==================================================================================================
Total params: 384,944
Trainable params: 380,544
Non-trainable params: 4,400
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       384944      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 151,382,961
Trainable params: 151,377,537
Non-trainable params: 5,424
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 60s - loss: 0.6783 - acc: 0.7731 - val_loss: 0.4728 - val_acc: 0.8965
Epoch 2/6
 - 51s - loss: 0.4004 - acc: 0.9169 - val_loss: 0.3198 - val_acc: 0.9666
Epoch 3/6
 - 51s - loss: 0.2800 - acc: 0.9641 - val_loss: 0.2130 - val_acc: 0.9816
Epoch 4/6
 - 51s - loss: 0.2195 - acc: 0.9813 - val_loss: 0.1785 - val_acc: 0.9901
Epoch 5/6
 - 51s - loss: 0.1826 - acc: 0.9879 - val_loss: 0.1551 - val_acc: 0.9946
Epoch 6/6
 - 51s - loss: 0.1511 - acc: 0.9923 - val_loss: 0.1260 - val_acc: 0.9976
Test accuracy:0.677
current auc_score ------------------> 0.906
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_18[0][0]              
==================================================================================================
Total params: 384,944
Trainable params: 380,544
Non-trainable params: 4,400
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       384944      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 151,382,961
Trainable params: 151,377,537
Non-trainable params: 5,424
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 60s - loss: 0.6788 - acc: 0.7745 - val_loss: 0.9340 - val_acc: 0.6037
Epoch 2/6
 - 51s - loss: 0.4293 - acc: 0.9042 - val_loss: 2.4218 - val_acc: 0.5156
Epoch 3/6
 - 51s - loss: 0.3085 - acc: 0.9552 - val_loss: 2.7588 - val_acc: 0.5351

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/6
 - 51s - loss: 0.2352 - acc: 0.9805 - val_loss: 1.8983 - val_acc: 0.5831
Epoch 5/6
 - 51s - loss: 0.2089 - acc: 0.9886 - val_loss: 1.7750 - val_acc: 0.5820

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.550
current auc_score ------------------> 0.647
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_18[0][0]              
==================================================================================================
Total params: 384,944
Trainable params: 380,544
Non-trainable params: 4,400
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       384944      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 151,382,961
Trainable params: 151,377,537
Non-trainable params: 5,424
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 61s - loss: 0.6311 - acc: 0.7970 - val_loss: 0.4389 - val_acc: 0.9052
Epoch 2/6
 - 52s - loss: 0.3778 - acc: 0.9297 - val_loss: 0.2967 - val_acc: 0.9649
Epoch 3/6
 - 52s - loss: 0.2738 - acc: 0.9691 - val_loss: 0.2323 - val_acc: 0.9827
Epoch 4/6
 - 52s - loss: 0.2226 - acc: 0.9810 - val_loss: 0.1871 - val_acc: 0.9869
Epoch 5/6
 - 52s - loss: 0.1870 - acc: 0.9872 - val_loss: 0.1530 - val_acc: 0.9957
Epoch 6/6
 - 52s - loss: 0.1580 - acc: 0.9909 - val_loss: 0.1317 - val_acc: 0.9962
Test accuracy:0.690
current auc_score ------------------> 0.885
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_18[0][0]              
==================================================================================================
Total params: 384,944
Trainable params: 380,544
Non-trainable params: 4,400
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       384944      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 151,382,961
Trainable params: 151,377,537
Non-trainable params: 5,424
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 61s - loss: 0.6828 - acc: 0.7657 - val_loss: 4.2701 - val_acc: 0.5035
Epoch 2/6
 - 51s - loss: 0.4439 - acc: 0.8974 - val_loss: 2.2551 - val_acc: 0.5060
Epoch 3/6
 - 51s - loss: 0.3218 - acc: 0.9506 - val_loss: 0.2470 - val_acc: 0.9752
Epoch 4/6
 - 51s - loss: 0.2497 - acc: 0.9728 - val_loss: 0.2122 - val_acc: 0.9856
Epoch 5/6
 - 51s - loss: 0.1998 - acc: 0.9842 - val_loss: 0.1561 - val_acc: 0.9954
Epoch 6/6
 - 51s - loss: 0.1681 - acc: 0.9894 - val_loss: 0.1489 - val_acc: 0.9927
Test accuracy:0.706
current auc_score ------------------> 0.861
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_18[0][0]              
==================================================================================================
Total params: 384,944
Trainable params: 380,544
Non-trainable params: 4,400
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       384944      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 151,382,961
Trainable params: 151,377,537
Non-trainable params: 5,424
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 60s - loss: 0.7482 - acc: 0.7274 - val_loss: 0.6187 - val_acc: 0.7899
Epoch 2/6
 - 51s - loss: 0.5369 - acc: 0.8432 - val_loss: 0.4151 - val_acc: 0.9124
Epoch 3/6
 - 51s - loss: 0.3853 - acc: 0.9250 - val_loss: 0.2757 - val_acc: 0.9718
Epoch 4/6
 - 51s - loss: 0.2879 - acc: 0.9630 - val_loss: 0.2159 - val_acc: 0.9881
Epoch 5/6
 - 51s - loss: 0.2324 - acc: 0.9773 - val_loss: 0.1985 - val_acc: 0.9891
Epoch 6/6
 - 51s - loss: 0.1914 - acc: 0.9853 - val_loss: 0.1588 - val_acc: 0.9936
Test accuracy:0.624
current auc_score ------------------> 0.858
accuracies:  [0.677016129032258, 0.5501344086021506, 0.6899193548387097, 0.7056451612903226, 0.6244623655913979]
aucs:  [0.9055749580876402, 0.6473528731645276, 0.8852918690021968, 0.8611814227078276, 0.8580041045207538]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_18[0][0]              
==================================================================================================
Total params: 548,048
Trainable params: 542,832
Non-trainable params: 5,216
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       548048      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 179,857,617
Trainable params: 179,851,377
Non-trainable params: 6,240
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 68s - loss: 0.7065 - acc: 0.7782 - val_loss: 2.0297 - val_acc: 0.5055
Epoch 2/6
 - 58s - loss: 0.4369 - acc: 0.9170 - val_loss: 2.5372 - val_acc: 0.5065
Epoch 3/6
 - 58s - loss: 0.3133 - acc: 0.9640 - val_loss: 2.5972 - val_acc: 0.5120

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/6
 - 58s - loss: 0.2423 - acc: 0.9852 - val_loss: 0.4499 - val_acc: 0.8908
Epoch 5/6
 - 58s - loss: 0.2173 - acc: 0.9913 - val_loss: 0.4551 - val_acc: 0.8721
Epoch 6/6
 - 58s - loss: 0.1985 - acc: 0.9942 - val_loss: 0.4131 - val_acc: 0.8972
Test accuracy:0.762
current auc_score ------------------> 0.847
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_18[0][0]              
==================================================================================================
Total params: 548,048
Trainable params: 542,832
Non-trainable params: 5,216
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       548048      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 179,857,617
Trainable params: 179,851,377
Non-trainable params: 6,240
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 69s - loss: 0.7420 - acc: 0.7582 - val_loss: 0.9291 - val_acc: 0.6808
Epoch 2/6
 - 58s - loss: 0.4712 - acc: 0.8972 - val_loss: 1.3608 - val_acc: 0.5815
Epoch 3/6
 - 58s - loss: 0.3280 - acc: 0.9575 - val_loss: 1.1991 - val_acc: 0.6217

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/6
 - 58s - loss: 0.2563 - acc: 0.9816 - val_loss: 1.3653 - val_acc: 0.6017
Epoch 5/6
 - 58s - loss: 0.2301 - acc: 0.9883 - val_loss: 0.1977 - val_acc: 0.9957
Epoch 6/6
 - 59s - loss: 0.2117 - acc: 0.9908 - val_loss: 0.1829 - val_acc: 0.9964
Test accuracy:0.620
current auc_score ------------------> 0.851
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_18[0][0]              
==================================================================================================
Total params: 548,048
Trainable params: 542,832
Non-trainable params: 5,216
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       548048      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 179,857,617
Trainable params: 179,851,377
Non-trainable params: 6,240
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 68s - loss: 0.6929 - acc: 0.7901 - val_loss: 0.5157 - val_acc: 0.8843
Epoch 2/6
 - 59s - loss: 0.4203 - acc: 0.9254 - val_loss: 0.3336 - val_acc: 0.9632
Epoch 3/6
 - 58s - loss: 0.2989 - acc: 0.9700 - val_loss: 0.2283 - val_acc: 0.9892
Epoch 4/6
 - 58s - loss: 0.2343 - acc: 0.9853 - val_loss: 0.1973 - val_acc: 0.9944
Epoch 5/6
 - 58s - loss: 0.1955 - acc: 0.9901 - val_loss: 0.1632 - val_acc: 0.9970
Epoch 6/6
 - 58s - loss: 0.1653 - acc: 0.9931 - val_loss: 0.1441 - val_acc: 0.9940
Test accuracy:0.677
current auc_score ------------------> 0.825
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_18[0][0]              
==================================================================================================
Total params: 548,048
Trainable params: 542,832
Non-trainable params: 5,216
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       548048      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 179,857,617
Trainable params: 179,851,377
Non-trainable params: 6,240
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 69s - loss: 0.7163 - acc: 0.7766 - val_loss: 0.5085 - val_acc: 0.8955
Epoch 2/6
 - 58s - loss: 0.4404 - acc: 0.9147 - val_loss: 0.3242 - val_acc: 0.9704
Epoch 3/6
 - 59s - loss: 0.3161 - acc: 0.9625 - val_loss: 0.2424 - val_acc: 0.9890
Epoch 4/6
 - 59s - loss: 0.2506 - acc: 0.9796 - val_loss: 0.1983 - val_acc: 0.9939
Epoch 5/6
 - 58s - loss: 0.2051 - acc: 0.9879 - val_loss: 0.1714 - val_acc: 0.9952
Epoch 6/6
 - 58s - loss: 0.1762 - acc: 0.9902 - val_loss: 0.1673 - val_acc: 0.9937
Test accuracy:0.648
current auc_score ------------------> 0.831
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [8]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_18[0][0]              
==================================================================================================
Total params: 548,048
Trainable params: 542,832
Non-trainable params: 5,216
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       548048      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 179,857,617
Trainable params: 179,851,377
Non-trainable params: 6,240
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 68s - loss: 0.6724 - acc: 0.8034 - val_loss: 3.1379 - val_acc: 0.5035
Epoch 2/6
 - 58s - loss: 0.4211 - acc: 0.9222 - val_loss: 2.2870 - val_acc: 0.5067
Epoch 3/6
 - 58s - loss: 0.3059 - acc: 0.9672 - val_loss: 3.5735 - val_acc: 0.5060
Epoch 4/6
 - 58s - loss: 0.2423 - acc: 0.9821 - val_loss: 5.4185 - val_acc: 0.5035

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/6
 - 58s - loss: 0.1998 - acc: 0.9912 - val_loss: 4.2374 - val_acc: 0.5036
Epoch 6/6
 - 58s - loss: 0.1803 - acc: 0.9949 - val_loss: 5.1531 - val_acc: 0.5036

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00006: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.677
accuracies:  [0.7618279569892473, 0.6200268817204301, 0.6772849462365591, 0.648252688172043, 0.49959677419354837]
aucs:  [0.8466762053416579, 0.8513628020580414, 0.8247478754769337, 0.831244724823679, 0.6774551971326166]
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_22[0][0]              
==================================================================================================
Total params: 27,112
Trainable params: 25,588
Non-trainable params: 1,524
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        27112       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 44,856,809
Trainable params: 44,854,261
Non-trainable params: 2,548
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 45s - loss: 0.5383 - acc: 0.7734 - val_loss: 0.4452 - val_acc: 0.8276
Epoch 2/6
 - 38s - loss: 0.2977 - acc: 0.9069 - val_loss: 0.1942 - val_acc: 0.9602
Epoch 3/6
 - 37s - loss: 0.2039 - acc: 0.9475 - val_loss: 0.1288 - val_acc: 0.9817
Epoch 4/6
 - 38s - loss: 0.1442 - acc: 0.9728 - val_loss: 0.1024 - val_acc: 0.9881
Epoch 5/6
 - 37s - loss: 0.1118 - acc: 0.9830 - val_loss: 0.0754 - val_acc: 0.9949
Epoch 6/6
 - 37s - loss: 0.0933 - acc: 0.9880 - val_loss: 0.0675 - val_acc: 0.9957
Test accuracy:0.722
current auc_score ------------------> 0.872
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_22[0][0]              
==================================================================================================
Total params: 27,112
Trainable params: 25,588
Non-trainable params: 1,524
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        27112       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 44,856,809
Trainable params: 44,854,261
Non-trainable params: 2,548
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 42s - loss: 0.5690 - acc: 0.7554 - val_loss: 5.4304 - val_acc: 0.5035
Epoch 2/6
 - 34s - loss: 0.3336 - acc: 0.8843 - val_loss: 5.4781 - val_acc: 0.5036
Epoch 3/6
 - 34s - loss: 0.2184 - acc: 0.9420 - val_loss: 5.3485 - val_acc: 0.5137
Epoch 4/6
 - 33s - loss: 0.1563 - acc: 0.9676 - val_loss: 6.3694 - val_acc: 0.5036
Epoch 5/6
 - 34s - loss: 0.1158 - acc: 0.9810 - val_loss: 6.2449 - val_acc: 0.5105

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/6
 - 33s - loss: 0.0874 - acc: 0.9899 - val_loss: 6.4560 - val_acc: 0.5050
Test accuracy:0.500
current auc_score ------------------> 0.702
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_22[0][0]              
==================================================================================================
Total params: 27,112
Trainable params: 25,588
Non-trainable params: 1,524
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        27112       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 44,856,809
Trainable params: 44,854,261
Non-trainable params: 2,548
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 45s - loss: 0.5043 - acc: 0.7951 - val_loss: 0.2901 - val_acc: 0.9039
Epoch 2/6
 - 37s - loss: 0.2591 - acc: 0.9222 - val_loss: 0.1902 - val_acc: 0.9592
Epoch 3/6
 - 37s - loss: 0.1725 - acc: 0.9610 - val_loss: 0.1188 - val_acc: 0.9837
Epoch 4/6
 - 37s - loss: 0.1305 - acc: 0.9765 - val_loss: 0.1397 - val_acc: 0.9863
Epoch 5/6
 - 37s - loss: 0.1073 - acc: 0.9831 - val_loss: 0.0777 - val_acc: 0.9933
Epoch 6/6
 - 36s - loss: 0.0907 - acc: 0.9876 - val_loss: 0.0633 - val_acc: 0.9967
Test accuracy:0.752
current auc_score ------------------> 0.905
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_22[0][0]              
==================================================================================================
Total params: 27,112
Trainable params: 25,588
Non-trainable params: 1,524
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        27112       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 44,856,809
Trainable params: 44,854,261
Non-trainable params: 2,548
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 41s - loss: 0.5469 - acc: 0.7671 - val_loss: 2.9958 - val_acc: 0.5039
Epoch 2/6
 - 34s - loss: 0.2895 - acc: 0.9063 - val_loss: 0.2006 - val_acc: 0.9577
Epoch 3/6
 - 33s - loss: 0.1933 - acc: 0.9525 - val_loss: 0.1278 - val_acc: 0.9765
Epoch 4/6
 - 34s - loss: 0.1400 - acc: 0.9724 - val_loss: 0.1095 - val_acc: 0.9876
Epoch 5/6
 - 34s - loss: 0.1136 - acc: 0.9821 - val_loss: 0.1052 - val_acc: 0.9812
Epoch 6/6
 - 34s - loss: 0.0957 - acc: 0.9860 - val_loss: 0.0666 - val_acc: 0.9932
Test accuracy:0.749
current auc_score ------------------> 0.890
Epochs  6  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 43776)        0           activation_22[0][0]              
==================================================================================================
Total params: 27,112
Trainable params: 25,588
Non-trainable params: 1,524
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 43776)        27112       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 87552)        0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          44827136    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 44,856,809
Trainable params: 44,854,261
Non-trainable params: 2,548
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
 - 43s - loss: 0.4652 - acc: 0.8185 - val_loss: 0.2521 - val_acc: 0.9364
Epoch 2/6
 - 35s - loss: 0.2370 - acc: 0.9326 - val_loss: 0.1707 - val_acc: 0.9694
Epoch 3/6
 - 34s - loss: 0.1634 - acc: 0.9637 - val_loss: 0.1305 - val_acc: 0.9818
Epoch 4/6
 - 34s - loss: 0.1229 - acc: 0.9787 - val_loss: 0.0993 - val_acc: 0.9872
Epoch 5/6
 - 34s - loss: 0.1040 - acc: 0.9840 - val_loss: 0.0824 - val_acc: 0.9947
Epoch 6/6
 - 34s - loss: 0.0864 - acc: 0.9887 - val_loss: 0.0634 - val_acc: 0.9959
Test accuracy:0.678
current auc_score ------------------> 0.884
accuracies:  [0.7217741935483871, 0.5, 0.7520161290322581, 0.7494623655913979, 0.6778225806451613]
aucs:  [0.8721702653485952, 0.701813576714071, 0.9049513672100822, 0.8899596051566655, 0.8835281535437622]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_22[0][0]              
==================================================================================================
Total params: 91,552
Trainable params: 88,888
Non-trainable params: 2,664
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        91552       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 80,310,689
Trainable params: 80,307,001
Non-trainable params: 3,688
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 52s - loss: 0.6050 - acc: 0.7558 - val_loss: 0.4353 - val_acc: 0.8391
Epoch 2/7
 - 43s - loss: 0.3583 - acc: 0.8953 - val_loss: 0.2540 - val_acc: 0.9554
Epoch 3/7
 - 43s - loss: 0.2435 - acc: 0.9507 - val_loss: 0.1805 - val_acc: 0.9770
Epoch 4/7
 - 43s - loss: 0.1835 - acc: 0.9723 - val_loss: 0.1444 - val_acc: 0.9888
Epoch 5/7
 - 43s - loss: 0.1460 - acc: 0.9824 - val_loss: 0.1056 - val_acc: 0.9955
Epoch 6/7
 - 43s - loss: 0.1245 - acc: 0.9872 - val_loss: 0.1354 - val_acc: 0.9843
Epoch 7/7
 - 42s - loss: 0.1125 - acc: 0.9896 - val_loss: 0.0839 - val_acc: 0.9971
Test accuracy:0.703
current auc_score ------------------> 0.873
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_22[0][0]              
==================================================================================================
Total params: 91,552
Trainable params: 88,888
Non-trainable params: 2,664
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        91552       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 80,310,689
Trainable params: 80,307,001
Non-trainable params: 3,688
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 51s - loss: 0.5569 - acc: 0.7933 - val_loss: 0.3528 - val_acc: 0.9084
Epoch 2/7
 - 43s - loss: 0.3127 - acc: 0.9175 - val_loss: 0.2179 - val_acc: 0.9652
Epoch 3/7
 - 43s - loss: 0.2276 - acc: 0.9545 - val_loss: 0.1750 - val_acc: 0.9745
Epoch 4/7
 - 43s - loss: 0.1701 - acc: 0.9761 - val_loss: 0.1246 - val_acc: 0.9913
Epoch 5/7
 - 43s - loss: 0.1360 - acc: 0.9869 - val_loss: 0.0994 - val_acc: 0.9950
Epoch 6/7
 - 43s - loss: 0.1210 - acc: 0.9886 - val_loss: 0.0979 - val_acc: 0.9923
Epoch 7/7
 - 42s - loss: 0.1063 - acc: 0.9910 - val_loss: 0.0834 - val_acc: 0.9967
Test accuracy:0.669
current auc_score ------------------> 0.874
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_22[0][0]              
==================================================================================================
Total params: 91,552
Trainable params: 88,888
Non-trainable params: 2,664
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        91552       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 80,310,689
Trainable params: 80,307,001
Non-trainable params: 3,688
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 51s - loss: 0.5406 - acc: 0.7983 - val_loss: 0.3502 - val_acc: 0.9094
Epoch 2/7
 - 42s - loss: 0.3063 - acc: 0.9211 - val_loss: 0.2493 - val_acc: 0.9523
Epoch 3/7
 - 42s - loss: 0.2194 - acc: 0.9594 - val_loss: 0.1799 - val_acc: 0.9798
Epoch 4/7
 - 42s - loss: 0.1618 - acc: 0.9792 - val_loss: 0.1263 - val_acc: 0.9906
Epoch 5/7
 - 42s - loss: 0.1312 - acc: 0.9877 - val_loss: 0.0995 - val_acc: 0.9950
Epoch 6/7
 - 42s - loss: 0.1130 - acc: 0.9911 - val_loss: 0.1010 - val_acc: 0.9947
Epoch 7/7
 - 43s - loss: 0.1011 - acc: 0.9920 - val_loss: 0.0894 - val_acc: 0.9971
Test accuracy:0.696
current auc_score ------------------> 0.864
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_22[0][0]              
==================================================================================================
Total params: 91,552
Trainable params: 88,888
Non-trainable params: 2,664
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        91552       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 80,310,689
Trainable params: 80,307,001
Non-trainable params: 3,688
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 50s - loss: 0.6350 - acc: 0.7432 - val_loss: 3.7613 - val_acc: 0.5035
Epoch 2/7
 - 41s - loss: 0.3851 - acc: 0.8801 - val_loss: 1.7975 - val_acc: 0.5133
Epoch 3/7
 - 41s - loss: 0.2649 - acc: 0.9409 - val_loss: 4.4908 - val_acc: 0.5035
Epoch 4/7
 - 41s - loss: 0.1927 - acc: 0.9692 - val_loss: 0.1414 - val_acc: 0.9883
Epoch 5/7
 - 41s - loss: 0.1549 - acc: 0.9807 - val_loss: 0.1176 - val_acc: 0.9907
Epoch 6/7
 - 41s - loss: 0.1304 - acc: 0.9863 - val_loss: 0.0967 - val_acc: 0.9967
Epoch 7/7
 - 40s - loss: 0.1122 - acc: 0.9904 - val_loss: 0.0908 - val_acc: 0.9960
Test accuracy:0.708
current auc_score ------------------> 0.888
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 78336)        0           activation_22[0][0]              
==================================================================================================
Total params: 91,552
Trainable params: 88,888
Non-trainable params: 2,664
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 78336)        91552       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 156672)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          80216576    merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 80,310,689
Trainable params: 80,307,001
Non-trainable params: 3,688
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 50s - loss: 0.5994 - acc: 0.7676 - val_loss: 3.3878 - val_acc: 0.5035
Epoch 2/7
 - 40s - loss: 0.3377 - acc: 0.9073 - val_loss: 1.7296 - val_acc: 0.5341
Epoch 3/7
 - 40s - loss: 0.2268 - acc: 0.9564 - val_loss: 2.8136 - val_acc: 0.5082
Epoch 4/7
 - 40s - loss: 0.1759 - acc: 0.9760 - val_loss: 1.0536 - val_acc: 0.6250
Epoch 5/7
 - 40s - loss: 0.1422 - acc: 0.9845 - val_loss: 1.5284 - val_acc: 0.5270
Epoch 6/7
 - 40s - loss: 0.1278 - acc: 0.9866 - val_loss: 0.8825 - val_acc: 0.7014
Epoch 7/7
 - 40s - loss: 0.1071 - acc: 0.9919 - val_loss: 1.7376 - val_acc: 0.5695
Test accuracy:0.597
current auc_score ------------------> 0.759
accuracies:  [0.7030913978494624, 0.6694892473118279, 0.6955645161290323, 0.7083333333333334, 0.5974462365591398]
aucs:  [0.8734509047288703, 0.8743296912937911, 0.8639149757197364, 0.8880981905422591, 0.7593005694299919]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_22[0][0]              
==================================================================================================
Total params: 194,872
Trainable params: 191,068
Non-trainable params: 3,804
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       194872      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 115,803,449
Trainable params: 115,798,621
Non-trainable params: 4,828
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 59s - loss: 0.6305 - acc: 0.7734 - val_loss: 4.6692 - val_acc: 0.5162
Epoch 2/7
 - 50s - loss: 0.4042 - acc: 0.8942 - val_loss: 1.3681 - val_acc: 0.6293
Epoch 3/7
 - 49s - loss: 0.3002 - acc: 0.9422 - val_loss: 1.0384 - val_acc: 0.6785
Epoch 4/7
 - 49s - loss: 0.2359 - acc: 0.9663 - val_loss: 0.7805 - val_acc: 0.7201
Epoch 5/7
 - 49s - loss: 0.1928 - acc: 0.9779 - val_loss: 1.3404 - val_acc: 0.6837
Epoch 6/7
 - 49s - loss: 0.1637 - acc: 0.9848 - val_loss: 0.8112 - val_acc: 0.7332

Epoch 00006: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 7/7
 - 50s - loss: 0.1397 - acc: 0.9905 - val_loss: 0.8280 - val_acc: 0.7451
Test accuracy:0.633
current auc_score ------------------> 0.708
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_22[0][0]              
==================================================================================================
Total params: 194,872
Trainable params: 191,068
Non-trainable params: 3,804
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       194872      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 115,803,449
Trainable params: 115,798,621
Non-trainable params: 4,828
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 60s - loss: 0.5776 - acc: 0.8046 - val_loss: 0.3943 - val_acc: 0.8980
Epoch 2/7
 - 51s - loss: 0.3436 - acc: 0.9242 - val_loss: 0.2469 - val_acc: 0.9667
Epoch 3/7
 - 50s - loss: 0.2580 - acc: 0.9588 - val_loss: 0.1982 - val_acc: 0.9804
Epoch 4/7
 - 50s - loss: 0.1978 - acc: 0.9780 - val_loss: 0.1531 - val_acc: 0.9922
Epoch 5/7
 - 50s - loss: 0.1647 - acc: 0.9860 - val_loss: 0.1360 - val_acc: 0.9946
Epoch 6/7
 - 50s - loss: 0.1437 - acc: 0.9898 - val_loss: 0.1157 - val_acc: 0.9959
Epoch 7/7
 - 50s - loss: 0.1254 - acc: 0.9918 - val_loss: 0.1060 - val_acc: 0.9954
Test accuracy:0.725
current auc_score ------------------> 0.918
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_22[0][0]              
==================================================================================================
Total params: 194,872
Trainable params: 191,068
Non-trainable params: 3,804
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       194872      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 115,803,449
Trainable params: 115,798,621
Non-trainable params: 4,828
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 61s - loss: 0.7000 - acc: 0.7308 - val_loss: 0.5451 - val_acc: 0.8136
Epoch 2/7
 - 51s - loss: 0.4447 - acc: 0.8755 - val_loss: 0.3166 - val_acc: 0.9423
Epoch 3/7
 - 51s - loss: 0.3120 - acc: 0.9388 - val_loss: 0.2664 - val_acc: 0.9539
Epoch 4/7
 - 51s - loss: 0.2394 - acc: 0.9653 - val_loss: 0.2082 - val_acc: 0.9794
Epoch 5/7
 - 51s - loss: 0.1946 - acc: 0.9780 - val_loss: 0.1617 - val_acc: 0.9912
Epoch 6/7
 - 51s - loss: 0.1622 - acc: 0.9858 - val_loss: 0.1403 - val_acc: 0.9921
Epoch 7/7
 - 51s - loss: 0.1418 - acc: 0.9895 - val_loss: 0.1126 - val_acc: 0.9957
Test accuracy:0.718
current auc_score ------------------> 0.817
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_22[0][0]              
==================================================================================================
Total params: 194,872
Trainable params: 191,068
Non-trainable params: 3,804
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       194872      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 115,803,449
Trainable params: 115,798,621
Non-trainable params: 4,828
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 58s - loss: 0.6179 - acc: 0.7821 - val_loss: 0.4190 - val_acc: 0.8872
Epoch 2/7
 - 49s - loss: 0.3790 - acc: 0.9054 - val_loss: 0.2934 - val_acc: 0.9518
Epoch 3/7
 - 49s - loss: 0.2803 - acc: 0.9508 - val_loss: 0.2101 - val_acc: 0.9778
Epoch 4/7
 - 49s - loss: 0.2222 - acc: 0.9723 - val_loss: 0.1790 - val_acc: 0.9882
Epoch 5/7
 - 49s - loss: 0.1868 - acc: 0.9809 - val_loss: 0.1608 - val_acc: 0.9821
Epoch 6/7
 - 49s - loss: 0.1560 - acc: 0.9868 - val_loss: 0.1331 - val_acc: 0.9942
Epoch 7/7
 - 49s - loss: 0.1363 - acc: 0.9900 - val_loss: 0.1103 - val_acc: 0.9956
Test accuracy:0.632
current auc_score ------------------> 0.883
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 112896)       0           activation_22[0][0]              
==================================================================================================
Total params: 194,872
Trainable params: 191,068
Non-trainable params: 3,804
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 112896)       194872      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 225792)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          115606016   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 115,803,449
Trainable params: 115,798,621
Non-trainable params: 4,828
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 59s - loss: 0.6579 - acc: 0.7594 - val_loss: 1.3373 - val_acc: 0.5439
Epoch 2/7
 - 49s - loss: 0.4030 - acc: 0.8978 - val_loss: 1.8151 - val_acc: 0.5373
Epoch 3/7
 - 49s - loss: 0.2890 - acc: 0.9482 - val_loss: 0.7374 - val_acc: 0.6826
Epoch 4/7
 - 49s - loss: 0.2171 - acc: 0.9740 - val_loss: 2.1319 - val_acc: 0.5223
Epoch 5/7
 - 49s - loss: 0.1808 - acc: 0.9835 - val_loss: 3.0845 - val_acc: 0.5036

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/7
 - 49s - loss: 0.1485 - acc: 0.9916 - val_loss: 3.2121 - val_acc: 0.5064
Epoch 7/7
 - 49s - loss: 0.1360 - acc: 0.9946 - val_loss: 3.2725 - val_acc: 0.5085

Epoch 00007: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00007: early stopping
Test accuracy:0.504
current auc_score ------------------> 0.734
accuracies:  [0.6325268817204301, 0.7248655913978495, 0.7182795698924731, 0.6321236559139785, 0.5041666666666667]
aucs:  [0.7078617831541218, 0.9178857382356341, 0.8167941741819864, 0.8831219288357035, 0.7335955023702163]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_22[0][0]              
==================================================================================================
Total params: 337,072
Trainable params: 332,128
Non-trainable params: 4,944
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       337072      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 151,335,089
Trainable params: 151,329,121
Non-trainable params: 5,968
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 67s - loss: 0.7632 - acc: 0.7185 - val_loss: 2.3072 - val_acc: 0.5035
Epoch 2/7
 - 57s - loss: 0.5174 - acc: 0.8533 - val_loss: 1.6976 - val_acc: 0.5123
Epoch 3/7
 - 57s - loss: 0.3642 - acc: 0.9351 - val_loss: 1.3823 - val_acc: 0.5117
Epoch 4/7
 - 57s - loss: 0.2813 - acc: 0.9634 - val_loss: 0.9210 - val_acc: 0.6767
Epoch 5/7
 - 57s - loss: 0.2260 - acc: 0.9788 - val_loss: 1.4861 - val_acc: 0.5831
Epoch 6/7
 - 57s - loss: 0.1946 - acc: 0.9825 - val_loss: 1.3758 - val_acc: 0.5823

Epoch 00006: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 7/7
 - 57s - loss: 0.1594 - acc: 0.9926 - val_loss: 1.1254 - val_acc: 0.6522
Test accuracy:0.676
current auc_score ------------------> 0.731
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_22[0][0]              
==================================================================================================
Total params: 337,072
Trainable params: 332,128
Non-trainable params: 4,944
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       337072      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 151,335,089
Trainable params: 151,329,121
Non-trainable params: 5,968
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 67s - loss: 0.7361 - acc: 0.7391 - val_loss: 1.8053 - val_acc: 0.5173
Epoch 2/7
 - 57s - loss: 0.4894 - acc: 0.8719 - val_loss: 2.7483 - val_acc: 0.5065
Epoch 3/7
 - 57s - loss: 0.3495 - acc: 0.9397 - val_loss: 0.2704 - val_acc: 0.9736
Epoch 4/7
 - 57s - loss: 0.2693 - acc: 0.9668 - val_loss: 0.2009 - val_acc: 0.9849
Epoch 5/7
 - 57s - loss: 0.2209 - acc: 0.9789 - val_loss: 0.1851 - val_acc: 0.9911
Epoch 6/7
 - 56s - loss: 0.1882 - acc: 0.9843 - val_loss: 0.1545 - val_acc: 0.9949
Epoch 7/7
 - 56s - loss: 0.1613 - acc: 0.9885 - val_loss: 0.1287 - val_acc: 0.9964
Test accuracy:0.711
current auc_score ------------------> 0.895
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_22[0][0]              
==================================================================================================
Total params: 337,072
Trainable params: 332,128
Non-trainable params: 4,944
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       337072      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 151,335,089
Trainable params: 151,329,121
Non-trainable params: 5,968
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 69s - loss: 0.6558 - acc: 0.7804 - val_loss: 0.5091 - val_acc: 0.8794
Epoch 2/7
 - 58s - loss: 0.4050 - acc: 0.9159 - val_loss: 0.2866 - val_acc: 0.9655
Epoch 3/7
 - 58s - loss: 0.2952 - acc: 0.9611 - val_loss: 0.2386 - val_acc: 0.9799
Epoch 4/7
 - 58s - loss: 0.2345 - acc: 0.9779 - val_loss: 0.1794 - val_acc: 0.9917
Epoch 5/7
 - 58s - loss: 0.1909 - acc: 0.9871 - val_loss: 0.1628 - val_acc: 0.9937
Epoch 6/7
 - 58s - loss: 0.1661 - acc: 0.9898 - val_loss: 0.1422 - val_acc: 0.9949
Epoch 7/7
 - 58s - loss: 0.1426 - acc: 0.9928 - val_loss: 0.1143 - val_acc: 0.9976
Test accuracy:0.743
current auc_score ------------------> 0.897
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_22[0][0]              
==================================================================================================
Total params: 337,072
Trainable params: 332,128
Non-trainable params: 4,944
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       337072      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 151,335,089
Trainable params: 151,329,121
Non-trainable params: 5,968
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 67s - loss: 0.6498 - acc: 0.7915 - val_loss: 1.8060 - val_acc: 0.5108
Epoch 2/7
 - 56s - loss: 0.3986 - acc: 0.9184 - val_loss: 2.1361 - val_acc: 0.5044
Epoch 3/7
 - 56s - loss: 0.2866 - acc: 0.9629 - val_loss: 3.6843 - val_acc: 0.5036

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 57s - loss: 0.2238 - acc: 0.9833 - val_loss: 3.9250 - val_acc: 0.5035
Epoch 5/7
 - 56s - loss: 0.2005 - acc: 0.9891 - val_loss: 2.6538 - val_acc: 0.5075

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.499
current auc_score ------------------> 0.738
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 147456)       0           activation_22[0][0]              
==================================================================================================
Total params: 337,072
Trainable params: 332,128
Non-trainable params: 4,944
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 147456)       337072      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 294912)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          150995456   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 151,335,089
Trainable params: 151,329,121
Non-trainable params: 5,968
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 68s - loss: 0.6892 - acc: 0.7667 - val_loss: 0.4998 - val_acc: 0.8702
Epoch 2/7
 - 58s - loss: 0.4374 - acc: 0.8989 - val_loss: 0.3369 - val_acc: 0.9602
Epoch 3/7
 - 58s - loss: 0.3084 - acc: 0.9573 - val_loss: 0.2602 - val_acc: 0.9779
Epoch 4/7
 - 58s - loss: 0.2425 - acc: 0.9767 - val_loss: 0.2137 - val_acc: 0.9868
Epoch 5/7
 - 58s - loss: 0.2013 - acc: 0.9848 - val_loss: 0.1630 - val_acc: 0.9926
Epoch 6/7
 - 58s - loss: 0.1730 - acc: 0.9890 - val_loss: 0.1370 - val_acc: 0.9965
Epoch 7/7
 - 58s - loss: 0.1467 - acc: 0.9927 - val_loss: 0.1232 - val_acc: 0.9980
Test accuracy:0.707
current auc_score ------------------> 0.873
accuracies:  [0.6763440860215054, 0.7112903225806452, 0.7430107526881721, 0.4991935483870968, 0.7071236559139785]
aucs:  [0.730942991964389, 0.8953944820210428, 0.8969273181870736, 0.7381445470574632, 0.8728811495548618]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 182016)       0           activation_22[0][0]              
==================================================================================================
Total params: 518,152
Trainable params: 512,068
Non-trainable params: 6,084
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 182016)       518152      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 364032)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          186384896   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 186,905,609
Trainable params: 186,898,501
Non-trainable params: 7,108
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 75s - loss: 0.7409 - acc: 0.7616 - val_loss: 0.5864 - val_acc: 0.8382
Epoch 2/7
 - 64s - loss: 0.4809 - acc: 0.8992 - val_loss: 0.3647 - val_acc: 0.9518
Epoch 3/7
 - 63s - loss: 0.3523 - acc: 0.9529 - val_loss: 0.2977 - val_acc: 0.9726
Epoch 4/7
 - 63s - loss: 0.2813 - acc: 0.9727 - val_loss: 0.2170 - val_acc: 0.9890
Epoch 5/7
 - 64s - loss: 0.2372 - acc: 0.9798 - val_loss: 0.1849 - val_acc: 0.9932
Epoch 6/7
 - 64s - loss: 0.2003 - acc: 0.9860 - val_loss: 0.1554 - val_acc: 0.9971
Epoch 7/7
 - 64s - loss: 0.1683 - acc: 0.9896 - val_loss: 0.1393 - val_acc: 0.9959
Test accuracy:0.699
current auc_score ------------------> 0.884
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 182016)       0           activation_22[0][0]              
==================================================================================================
Total params: 518,152
Trainable params: 512,068
Non-trainable params: 6,084
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 182016)       518152      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 364032)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          186384896   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 186,905,609
Trainable params: 186,898,501
Non-trainable params: 7,108
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 75s - loss: 0.7653 - acc: 0.7474 - val_loss: 0.5494 - val_acc: 0.8745
Epoch 2/7
 - 63s - loss: 0.4932 - acc: 0.8956 - val_loss: 0.5839 - val_acc: 0.8611
Epoch 3/7
 - 63s - loss: 0.3626 - acc: 0.9513 - val_loss: 0.2834 - val_acc: 0.9821
Epoch 4/7
 - 63s - loss: 0.2820 - acc: 0.9745 - val_loss: 0.2153 - val_acc: 0.9910
Epoch 5/7
 - 63s - loss: 0.2296 - acc: 0.9846 - val_loss: 0.1933 - val_acc: 0.9936
Epoch 6/7
 - 63s - loss: 0.1958 - acc: 0.9883 - val_loss: 0.1591 - val_acc: 0.9955
Epoch 7/7
 - 63s - loss: 0.1670 - acc: 0.9908 - val_loss: 0.1507 - val_acc: 0.9944
Test accuracy:0.698
current auc_score ------------------> 0.869
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 182016)       0           activation_22[0][0]              
==================================================================================================
Total params: 518,152
Trainable params: 512,068
Non-trainable params: 6,084
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 182016)       518152      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 364032)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          186384896   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 186,905,609
Trainable params: 186,898,501
Non-trainable params: 7,108
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 75s - loss: 0.7549 - acc: 0.7585 - val_loss: 1.7810 - val_acc: 0.5328
Epoch 2/7
 - 63s - loss: 0.4712 - acc: 0.9041 - val_loss: 2.2914 - val_acc: 0.5513
Epoch 3/7
 - 63s - loss: 0.3415 - acc: 0.9575 - val_loss: 2.8450 - val_acc: 0.5143

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 63s - loss: 0.2688 - acc: 0.9822 - val_loss: 2.3035 - val_acc: 0.5558
Epoch 5/7
 - 63s - loss: 0.2420 - acc: 0.9883 - val_loss: 2.6983 - val_acc: 0.5418

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 6/7
 - 63s - loss: 0.2229 - acc: 0.9921 - val_loss: 2.4329 - val_acc: 0.5738
Epoch 7/7
 - 63s - loss: 0.2159 - acc: 0.9933 - val_loss: 2.2377 - val_acc: 0.5959

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Test accuracy:0.631
current auc_score ------------------> 0.681
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 182016)       0           activation_22[0][0]              
==================================================================================================
Total params: 518,152
Trainable params: 512,068
Non-trainable params: 6,084
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 182016)       518152      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 364032)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          186384896   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 186,905,609
Trainable params: 186,898,501
Non-trainable params: 7,108
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 75s - loss: 0.7323 - acc: 0.7679 - val_loss: 0.4954 - val_acc: 0.9042
Epoch 2/7
 - 64s - loss: 0.4475 - acc: 0.9175 - val_loss: 0.3531 - val_acc: 0.9684
Epoch 3/7
 - 64s - loss: 0.3368 - acc: 0.9602 - val_loss: 0.2643 - val_acc: 0.9853
Epoch 4/7
 - 64s - loss: 0.2673 - acc: 0.9791 - val_loss: 0.2276 - val_acc: 0.9915
Epoch 5/7
 - 64s - loss: 0.2180 - acc: 0.9866 - val_loss: 0.1865 - val_acc: 0.9951
Epoch 6/7
 - 63s - loss: 0.1833 - acc: 0.9917 - val_loss: 0.1625 - val_acc: 0.9936
Epoch 7/7
 - 64s - loss: 0.1556 - acc: 0.9941 - val_loss: 0.1317 - val_acc: 0.9970
Test accuracy:0.727
current auc_score ------------------> 0.868
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 182016)       0           activation_22[0][0]              
==================================================================================================
Total params: 518,152
Trainable params: 512,068
Non-trainable params: 6,084
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 182016)       518152      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 364032)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          186384896   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 186,905,609
Trainable params: 186,898,501
Non-trainable params: 7,108
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 75s - loss: 0.7359 - acc: 0.7661 - val_loss: 1.4001 - val_acc: 0.5269
Epoch 2/7
 - 64s - loss: 0.4840 - acc: 0.8973 - val_loss: 2.6444 - val_acc: 0.5035
Epoch 3/7
 - 64s - loss: 0.3554 - acc: 0.9542 - val_loss: 1.4322 - val_acc: 0.5417

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 63s - loss: 0.2850 - acc: 0.9765 - val_loss: 1.9925 - val_acc: 0.5207
Epoch 5/7
 - 63s - loss: 0.2562 - acc: 0.9847 - val_loss: 1.6284 - val_acc: 0.5737

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 6/7
 - 63s - loss: 0.2374 - acc: 0.9886 - val_loss: 1.8622 - val_acc: 0.5487
Epoch 7/7
 - 63s - loss: 0.2280 - acc: 0.9905 - val_loss: 1.4898 - val_acc: 0.5884

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Test accuracy:0.562
current auc_score ------------------> 0.684
accuracies:  [0.6987903225806451, 0.697983870967742, 0.6306451612903226, 0.7268817204301076, 0.5616935483870967]
aucs:  [0.8844017371950514, 0.8692750607006589, 0.681174810671754, 0.867733553011909, 0.6837453390565383]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_22[0][0]              
==================================================================================================
Total params: 738,112
Trainable params: 730,888
Non-trainable params: 7,224
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       738112      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 222,515,009
Trainable params: 222,506,761
Non-trainable params: 8,248
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 87s - loss: 0.7826 - acc: 0.7663 - val_loss: 0.5398 - val_acc: 0.9001
Epoch 2/7
 - 74s - loss: 0.4922 - acc: 0.9170 - val_loss: 0.4125 - val_acc: 0.9538
Epoch 3/7
 - 74s - loss: 0.3610 - acc: 0.9642 - val_loss: 0.3049 - val_acc: 0.9824
Epoch 4/7
 - 74s - loss: 0.2873 - acc: 0.9813 - val_loss: 0.2331 - val_acc: 0.9931
Epoch 5/7
 - 74s - loss: 0.2333 - acc: 0.9894 - val_loss: 0.1970 - val_acc: 0.9962
Epoch 6/7
 - 74s - loss: 0.1950 - acc: 0.9928 - val_loss: 0.1710 - val_acc: 0.9974
Epoch 7/7
 - 74s - loss: 0.1620 - acc: 0.9952 - val_loss: 0.1451 - val_acc: 0.9962
Test accuracy:0.744
current auc_score ------------------> 0.868
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_22[0][0]              
==================================================================================================
Total params: 738,112
Trainable params: 730,888
Non-trainable params: 7,224
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       738112      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 222,515,009
Trainable params: 222,506,761
Non-trainable params: 8,248
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 87s - loss: 0.8096 - acc: 0.7550 - val_loss: 0.6002 - val_acc: 0.8721
Epoch 2/7
 - 74s - loss: 0.5357 - acc: 0.8939 - val_loss: 0.4376 - val_acc: 0.9384
Epoch 3/7
 - 74s - loss: 0.3888 - acc: 0.9530 - val_loss: 0.3436 - val_acc: 0.9667
Epoch 4/7
 - 74s - loss: 0.3052 - acc: 0.9763 - val_loss: 0.2694 - val_acc: 0.9858
Epoch 5/7
 - 74s - loss: 0.2581 - acc: 0.9832 - val_loss: 0.2122 - val_acc: 0.9923
Epoch 6/7
 - 74s - loss: 0.2161 - acc: 0.9881 - val_loss: 0.1773 - val_acc: 0.9961
Epoch 7/7
 - 74s - loss: 0.1796 - acc: 0.9910 - val_loss: 0.1483 - val_acc: 0.9972
Test accuracy:0.722
current auc_score ------------------> 0.890
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_22[0][0]              
==================================================================================================
Total params: 738,112
Trainable params: 730,888
Non-trainable params: 7,224
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       738112      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 222,515,009
Trainable params: 222,506,761
Non-trainable params: 8,248
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 86s - loss: 0.7828 - acc: 0.7678 - val_loss: 3.0797 - val_acc: 0.5035
Epoch 2/7
 - 74s - loss: 0.4871 - acc: 0.9146 - val_loss: 2.1928 - val_acc: 0.5344
Epoch 3/7
 - 74s - loss: 0.3573 - acc: 0.9634 - val_loss: 1.9202 - val_acc: 0.5118
Epoch 4/7
 - 74s - loss: 0.2900 - acc: 0.9771 - val_loss: 3.9297 - val_acc: 0.5036
Epoch 5/7
 - 74s - loss: 0.2289 - acc: 0.9892 - val_loss: 5.1821 - val_acc: 0.5035

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/7
 - 74s - loss: 0.1940 - acc: 0.9947 - val_loss: 4.6611 - val_acc: 0.5035
Epoch 00006: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.584
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_22[0][0]              
==================================================================================================
Total params: 738,112
Trainable params: 730,888
Non-trainable params: 7,224
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       738112      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 222,515,009
Trainable params: 222,506,761
Non-trainable params: 8,248
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 86s - loss: 0.7350 - acc: 0.7920 - val_loss: 0.5319 - val_acc: 0.9068
Epoch 2/7
 - 74s - loss: 0.4711 - acc: 0.9236 - val_loss: 0.3491 - val_acc: 0.9728
Epoch 3/7
 - 74s - loss: 0.3557 - acc: 0.9642 - val_loss: 0.2816 - val_acc: 0.9864
Epoch 4/7
 - 74s - loss: 0.2832 - acc: 0.9790 - val_loss: 0.2476 - val_acc: 0.9883
Epoch 5/7
 - 74s - loss: 0.2297 - acc: 0.9878 - val_loss: 0.2067 - val_acc: 0.9905
Epoch 6/7
 - 74s - loss: 0.1935 - acc: 0.9904 - val_loss: 0.1672 - val_acc: 0.9945
Epoch 7/7
 - 74s - loss: 0.1622 - acc: 0.9936 - val_loss: 0.1460 - val_acc: 0.9969
Test accuracy:0.724
current auc_score ------------------> 0.873
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [10]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_22[0][0]              
==================================================================================================
Total params: 738,112
Trainable params: 730,888
Non-trainable params: 7,224
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       738112      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_11[0][0]                 
==================================================================================================
Total params: 222,515,009
Trainable params: 222,506,761
Non-trainable params: 8,248
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 86s - loss: 0.7892 - acc: 0.7630 - val_loss: 0.6387 - val_acc: 0.8298
Epoch 2/7
 - 74s - loss: 0.4914 - acc: 0.9117 - val_loss: 0.4169 - val_acc: 0.9447
Epoch 3/7
 - 74s - loss: 0.3655 - acc: 0.9605 - val_loss: 0.3140 - val_acc: 0.9778
Epoch 4/7
 - 74s - loss: 0.2872 - acc: 0.9802 - val_loss: 0.2318 - val_acc: 0.9947
Epoch 5/7
 - 74s - loss: 0.2696 - acc: 0.9767 - val_loss: 0.2126 - val_acc: 0.9913
Epoch 6/7
 - 74s - loss: 0.2129 - acc: 0.9897 - val_loss: 0.1892 - val_acc: 0.9962
Epoch 7/7
 - 74s - loss: 0.1824 - acc: 0.9922 - val_loss: 0.1525 - val_acc: 0.9972
Test accuracy:0.772
current auc_score ------------------> 0.889
accuracies:  [0.744489247311828, 0.7223118279569892, 0.5, 0.7239247311827957, 0.7723118279569893]
aucs:  [0.868437174817898, 0.8903603017689906, 0.583688143137935, 0.8733839172158631, 0.8889790004624811]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 24, 24, 24)   1824        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 24, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 6, 24, 24)    0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 82, 24, 24)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 82, 24, 24)   328         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 82, 24, 24)   0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 24, 24, 24)   1968        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 24, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 6, 24, 24)    0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 88, 24, 24)   0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_26[0][0]              
==================================================================================================
Total params: 34,368
Trainable params: 32,408
Non-trainable params: 1,960
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        34368       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 51,941,953
Trainable params: 51,938,969
Non-trainable params: 2,984
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 47s - loss: 0.5765 - acc: 0.7580 - val_loss: 2.1982 - val_acc: 0.5046
Epoch 2/7
 - 38s - loss: 0.3303 - acc: 0.8899 - val_loss: 0.2291 - val_acc: 0.9380
Epoch 3/7
 - 38s - loss: 0.2354 - acc: 0.9384 - val_loss: 0.1609 - val_acc: 0.9715
Epoch 4/7
 - 38s - loss: 0.1706 - acc: 0.9644 - val_loss: 0.1143 - val_acc: 0.9876
Epoch 5/7
 - 38s - loss: 0.1374 - acc: 0.9765 - val_loss: 0.0961 - val_acc: 0.9898
Epoch 6/7
 - 38s - loss: 0.1117 - acc: 0.9836 - val_loss: 0.0817 - val_acc: 0.9947
Epoch 7/7
 - 39s - loss: 0.0961 - acc: 0.9871 - val_loss: 0.0798 - val_acc: 0.9900
Test accuracy:0.729
current auc_score ------------------> 0.853
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 24, 24, 24)   1824        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 24, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 6, 24, 24)    0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 82, 24, 24)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 82, 24, 24)   328         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 82, 24, 24)   0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 24, 24, 24)   1968        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 24, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 6, 24, 24)    0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 88, 24, 24)   0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_26[0][0]              
==================================================================================================
Total params: 34,368
Trainable params: 32,408
Non-trainable params: 1,960
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        34368       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 51,941,953
Trainable params: 51,938,969
Non-trainable params: 2,984
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 49s - loss: 0.5070 - acc: 0.8017 - val_loss: 0.3293 - val_acc: 0.8893
Epoch 2/7
 - 38s - loss: 0.2843 - acc: 0.9128 - val_loss: 0.1812 - val_acc: 0.9625
Epoch 3/7
 - 38s - loss: 0.1882 - acc: 0.9570 - val_loss: 0.1316 - val_acc: 0.9819
Epoch 4/7
 - 38s - loss: 0.1425 - acc: 0.9741 - val_loss: 0.1029 - val_acc: 0.9881
Epoch 5/7
 - 39s - loss: 0.1172 - acc: 0.9824 - val_loss: 0.0843 - val_acc: 0.9932
Epoch 6/7
 - 38s - loss: 0.0992 - acc: 0.9868 - val_loss: 0.0744 - val_acc: 0.9959
Epoch 7/7
 - 38s - loss: 0.0864 - acc: 0.9897 - val_loss: 0.0652 - val_acc: 0.9975
Test accuracy:0.715
current auc_score ------------------> 0.864
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 24, 24, 24)   1824        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 24, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 6, 24, 24)    0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 82, 24, 24)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 82, 24, 24)   328         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 82, 24, 24)   0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 24, 24, 24)   1968        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 24, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 6, 24, 24)    0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 88, 24, 24)   0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_26[0][0]              
==================================================================================================
Total params: 34,368
Trainable params: 32,408
Non-trainable params: 1,960
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        34368       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 51,941,953
Trainable params: 51,938,969
Non-trainable params: 2,984
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 47s - loss: 0.5791 - acc: 0.7569 - val_loss: 0.3846 - val_acc: 0.8686
Epoch 2/7
 - 38s - loss: 0.3287 - acc: 0.8917 - val_loss: 0.2337 - val_acc: 0.9337
Epoch 3/7
 - 38s - loss: 0.2207 - acc: 0.9460 - val_loss: 0.1467 - val_acc: 0.9813
Epoch 4/7
 - 38s - loss: 0.1656 - acc: 0.9667 - val_loss: 0.1475 - val_acc: 0.9753
Epoch 5/7
 - 38s - loss: 0.1329 - acc: 0.9783 - val_loss: 0.0916 - val_acc: 0.9920
Epoch 6/7
 - 38s - loss: 0.1078 - acc: 0.9860 - val_loss: 0.0863 - val_acc: 0.9940
Epoch 7/7
 - 38s - loss: 0.0950 - acc: 0.9879 - val_loss: 0.0717 - val_acc: 0.9945
Test accuracy:0.755
current auc_score ------------------> 0.879
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 24, 24, 24)   1824        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 24, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 6, 24, 24)    0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 82, 24, 24)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 82, 24, 24)   328         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 82, 24, 24)   0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 24, 24, 24)   1968        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 24, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 6, 24, 24)    0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 88, 24, 24)   0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_26[0][0]              
==================================================================================================
Total params: 34,368
Trainable params: 32,408
Non-trainable params: 1,960
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        34368       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 51,941,953
Trainable params: 51,938,969
Non-trainable params: 2,984
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 48s - loss: 0.5017 - acc: 0.8041 - val_loss: 0.4013 - val_acc: 0.8434
Epoch 2/7
 - 38s - loss: 0.2748 - acc: 0.9191 - val_loss: 0.2140 - val_acc: 0.9538
Epoch 3/7
 - 39s - loss: 0.1927 - acc: 0.9557 - val_loss: 0.1431 - val_acc: 0.9785
Epoch 4/7
 - 38s - loss: 0.1480 - acc: 0.9732 - val_loss: 0.1112 - val_acc: 0.9887
Epoch 5/7
 - 38s - loss: 0.1176 - acc: 0.9830 - val_loss: 0.0941 - val_acc: 0.9933
Epoch 6/7
 - 38s - loss: 0.1025 - acc: 0.9860 - val_loss: 0.0821 - val_acc: 0.9951
Epoch 7/7
 - 38s - loss: 0.0872 - acc: 0.9906 - val_loss: 0.0647 - val_acc: 0.9974
Test accuracy:0.650
current auc_score ------------------> 0.853
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  6  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 24, 24)   384         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 24, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 6, 24, 24)    0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 24, 24)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 22, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 24, 24)   528         activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 24, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 6, 24, 24)    0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 28, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 24, 24)   672         activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 24, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 6, 24, 24)    0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 34, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 24, 24, 24)   816         activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 6, 24, 24)    0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 40, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 40, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 24, 24, 24)   960         activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 6, 24, 24)    0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 46, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 46, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 24, 24, 24)   1104        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 6, 24, 24)    0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 52, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 52, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 24, 24, 24)   1248        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 24, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 6, 24, 24)    0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 58, 24, 24)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 58, 24, 24)   232         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 24, 24)   0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 24, 24, 24)   1392        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 24, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 6, 24, 24)    0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 64, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 64, 24, 24)   0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 24, 24, 24)   1536        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 24, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 6, 24, 24)    0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 70, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 70, 24, 24)   0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 24, 24, 24)   1680        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 24, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 6, 24, 24)    0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 76, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 76, 24, 24)   304         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 76, 24, 24)   0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 24, 24, 24)   1824        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 24, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 6, 24, 24)    0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 82, 24, 24)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 82, 24, 24)   328         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 82, 24, 24)   0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 24, 24, 24)   1968        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 24, 24, 24)   96          dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 24, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 6, 24, 24)    1296        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 6, 24, 24)    0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 88, 24, 24)   0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 88, 24, 24)   352         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 88, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 50688)        0           activation_26[0][0]              
==================================================================================================
Total params: 34,368
Trainable params: 32,408
Non-trainable params: 1,960
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 50688)        34368       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 101376)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          51905024    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 51,941,953
Trainable params: 51,938,969
Non-trainable params: 2,984
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 50s - loss: 0.5182 - acc: 0.7929 - val_loss: 0.3533 - val_acc: 0.8798
Epoch 2/7
 - 41s - loss: 0.2948 - acc: 0.9073 - val_loss: 0.2703 - val_acc: 0.9242
Epoch 3/7
 - 40s - loss: 0.2008 - acc: 0.9540 - val_loss: 0.1527 - val_acc: 0.9822
Epoch 4/7
 - 40s - loss: 0.1556 - acc: 0.9709 - val_loss: 0.1124 - val_acc: 0.9885
Epoch 5/7
 - 40s - loss: 0.1238 - acc: 0.9807 - val_loss: 0.0923 - val_acc: 0.9936
Epoch 6/7
 - 41s - loss: 0.1051 - acc: 0.9850 - val_loss: 0.0756 - val_acc: 0.9945
Epoch 7/7
 - 41s - loss: 0.0884 - acc: 0.9898 - val_loss: 0.0649 - val_acc: 0.9952
Test accuracy:0.703
current auc_score ------------------> 0.909
accuracies:  [0.7291666666666666, 0.7150537634408602, 0.7545698924731182, 0.6502688172043011, 0.7032258064516129]
aucs:  [0.8534046566077003, 0.8636020782749451, 0.879251611457972, 0.8525437911897329, 0.9091693042548272]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 48, 24, 24)   6528        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 48, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 12, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 148, 24, 24)  592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 148, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 48, 24, 24)   7104        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 48, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 12, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 160, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_26[0][0]              
==================================================================================================
Total params: 117,168
Trainable params: 113,696
Non-trainable params: 3,472
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        117168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 94,492,081
Trainable params: 94,487,585
Non-trainable params: 4,496
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 59s - loss: 0.6263 - acc: 0.7604 - val_loss: 2.3592 - val_acc: 0.5079
Epoch 2/7
 - 48s - loss: 0.3878 - acc: 0.8893 - val_loss: 1.0703 - val_acc: 0.5976
Epoch 3/7
 - 48s - loss: 0.2763 - acc: 0.9447 - val_loss: 4.1205 - val_acc: 0.5035
Epoch 4/7
 - 48s - loss: 0.2194 - acc: 0.9629 - val_loss: 1.8972 - val_acc: 0.5871

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/7
 - 48s - loss: 0.1731 - acc: 0.9803 - val_loss: 1.9163 - val_acc: 0.5681
Epoch 6/7
 - 48s - loss: 0.1531 - acc: 0.9865 - val_loss: 1.8384 - val_acc: 0.5791

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00006: early stopping
Test accuracy:0.578
current auc_score ------------------> 0.710
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 48, 24, 24)   6528        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 48, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 12, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 148, 24, 24)  592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 148, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 48, 24, 24)   7104        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 48, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 12, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 160, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_26[0][0]              
==================================================================================================
Total params: 117,168
Trainable params: 113,696
Non-trainable params: 3,472
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        117168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 94,492,081
Trainable params: 94,487,585
Non-trainable params: 4,496
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 59s - loss: 0.6497 - acc: 0.7450 - val_loss: 0.5357 - val_acc: 0.7882
Epoch 2/7
 - 48s - loss: 0.4168 - acc: 0.8709 - val_loss: 0.3135 - val_acc: 0.9361
Epoch 3/7
 - 48s - loss: 0.3078 - acc: 0.9296 - val_loss: 0.2337 - val_acc: 0.9546
Epoch 4/7
 - 48s - loss: 0.2442 - acc: 0.9550 - val_loss: 0.2072 - val_acc: 0.9669
Epoch 5/7
 - 48s - loss: 0.1992 - acc: 0.9703 - val_loss: 0.1566 - val_acc: 0.9832
Epoch 6/7
 - 48s - loss: 0.1712 - acc: 0.9778 - val_loss: 0.1284 - val_acc: 0.9898
Epoch 7/7
 - 48s - loss: 0.1505 - acc: 0.9817 - val_loss: 0.1099 - val_acc: 0.9961
Test accuracy:0.723
current auc_score ------------------> 0.909
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 48, 24, 24)   6528        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 48, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 12, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 148, 24, 24)  592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 148, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 48, 24, 24)   7104        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 48, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 12, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 160, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_26[0][0]              
==================================================================================================
Total params: 117,168
Trainable params: 113,696
Non-trainable params: 3,472
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        117168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 94,492,081
Trainable params: 94,487,585
Non-trainable params: 4,496
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 61s - loss: 0.6008 - acc: 0.7738 - val_loss: 0.4174 - val_acc: 0.8737
Epoch 2/7
 - 50s - loss: 0.3540 - acc: 0.9067 - val_loss: 0.2505 - val_acc: 0.9608
Epoch 3/7
 - 50s - loss: 0.2524 - acc: 0.9539 - val_loss: 0.1773 - val_acc: 0.9818
Epoch 4/7
 - 50s - loss: 0.2034 - acc: 0.9689 - val_loss: 0.1503 - val_acc: 0.9901
Epoch 5/7
 - 50s - loss: 0.1655 - acc: 0.9810 - val_loss: 0.1219 - val_acc: 0.9952
Epoch 6/7
 - 50s - loss: 0.1407 - acc: 0.9872 - val_loss: 0.1040 - val_acc: 0.9984
Epoch 7/7
 - 50s - loss: 0.1228 - acc: 0.9905 - val_loss: 0.0958 - val_acc: 0.9975
Test accuracy:0.652
current auc_score ------------------> 0.873
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 48, 24, 24)   6528        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 48, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 12, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 148, 24, 24)  592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 148, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 48, 24, 24)   7104        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 48, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 12, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 160, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_26[0][0]              
==================================================================================================
Total params: 117,168
Trainable params: 113,696
Non-trainable params: 3,472
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        117168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 94,492,081
Trainable params: 94,487,585
Non-trainable params: 4,496
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 60s - loss: 0.6390 - acc: 0.7513 - val_loss: 0.4341 - val_acc: 0.8760
Epoch 2/7
 - 50s - loss: 0.4039 - acc: 0.8785 - val_loss: 0.3095 - val_acc: 0.9265
Epoch 3/7
 - 49s - loss: 0.2826 - acc: 0.9402 - val_loss: 0.2069 - val_acc: 0.9768
Epoch 4/7
 - 49s - loss: 0.2133 - acc: 0.9668 - val_loss: 0.1494 - val_acc: 0.9880
Epoch 5/7
 - 49s - loss: 0.1743 - acc: 0.9787 - val_loss: 0.1282 - val_acc: 0.9898
Epoch 6/7
 - 49s - loss: 0.1440 - acc: 0.9867 - val_loss: 0.1070 - val_acc: 0.9942
Epoch 7/7
 - 49s - loss: 0.1296 - acc: 0.9875 - val_loss: 0.1216 - val_acc: 0.9955
Test accuracy:0.710
current auc_score ------------------> 0.868
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  12  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 24, 24)   768         activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 48, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 24, 24)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 28, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 24, 24)   1344        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 48, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 40, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 48, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 52, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 64, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 76, 24, 24)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 76, 24, 24)   0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 24, 24)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 88, 24, 24)   0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 48, 24, 24)   4224        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 100, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 100, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 48, 24, 24)   4800        activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 112, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 48, 24, 24)   5376        activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 48, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 124, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 48, 24, 24)   5952        activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 48, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 136, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 136, 24, 24)  544         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 136, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 48, 24, 24)   6528        activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 48, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 12, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 148, 24, 24)  592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 148, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 48, 24, 24)   7104        activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 48, 24, 24)   192         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 48, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 12, 24, 24)   5184        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 12, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 160, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 160, 24, 24)  640         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 160, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 92160)        0           activation_26[0][0]              
==================================================================================================
Total params: 117,168
Trainable params: 113,696
Non-trainable params: 3,472
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 92160)        117168      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 184320)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          94372352    merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 94,492,081
Trainable params: 94,487,585
Non-trainable params: 4,496
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 59s - loss: 0.6099 - acc: 0.7680 - val_loss: 1.0714 - val_acc: 0.5531
Epoch 2/7
 - 48s - loss: 0.3779 - acc: 0.8944 - val_loss: 2.1454 - val_acc: 0.5074
Epoch 3/7
 - 48s - loss: 0.2565 - acc: 0.9523 - val_loss: 2.6471 - val_acc: 0.5120

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 48s - loss: 0.1864 - acc: 0.9798 - val_loss: 1.9325 - val_acc: 0.5309
Epoch 5/7
 - 48s - loss: 0.1638 - acc: 0.9855 - val_loss: 1.9522 - val_acc: 0.5629

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 6/7
 - 48s - loss: 0.1481 - acc: 0.9899 - val_loss: 1.9958 - val_acc: 0.5579
Epoch 7/7
 - 48s - loss: 0.1413 - acc: 0.9928 - val_loss: 1.6698 - val_acc: 0.5910

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Test accuracy:0.601
current auc_score ------------------> 0.717
accuracies:  [0.5780913978494624, 0.723252688172043, 0.6524193548387097, 0.7100806451612903, 0.6005376344086022]
aucs:  [0.7095374465256099, 0.9093582350560757, 0.8725034686090879, 0.8680064169268125, 0.7167159859521331]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 72, 24, 24)   14112       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 72, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 214, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 214, 24, 24)  856         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 214, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 72, 24, 24)   15408       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 72, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 232, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_26[0][0]              
==================================================================================================
Total params: 250,080
Trainable params: 245,096
Non-trainable params: 4,984
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       250080      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 137,092,321
Trainable params: 137,086,313
Non-trainable params: 6,008
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 72s - loss: 0.6935 - acc: 0.7491 - val_loss: 0.5635 - val_acc: 0.8222
Epoch 2/7
 - 61s - loss: 0.4561 - acc: 0.8837 - val_loss: 0.3545 - val_acc: 0.9365
Epoch 3/7
 - 60s - loss: 0.3262 - acc: 0.9436 - val_loss: 0.2339 - val_acc: 0.9790
Epoch 4/7
 - 61s - loss: 0.2539 - acc: 0.9681 - val_loss: 0.2014 - val_acc: 0.9798
Epoch 5/7
 - 61s - loss: 0.2065 - acc: 0.9800 - val_loss: 0.1595 - val_acc: 0.9931
Epoch 6/7
 - 61s - loss: 0.1705 - acc: 0.9877 - val_loss: 0.1416 - val_acc: 0.9965
Epoch 7/7
 - 61s - loss: 0.1510 - acc: 0.9907 - val_loss: 0.1275 - val_acc: 0.9951
Test accuracy:0.726
current auc_score ------------------> 0.911
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 72, 24, 24)   14112       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 72, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 214, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 214, 24, 24)  856         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 214, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 72, 24, 24)   15408       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 72, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 232, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_26[0][0]              
==================================================================================================
Total params: 250,080
Trainable params: 245,096
Non-trainable params: 4,984
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       250080      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 137,092,321
Trainable params: 137,086,313
Non-trainable params: 6,008
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 72s - loss: 0.7139 - acc: 0.7392 - val_loss: 0.6201 - val_acc: 0.7708
Epoch 2/7
 - 60s - loss: 0.4473 - acc: 0.8848 - val_loss: 0.3494 - val_acc: 0.9341
Epoch 3/7
 - 60s - loss: 0.3270 - acc: 0.9427 - val_loss: 0.2446 - val_acc: 0.9753
Epoch 4/7
 - 60s - loss: 0.2552 - acc: 0.9692 - val_loss: 0.1921 - val_acc: 0.9868
Epoch 5/7
 - 60s - loss: 0.2109 - acc: 0.9801 - val_loss: 0.1653 - val_acc: 0.9900
Epoch 6/7
 - 60s - loss: 0.1802 - acc: 0.9864 - val_loss: 0.1442 - val_acc: 0.9930
Epoch 7/7
 - 59s - loss: 0.1558 - acc: 0.9900 - val_loss: 0.1348 - val_acc: 0.9949
Test accuracy:0.679
current auc_score ------------------> 0.845
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 72, 24, 24)   14112       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 72, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 214, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 214, 24, 24)  856         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 214, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 72, 24, 24)   15408       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 72, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 232, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_26[0][0]              
==================================================================================================
Total params: 250,080
Trainable params: 245,096
Non-trainable params: 4,984
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       250080      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 137,092,321
Trainable params: 137,086,313
Non-trainable params: 6,008
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 70s - loss: 0.6717 - acc: 0.7679 - val_loss: 0.9159 - val_acc: 0.6186
Epoch 2/7
 - 59s - loss: 0.4211 - acc: 0.8996 - val_loss: 3.1578 - val_acc: 0.5035
Epoch 3/7
 - 59s - loss: 0.3220 - acc: 0.9450 - val_loss: 1.2994 - val_acc: 0.5338

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 58s - loss: 0.2492 - acc: 0.9722 - val_loss: 1.9812 - val_acc: 0.5172
Epoch 5/7
 - 58s - loss: 0.2173 - acc: 0.9821 - val_loss: 2.4742 - val_acc: 0.5152

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.509
current auc_score ------------------> 0.681
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 72, 24, 24)   14112       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 72, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 214, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 214, 24, 24)  856         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 214, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 72, 24, 24)   15408       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 72, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 232, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_26[0][0]              
==================================================================================================
Total params: 250,080
Trainable params: 245,096
Non-trainable params: 4,984
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       250080      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 137,092,321
Trainable params: 137,086,313
Non-trainable params: 6,008
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 72s - loss: 0.7100 - acc: 0.7358 - val_loss: 0.5210 - val_acc: 0.8588
Epoch 2/7
 - 61s - loss: 0.4685 - acc: 0.8766 - val_loss: 0.3530 - val_acc: 0.9350
Epoch 3/7
 - 60s - loss: 0.3276 - acc: 0.9434 - val_loss: 0.2543 - val_acc: 0.9735
Epoch 4/7
 - 60s - loss: 0.2476 - acc: 0.9721 - val_loss: 0.1886 - val_acc: 0.9873
Epoch 5/7
 - 60s - loss: 0.2066 - acc: 0.9823 - val_loss: 0.1660 - val_acc: 0.9925
Epoch 6/7
 - 60s - loss: 0.1796 - acc: 0.9859 - val_loss: 0.1390 - val_acc: 0.9960
Epoch 7/7
 - 59s - loss: 0.1522 - acc: 0.9897 - val_loss: 0.1246 - val_acc: 0.9980
Test accuracy:0.732
current auc_score ------------------> 0.862
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  18  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 24, 24)   1152        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 72, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 24, 24)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 34, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 24, 24)   2448        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 72, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 52, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 24, 24)   3744        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 72, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 70, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 24, 24)   5040        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 24, 24)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 88, 24, 24)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 24, 24)   6336        activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 106, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 72, 24, 24)   7632        activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 124, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 124, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 72, 24, 24)   8928        activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 142, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 142, 24, 24)  568         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 142, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 72, 24, 24)   10224       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 160, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 160, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 72, 24, 24)   11520       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 178, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 178, 24, 24)  712         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 178, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 72, 24, 24)   12816       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 196, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 196, 24, 24)  784         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 196, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 72, 24, 24)   14112       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 72, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 214, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 214, 24, 24)  856         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 214, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 72, 24, 24)   15408       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 72, 24, 24)   288         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 72, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 18, 24, 24)   11664       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 232, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 232, 24, 24)  928         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 232, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 133632)       0           activation_26[0][0]              
==================================================================================================
Total params: 250,080
Trainable params: 245,096
Non-trainable params: 4,984
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 133632)       250080      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 267264)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          136839680   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 137,092,321
Trainable params: 137,086,313
Non-trainable params: 6,008
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 71s - loss: 0.6658 - acc: 0.7702 - val_loss: 0.4886 - val_acc: 0.8764
Epoch 2/7
 - 59s - loss: 0.4198 - acc: 0.8991 - val_loss: 0.3283 - val_acc: 0.9485
Epoch 3/7
 - 58s - loss: 0.2967 - acc: 0.9556 - val_loss: 0.2486 - val_acc: 0.9720
Epoch 4/7
 - 58s - loss: 0.2295 - acc: 0.9757 - val_loss: 0.1944 - val_acc: 0.9862
Epoch 5/7
 - 58s - loss: 0.1930 - acc: 0.9831 - val_loss: 0.1522 - val_acc: 0.9950
Epoch 6/7
 - 58s - loss: 0.1672 - acc: 0.9882 - val_loss: 0.1371 - val_acc: 0.9947
Epoch 7/7
 - 58s - loss: 0.1424 - acc: 0.9915 - val_loss: 0.1199 - val_acc: 0.9961
Test accuracy:0.723
current auc_score ------------------> 0.887
accuracies:  [0.7262096774193548, 0.6790322580645162, 0.5092741935483871, 0.7323924731182796, 0.7228494623655914]
aucs:  [0.9109394872239566, 0.845221918718927, 0.680602526303619, 0.8615968970401202, 0.8873835848074921]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 96, 24, 24)   24576       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 280, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 280, 24, 24)  1120        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 280, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 96, 24, 24)   26880       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 304, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_26[0][0]              
==================================================================================================
Total params: 433,104
Trainable params: 426,608
Non-trainable params: 6,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       433104      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 179,742,673
Trainable params: 179,735,153
Non-trainable params: 7,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 81s - loss: 0.7226 - acc: 0.7662 - val_loss: 1.0111 - val_acc: 0.6186
Epoch 2/7
 - 68s - loss: 0.4827 - acc: 0.8940 - val_loss: 1.1082 - val_acc: 0.6368
Epoch 3/7
 - 68s - loss: 0.3561 - acc: 0.9486 - val_loss: 2.5569 - val_acc: 0.5048

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 68s - loss: 0.2804 - acc: 0.9747 - val_loss: 1.4040 - val_acc: 0.5995
Epoch 5/7
 - 68s - loss: 0.2520 - acc: 0.9829 - val_loss: 1.7115 - val_acc: 0.5452

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 6/7
 - 68s - loss: 0.2313 - acc: 0.9877 - val_loss: 2.3540 - val_acc: 0.5269
Epoch 00006: early stopping
Test accuracy:0.506
current auc_score ------------------> 0.695
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 96, 24, 24)   24576       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 280, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 280, 24, 24)  1120        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 280, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 96, 24, 24)   26880       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 304, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_26[0][0]              
==================================================================================================
Total params: 433,104
Trainable params: 426,608
Non-trainable params: 6,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       433104      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 179,742,673
Trainable params: 179,735,153
Non-trainable params: 7,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 81s - loss: 0.7263 - acc: 0.7709 - val_loss: 0.5156 - val_acc: 0.8873
Epoch 2/7
 - 68s - loss: 0.4558 - acc: 0.9079 - val_loss: 0.3600 - val_acc: 0.9577
Epoch 3/7
 - 68s - loss: 0.3350 - acc: 0.9577 - val_loss: 0.2815 - val_acc: 0.9743
Epoch 4/7
 - 68s - loss: 0.2687 - acc: 0.9749 - val_loss: 0.2199 - val_acc: 0.9901
Epoch 5/7
 - 68s - loss: 0.2222 - acc: 0.9842 - val_loss: 0.1888 - val_acc: 0.9911
Epoch 6/7
 - 68s - loss: 0.1856 - acc: 0.9902 - val_loss: 0.1586 - val_acc: 0.9940
Epoch 7/7
 - 69s - loss: 0.1625 - acc: 0.9905 - val_loss: 0.1317 - val_acc: 0.9981
Test accuracy:0.747
current auc_score ------------------> 0.877
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 96, 24, 24)   24576       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 280, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 280, 24, 24)  1120        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 280, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 96, 24, 24)   26880       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 304, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_26[0][0]              
==================================================================================================
Total params: 433,104
Trainable params: 426,608
Non-trainable params: 6,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       433104      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 179,742,673
Trainable params: 179,735,153
Non-trainable params: 7,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 81s - loss: 0.7774 - acc: 0.7365 - val_loss: 1.8789 - val_acc: 0.5041
Epoch 2/7
 - 68s - loss: 0.5127 - acc: 0.8787 - val_loss: 1.4617 - val_acc: 0.5215
Epoch 3/7
 - 69s - loss: 0.3610 - acc: 0.9465 - val_loss: 0.9348 - val_acc: 0.6005
Epoch 4/7
 - 69s - loss: 0.2884 - acc: 0.9686 - val_loss: 0.9493 - val_acc: 0.6044
Epoch 5/7
 - 69s - loss: 0.2386 - acc: 0.9797 - val_loss: 1.0699 - val_acc: 0.6232

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/7
 - 69s - loss: 0.2004 - acc: 0.9893 - val_loss: 0.7342 - val_acc: 0.7764
Epoch 7/7
 - 69s - loss: 0.1803 - acc: 0.9934 - val_loss: 0.6970 - val_acc: 0.7839
Test accuracy:0.790
current auc_score ------------------> 0.858
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 96, 24, 24)   24576       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 280, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 280, 24, 24)  1120        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 280, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 96, 24, 24)   26880       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 304, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_26[0][0]              
==================================================================================================
Total params: 433,104
Trainable params: 426,608
Non-trainable params: 6,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       433104      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 179,742,673
Trainable params: 179,735,153
Non-trainable params: 7,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 82s - loss: 0.7904 - acc: 0.7302 - val_loss: 0.5855 - val_acc: 0.8401
Epoch 2/7
 - 69s - loss: 0.5200 - acc: 0.8749 - val_loss: 0.4067 - val_acc: 0.9316
Epoch 3/7
 - 69s - loss: 0.3638 - acc: 0.9465 - val_loss: 0.2877 - val_acc: 0.9764
Epoch 4/7
 - 69s - loss: 0.2828 - acc: 0.9726 - val_loss: 0.2276 - val_acc: 0.9910
Epoch 5/7
 - 69s - loss: 0.2333 - acc: 0.9821 - val_loss: 0.1993 - val_acc: 0.9928
Epoch 6/7
 - 68s - loss: 0.2030 - acc: 0.9858 - val_loss: 0.1677 - val_acc: 0.9933
Epoch 7/7
 - 69s - loss: 0.1751 - acc: 0.9886 - val_loss: 0.1439 - val_acc: 0.9950
Test accuracy:0.693
current auc_score ------------------> 0.837
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 96, 24, 24)   15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 24, 24)   0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 184, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 184, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 96, 24, 24)   17664       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 24, 24)   0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 208, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 208, 24, 24)  832         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 208, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 96, 24, 24)   19968       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 24, 24)   0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 232, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 232, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 96, 24, 24)   22272       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 24, 24)   0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 256, 24, 24)  1024        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 256, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 96, 24, 24)   24576       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 24, 24)   0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 280, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 280, 24, 24)  1120        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 280, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 96, 24, 24)   26880       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 96, 24, 24)   384         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 24, 24)   0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 24, 24, 24)   20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 304, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 304, 24, 24)  1216        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 304, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 175104)       0           activation_26[0][0]              
==================================================================================================
Total params: 433,104
Trainable params: 426,608
Non-trainable params: 6,496
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 175104)       433104      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 350208)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          179307008   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 179,742,673
Trainable params: 179,735,153
Non-trainable params: 7,520
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 81s - loss: 0.7728 - acc: 0.7433 - val_loss: 1.8448 - val_acc: 0.5054
Epoch 2/7
 - 68s - loss: 0.5031 - acc: 0.8854 - val_loss: 0.8995 - val_acc: 0.6319
Epoch 3/7
 - 68s - loss: 0.3671 - acc: 0.9463 - val_loss: 1.2729 - val_acc: 0.5476
Epoch 4/7
 - 68s - loss: 0.2939 - acc: 0.9689 - val_loss: 0.9682 - val_acc: 0.6382

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/7
 - 68s - loss: 0.2360 - acc: 0.9861 - val_loss: 0.3544 - val_acc: 0.9534
Epoch 6/7
 - 68s - loss: 0.2179 - acc: 0.9900 - val_loss: 0.3513 - val_acc: 0.9487
Epoch 7/7
 - 68s - loss: 0.2002 - acc: 0.9933 - val_loss: 0.3065 - val_acc: 0.9581
Test accuracy:0.742
current auc_score ------------------> 0.823
accuracies:  [0.5056451612903226, 0.746505376344086, 0.7901881720430107, 0.6932795698924731, 0.7422043010752688]
aucs:  [0.6951249783211932, 0.8768111197826338, 0.8579758498092265, 0.8367448187651751, 0.8225964345589085]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 120, 24, 24)  37920       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 346, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 346, 24, 24)  1384        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 346, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 120, 24, 24)  41520       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 376, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_26[0][0]              
==================================================================================================
Total params: 666,240
Trainable params: 658,232
Non-trainable params: 8,008
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       666240      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 222,443,137
Trainable params: 222,434,105
Non-trainable params: 9,032
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 91s - loss: 0.8179 - acc: 0.7449 - val_loss: 0.6311 - val_acc: 0.8581
Epoch 2/7
 - 77s - loss: 0.5573 - acc: 0.8813 - val_loss: 0.4381 - val_acc: 0.9409
Epoch 3/7
 - 77s - loss: 0.4189 - acc: 0.9416 - val_loss: 0.3487 - val_acc: 0.9713
Epoch 4/7
 - 77s - loss: 0.3232 - acc: 0.9702 - val_loss: 0.3024 - val_acc: 0.9736
Epoch 5/7
 - 77s - loss: 0.2653 - acc: 0.9805 - val_loss: 0.2273 - val_acc: 0.9893
Epoch 6/7
 - 77s - loss: 0.2176 - acc: 0.9887 - val_loss: 0.2031 - val_acc: 0.9878
Epoch 7/7
 - 77s - loss: 0.1874 - acc: 0.9905 - val_loss: 0.1531 - val_acc: 0.9972
Test accuracy:0.691
current auc_score ------------------> 0.867
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 120, 24, 24)  37920       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 346, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 346, 24, 24)  1384        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 346, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 120, 24, 24)  41520       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 376, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_26[0][0]              
==================================================================================================
Total params: 666,240
Trainable params: 658,232
Non-trainable params: 8,008
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       666240      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 222,443,137
Trainable params: 222,434,105
Non-trainable params: 9,032
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 91s - loss: 0.7965 - acc: 0.7571 - val_loss: 1.4003 - val_acc: 0.6546
Epoch 2/7
 - 77s - loss: 0.5551 - acc: 0.8814 - val_loss: 0.7721 - val_acc: 0.7533
Epoch 3/7
 - 77s - loss: 0.4201 - acc: 0.9397 - val_loss: 0.8559 - val_acc: 0.7294
Epoch 4/7
 - 77s - loss: 0.3434 - acc: 0.9622 - val_loss: 1.0254 - val_acc: 0.6837

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/7
 - 77s - loss: 0.2808 - acc: 0.9798 - val_loss: 0.9538 - val_acc: 0.7260
Epoch 6/7
 - 77s - loss: 0.2572 - acc: 0.9858 - val_loss: 0.2167 - val_acc: 0.9954
Epoch 7/7
 - 77s - loss: 0.2408 - acc: 0.9877 - val_loss: 0.2026 - val_acc: 0.9967
Test accuracy:0.597
current auc_score ------------------> 0.841
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 120, 24, 24)  37920       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 346, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 346, 24, 24)  1384        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 346, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 120, 24, 24)  41520       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 376, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_26[0][0]              
==================================================================================================
Total params: 666,240
Trainable params: 658,232
Non-trainable params: 8,008
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       666240      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 222,443,137
Trainable params: 222,434,105
Non-trainable params: 9,032
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 90s - loss: 0.7910 - acc: 0.7600 - val_loss: 0.6066 - val_acc: 0.8515
Epoch 2/7
 - 77s - loss: 0.5121 - acc: 0.9084 - val_loss: 0.3990 - val_acc: 0.9587
Epoch 3/7
 - 77s - loss: 0.3832 - acc: 0.9564 - val_loss: 0.3211 - val_acc: 0.9774
Epoch 4/7
 - 77s - loss: 0.3037 - acc: 0.9766 - val_loss: 0.2720 - val_acc: 0.9812
Epoch 5/7
 - 77s - loss: 0.2477 - acc: 0.9856 - val_loss: 0.2049 - val_acc: 0.9952
Epoch 6/7
 - 77s - loss: 0.2066 - acc: 0.9909 - val_loss: 0.1754 - val_acc: 0.9949
Epoch 7/7
 - 77s - loss: 0.1740 - acc: 0.9940 - val_loss: 0.1540 - val_acc: 0.9982
Test accuracy:0.714
current auc_score ------------------> 0.875
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 120, 24, 24)  37920       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 346, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 346, 24, 24)  1384        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 346, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 120, 24, 24)  41520       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 376, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_26[0][0]              
==================================================================================================
Total params: 666,240
Trainable params: 658,232
Non-trainable params: 8,008
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       666240      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 222,443,137
Trainable params: 222,434,105
Non-trainable params: 9,032
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 90s - loss: 0.7801 - acc: 0.7751 - val_loss: 1.4359 - val_acc: 0.5557
Epoch 2/7
 - 77s - loss: 0.5047 - acc: 0.9096 - val_loss: 1.1763 - val_acc: 0.6012
Epoch 3/7
 - 77s - loss: 0.3691 - acc: 0.9616 - val_loss: 2.8391 - val_acc: 0.5054
Epoch 4/7
 - 77s - loss: 0.2962 - acc: 0.9800 - val_loss: 2.0532 - val_acc: 0.5141

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/7
 - 77s - loss: 0.2454 - acc: 0.9911 - val_loss: 2.5645 - val_acc: 0.5252
Epoch 6/7
 - 77s - loss: 0.2263 - acc: 0.9927 - val_loss: 1.2329 - val_acc: 0.6414

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 7/7
 - 77s - loss: 0.2115 - acc: 0.9960 - val_loss: 1.7407 - val_acc: 0.5981
Test accuracy:0.587
current auc_score ------------------> 0.687
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 120, 24, 24)  23520       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 226, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 226, 24, 24)  904         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 226, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 120, 24, 24)  27120       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 256, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 256, 24, 24)  1024        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 256, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 120, 24, 24)  30720       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 286, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 286, 24, 24)  1144        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 286, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 120, 24, 24)  34320       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 316, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 316, 24, 24)  1264        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 316, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 120, 24, 24)  37920       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 346, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 346, 24, 24)  1384        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 346, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 120, 24, 24)  41520       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 120, 24, 24)  480         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 30, 24, 24)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 376, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 376, 24, 24)  1504        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 376, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 216576)       0           activation_26[0][0]              
==================================================================================================
Total params: 666,240
Trainable params: 658,232
Non-trainable params: 8,008
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 216576)       666240      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 433152)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          221774336   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 222,443,137
Trainable params: 222,434,105
Non-trainable params: 9,032
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 91s - loss: 0.8191 - acc: 0.7460 - val_loss: 0.6393 - val_acc: 0.8360
Epoch 2/7
 - 77s - loss: 0.5403 - acc: 0.8911 - val_loss: 0.4347 - val_acc: 0.9286
Epoch 3/7
 - 77s - loss: 0.4144 - acc: 0.9436 - val_loss: 0.3258 - val_acc: 0.9759
Epoch 4/7
 - 77s - loss: 0.3250 - acc: 0.9693 - val_loss: 0.2851 - val_acc: 0.9769
Epoch 5/7
 - 77s - loss: 0.2629 - acc: 0.9815 - val_loss: 0.2157 - val_acc: 0.9923
Epoch 6/7
 - 77s - loss: 0.2205 - acc: 0.9867 - val_loss: 0.1785 - val_acc: 0.9951
Epoch 7/7
 - 77s - loss: 0.1853 - acc: 0.9908 - val_loss: 0.1542 - val_acc: 0.9957
Test accuracy:0.660
current auc_score ------------------> 0.863
accuracies:  [0.6911290322580645, 0.5966397849462366, 0.7141129032258065, 0.5869623655913978, 0.6596774193548387]
aucs:  [0.8669529353104406, 0.8406348999884381, 0.8745182969129378, 0.6870919325933634, 0.8625187882992252]
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 144, 24, 24)  54144       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 412, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 412, 24, 24)  1648        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 412, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 144, 24, 24)  59328       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 448, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 448, 24, 24)  1792        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 448, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 258048)       0           activation_26[0][0]              
==================================================================================================
Total params: 949,488
Trainable params: 939,968
Non-trainable params: 9,520
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 258048)       949488      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 516096)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          264241664   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 265,193,713
Trainable params: 265,183,169
Non-trainable params: 10,544
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 106s - loss: 0.8236 - acc: 0.7743 - val_loss: 0.6042 - val_acc: 0.9000
Epoch 2/7
 - 91s - loss: 0.5362 - acc: 0.9171 - val_loss: 0.4264 - val_acc: 0.9608
Epoch 3/7
 - 91s - loss: 0.3923 - acc: 0.9653 - val_loss: 0.3335 - val_acc: 0.9800
Epoch 4/7
 - 91s - loss: 0.3158 - acc: 0.9786 - val_loss: 0.2624 - val_acc: 0.9921
Epoch 5/7
 - 91s - loss: 0.2571 - acc: 0.9861 - val_loss: 0.2224 - val_acc: 0.9933
Epoch 6/7
 - 91s - loss: 0.2078 - acc: 0.9927 - val_loss: 0.1739 - val_acc: 0.9972
Epoch 7/7
 - 91s - loss: 0.1726 - acc: 0.9940 - val_loss: 0.1439 - val_acc: 0.9982
Test accuracy:0.692
current auc_score ------------------> 0.849
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 144, 24, 24)  54144       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 412, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 412, 24, 24)  1648        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 412, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 144, 24, 24)  59328       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 448, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 448, 24, 24)  1792        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 448, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 258048)       0           activation_26[0][0]              
==================================================================================================
Total params: 949,488
Trainable params: 939,968
Non-trainable params: 9,520
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 258048)       949488      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 516096)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          264241664   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 265,193,713
Trainable params: 265,183,169
Non-trainable params: 10,544
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 107s - loss: 0.8866 - acc: 0.7363 - val_loss: 2.9856 - val_acc: 0.5035
Epoch 2/7
 - 91s - loss: 0.5853 - acc: 0.8913 - val_loss: 1.8666 - val_acc: 0.5122
Epoch 3/7
 - 91s - loss: 0.4183 - acc: 0.9573 - val_loss: 2.4839 - val_acc: 0.5061
Epoch 4/7
 - 90s - loss: 0.3301 - acc: 0.9760 - val_loss: 2.3237 - val_acc: 0.5078

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/7
 - 91s - loss: 0.2703 - acc: 0.9893 - val_loss: 2.1697 - val_acc: 0.5054
Epoch 6/7
 - 91s - loss: 0.2488 - acc: 0.9913 - val_loss: 2.6706 - val_acc: 0.5108

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00006: early stopping
Test accuracy:0.502
current auc_score ------------------> 0.638
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 144, 24, 24)  54144       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 412, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 412, 24, 24)  1648        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 412, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 144, 24, 24)  59328       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 448, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 448, 24, 24)  1792        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 448, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 258048)       0           activation_26[0][0]              
==================================================================================================
Total params: 949,488
Trainable params: 939,968
Non-trainable params: 9,520
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 258048)       949488      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 516096)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          264241664   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 265,193,713
Trainable params: 265,183,169
Non-trainable params: 10,544
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 105s - loss: 0.8413 - acc: 0.7652 - val_loss: 1.0272 - val_acc: 0.6703
Epoch 2/7
 - 91s - loss: 0.5458 - acc: 0.9137 - val_loss: 1.5492 - val_acc: 0.5848
Epoch 3/7
 - 91s - loss: 0.4139 - acc: 0.9619 - val_loss: 3.8442 - val_acc: 0.5048

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 91s - loss: 0.3359 - acc: 0.9837 - val_loss: 2.7047 - val_acc: 0.5355
Epoch 5/7
 - 91s - loss: 0.3066 - acc: 0.9887 - val_loss: 0.2730 - val_acc: 0.9954
Epoch 6/7
 - 91s - loss: 0.2812 - acc: 0.9923 - val_loss: 0.2532 - val_acc: 0.9971
Epoch 7/7
 - 91s - loss: 0.2584 - acc: 0.9943 - val_loss: 0.2326 - val_acc: 0.9966
Test accuracy:0.662
current auc_score ------------------> 0.880
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 144, 24, 24)  54144       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 412, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 412, 24, 24)  1648        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 412, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 144, 24, 24)  59328       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 448, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 448, 24, 24)  1792        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 448, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 258048)       0           activation_26[0][0]              
==================================================================================================
Total params: 949,488
Trainable params: 939,968
Non-trainable params: 9,520
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 258048)       949488      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 516096)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          264241664   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 265,193,713
Trainable params: 265,183,169
Non-trainable params: 10,544
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 105s - loss: 0.9033 - acc: 0.7275 - val_loss: 0.7409 - val_acc: 0.7991
Epoch 2/7
 - 91s - loss: 0.6595 - acc: 0.8495 - val_loss: 0.5590 - val_acc: 0.9160
Epoch 3/7
 - 91s - loss: 0.4916 - acc: 0.9270 - val_loss: 0.3840 - val_acc: 0.9736
Epoch 4/7
 - 90s - loss: 0.3783 - acc: 0.9627 - val_loss: 0.3024 - val_acc: 0.9887
Epoch 5/7
 - 91s - loss: 0.3084 - acc: 0.9773 - val_loss: 0.2436 - val_acc: 0.9918
Epoch 6/7
 - 91s - loss: 0.2511 - acc: 0.9863 - val_loss: 0.2013 - val_acc: 0.9951
Epoch 7/7
 - 91s - loss: 0.2070 - acc: 0.9905 - val_loss: 0.1747 - val_acc: 0.9936
Test accuracy:0.670
current auc_score ------------------> 0.825
Epochs  7  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [12]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  1  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_0_6_bn (BatchNormalizatio (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           dense_0_6_bn[0][0]               
__________________________________________________________________________________________________
dense_0_6_bottleneck_conv2D (Co (None, 144, 24, 24)  33408       activation_14[0][0]              
__________________________________________________________________________________________________
dense_0_6_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_6_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 24, 24)  0           dense_0_6_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_6_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 24, 24)   0           dense_0_6_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 268, 24, 24)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_0_7_bn (BatchNormalizatio (None, 268, 24, 24)  1072        concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 268, 24, 24)  0           dense_0_7_bn[0][0]               
__________________________________________________________________________________________________
dense_0_7_bottleneck_conv2D (Co (None, 144, 24, 24)  38592       activation_16[0][0]              
__________________________________________________________________________________________________
dense_0_7_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_7_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 24, 24)  0           dense_0_7_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_7_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 24, 24)   0           dense_0_7_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 304, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_0_8_bn (BatchNormalizatio (None, 304, 24, 24)  1216        concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 304, 24, 24)  0           dense_0_8_bn[0][0]               
__________________________________________________________________________________________________
dense_0_8_bottleneck_conv2D (Co (None, 144, 24, 24)  43776       activation_18[0][0]              
__________________________________________________________________________________________________
dense_0_8_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_8_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 24, 24)  0           dense_0_8_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_8_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 24, 24)   0           dense_0_8_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 340, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_0_9_bn (BatchNormalizatio (None, 340, 24, 24)  1360        concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 340, 24, 24)  0           dense_0_9_bn[0][0]               
__________________________________________________________________________________________________
dense_0_9_bottleneck_conv2D (Co (None, 144, 24, 24)  48960       activation_20[0][0]              
__________________________________________________________________________________________________
dense_0_9_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_9_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 24, 24)  0           dense_0_9_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_9_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 24, 24)   0           dense_0_9_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 376, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_0_10_bn (BatchNormalizati (None, 376, 24, 24)  1504        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 376, 24, 24)  0           dense_0_10_bn[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_conv2D (C (None, 144, 24, 24)  54144       activation_22[0][0]              
__________________________________________________________________________________________________
dense_0_10_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_10_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 24, 24)  0           dense_0_10_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_10_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 24, 24)   0           dense_0_10_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 412, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_0_11_bn (BatchNormalizati (None, 412, 24, 24)  1648        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 412, 24, 24)  0           dense_0_11_bn[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_conv2D (C (None, 144, 24, 24)  59328       activation_24[0][0]              
__________________________________________________________________________________________________
dense_0_11_bottleneck_bn (Batch (None, 144, 24, 24)  576         dense_0_11_bottleneck_conv2D[0][0
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 24, 24)  0           dense_0_11_bottleneck_bn[0][0]   
__________________________________________________________________________________________________
dense_0_11_conv2D (Conv2D)      (None, 36, 24, 24)   46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 24, 24)   0           dense_0_11_conv2D[0][0]          
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 448, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 448, 24, 24)  1792        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 448, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 258048)       0           activation_26[0][0]              
==================================================================================================
Total params: 949,488
Trainable params: 939,968
Non-trainable params: 9,520
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 258048)       949488      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 516096)       0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          264241664   merge_features[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 265,193,713
Trainable params: 265,183,169
Non-trainable params: 10,544
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 106s - loss: 0.8424 - acc: 0.7646 - val_loss: 1.1470 - val_acc: 0.6363
Epoch 2/7
 - 91s - loss: 0.5772 - acc: 0.8982 - val_loss: 2.7271 - val_acc: 0.5246
Epoch 3/7
 - 90s - loss: 0.4292 - acc: 0.9544 - val_loss: 2.7325 - val_acc: 0.5203

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/7
 - 90s - loss: 0.3465 - acc: 0.9790 - val_loss: 2.2971 - val_acc: 0.5592
Epoch 5/7
 - 90s - loss: 0.3125 - acc: 0.9858 - val_loss: 3.0337 - val_acc: 0.5269

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.507
current auc_score ------------------> 0.665
accuracies:  [0.6919354838709677, 0.5022849462365592, 0.6625, 0.6696236559139785, 0.5071236559139785]
aucs:  [0.8491762776043474, 0.6377299398774424, 0.8803049846803099, 0.8252870635333565, 0.6654288067984739]
['0.871+/-0.018', '0.893+/-0.024', '0.872+/-0.017', '0.879+/-0.015', '0.886+/-0.028', '0.881+/-0.017', '0.892+/-0.013', '0.885+/-0.022', '0.893+/-0.013', '0.847+/-0.077', '0.876+/-0.025', '0.858+/-0.018', '0.892+/-0.013', '0.886+/-0.022', '0.81+/-0.106', '0.81+/-0.116', '0.831+/-0.094', '0.806+/-0.065', '0.85+/-0.075', '0.852+/-0.047', '0.812+/-0.082', '0.827+/-0.076', '0.797+/-0.094', '0.821+/-0.119', '0.872+/-0.021', '0.815+/-0.085', '0.837+/-0.081', '0.818+/-0.064', '0.826+/-0.071', '0.772+/-0.1']
[0.905, 0.93, 0.897, 0.891, 0.928, 0.907, 0.907, 0.911, 0.914, 0.924, 0.911, 0.883, 0.915, 0.917, 0.906, 0.928, 0.906, 0.851, 0.905, 0.888, 0.918, 0.897, 0.884, 0.89, 0.909, 0.909, 0.911, 0.877, 0.875, 0.88]
(['2', '24', '1', '16', '0.2', '0.0002', '6'], '0.871+/-0.018', 0.905)
(['2', '30', '1', '16', '0.2', '0.0002', '6'], '0.893+/-0.024', 0.93)
(['2', '36', '1', '16', '0.2', '0.0002', '6'], '0.872+/-0.017', 0.897)
(['3', '24', '1', '16', '0.2', '0.0002', '6'], '0.879+/-0.015', 0.891)
(['3', '30', '1', '16', '0.2', '0.0002', '6'], '0.886+/-0.028', 0.928)
(['3', '36', '1', '16', '0.2', '0.0002', '6'], '0.881+/-0.017', 0.907)
(['4', '24', '1', '16', '0.2', '0.0002', '6'], '0.892+/-0.013', 0.907)
(['4', '30', '1', '16', '0.2', '0.0002', '6'], '0.885+/-0.022', 0.911)
(['4', '36', '1', '16', '0.2', '0.0002', '6'], '0.893+/-0.013', 0.914)
(['6', '24', '1', '16', '0.2', '0.0002', '6'], '0.847+/-0.077', 0.924)
(['6', '30', '1', '16', '0.2', '0.0002', '6'], '0.876+/-0.025', 0.911)
(['6', '36', '1', '16', '0.2', '0.0002', '6'], '0.858+/-0.018', 0.883)
(['8', '6', '1', '16', '0.2', '0.0002', '6'], '0.892+/-0.013', 0.915)
(['8', '12', '1', '16', '0.2', '0.0002', '6'], '0.886+/-0.022', 0.917)
(['8', '18', '1', '16', '0.2', '0.0002', '6'], '0.81+/-0.106', 0.906)
(['8', '24', '1', '16', '0.2', '0.0002', '6'], '0.81+/-0.116', 0.928)
(['8', '30', '1', '16', '0.2', '0.0002', '6'], '0.831+/-0.094', 0.906)
(['8', '36', '1', '16', '0.2', '0.0002', '6'], '0.806+/-0.065', 0.851)
(['10', '6', '1', '16', '0.2', '0.0002', '6'], '0.85+/-0.075', 0.905)
(['10', '12', '1', '16', '0.2', '0.0002', '7'], '0.852+/-0.047', 0.888)
(['10', '18', '1', '16', '0.2', '0.0002', '7'], '0.812+/-0.082', 0.918)
(['10', '24', '1', '16', '0.2', '0.0002', '7'], '0.827+/-0.076', 0.897)
(['10', '30', '1', '16', '0.2', '0.0002', '7'], '0.797+/-0.094', 0.884)
(['10', '36', '1', '16', '0.2', '0.0002', '7'], '0.821+/-0.119', 0.89)
(['12', '6', '1', '16', '0.2', '0.0002', '7'], '0.872+/-0.021', 0.909)
(['12', '12', '1', '16', '0.2', '0.0002', '7'], '0.815+/-0.085', 0.909)
(['12', '18', '1', '16', '0.2', '0.0002', '7'], '0.837+/-0.081', 0.911)
(['12', '24', '1', '16', '0.2', '0.0002', '7'], '0.818+/-0.064', 0.877)
(['12', '30', '1', '16', '0.2', '0.0002', '7'], '0.826+/-0.071', 0.875)
(['12', '36', '1', '16', '0.2', '0.0002', '7'], '0.772+/-0.1', 0.88)
