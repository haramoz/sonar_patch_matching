python keras_dn_simple_multigpu.py
python keras_dn_simple.py
python custom_gridsearch_dn_siamese.py
python custom_gs_dn_siamese_layers_multi.py -g 1
python custom_gridsearch_dn_siamese_layers_avg.py
Column names are layers_per_block, growth_rate, nb_dense_block, nb_filter, dropout, lr, epochs
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 32, 24, 24)   2048        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 32, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 32, 12, 12)   128         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   3072        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 56, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 56, 12, 12)   224         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 56, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 80, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 80, 12, 12)   320         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 40, 12, 12)   3200        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 40, 6, 6)     160         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 40, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     3840        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 64, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 64, 6, 6)     256         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 64, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     6144        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 6, 6)     0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 88, 6, 6)     352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 88, 6, 6)     0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 44, 6, 6)     3872        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 44, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 44, 3, 3)     176         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 44, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     4224        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 68, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 68, 3, 3)     272         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 68, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     6528        activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 92, 3, 3)     0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 92, 3, 3)     368         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 92, 3, 3)     0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 828)          0           activation_21[0][0]              
==================================================================================================
Total params: 216,224
Trainable params: 213,288
Non-trainable params: 2,936
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 828)          216224      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 1656)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          848384      merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,067,169
Trainable params: 1,063,209
Non-trainable params: 3,960
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 71s - loss: 0.8904 - acc: 0.6754 - val_loss: 1.6736 - val_acc: 0.5092
Epoch 2/10
 - 61s - loss: 0.6734 - acc: 0.7723 - val_loss: 0.9291 - val_acc: 0.5865
Epoch 3/10
 - 62s - loss: 0.5197 - acc: 0.8507 - val_loss: 1.0297 - val_acc: 0.5235
Epoch 4/10
 - 62s - loss: 0.4234 - acc: 0.8992 - val_loss: 0.8458 - val_acc: 0.6066
Epoch 5/10
 - 62s - loss: 0.3415 - acc: 0.9383 - val_loss: 1.0653 - val_acc: 0.5483
Epoch 6/10
 - 62s - loss: 0.2880 - acc: 0.9606 - val_loss: 0.9562 - val_acc: 0.5896

Epoch 00006: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 7/10
 - 63s - loss: 0.2538 - acc: 0.9732 - val_loss: 1.0925 - val_acc: 0.5513
Epoch 8/10
 - 62s - loss: 0.2420 - acc: 0.9778 - val_loss: 0.8887 - val_acc: 0.6097

Epoch 00008: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 9/10
 - 63s - loss: 0.2316 - acc: 0.9816 - val_loss: 0.9529 - val_acc: 0.5855
Epoch 10/10
 - 63s - loss: 0.2285 - acc: 0.9825 - val_loss: 1.0148 - val_acc: 0.5646

Epoch 00010: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Test accuracy:0.539
current auc_score ------------------> 0.723
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 32, 24, 24)   2048        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 32, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 32, 12, 12)   128         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   3072        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 56, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 56, 12, 12)   224         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 56, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 80, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 80, 12, 12)   320         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 40, 12, 12)   3200        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 40, 6, 6)     160         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 40, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     3840        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 64, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 64, 6, 6)     256         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 64, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     6144        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 6, 6)     0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 88, 6, 6)     352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 88, 6, 6)     0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 44, 6, 6)     3872        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 44, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 44, 3, 3)     176         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 44, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     4224        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 68, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 68, 3, 3)     272         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 68, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     6528        activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 92, 3, 3)     0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 92, 3, 3)     368         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 92, 3, 3)     0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 828)          0           activation_21[0][0]              
==================================================================================================
Total params: 216,224
Trainable params: 213,288
Non-trainable params: 2,936
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 828)          216224      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 1656)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          848384      merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,067,169
Trainable params: 1,063,209
Non-trainable params: 3,960
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 71s - loss: 0.8645 - acc: 0.6847 - val_loss: 1.0139 - val_acc: 0.5605
Epoch 2/10
 - 61s - loss: 0.6276 - acc: 0.7921 - val_loss: 1.0611 - val_acc: 0.5211
Epoch 3/10
 - 62s - loss: 0.5102 - acc: 0.8533 - val_loss: 1.0710 - val_acc: 0.5245

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/10
 - 62s - loss: 0.4366 - acc: 0.8901 - val_loss: 1.1005 - val_acc: 0.5220
Epoch 5/10
 - 62s - loss: 0.4035 - acc: 0.9061 - val_loss: 0.8999 - val_acc: 0.5636
Epoch 6/10
 - 62s - loss: 0.3691 - acc: 0.9231 - val_loss: 0.3203 - val_acc: 0.9448
Epoch 7/10
 - 62s - loss: 0.3399 - acc: 0.9365 - val_loss: 0.2978 - val_acc: 0.9533
Epoch 8/10
 - 61s - loss: 0.3165 - acc: 0.9484 - val_loss: 0.2967 - val_acc: 0.9566
Epoch 9/10
 - 61s - loss: 0.2950 - acc: 0.9566 - val_loss: 0.2560 - val_acc: 0.9718
Epoch 10/10
 - 62s - loss: 0.2728 - acc: 0.9654 - val_loss: 0.2454 - val_acc: 0.9750
Test accuracy:0.635
current auc_score ------------------> 0.840
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 32, 24, 24)   2048        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 32, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 32, 12, 12)   128         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   3072        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 56, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 56, 12, 12)   224         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 56, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 80, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 80, 12, 12)   320         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 40, 12, 12)   3200        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 40, 6, 6)     160         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 40, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     3840        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 64, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 64, 6, 6)     256         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 64, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     6144        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 6, 6)     0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 88, 6, 6)     352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 88, 6, 6)     0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 44, 6, 6)     3872        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 44, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 44, 3, 3)     176         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 44, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     4224        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 68, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 68, 3, 3)     272         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 68, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     6528        activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 92, 3, 3)     0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 92, 3, 3)     368         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 92, 3, 3)     0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 828)          0           activation_21[0][0]              
==================================================================================================
Total params: 216,224
Trainable params: 213,288
Non-trainable params: 2,936
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 828)          216224      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 1656)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          848384      merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,067,169
Trainable params: 1,063,209
Non-trainable params: 3,960
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 71s - loss: 0.8771 - acc: 0.6722 - val_loss: 1.1941 - val_acc: 0.5536
Epoch 2/10
 - 62s - loss: 0.6542 - acc: 0.7748 - val_loss: 0.8695 - val_acc: 0.6472
Epoch 3/10
 - 62s - loss: 0.5268 - acc: 0.8390 - val_loss: 1.4128 - val_acc: 0.5226
Epoch 4/10
 - 63s - loss: 0.4328 - acc: 0.8914 - val_loss: 0.9875 - val_acc: 0.5591

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 63s - loss: 0.3709 - acc: 0.9225 - val_loss: 0.3417 - val_acc: 0.9366
Epoch 6/10
 - 62s - loss: 0.3475 - acc: 0.9321 - val_loss: 0.2988 - val_acc: 0.9576
Epoch 7/10
 - 62s - loss: 0.3214 - acc: 0.9444 - val_loss: 0.2997 - val_acc: 0.9544
Epoch 8/10
 - 61s - loss: 0.3004 - acc: 0.9535 - val_loss: 0.2531 - val_acc: 0.9733
Epoch 9/10
 - 62s - loss: 0.2768 - acc: 0.9636 - val_loss: 0.2374 - val_acc: 0.9805
Epoch 10/10
 - 61s - loss: 0.2570 - acc: 0.9715 - val_loss: 0.2227 - val_acc: 0.9837
Test accuracy:0.695
current auc_score ------------------> 0.868
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 32, 24, 24)   2048        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 32, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 32, 12, 12)   128         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   3072        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 56, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 56, 12, 12)   224         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 56, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 80, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 80, 12, 12)   320         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 40, 12, 12)   3200        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 40, 6, 6)     160         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 40, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     3840        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 64, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 64, 6, 6)     256         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 64, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     6144        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 6, 6)     0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 88, 6, 6)     352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 88, 6, 6)     0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 44, 6, 6)     3872        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 44, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 44, 3, 3)     176         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 44, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     4224        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 68, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 68, 3, 3)     272         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 68, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     6528        activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 92, 3, 3)     0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 92, 3, 3)     368         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 92, 3, 3)     0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 828)          0           activation_21[0][0]              
==================================================================================================
Total params: 216,224
Trainable params: 213,288
Non-trainable params: 2,936
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 828)          216224      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 1656)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          848384      merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,067,169
Trainable params: 1,063,209
Non-trainable params: 3,960
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 70s - loss: 0.8576 - acc: 0.6821 - val_loss: 2.1653 - val_acc: 0.4981
Epoch 2/10
 - 62s - loss: 0.6344 - acc: 0.7879 - val_loss: 1.8031 - val_acc: 0.5026
Epoch 3/10
 - 62s - loss: 0.5073 - acc: 0.8555 - val_loss: 1.1373 - val_acc: 0.5387
Epoch 4/10
 - 62s - loss: 0.4157 - acc: 0.9007 - val_loss: 0.9996 - val_acc: 0.5575
Epoch 5/10
 - 63s - loss: 0.3440 - acc: 0.9343 - val_loss: 1.0453 - val_acc: 0.5683
Epoch 6/10
 - 63s - loss: 0.2866 - acc: 0.9588 - val_loss: 0.9547 - val_acc: 0.5420
Epoch 7/10
 - 62s - loss: 0.2503 - acc: 0.9737 - val_loss: 1.3657 - val_acc: 0.5147
Epoch 8/10
 - 63s - loss: 0.2238 - acc: 0.9827 - val_loss: 2.6950 - val_acc: 0.5074

Epoch 00008: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 9/10
 - 62s - loss: 0.2064 - acc: 0.9883 - val_loss: 1.6128 - val_acc: 0.5272
Epoch 00009: early stopping
Test accuracy:0.508
current auc_score ------------------> 0.689
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 32, 24, 24)   2048        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 32, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 32, 12, 12)   128         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 32, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   3072        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 56, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 56, 12, 12)   224         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 56, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 80, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 80, 12, 12)   320         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 40, 12, 12)   3200        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 40, 6, 6)     160         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 40, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     3840        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 64, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 64, 6, 6)     256         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 64, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     6144        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 88, 6, 6)     0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 88, 6, 6)     352         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 88, 6, 6)     0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 44, 6, 6)     3872        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 44, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 44, 3, 3)     176         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 44, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     4224        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 68, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 68, 3, 3)     272         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 68, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     6528        activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 92, 3, 3)     0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 92, 3, 3)     368         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 92, 3, 3)     0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 828)          0           activation_21[0][0]              
==================================================================================================
Total params: 216,224
Trainable params: 213,288
Non-trainable params: 2,936
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 828)          216224      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 1656)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          848384      merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,067,169
Trainable params: 1,063,209
Non-trainable params: 3,960
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 72s - loss: 0.8519 - acc: 0.6929 - val_loss: 0.7383 - val_acc: 0.7383
Epoch 2/10
 - 63s - loss: 0.6102 - acc: 0.8031 - val_loss: 0.6112 - val_acc: 0.8274
Epoch 3/10
 - 62s - loss: 0.4809 - acc: 0.8686 - val_loss: 0.4850 - val_acc: 0.8744
Epoch 4/10
 - 62s - loss: 0.3942 - acc: 0.9110 - val_loss: 0.3719 - val_acc: 0.9216
Epoch 5/10
 - 63s - loss: 0.3322 - acc: 0.9400 - val_loss: 0.3014 - val_acc: 0.9570
Epoch 6/10
 - 63s - loss: 0.2846 - acc: 0.9591 - val_loss: 0.2656 - val_acc: 0.9688
Epoch 7/10
 - 63s - loss: 0.2492 - acc: 0.9736 - val_loss: 0.2204 - val_acc: 0.9852
Epoch 8/10
 - 63s - loss: 0.2240 - acc: 0.9810 - val_loss: 0.1900 - val_acc: 0.9935
Epoch 9/10
 - 63s - loss: 0.2060 - acc: 0.9875 - val_loss: 0.1982 - val_acc: 0.9891
Epoch 10/10
 - 63s - loss: 0.1917 - acc: 0.9906 - val_loss: 0.1740 - val_acc: 0.9955
Test accuracy:0.664
current auc_score ------------------> 0.901
accuracies:  [0.5391129032258064, 0.6349462365591397, 0.6951612903225807, 0.5081989247311828, 0.6643817204301076]
aucs:  [0.7229449936408834, 0.840235793155278, 0.8682175685050296, 0.6886188070875247, 0.900800237021621]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  4560        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    5880        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    9480        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    6480        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    10080       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1026)         0           activation_21[0][0]              
==================================================================================================
Total params: 332,868
Trainable params: 329,254
Non-trainable params: 3,614
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1026)         332868      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2052)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1051136     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,386,565
Trainable params: 1,381,927
Non-trainable params: 4,638
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 86s - loss: 0.9084 - acc: 0.6851 - val_loss: 0.9933 - val_acc: 0.6431
Epoch 2/10
 - 77s - loss: 0.6745 - acc: 0.7892 - val_loss: 0.7045 - val_acc: 0.7859
Epoch 3/10
 - 77s - loss: 0.5381 - acc: 0.8631 - val_loss: 0.5872 - val_acc: 0.8392
Epoch 4/10
 - 77s - loss: 0.4410 - acc: 0.9089 - val_loss: 0.5364 - val_acc: 0.8776
Epoch 5/10
 - 77s - loss: 0.3661 - acc: 0.9443 - val_loss: 0.4183 - val_acc: 0.9277
Epoch 6/10
 - 77s - loss: 0.3132 - acc: 0.9654 - val_loss: 0.2962 - val_acc: 0.9754
Epoch 7/10
 - 77s - loss: 0.2772 - acc: 0.9784 - val_loss: 0.2524 - val_acc: 0.9878
Epoch 8/10
 - 77s - loss: 0.2538 - acc: 0.9861 - val_loss: 0.2752 - val_acc: 0.9802
Epoch 9/10
 - 78s - loss: 0.2380 - acc: 0.9902 - val_loss: 0.2241 - val_acc: 0.9949
Epoch 10/10
 - 77s - loss: 0.2252 - acc: 0.9925 - val_loss: 0.2190 - val_acc: 0.9942
Test accuracy:0.663
current auc_score ------------------> 0.819
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  4560        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    5880        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    9480        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    6480        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    10080       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1026)         0           activation_21[0][0]              
==================================================================================================
Total params: 332,868
Trainable params: 329,254
Non-trainable params: 3,614
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1026)         332868      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2052)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1051136     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,386,565
Trainable params: 1,381,927
Non-trainable params: 4,638
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 85s - loss: 0.9083 - acc: 0.6805 - val_loss: 1.1917 - val_acc: 0.5208
Epoch 2/10
 - 77s - loss: 0.6657 - acc: 0.7955 - val_loss: 2.1580 - val_acc: 0.5056
Epoch 3/10
 - 76s - loss: 0.5143 - acc: 0.8745 - val_loss: 0.9604 - val_acc: 0.5523
Epoch 4/10
 - 76s - loss: 0.4160 - acc: 0.9233 - val_loss: 1.9469 - val_acc: 0.4967
Epoch 5/10
 - 76s - loss: 0.3488 - acc: 0.9533 - val_loss: 0.7951 - val_acc: 0.6866
Epoch 6/10
 - 76s - loss: 0.3003 - acc: 0.9716 - val_loss: 1.0923 - val_acc: 0.5742
Epoch 7/10
 - 76s - loss: 0.2689 - acc: 0.9832 - val_loss: 0.9249 - val_acc: 0.6314

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 8/10
 - 77s - loss: 0.2522 - acc: 0.9875 - val_loss: 0.8935 - val_acc: 0.6178
Epoch 9/10
 - 77s - loss: 0.2405 - acc: 0.9916 - val_loss: 0.9106 - val_acc: 0.6185

Epoch 00009: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00009: early stopping
Test accuracy:0.687
current auc_score ------------------> 0.747
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  4560        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    5880        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    9480        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    6480        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    10080       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1026)         0           activation_21[0][0]              
==================================================================================================
Total params: 332,868
Trainable params: 329,254
Non-trainable params: 3,614
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1026)         332868      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2052)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1051136     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,386,565
Trainable params: 1,381,927
Non-trainable params: 4,638
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 84s - loss: 0.8733 - acc: 0.7022 - val_loss: 2.0327 - val_acc: 0.4912
Epoch 2/10
 - 76s - loss: 0.6277 - acc: 0.8145 - val_loss: 1.8996 - val_acc: 0.5113
Epoch 3/10
 - 76s - loss: 0.5045 - acc: 0.8771 - val_loss: 1.6412 - val_acc: 0.5235
Epoch 4/10
 - 76s - loss: 0.4218 - acc: 0.9174 - val_loss: 2.5233 - val_acc: 0.5059
Epoch 5/10
 - 76s - loss: 0.3560 - acc: 0.9468 - val_loss: 1.4789 - val_acc: 0.5365
Epoch 6/10
 - 76s - loss: 0.3067 - acc: 0.9676 - val_loss: 1.7558 - val_acc: 0.5196
Epoch 7/10
 - 76s - loss: 0.2732 - acc: 0.9795 - val_loss: 1.9796 - val_acc: 0.5143

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 8/10
 - 76s - loss: 0.2533 - acc: 0.9862 - val_loss: 0.2385 - val_acc: 0.9907
Epoch 9/10
 - 76s - loss: 0.2426 - acc: 0.9894 - val_loss: 0.2331 - val_acc: 0.9918
Epoch 10/10
 - 76s - loss: 0.2362 - acc: 0.9911 - val_loss: 0.2266 - val_acc: 0.9928
Test accuracy:0.676
current auc_score ------------------> 0.870
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  4560        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    5880        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    9480        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    6480        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    10080       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1026)         0           activation_21[0][0]              
==================================================================================================
Total params: 332,868
Trainable params: 329,254
Non-trainable params: 3,614
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1026)         332868      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2052)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1051136     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,386,565
Trainable params: 1,381,927
Non-trainable params: 4,638
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 86s - loss: 0.8951 - acc: 0.6913 - val_loss: 1.0260 - val_acc: 0.6702
Epoch 2/10
 - 78s - loss: 0.6487 - acc: 0.8025 - val_loss: 0.6183 - val_acc: 0.8356
Epoch 3/10
 - 77s - loss: 0.5210 - acc: 0.8718 - val_loss: 0.5098 - val_acc: 0.8803
Epoch 4/10
 - 77s - loss: 0.4282 - acc: 0.9165 - val_loss: 0.3759 - val_acc: 0.9423
Epoch 5/10
 - 78s - loss: 0.3589 - acc: 0.9464 - val_loss: 0.3335 - val_acc: 0.9575
Epoch 6/10
 - 78s - loss: 0.3103 - acc: 0.9652 - val_loss: 0.2799 - val_acc: 0.9809
Epoch 7/10
 - 78s - loss: 0.2717 - acc: 0.9798 - val_loss: 0.2825 - val_acc: 0.9744
Epoch 8/10
 - 77s - loss: 0.2481 - acc: 0.9870 - val_loss: 0.2200 - val_acc: 0.9957
Epoch 9/10
 - 78s - loss: 0.2307 - acc: 0.9920 - val_loss: 0.2264 - val_acc: 0.9921
Epoch 10/10
 - 79s - loss: 0.2174 - acc: 0.9941 - val_loss: 0.2030 - val_acc: 0.9974
Test accuracy:0.698
current auc_score ------------------> 0.854
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  4560        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    5880        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    9480        activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    6480        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    10080       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1026)         0           activation_21[0][0]              
==================================================================================================
Total params: 332,868
Trainable params: 329,254
Non-trainable params: 3,614
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1026)         332868      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2052)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1051136     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,386,565
Trainable params: 1,381,927
Non-trainable params: 4,638
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 84s - loss: 0.9082 - acc: 0.6830 - val_loss: 0.8822 - val_acc: 0.6783
Epoch 2/10
 - 77s - loss: 0.6683 - acc: 0.7925 - val_loss: 0.5905 - val_acc: 0.8416
Epoch 3/10
 - 77s - loss: 0.5466 - acc: 0.8602 - val_loss: 0.6171 - val_acc: 0.8373
Epoch 4/10
 - 77s - loss: 0.4553 - acc: 0.9057 - val_loss: 0.4050 - val_acc: 0.9285
Epoch 5/10
 - 77s - loss: 0.3864 - acc: 0.9370 - val_loss: 0.3323 - val_acc: 0.9610
Epoch 6/10
 - 77s - loss: 0.3310 - acc: 0.9590 - val_loss: 0.2797 - val_acc: 0.9794
Epoch 7/10
 - 77s - loss: 0.2889 - acc: 0.9752 - val_loss: 0.2598 - val_acc: 0.9843
Epoch 8/10
 - 77s - loss: 0.2633 - acc: 0.9833 - val_loss: 0.2351 - val_acc: 0.9911
Epoch 9/10
 - 76s - loss: 0.2458 - acc: 0.9878 - val_loss: 0.2334 - val_acc: 0.9902
Epoch 10/10
 - 76s - loss: 0.2303 - acc: 0.9917 - val_loss: 0.2116 - val_acc: 0.9967
Test accuracy:0.707
current auc_score ------------------> 0.858
accuracies:  [0.6634408602150538, 0.6870967741935484, 0.6762096774193549, 0.697983870967742, 0.7071236559139785]
aucs:  [0.8191895739391837, 0.7474191380506418, 0.8699023731067175, 0.8535560469418428, 0.8580519424210891]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  6336        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 116, 12, 12)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    8352        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 94, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 94, 6, 6)     376         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 94, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    13536       activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 130, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    9360        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 101, 3, 3)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 101, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    14544       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 137, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_21[0][0]              
==================================================================================================
Total params: 475,118
Trainable params: 470,820
Non-trainable params: 4,298
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         475118      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,740,783
Trainable params: 1,735,461
Non-trainable params: 5,322
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 100s - loss: 0.9202 - acc: 0.6981 - val_loss: 1.2261 - val_acc: 0.6360
Epoch 2/10
 - 91s - loss: 0.6735 - acc: 0.8149 - val_loss: 0.5782 - val_acc: 0.8642
Epoch 3/10
 - 91s - loss: 0.5286 - acc: 0.8897 - val_loss: 0.5673 - val_acc: 0.8686
Epoch 4/10
 - 91s - loss: 0.4354 - acc: 0.9342 - val_loss: 0.3759 - val_acc: 0.9613
Epoch 5/10
 - 91s - loss: 0.3681 - acc: 0.9621 - val_loss: 0.4016 - val_acc: 0.9480
Epoch 6/10
 - 92s - loss: 0.3289 - acc: 0.9766 - val_loss: 0.3202 - val_acc: 0.9782
Epoch 7/10
 - 92s - loss: 0.2984 - acc: 0.9866 - val_loss: 0.3293 - val_acc: 0.9703
Epoch 8/10
 - 92s - loss: 0.2793 - acc: 0.9902 - val_loss: 0.3003 - val_acc: 0.9795
Epoch 9/10
 - 92s - loss: 0.2628 - acc: 0.9938 - val_loss: 0.2475 - val_acc: 0.9956
Epoch 10/10
 - 92s - loss: 0.2480 - acc: 0.9961 - val_loss: 0.2376 - val_acc: 0.9986
Test accuracy:0.593
current auc_score ------------------> 0.808
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  6336        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 116, 12, 12)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    8352        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 94, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 94, 6, 6)     376         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 94, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    13536       activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 130, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    9360        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 101, 3, 3)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 101, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    14544       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 137, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_21[0][0]              
==================================================================================================
Total params: 475,118
Trainable params: 470,820
Non-trainable params: 4,298
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         475118      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,740,783
Trainable params: 1,735,461
Non-trainable params: 5,322
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 102s - loss: 0.9030 - acc: 0.7067 - val_loss: 0.9114 - val_acc: 0.7150
Epoch 2/10
 - 95s - loss: 0.6620 - acc: 0.8221 - val_loss: 0.7052 - val_acc: 0.8272
Epoch 3/10
 - 94s - loss: 0.5324 - acc: 0.8893 - val_loss: 0.6589 - val_acc: 0.8456
Epoch 4/10
 - 94s - loss: 0.4327 - acc: 0.9351 - val_loss: 0.4117 - val_acc: 0.9420
Epoch 5/10
 - 95s - loss: 0.3683 - acc: 0.9615 - val_loss: 0.3501 - val_acc: 0.9657
Epoch 6/10
 - 94s - loss: 0.3225 - acc: 0.9785 - val_loss: 0.2884 - val_acc: 0.9874
Epoch 7/10
 - 95s - loss: 0.2926 - acc: 0.9873 - val_loss: 0.2776 - val_acc: 0.9915
Epoch 8/10
 - 94s - loss: 0.2733 - acc: 0.9919 - val_loss: 0.2539 - val_acc: 0.9965
Epoch 9/10
 - 95s - loss: 0.2575 - acc: 0.9950 - val_loss: 0.2442 - val_acc: 0.9976
Epoch 10/10
 - 94s - loss: 0.2441 - acc: 0.9969 - val_loss: 0.2385 - val_acc: 0.9969
Test accuracy:0.620
current auc_score ------------------> 0.874
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  6336        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 116, 12, 12)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    8352        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 94, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 94, 6, 6)     376         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 94, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    13536       activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 130, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    9360        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 101, 3, 3)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 101, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    14544       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 137, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_21[0][0]              
==================================================================================================
Total params: 475,118
Trainable params: 470,820
Non-trainable params: 4,298
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         475118      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,740,783
Trainable params: 1,735,461
Non-trainable params: 5,322
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 104s - loss: 0.9454 - acc: 0.6925 - val_loss: 0.8181 - val_acc: 0.7181
Epoch 2/10
 - 95s - loss: 0.6787 - acc: 0.8099 - val_loss: 0.6197 - val_acc: 0.8505
Epoch 3/10
 - 95s - loss: 0.5293 - acc: 0.8884 - val_loss: 0.4941 - val_acc: 0.9104
Epoch 4/10
 - 95s - loss: 0.4333 - acc: 0.9334 - val_loss: 0.3645 - val_acc: 0.9650
Epoch 5/10
 - 95s - loss: 0.3648 - acc: 0.9630 - val_loss: 0.3363 - val_acc: 0.9731
Epoch 6/10
 - 95s - loss: 0.3209 - acc: 0.9796 - val_loss: 0.2957 - val_acc: 0.9880
Epoch 7/10
 - 95s - loss: 0.2942 - acc: 0.9875 - val_loss: 0.2634 - val_acc: 0.9954
Epoch 8/10
 - 95s - loss: 0.2733 - acc: 0.9927 - val_loss: 0.2596 - val_acc: 0.9952
Epoch 9/10
 - 95s - loss: 0.2601 - acc: 0.9949 - val_loss: 0.2484 - val_acc: 0.9964
Epoch 10/10
 - 95s - loss: 0.2478 - acc: 0.9965 - val_loss: 0.2370 - val_acc: 0.9985
Test accuracy:0.670
current auc_score ------------------> 0.832
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  6336        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 116, 12, 12)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    8352        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 94, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 94, 6, 6)     376         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 94, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    13536       activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 130, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    9360        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 101, 3, 3)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 101, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    14544       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 137, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_21[0][0]              
==================================================================================================
Total params: 475,118
Trainable params: 470,820
Non-trainable params: 4,298
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         475118      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,740,783
Trainable params: 1,735,461
Non-trainable params: 5,322
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 101s - loss: 0.8912 - acc: 0.7086 - val_loss: 1.0190 - val_acc: 0.6408
Epoch 2/10
 - 93s - loss: 0.6303 - acc: 0.8364 - val_loss: 0.6954 - val_acc: 0.7968
Epoch 3/10
 - 92s - loss: 0.5036 - acc: 0.9029 - val_loss: 0.4404 - val_acc: 0.9296
Epoch 4/10
 - 92s - loss: 0.4120 - acc: 0.9435 - val_loss: 0.3478 - val_acc: 0.9701
Epoch 5/10
 - 92s - loss: 0.3576 - acc: 0.9651 - val_loss: 0.3090 - val_acc: 0.9833
Epoch 6/10
 - 92s - loss: 0.3191 - acc: 0.9794 - val_loss: 0.2914 - val_acc: 0.9871
Epoch 7/10
 - 92s - loss: 0.2925 - acc: 0.9874 - val_loss: 0.2842 - val_acc: 0.9876
Epoch 8/10
 - 92s - loss: 0.2726 - acc: 0.9923 - val_loss: 0.2503 - val_acc: 0.9974
Epoch 9/10
 - 92s - loss: 0.2592 - acc: 0.9937 - val_loss: 0.2477 - val_acc: 0.9972
Epoch 10/10
 - 92s - loss: 0.2481 - acc: 0.9953 - val_loss: 0.2338 - val_acc: 0.9984
Test accuracy:0.666
current auc_score ------------------> 0.849
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_6[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  6336        activation_7[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 116, 12, 12)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_11[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    8352        activation_12[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 94, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 94, 6, 6)     376         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 94, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    13536       activation_14[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 130, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_16[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    9360        activation_17[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 101, 3, 3)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 101, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    14544       activation_19[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 137, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_21[0][0]              
==================================================================================================
Total params: 475,118
Trainable params: 470,820
Non-trainable params: 4,298
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         475118      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_9[0][0]                  
==================================================================================================
Total params: 1,740,783
Trainable params: 1,735,461
Non-trainable params: 5,322
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 100s - loss: 0.9256 - acc: 0.6924 - val_loss: 2.1911 - val_acc: 0.5028
Epoch 2/10
 - 92s - loss: 0.6615 - acc: 0.8189 - val_loss: 2.0776 - val_acc: 0.4962
Epoch 3/10
 - 91s - loss: 0.5236 - acc: 0.8908 - val_loss: 1.0457 - val_acc: 0.5405
Epoch 4/10
 - 91s - loss: 0.4293 - acc: 0.9350 - val_loss: 1.5587 - val_acc: 0.5045
Epoch 5/10
 - 93s - loss: 0.3612 - acc: 0.9655 - val_loss: 0.6834 - val_acc: 0.7952
Epoch 6/10
 - 92s - loss: 0.3189 - acc: 0.9803 - val_loss: 0.6016 - val_acc: 0.8445
Epoch 7/10
 - 92s - loss: 0.2922 - acc: 0.9877 - val_loss: 0.5722 - val_acc: 0.8666
Epoch 8/10
 - 91s - loss: 0.2761 - acc: 0.9916 - val_loss: 0.7292 - val_acc: 0.7797
Epoch 9/10
 - 91s - loss: 0.2590 - acc: 0.9945 - val_loss: 0.6184 - val_acc: 0.8335

Epoch 00009: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 10/10
 - 91s - loss: 0.2487 - acc: 0.9965 - val_loss: 0.5966 - val_acc: 0.8410
Test accuracy:0.641
current auc_score ------------------> 0.696
accuracies:  [0.592741935483871, 0.6204301075268818, 0.6696236559139785, 0.6655913978494624, 0.6413978494623656]
aucs:  [0.8077984449069257, 0.8744509480864839, 0.8324521620996648, 0.8486893716036537, 0.6958591311134235]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   4224        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   6528        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 92, 12, 12)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 92, 12, 12)   368         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 92, 12, 12)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   8832        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 116, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     5568        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 82, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 82, 6, 6)     328         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 82, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     7872        activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 106, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 106, 6, 6)    424         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 106, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     10176       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 130, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     6240        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 89, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 89, 3, 3)     356         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 89, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     8544        activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 113, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 113, 3, 3)    452         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 113, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     10848       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 137, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_29[0][0]              
==================================================================================================
Total params: 358,922
Trainable params: 353,970
Non-trainable params: 4,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         358922      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 1,624,587
Trainable params: 1,618,611
Non-trainable params: 5,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 100s - loss: 0.9464 - acc: 0.6832 - val_loss: 1.4571 - val_acc: 0.5633
Epoch 2/10
 - 88s - loss: 0.7141 - acc: 0.7924 - val_loss: 1.2875 - val_acc: 0.5302
Epoch 3/10
 - 88s - loss: 0.5841 - acc: 0.8595 - val_loss: 1.3440 - val_acc: 0.5246
Epoch 4/10
 - 88s - loss: 0.4915 - acc: 0.9044 - val_loss: 1.3189 - val_acc: 0.5314

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 88s - loss: 0.4351 - acc: 0.9319 - val_loss: 0.5360 - val_acc: 0.8827
Epoch 6/10
 - 88s - loss: 0.4070 - acc: 0.9435 - val_loss: 0.4155 - val_acc: 0.9400
Epoch 7/10
 - 89s - loss: 0.3839 - acc: 0.9549 - val_loss: 0.4365 - val_acc: 0.9272
Epoch 8/10
 - 89s - loss: 0.3580 - acc: 0.9639 - val_loss: 0.3517 - val_acc: 0.9695
Epoch 9/10
 - 89s - loss: 0.3413 - acc: 0.9707 - val_loss: 0.3463 - val_acc: 0.9666
Epoch 10/10
 - 88s - loss: 0.3228 - acc: 0.9775 - val_loss: 0.3137 - val_acc: 0.9819
Test accuracy:0.729
current auc_score ------------------> 0.867
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   4224        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   6528        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 92, 12, 12)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 92, 12, 12)   368         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 92, 12, 12)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   8832        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 116, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     5568        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 82, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 82, 6, 6)     328         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 82, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     7872        activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 106, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 106, 6, 6)    424         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 106, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     10176       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 130, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     6240        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 89, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 89, 3, 3)     356         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 89, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     8544        activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 113, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 113, 3, 3)    452         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 113, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     10848       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 137, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_29[0][0]              
==================================================================================================
Total params: 358,922
Trainable params: 353,970
Non-trainable params: 4,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         358922      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 1,624,587
Trainable params: 1,618,611
Non-trainable params: 5,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 99s - loss: 0.9420 - acc: 0.6864 - val_loss: 1.1433 - val_acc: 0.5630
Epoch 2/10
 - 88s - loss: 0.7153 - acc: 0.7892 - val_loss: 0.7168 - val_acc: 0.7993
Epoch 3/10
 - 88s - loss: 0.5853 - acc: 0.8598 - val_loss: 0.6743 - val_acc: 0.8197
Epoch 4/10
 - 88s - loss: 0.4847 - acc: 0.9091 - val_loss: 0.5157 - val_acc: 0.8970
Epoch 5/10
 - 88s - loss: 0.4102 - acc: 0.9441 - val_loss: 0.4318 - val_acc: 0.9311
Epoch 6/10
 - 87s - loss: 0.3565 - acc: 0.9654 - val_loss: 0.3176 - val_acc: 0.9808
Epoch 7/10
 - 88s - loss: 0.3173 - acc: 0.9795 - val_loss: 0.3006 - val_acc: 0.9841
Epoch 8/10
 - 88s - loss: 0.2914 - acc: 0.9874 - val_loss: 0.2670 - val_acc: 0.9931
Epoch 9/10
 - 88s - loss: 0.2746 - acc: 0.9914 - val_loss: 0.2518 - val_acc: 0.9969
Epoch 10/10
 - 88s - loss: 0.2607 - acc: 0.9934 - val_loss: 0.2617 - val_acc: 0.9932
Test accuracy:0.586
current auc_score ------------------> 0.818
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   4224        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   6528        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 92, 12, 12)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 92, 12, 12)   368         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 92, 12, 12)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   8832        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 116, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     5568        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 82, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 82, 6, 6)     328         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 82, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     7872        activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 106, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 106, 6, 6)    424         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 106, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     10176       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 130, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     6240        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 89, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 89, 3, 3)     356         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 89, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     8544        activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 113, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 113, 3, 3)    452         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 113, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     10848       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 137, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_29[0][0]              
==================================================================================================
Total params: 358,922
Trainable params: 353,970
Non-trainable params: 4,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         358922      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 1,624,587
Trainable params: 1,618,611
Non-trainable params: 5,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 98s - loss: 0.9026 - acc: 0.7046 - val_loss: 2.2371 - val_acc: 0.4964
Epoch 2/10
 - 88s - loss: 0.6734 - acc: 0.8089 - val_loss: 1.3880 - val_acc: 0.5254
Epoch 3/10
 - 87s - loss: 0.5581 - acc: 0.8693 - val_loss: 1.2238 - val_acc: 0.5240
Epoch 4/10
 - 87s - loss: 0.4686 - acc: 0.9140 - val_loss: 1.3060 - val_acc: 0.5008
Epoch 5/10
 - 87s - loss: 0.3958 - acc: 0.9486 - val_loss: 0.8991 - val_acc: 0.6589
Epoch 6/10
 - 86s - loss: 0.3456 - acc: 0.9693 - val_loss: 0.9237 - val_acc: 0.6295
Epoch 7/10
 - 87s - loss: 0.3092 - acc: 0.9814 - val_loss: 0.9896 - val_acc: 0.5758

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 8/10
 - 87s - loss: 0.2883 - acc: 0.9878 - val_loss: 0.9997 - val_acc: 0.5958
Epoch 9/10
 - 87s - loss: 0.2787 - acc: 0.9907 - val_loss: 1.0506 - val_acc: 0.5861

Epoch 00009: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00009: early stopping
Test accuracy:0.531
current auc_score ------------------> 0.702
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   4224        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   6528        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 92, 12, 12)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 92, 12, 12)   368         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 92, 12, 12)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   8832        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 116, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     5568        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 82, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 82, 6, 6)     328         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 82, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     7872        activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 106, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 106, 6, 6)    424         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 106, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     10176       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 130, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     6240        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 89, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 89, 3, 3)     356         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 89, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     8544        activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 113, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 113, 3, 3)    452         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 113, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     10848       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 137, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_29[0][0]              
==================================================================================================
Total params: 358,922
Trainable params: 353,970
Non-trainable params: 4,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         358922      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 1,624,587
Trainable params: 1,618,611
Non-trainable params: 5,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 102s - loss: 0.9605 - acc: 0.6765 - val_loss: 4.0128 - val_acc: 0.4974
Epoch 2/10
 - 89s - loss: 0.7108 - acc: 0.7917 - val_loss: 1.5738 - val_acc: 0.5133
Epoch 3/10
 - 88s - loss: 0.5879 - acc: 0.8581 - val_loss: 1.1941 - val_acc: 0.5425
Epoch 4/10
 - 89s - loss: 0.4990 - acc: 0.9003 - val_loss: 1.0163 - val_acc: 0.5836
Epoch 5/10
 - 89s - loss: 0.4267 - acc: 0.9354 - val_loss: 0.9793 - val_acc: 0.5738
Epoch 6/10
 - 89s - loss: 0.3683 - acc: 0.9598 - val_loss: 1.5361 - val_acc: 0.5195
Epoch 7/10
 - 88s - loss: 0.3307 - acc: 0.9733 - val_loss: 1.0550 - val_acc: 0.5761

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 8/10
 - 89s - loss: 0.3052 - acc: 0.9832 - val_loss: 0.9281 - val_acc: 0.6018
Epoch 9/10
 - 89s - loss: 0.2941 - acc: 0.9854 - val_loss: 0.9391 - val_acc: 0.6183
Epoch 10/10
 - 89s - loss: 0.2834 - acc: 0.9894 - val_loss: 0.9355 - val_acc: 0.6175

Epoch 00010: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Test accuracy:0.668
current auc_score ------------------> 0.709
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 44, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 44, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   4224        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 68, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   6528        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 92, 12, 12)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 92, 12, 12)   368         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 92, 12, 12)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   8832        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 116, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 12, 12)  464         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 12, 12)   6728        activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 58, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 6, 6)     232         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 58, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     5568        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 82, 6, 6)     0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 82, 6, 6)     328         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 82, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     7872        activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 106, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 106, 6, 6)    424         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 106, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     10176       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 130, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 6, 6)    520         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 130, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 6, 6)     8450        activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 65, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 3, 3)     260         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 65, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     6240        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 89, 3, 3)     0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 89, 3, 3)     356         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 89, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     8544        activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 113, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 113, 3, 3)    452         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 113, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     10848       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 137, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 3, 3)    548         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 137, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1233)         0           activation_29[0][0]              
==================================================================================================
Total params: 358,922
Trainable params: 353,970
Non-trainable params: 4,952
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1233)         358922      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 2466)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1263104     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 1,624,587
Trainable params: 1,618,611
Non-trainable params: 5,976
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 105s - loss: 0.9408 - acc: 0.6893 - val_loss: 0.9674 - val_acc: 0.6772
Epoch 2/10
 - 93s - loss: 0.7218 - acc: 0.7903 - val_loss: 0.9591 - val_acc: 0.7123
Epoch 3/10
 - 92s - loss: 0.5830 - acc: 0.8615 - val_loss: 0.6022 - val_acc: 0.8558
Epoch 4/10
 - 92s - loss: 0.4794 - acc: 0.9145 - val_loss: 0.4713 - val_acc: 0.9168
Epoch 5/10
 - 91s - loss: 0.4085 - acc: 0.9457 - val_loss: 0.4671 - val_acc: 0.9163
Epoch 6/10
 - 92s - loss: 0.3517 - acc: 0.9688 - val_loss: 0.3226 - val_acc: 0.9784
Epoch 7/10
 - 91s - loss: 0.3190 - acc: 0.9778 - val_loss: 0.2934 - val_acc: 0.9877
Epoch 8/10
 - 91s - loss: 0.2938 - acc: 0.9865 - val_loss: 0.2671 - val_acc: 0.9936
Epoch 9/10
 - 91s - loss: 0.2733 - acc: 0.9914 - val_loss: 0.2677 - val_acc: 0.9915
Epoch 10/10
 - 91s - loss: 0.2595 - acc: 0.9946 - val_loss: 0.2567 - val_acc: 0.9927
Test accuracy:0.706
current auc_score ------------------> 0.843
accuracies:  [0.7288978494623656, 0.5862903225806452, 0.5311827956989247, 0.6682795698924732, 0.7063172043010753]
aucs:  [0.8665541897907273, 0.817817449994219, 0.7021416854549659, 0.7092529844490693, 0.842985243958839]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 24, 24)   5618        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 53, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 12, 12)   212         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 53, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  6360        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 12, 12)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 83, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  9960        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 12, 12)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 113, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  13560       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 12, 12)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 143, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 12, 12)   10153       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 71, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 6, 6)     284         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 71, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    8520        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 6, 6)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 101, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    12120       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 6, 6)    524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 131, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    15720       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 6, 6)    644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 161, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 6, 6)     12880       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 80, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 3, 3)     320         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 80, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    9600        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    13200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 3, 3)    560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 140, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    16800       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 3, 3)    680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 170, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1530)         0           activation_29[0][0]              
==================================================================================================
Total params: 552,859
Trainable params: 546,747
Non-trainable params: 6,112
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1530)         552859      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3060)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1567232     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,122,652
Trainable params: 2,115,516
Non-trainable params: 7,136
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 124s - loss: 0.9830 - acc: 0.7027 - val_loss: 1.1300 - val_acc: 0.6509
Epoch 2/10
 - 111s - loss: 0.7426 - acc: 0.8132 - val_loss: 0.7700 - val_acc: 0.8117
Epoch 3/10
 - 111s - loss: 0.6097 - acc: 0.8802 - val_loss: 0.5567 - val_acc: 0.9101
Epoch 4/10
 - 111s - loss: 0.5177 - acc: 0.9241 - val_loss: 0.4789 - val_acc: 0.9454
Epoch 5/10
 - 111s - loss: 0.4468 - acc: 0.9552 - val_loss: 0.4034 - val_acc: 0.9743
Epoch 6/10
 - 112s - loss: 0.3928 - acc: 0.9742 - val_loss: 0.3707 - val_acc: 0.9826
Epoch 7/10
 - 111s - loss: 0.3617 - acc: 0.9838 - val_loss: 0.4307 - val_acc: 0.9518
Epoch 8/10
 - 111s - loss: 0.3402 - acc: 0.9890 - val_loss: 0.3251 - val_acc: 0.9918
Epoch 9/10
 - 112s - loss: 0.3215 - acc: 0.9930 - val_loss: 0.3789 - val_acc: 0.9699
Epoch 10/10
 - 112s - loss: 0.3063 - acc: 0.9952 - val_loss: 0.3008 - val_acc: 0.9950
Test accuracy:0.617
current auc_score ------------------> 0.856
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 24, 24)   5618        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 53, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 12, 12)   212         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 53, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  6360        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 12, 12)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 83, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  9960        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 12, 12)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 113, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  13560       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 12, 12)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 143, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 12, 12)   10153       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 71, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 6, 6)     284         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 71, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    8520        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 6, 6)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 101, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    12120       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 6, 6)    524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 131, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    15720       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 6, 6)    644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 161, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 6, 6)     12880       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 80, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 3, 3)     320         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 80, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    9600        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    13200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 3, 3)    560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 140, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    16800       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 3, 3)    680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 170, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1530)         0           activation_29[0][0]              
==================================================================================================
Total params: 552,859
Trainable params: 546,747
Non-trainable params: 6,112
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1530)         552859      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3060)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1567232     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,122,652
Trainable params: 2,115,516
Non-trainable params: 7,136
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 124s - loss: 0.9580 - acc: 0.7118 - val_loss: 0.9357 - val_acc: 0.7258
Epoch 2/10
 - 112s - loss: 0.7279 - acc: 0.8199 - val_loss: 0.9470 - val_acc: 0.7390
Epoch 3/10
 - 112s - loss: 0.6063 - acc: 0.8814 - val_loss: 0.5745 - val_acc: 0.9017
Epoch 4/10
 - 112s - loss: 0.5149 - acc: 0.9243 - val_loss: 0.4952 - val_acc: 0.9282
Epoch 5/10
 - 112s - loss: 0.4473 - acc: 0.9529 - val_loss: 0.4232 - val_acc: 0.9652
Epoch 6/10
 - 112s - loss: 0.3963 - acc: 0.9719 - val_loss: 0.3841 - val_acc: 0.9740
Epoch 7/10
 - 112s - loss: 0.3623 - acc: 0.9828 - val_loss: 0.3871 - val_acc: 0.9689
Epoch 8/10
 - 112s - loss: 0.3366 - acc: 0.9900 - val_loss: 0.3222 - val_acc: 0.9926
Epoch 9/10
 - 112s - loss: 0.3171 - acc: 0.9929 - val_loss: 0.3147 - val_acc: 0.9902
Epoch 10/10
 - 112s - loss: 0.3020 - acc: 0.9952 - val_loss: 0.2850 - val_acc: 0.9989
Test accuracy:0.643
current auc_score ------------------> 0.852
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 24, 24)   5618        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 53, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 12, 12)   212         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 53, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  6360        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 12, 12)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 83, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  9960        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 12, 12)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 113, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  13560       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 12, 12)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 143, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 12, 12)   10153       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 71, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 6, 6)     284         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 71, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    8520        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 6, 6)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 101, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    12120       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 6, 6)    524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 131, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    15720       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 6, 6)    644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 161, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 6, 6)     12880       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 80, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 3, 3)     320         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 80, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    9600        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    13200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 3, 3)    560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 140, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    16800       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 3, 3)    680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 170, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1530)         0           activation_29[0][0]              
==================================================================================================
Total params: 552,859
Trainable params: 546,747
Non-trainable params: 6,112
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1530)         552859      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3060)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1567232     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,122,652
Trainable params: 2,115,516
Non-trainable params: 7,136
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 122s - loss: 0.9688 - acc: 0.7088 - val_loss: 3.1274 - val_acc: 0.4969
Epoch 2/10
 - 110s - loss: 0.7340 - acc: 0.8176 - val_loss: 2.3193 - val_acc: 0.5036
Epoch 3/10
 - 111s - loss: 0.6142 - acc: 0.8775 - val_loss: 1.0758 - val_acc: 0.5355
Epoch 4/10
 - 110s - loss: 0.5170 - acc: 0.9229 - val_loss: 1.1476 - val_acc: 0.4882
Epoch 5/10
 - 110s - loss: 0.4425 - acc: 0.9556 - val_loss: 1.0253 - val_acc: 0.5853
Epoch 6/10
 - 110s - loss: 0.3914 - acc: 0.9746 - val_loss: 1.1335 - val_acc: 0.5427
Epoch 7/10
 - 111s - loss: 0.3566 - acc: 0.9843 - val_loss: 1.5484 - val_acc: 0.5136

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 8/10
 - 111s - loss: 0.3383 - acc: 0.9903 - val_loss: 1.1873 - val_acc: 0.5492
Epoch 9/10
 - 110s - loss: 0.3257 - acc: 0.9931 - val_loss: 1.0484 - val_acc: 0.5960

Epoch 00009: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 10/10
 - 111s - loss: 0.3208 - acc: 0.9938 - val_loss: 1.1108 - val_acc: 0.5860
Test accuracy:0.645
current auc_score ------------------> 0.777
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 24, 24)   5618        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 53, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 12, 12)   212         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 53, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  6360        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 12, 12)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 83, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  9960        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 12, 12)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 113, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  13560       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 12, 12)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 143, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 12, 12)   10153       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 71, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 6, 6)     284         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 71, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    8520        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 6, 6)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 101, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    12120       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 6, 6)    524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 131, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    15720       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 6, 6)    644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 161, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 6, 6)     12880       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 80, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 3, 3)     320         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 80, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    9600        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    13200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 3, 3)    560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 140, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    16800       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 3, 3)    680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 170, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1530)         0           activation_29[0][0]              
==================================================================================================
Total params: 552,859
Trainable params: 546,747
Non-trainable params: 6,112
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1530)         552859      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3060)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1567232     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,122,652
Trainable params: 2,115,516
Non-trainable params: 7,136
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 123s - loss: 0.9665 - acc: 0.7022 - val_loss: 1.4058 - val_acc: 0.4908
Epoch 2/10
 - 111s - loss: 0.7284 - acc: 0.8156 - val_loss: 1.8352 - val_acc: 0.5097
Epoch 3/10
 - 111s - loss: 0.5926 - acc: 0.8893 - val_loss: 0.5902 - val_acc: 0.8898
Epoch 4/10
 - 111s - loss: 0.5027 - acc: 0.9309 - val_loss: 0.4804 - val_acc: 0.9371
Epoch 5/10
 - 111s - loss: 0.4277 - acc: 0.9620 - val_loss: 0.4159 - val_acc: 0.9606
Epoch 6/10
 - 111s - loss: 0.3844 - acc: 0.9779 - val_loss: 0.3711 - val_acc: 0.9777
Epoch 7/10
 - 111s - loss: 0.3531 - acc: 0.9870 - val_loss: 0.3348 - val_acc: 0.9913
Epoch 8/10
 - 111s - loss: 0.3320 - acc: 0.9920 - val_loss: 0.3223 - val_acc: 0.9922
Epoch 9/10
 - 111s - loss: 0.3168 - acc: 0.9941 - val_loss: 0.3165 - val_acc: 0.9908
Epoch 10/10
 - 111s - loss: 0.3035 - acc: 0.9952 - val_loss: 0.3090 - val_acc: 0.9895
Test accuracy:0.619
current auc_score ------------------> 0.766
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 24, 24)   5618        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 53, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 12, 12)   212         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 53, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  6360        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 12, 12)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 83, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  9960        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 12, 12)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 113, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  13560       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 12, 12)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 143, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 12, 12)   10153       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 71, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 6, 6)     284         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 71, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    8520        activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 6, 6)    404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 101, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    12120       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 6, 6)    524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 131, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    15720       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 6, 6)    644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 161, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 6, 6)     12880       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 80, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 3, 3)     320         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 80, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    9600        activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    13200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 3, 3)    560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 140, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    16800       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 3, 3)    680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 170, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1530)         0           activation_29[0][0]              
==================================================================================================
Total params: 552,859
Trainable params: 546,747
Non-trainable params: 6,112
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1530)         552859      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3060)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1567232     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,122,652
Trainable params: 2,115,516
Non-trainable params: 7,136
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 124s - loss: 0.9554 - acc: 0.7136 - val_loss: 1.1387 - val_acc: 0.6265
Epoch 2/10
 - 110s - loss: 0.7101 - acc: 0.8271 - val_loss: 1.1436 - val_acc: 0.5428
Epoch 3/10
 - 111s - loss: 0.5870 - acc: 0.8891 - val_loss: 1.0305 - val_acc: 0.6028
Epoch 4/10
 - 110s - loss: 0.4989 - acc: 0.9314 - val_loss: 1.0026 - val_acc: 0.5815
Epoch 5/10
 - 110s - loss: 0.4299 - acc: 0.9609 - val_loss: 1.0399 - val_acc: 0.6119
Epoch 00005: early stopping
Test accuracy:0.722
current auc_score ------------------> 0.661
accuracies:  [0.6173387096774193, 0.6426075268817204, 0.6454301075268817, 0.619489247311828, 0.7219086021505376]
aucs:  [0.8556587466759162, 0.8515402792230315, 0.7772422028558215, 0.7658286362585269, 0.6613172043010752]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 62, 24, 24)   7688        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 62, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 62, 12, 12)   248         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 62, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  8928        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  14112       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 134, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 134, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  19296       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 170, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 170, 12, 12)  680         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 170, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 85, 12, 12)   14450       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 85, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 85, 6, 6)     340         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 85, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    12240       activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 121, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 121, 6, 6)    484         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 121, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    17424       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 157, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 157, 6, 6)    628         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 157, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    22608       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 193, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 193, 6, 6)    772         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 193, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 96, 6, 6)     18528       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 96, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 96, 3, 3)     384         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    13824       activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 132, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 132, 3, 3)    528         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 132, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    19008       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 168, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 168, 3, 3)    672         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 168, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    24192       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 204, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 204, 3, 3)    816         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 204, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1836)         0           activation_29[0][0]              
==================================================================================================
Total params: 789,994
Trainable params: 782,706
Non-trainable params: 7,288
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1836)         789994      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3672)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1880576     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,673,131
Trainable params: 2,664,819
Non-trainable params: 8,312
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 154s - loss: 1.0536 - acc: 0.7027 - val_loss: 0.9772 - val_acc: 0.7075
Epoch 2/10
 - 142s - loss: 0.8048 - acc: 0.8149 - val_loss: 0.9666 - val_acc: 0.7359
Epoch 3/10
 - 143s - loss: 0.6809 - acc: 0.8784 - val_loss: 0.7326 - val_acc: 0.8510
Epoch 4/10
 - 144s - loss: 0.5733 - acc: 0.9288 - val_loss: 0.5998 - val_acc: 0.9083
Epoch 5/10
 - 143s - loss: 0.4966 - acc: 0.9594 - val_loss: 0.4452 - val_acc: 0.9792
Epoch 6/10
 - 143s - loss: 0.4422 - acc: 0.9795 - val_loss: 0.4217 - val_acc: 0.9810
Epoch 7/10
 - 143s - loss: 0.4125 - acc: 0.9875 - val_loss: 0.3865 - val_acc: 0.9933
Epoch 8/10
 - 143s - loss: 0.3875 - acc: 0.9928 - val_loss: 0.3746 - val_acc: 0.9940
Epoch 9/10
 - 143s - loss: 0.3686 - acc: 0.9949 - val_loss: 0.3555 - val_acc: 0.9971
Epoch 10/10
 - 143s - loss: 0.3514 - acc: 0.9964 - val_loss: 0.3605 - val_acc: 0.9906
Test accuracy:0.601
current auc_score ------------------> 0.782
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 62, 24, 24)   7688        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 62, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 62, 12, 12)   248         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 62, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  8928        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  14112       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 134, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 134, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  19296       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 170, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 170, 12, 12)  680         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 170, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 85, 12, 12)   14450       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 85, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 85, 6, 6)     340         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 85, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    12240       activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 121, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 121, 6, 6)    484         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 121, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    17424       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 157, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 157, 6, 6)    628         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 157, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    22608       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 193, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 193, 6, 6)    772         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 193, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 96, 6, 6)     18528       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 96, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 96, 3, 3)     384         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    13824       activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 132, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 132, 3, 3)    528         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 132, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    19008       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 168, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 168, 3, 3)    672         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 168, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    24192       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 204, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 204, 3, 3)    816         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 204, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1836)         0           activation_29[0][0]              
==================================================================================================
Total params: 789,994
Trainable params: 782,706
Non-trainable params: 7,288
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1836)         789994      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3672)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1880576     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,673,131
Trainable params: 2,664,819
Non-trainable params: 8,312
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 150s - loss: 1.0305 - acc: 0.7060 - val_loss: 1.3598 - val_acc: 0.5458
Epoch 2/10
 - 138s - loss: 0.7806 - acc: 0.8264 - val_loss: 1.7248 - val_acc: 0.5065
Epoch 3/10
 - 139s - loss: 0.6554 - acc: 0.8891 - val_loss: 1.7957 - val_acc: 0.4880

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/10
 - 139s - loss: 0.5713 - acc: 0.9297 - val_loss: 1.2891 - val_acc: 0.4575
Epoch 5/10
 - 139s - loss: 0.5322 - acc: 0.9470 - val_loss: 1.2288 - val_acc: 0.4772
Epoch 00005: early stopping
Test accuracy:0.493
current auc_score ------------------> 0.537
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 62, 24, 24)   7688        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 62, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 62, 12, 12)   248         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 62, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  8928        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  14112       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 134, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 134, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  19296       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 170, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 170, 12, 12)  680         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 170, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 85, 12, 12)   14450       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 85, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 85, 6, 6)     340         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 85, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    12240       activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 121, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 121, 6, 6)    484         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 121, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    17424       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 157, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 157, 6, 6)    628         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 157, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    22608       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 193, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 193, 6, 6)    772         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 193, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 96, 6, 6)     18528       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 96, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 96, 3, 3)     384         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    13824       activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 132, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 132, 3, 3)    528         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 132, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    19008       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 168, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 168, 3, 3)    672         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 168, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    24192       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 204, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 204, 3, 3)    816         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 204, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1836)         0           activation_29[0][0]              
==================================================================================================
Total params: 789,994
Trainable params: 782,706
Non-trainable params: 7,288
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1836)         789994      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3672)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1880576     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,673,131
Trainable params: 2,664,819
Non-trainable params: 8,312
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 151s - loss: 1.0397 - acc: 0.6953 - val_loss: 1.3421 - val_acc: 0.5558
Epoch 2/10
 - 139s - loss: 0.7955 - acc: 0.8146 - val_loss: 2.0084 - val_acc: 0.5159
Epoch 3/10
 - 139s - loss: 0.6470 - acc: 0.8940 - val_loss: 1.8200 - val_acc: 0.5018

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/10
 - 138s - loss: 0.5513 - acc: 0.9387 - val_loss: 1.0118 - val_acc: 0.6467
Epoch 5/10
 - 139s - loss: 0.5191 - acc: 0.9502 - val_loss: 1.0033 - val_acc: 0.6723
Epoch 6/10
 - 139s - loss: 0.4836 - acc: 0.9674 - val_loss: 0.9855 - val_acc: 0.6786
Epoch 7/10
 - 139s - loss: 0.4599 - acc: 0.9738 - val_loss: 1.4854 - val_acc: 0.5166
Epoch 8/10
 - 139s - loss: 0.4391 - acc: 0.9813 - val_loss: 1.3379 - val_acc: 0.5389

Epoch 00008: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 9/10
 - 138s - loss: 0.4253 - acc: 0.9858 - val_loss: 1.5197 - val_acc: 0.5217
Epoch 10/10
 - 138s - loss: 0.4192 - acc: 0.9868 - val_loss: 1.5763 - val_acc: 0.5223

Epoch 00010: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Epoch 00010: early stopping
Test accuracy:0.506
current auc_score ------------------> 0.716
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 62, 24, 24)   7688        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 62, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 62, 12, 12)   248         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 62, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  8928        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  14112       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 134, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 134, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  19296       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 170, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 170, 12, 12)  680         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 170, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 85, 12, 12)   14450       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 85, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 85, 6, 6)     340         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 85, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    12240       activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 121, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 121, 6, 6)    484         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 121, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    17424       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 157, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 157, 6, 6)    628         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 157, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    22608       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 193, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 193, 6, 6)    772         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 193, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 96, 6, 6)     18528       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 96, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 96, 3, 3)     384         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    13824       activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 132, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 132, 3, 3)    528         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 132, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    19008       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 168, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 168, 3, 3)    672         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 168, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    24192       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 204, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 204, 3, 3)    816         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 204, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1836)         0           activation_29[0][0]              
==================================================================================================
Total params: 789,994
Trainable params: 782,706
Non-trainable params: 7,288
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1836)         789994      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3672)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1880576     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,673,131
Trainable params: 2,664,819
Non-trainable params: 8,312
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 151s - loss: 1.0105 - acc: 0.7188 - val_loss: 2.0381 - val_acc: 0.4982
Epoch 2/10
 - 139s - loss: 0.7564 - acc: 0.8373 - val_loss: 1.3508 - val_acc: 0.5260
Epoch 3/10
 - 138s - loss: 0.6368 - acc: 0.8968 - val_loss: 1.0826 - val_acc: 0.5571
Epoch 4/10
 - 139s - loss: 0.5451 - acc: 0.9398 - val_loss: 1.1298 - val_acc: 0.5479
Epoch 5/10
 - 138s - loss: 0.4758 - acc: 0.9677 - val_loss: 1.2872 - val_acc: 0.5265

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/10
 - 138s - loss: 0.4358 - acc: 0.9818 - val_loss: 1.0515 - val_acc: 0.6067
Epoch 7/10
 - 138s - loss: 0.4211 - acc: 0.9859 - val_loss: 1.1032 - val_acc: 0.5543
Epoch 8/10
 - 138s - loss: 0.4078 - acc: 0.9893 - val_loss: 1.1294 - val_acc: 0.5751

Epoch 00008: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 9/10
 - 138s - loss: 0.3981 - acc: 0.9920 - val_loss: 1.0865 - val_acc: 0.5920
Epoch 10/10
 - 138s - loss: 0.3953 - acc: 0.9918 - val_loss: 1.1170 - val_acc: 0.5970

Epoch 00010: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Epoch 00010: early stopping
Test accuracy:0.674
current auc_score ------------------> 0.670
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [3, 3, 3, 3]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 62, 24, 24)   7688        activation_8[0][0]               
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 62, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 62, 12, 12)   248         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 62, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  8928        activation_9[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  14112       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 134, 12, 12)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 134, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  19296       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 170, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 170, 12, 12)  680         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 170, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 85, 12, 12)   14450       activation_15[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 85, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 85, 6, 6)     340         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 85, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    12240       activation_16[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 121, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 121, 6, 6)    484         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 121, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    17424       activation_18[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 157, 6, 6)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 157, 6, 6)    628         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 157, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    22608       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 193, 6, 6)    0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 193, 6, 6)    772         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 193, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 96, 6, 6)     18528       activation_22[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 96, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 96, 3, 3)     384         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    13824       activation_23[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 132, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 132, 3, 3)    528         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 132, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    19008       activation_25[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 168, 3, 3)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 168, 3, 3)    672         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 168, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    24192       activation_27[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 204, 3, 3)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 204, 3, 3)    816         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 204, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1836)         0           activation_29[0][0]              
==================================================================================================
Total params: 789,994
Trainable params: 782,706
Non-trainable params: 7,288
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1836)         789994      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3672)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1880576     merge_features[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_13[0][0]                 
==================================================================================================
Total params: 2,673,131
Trainable params: 2,664,819
Non-trainable params: 8,312
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 156s - loss: 1.0560 - acc: 0.6931 - val_loss: 1.0479 - val_acc: 0.6767
Epoch 2/10
 - 144s - loss: 0.8175 - acc: 0.8030 - val_loss: 0.8160 - val_acc: 0.7937
Epoch 3/10
 - 144s - loss: 0.6816 - acc: 0.8743 - val_loss: 0.7733 - val_acc: 0.8262
Epoch 4/10
 - 143s - loss: 0.5708 - acc: 0.9287 - val_loss: 0.6045 - val_acc: 0.9046
Epoch 5/10
 - 144s - loss: 0.4911 - acc: 0.9614 - val_loss: 0.4856 - val_acc: 0.9570
Epoch 6/10
 - 144s - loss: 0.4426 - acc: 0.9777 - val_loss: 0.4283 - val_acc: 0.9805
Epoch 7/10
 - 144s - loss: 0.4095 - acc: 0.9879 - val_loss: 0.4260 - val_acc: 0.9782
Epoch 8/10
 - 144s - loss: 0.3838 - acc: 0.9935 - val_loss: 0.3777 - val_acc: 0.9906
Epoch 9/10
 - 144s - loss: 0.3638 - acc: 0.9960 - val_loss: 0.3947 - val_acc: 0.9817
Epoch 10/10
 - 144s - loss: 0.3474 - acc: 0.9971 - val_loss: 0.3505 - val_acc: 0.9913
Test accuracy:0.652
current auc_score ------------------> 0.813
accuracies:  [0.6013440860215054, 0.4931451612903226, 0.5060483870967742, 0.6736559139784947, 0.6516129032258065]
aucs:  [0.7821455153775003, 0.5368342077118743, 0.7164198895826107, 0.6701607483524107, 0.8131701641808302]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 56, 24, 24)   6272        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 56, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 56, 12, 12)   224         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 56, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 104, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 104, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 152, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 152, 12, 12)  608         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 152, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 76, 12, 12)   11552       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 76, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 76, 6, 6)     304         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 76, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     7296        activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 100, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 100, 6, 6)    400         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 100, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 124, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 124, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     11904       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 148, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     14208       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 172, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 172, 6, 6)    688         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 172, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 86, 6, 6)     14792       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 86, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 86, 3, 3)     344         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 86, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     8256        activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     10560       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 134, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 134, 3, 3)    536         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 134, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     12864       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 158, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 158, 3, 3)    632         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 158, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     15168       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 182, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 182, 3, 3)    728         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 182, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1638)         0           activation_37[0][0]              
==================================================================================================
Total params: 525,056
Trainable params: 517,692
Non-trainable params: 7,364
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1638)         525056      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3276)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1677824     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,205,441
Trainable params: 2,197,053
Non-trainable params: 8,388
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 134s - loss: 1.0259 - acc: 0.6824 - val_loss: 1.3598 - val_acc: 0.5364
Epoch 2/10
 - 119s - loss: 0.7915 - acc: 0.7971 - val_loss: 0.8584 - val_acc: 0.7917
Epoch 3/10
 - 118s - loss: 0.6661 - acc: 0.8610 - val_loss: 0.7131 - val_acc: 0.8504
Epoch 4/10
 - 116s - loss: 0.5658 - acc: 0.9107 - val_loss: 0.5985 - val_acc: 0.9021
Epoch 5/10
 - 117s - loss: 0.4876 - acc: 0.9461 - val_loss: 0.4594 - val_acc: 0.9601
Epoch 6/10
 - 117s - loss: 0.4328 - acc: 0.9674 - val_loss: 0.4071 - val_acc: 0.9759
Epoch 7/10
 - 117s - loss: 0.3937 - acc: 0.9799 - val_loss: 0.3840 - val_acc: 0.9805
Epoch 8/10
 - 117s - loss: 0.3684 - acc: 0.9866 - val_loss: 0.3645 - val_acc: 0.9844
Epoch 9/10
 - 117s - loss: 0.3456 - acc: 0.9919 - val_loss: 0.3350 - val_acc: 0.9920
Epoch 10/10
 - 116s - loss: 0.3292 - acc: 0.9943 - val_loss: 0.3262 - val_acc: 0.9905
Test accuracy:0.658
current auc_score ------------------> 0.906
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 56, 24, 24)   6272        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 56, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 56, 12, 12)   224         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 56, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 104, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 104, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 152, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 152, 12, 12)  608         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 152, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 76, 12, 12)   11552       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 76, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 76, 6, 6)     304         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 76, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     7296        activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 100, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 100, 6, 6)    400         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 100, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 124, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 124, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     11904       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 148, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     14208       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 172, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 172, 6, 6)    688         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 172, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 86, 6, 6)     14792       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 86, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 86, 3, 3)     344         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 86, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     8256        activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     10560       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 134, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 134, 3, 3)    536         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 134, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     12864       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 158, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 158, 3, 3)    632         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 158, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     15168       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 182, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 182, 3, 3)    728         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 182, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1638)         0           activation_37[0][0]              
==================================================================================================
Total params: 525,056
Trainable params: 517,692
Non-trainable params: 7,364
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1638)         525056      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3276)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1677824     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,205,441
Trainable params: 2,197,053
Non-trainable params: 8,388
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 131s - loss: 1.0051 - acc: 0.6991 - val_loss: 5.5044 - val_acc: 0.4965
Epoch 2/10
 - 116s - loss: 0.7946 - acc: 0.7981 - val_loss: 1.0576 - val_acc: 0.6109
Epoch 3/10
 - 116s - loss: 0.6575 - acc: 0.8663 - val_loss: 1.1474 - val_acc: 0.5446
Epoch 4/10
 - 116s - loss: 0.5517 - acc: 0.9195 - val_loss: 1.6680 - val_acc: 0.5056

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 116s - loss: 0.4834 - acc: 0.9494 - val_loss: 1.5952 - val_acc: 0.5080
Epoch 6/10
 - 116s - loss: 0.4545 - acc: 0.9609 - val_loss: 1.9841 - val_acc: 0.5041

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00006: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.669
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 56, 24, 24)   6272        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 56, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 56, 12, 12)   224         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 56, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 104, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 104, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 152, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 152, 12, 12)  608         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 152, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 76, 12, 12)   11552       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 76, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 76, 6, 6)     304         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 76, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     7296        activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 100, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 100, 6, 6)    400         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 100, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 124, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 124, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     11904       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 148, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     14208       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 172, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 172, 6, 6)    688         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 172, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 86, 6, 6)     14792       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 86, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 86, 3, 3)     344         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 86, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     8256        activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     10560       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 134, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 134, 3, 3)    536         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 134, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     12864       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 158, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 158, 3, 3)    632         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 158, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     15168       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 182, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 182, 3, 3)    728         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 182, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1638)         0           activation_37[0][0]              
==================================================================================================
Total params: 525,056
Trainable params: 517,692
Non-trainable params: 7,364
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1638)         525056      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3276)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1677824     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,205,441
Trainable params: 2,197,053
Non-trainable params: 8,388
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 131s - loss: 1.0198 - acc: 0.6890 - val_loss: 1.2099 - val_acc: 0.5528
Epoch 2/10
 - 116s - loss: 0.7778 - acc: 0.8067 - val_loss: 2.1733 - val_acc: 0.5014
Epoch 3/10
 - 115s - loss: 0.6683 - acc: 0.8625 - val_loss: 1.8286 - val_acc: 0.4979

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/10
 - 115s - loss: 0.5949 - acc: 0.8983 - val_loss: 1.2314 - val_acc: 0.5281
Epoch 5/10
 - 115s - loss: 0.5596 - acc: 0.9159 - val_loss: 1.3201 - val_acc: 0.5122

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.611
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 56, 24, 24)   6272        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 56, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 56, 12, 12)   224         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 56, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 104, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 104, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 152, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 152, 12, 12)  608         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 152, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 76, 12, 12)   11552       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 76, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 76, 6, 6)     304         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 76, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     7296        activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 100, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 100, 6, 6)    400         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 100, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 124, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 124, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     11904       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 148, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     14208       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 172, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 172, 6, 6)    688         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 172, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 86, 6, 6)     14792       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 86, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 86, 3, 3)     344         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 86, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     8256        activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     10560       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 134, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 134, 3, 3)    536         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 134, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     12864       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 158, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 158, 3, 3)    632         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 158, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     15168       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 182, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 182, 3, 3)    728         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 182, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1638)         0           activation_37[0][0]              
==================================================================================================
Total params: 525,056
Trainable params: 517,692
Non-trainable params: 7,364
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1638)         525056      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3276)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1677824     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,205,441
Trainable params: 2,197,053
Non-trainable params: 8,388
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 131s - loss: 1.0193 - acc: 0.6869 - val_loss: 1.6793 - val_acc: 0.5072
Epoch 2/10
 - 115s - loss: 0.7781 - acc: 0.8003 - val_loss: 1.3950 - val_acc: 0.5607
Epoch 3/10
 - 115s - loss: 0.6401 - acc: 0.8737 - val_loss: 1.0182 - val_acc: 0.6239
Epoch 4/10
 - 116s - loss: 0.5473 - acc: 0.9182 - val_loss: 0.9704 - val_acc: 0.6437
Epoch 5/10
 - 116s - loss: 0.4694 - acc: 0.9539 - val_loss: 0.9570 - val_acc: 0.6434
Epoch 6/10
 - 116s - loss: 0.4160 - acc: 0.9733 - val_loss: 0.9271 - val_acc: 0.6822
Epoch 7/10
 - 116s - loss: 0.3795 - acc: 0.9848 - val_loss: 1.1792 - val_acc: 0.5275
Epoch 8/10
 - 117s - loss: 0.3580 - acc: 0.9896 - val_loss: 0.8839 - val_acc: 0.7091
Epoch 9/10
 - 116s - loss: 0.3366 - acc: 0.9936 - val_loss: 1.0367 - val_acc: 0.6214
Epoch 10/10
 - 116s - loss: 0.3210 - acc: 0.9955 - val_loss: 1.1379 - val_acc: 0.5884

Epoch 00010: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Test accuracy:0.570
current auc_score ------------------> 0.782
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 56, 24, 24)   6272        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 56, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 56, 12, 12)   224         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 56, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   5376        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 80, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 80, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 104, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 104, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 152, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 152, 12, 12)  608         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 152, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 76, 12, 12)   11552       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 76, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 76, 6, 6)     304         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 76, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     7296        activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 100, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 100, 6, 6)    400         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 100, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 124, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 124, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     11904       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 148, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     14208       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 172, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 172, 6, 6)    688         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 172, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 86, 6, 6)     14792       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 86, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 86, 3, 3)     344         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 86, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     8256        activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 110, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 3, 3)    440         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 110, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     10560       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 134, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 134, 3, 3)    536         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 134, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     12864       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 158, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 158, 3, 3)    632         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 158, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     15168       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 182, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 182, 3, 3)    728         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 182, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 1638)         0           activation_37[0][0]              
==================================================================================================
Total params: 525,056
Trainable params: 517,692
Non-trainable params: 7,364
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 1638)         525056      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 3276)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          1677824     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,205,441
Trainable params: 2,197,053
Non-trainable params: 8,388
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 135s - loss: 1.0307 - acc: 0.6922 - val_loss: 1.2194 - val_acc: 0.5894
Epoch 2/10
 - 118s - loss: 0.8137 - acc: 0.7824 - val_loss: 1.3409 - val_acc: 0.6033
Epoch 3/10
 - 117s - loss: 0.6941 - acc: 0.8459 - val_loss: 0.9683 - val_acc: 0.7260
Epoch 4/10
 - 118s - loss: 0.5891 - acc: 0.9010 - val_loss: 0.7485 - val_acc: 0.8120
Epoch 5/10
 - 116s - loss: 0.5096 - acc: 0.9368 - val_loss: 0.4948 - val_acc: 0.9418
Epoch 6/10
 - 118s - loss: 0.4454 - acc: 0.9639 - val_loss: 0.4453 - val_acc: 0.9634
Epoch 7/10
 - 117s - loss: 0.3974 - acc: 0.9800 - val_loss: 0.4305 - val_acc: 0.9634
Epoch 8/10
 - 117s - loss: 0.3692 - acc: 0.9871 - val_loss: 0.3462 - val_acc: 0.9937
Epoch 9/10
 - 117s - loss: 0.3467 - acc: 0.9929 - val_loss: 0.3645 - val_acc: 0.9832
Epoch 10/10
 - 117s - loss: 0.3302 - acc: 0.9947 - val_loss: 0.3185 - val_acc: 0.9962
Test accuracy:0.701
current auc_score ------------------> 0.854
accuracies:  [0.6576612903225807, 0.5, 0.49973118279569895, 0.5702956989247312, 0.7010752688172043]
aucs:  [0.9064991617528038, 0.669095198866921, 0.6106343218869232, 0.7822974838131576, 0.854085009827726]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 68, 24, 24)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 68, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 68, 12, 12)   272         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 128, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 158, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 158, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 94, 12, 12)   17672       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 94, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 94, 6, 6)     376         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 94, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    11280       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 124, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    14880       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 154, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 154, 6, 6)    616         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 154, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    18480       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 184, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    22080       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 214, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 214, 6, 6)    856         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 214, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 107, 6, 6)    22898       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 107, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 107, 3, 3)    428         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 107, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    12840       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 137, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 137, 3, 3)    548         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 137, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    16440       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 167, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 167, 3, 3)    668         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 167, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    20040       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 197, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 197, 3, 3)    788         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 197, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    23640       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 227, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 227, 3, 3)    908         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 227, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2043)         0           activation_37[0][0]              
==================================================================================================
Total params: 810,446
Trainable params: 801,324
Non-trainable params: 9,122
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2043)         810446      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4086)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2092544     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,905,551
Trainable params: 2,895,405
Non-trainable params: 10,146
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 165s - loss: 1.1053 - acc: 0.6985 - val_loss: 1.9269 - val_acc: 0.5404
Epoch 2/10
 - 149s - loss: 0.8763 - acc: 0.7980 - val_loss: 1.4902 - val_acc: 0.5304
Epoch 3/10
 - 149s - loss: 0.7356 - acc: 0.8700 - val_loss: 1.8189 - val_acc: 0.5217
Epoch 4/10
 - 149s - loss: 0.6329 - acc: 0.9185 - val_loss: 2.0028 - val_acc: 0.5112

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 149s - loss: 0.5599 - acc: 0.9507 - val_loss: 1.1224 - val_acc: 0.5950
Epoch 6/10
 - 149s - loss: 0.5292 - acc: 0.9639 - val_loss: 1.4896 - val_acc: 0.5446
Epoch 7/10
 - 148s - loss: 0.5026 - acc: 0.9730 - val_loss: 1.5280 - val_acc: 0.5409

Epoch 00007: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 8/10
 - 148s - loss: 0.4874 - acc: 0.9787 - val_loss: 1.6628 - val_acc: 0.5272
Epoch 9/10
 - 149s - loss: 0.4815 - acc: 0.9803 - val_loss: 1.4349 - val_acc: 0.5423

Epoch 00009: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Epoch 00009: early stopping
Test accuracy:0.523
current auc_score ------------------> 0.732
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 68, 24, 24)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 68, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 68, 12, 12)   272         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 128, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 158, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 158, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 94, 12, 12)   17672       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 94, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 94, 6, 6)     376         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 94, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    11280       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 124, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    14880       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 154, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 154, 6, 6)    616         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 154, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    18480       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 184, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    22080       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 214, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 214, 6, 6)    856         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 214, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 107, 6, 6)    22898       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 107, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 107, 3, 3)    428         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 107, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    12840       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 137, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 137, 3, 3)    548         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 137, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    16440       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 167, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 167, 3, 3)    668         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 167, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    20040       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 197, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 197, 3, 3)    788         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 197, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    23640       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 227, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 227, 3, 3)    908         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 227, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2043)         0           activation_37[0][0]              
==================================================================================================
Total params: 810,446
Trainable params: 801,324
Non-trainable params: 9,122
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2043)         810446      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4086)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2092544     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,905,551
Trainable params: 2,895,405
Non-trainable params: 10,146
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 164s - loss: 1.0990 - acc: 0.6971 - val_loss: 1.2068 - val_acc: 0.5670
Epoch 2/10
 - 149s - loss: 0.8711 - acc: 0.8027 - val_loss: 1.4952 - val_acc: 0.5132
Epoch 3/10
 - 149s - loss: 0.7201 - acc: 0.8763 - val_loss: 1.4716 - val_acc: 0.5241

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/10
 - 149s - loss: 0.6269 - acc: 0.9240 - val_loss: 1.3905 - val_acc: 0.5354
Epoch 5/10
 - 150s - loss: 0.5816 - acc: 0.9440 - val_loss: 1.4634 - val_acc: 0.5312

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.431
current auc_score ------------------> 0.431
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 68, 24, 24)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 68, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 68, 12, 12)   272         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 128, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 158, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 158, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 94, 12, 12)   17672       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 94, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 94, 6, 6)     376         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 94, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    11280       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 124, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    14880       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 154, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 154, 6, 6)    616         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 154, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    18480       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 184, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    22080       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 214, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 214, 6, 6)    856         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 214, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 107, 6, 6)    22898       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 107, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 107, 3, 3)    428         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 107, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    12840       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 137, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 137, 3, 3)    548         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 137, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    16440       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 167, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 167, 3, 3)    668         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 167, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    20040       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 197, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 197, 3, 3)    788         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 197, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    23640       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 227, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 227, 3, 3)    908         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 227, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2043)         0           activation_37[0][0]              
==================================================================================================
Total params: 810,446
Trainable params: 801,324
Non-trainable params: 9,122
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2043)         810446      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4086)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2092544     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,905,551
Trainable params: 2,895,405
Non-trainable params: 10,146
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 168s - loss: 1.0877 - acc: 0.6994 - val_loss: 1.0761 - val_acc: 0.6934
Epoch 2/10
 - 152s - loss: 0.8412 - acc: 0.8184 - val_loss: 0.9173 - val_acc: 0.7781
Epoch 3/10
 - 154s - loss: 0.7175 - acc: 0.8831 - val_loss: 0.6894 - val_acc: 0.8945
Epoch 4/10
 - 154s - loss: 0.6177 - acc: 0.9270 - val_loss: 0.6443 - val_acc: 0.9090
Epoch 5/10
 - 156s - loss: 0.5421 - acc: 0.9586 - val_loss: 0.5336 - val_acc: 0.9618
Epoch 6/10
 - 156s - loss: 0.4857 - acc: 0.9787 - val_loss: 0.4979 - val_acc: 0.9721
Epoch 7/10
 - 156s - loss: 0.4547 - acc: 0.9863 - val_loss: 0.4390 - val_acc: 0.9887
Epoch 8/10
 - 156s - loss: 0.4251 - acc: 0.9927 - val_loss: 0.4157 - val_acc: 0.9922
Epoch 9/10
 - 156s - loss: 0.4028 - acc: 0.9956 - val_loss: 0.3864 - val_acc: 0.9974
Epoch 10/10
 - 154s - loss: 0.3836 - acc: 0.9969 - val_loss: 0.3704 - val_acc: 0.9976
Test accuracy:0.643
current auc_score ------------------> 0.776
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 68, 24, 24)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 68, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 68, 12, 12)   272         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 128, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 158, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 158, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 94, 12, 12)   17672       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 94, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 94, 6, 6)     376         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 94, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    11280       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 124, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    14880       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 154, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 154, 6, 6)    616         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 154, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    18480       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 184, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    22080       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 214, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 214, 6, 6)    856         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 214, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 107, 6, 6)    22898       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 107, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 107, 3, 3)    428         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 107, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    12840       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 137, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 137, 3, 3)    548         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 137, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    16440       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 167, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 167, 3, 3)    668         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 167, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    20040       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 197, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 197, 3, 3)    788         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 197, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    23640       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 227, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 227, 3, 3)    908         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 227, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2043)         0           activation_37[0][0]              
==================================================================================================
Total params: 810,446
Trainable params: 801,324
Non-trainable params: 9,122
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2043)         810446      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4086)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2092544     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,905,551
Trainable params: 2,895,405
Non-trainable params: 10,146
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 167s - loss: 1.1510 - acc: 0.6676 - val_loss: 1.1971 - val_acc: 0.5748
Epoch 2/10
 - 150s - loss: 0.9004 - acc: 0.7893 - val_loss: 1.5742 - val_acc: 0.5029
Epoch 3/10
 - 150s - loss: 0.7399 - acc: 0.8691 - val_loss: 1.9710 - val_acc: 0.4962

Epoch 00003: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 4/10
 - 150s - loss: 0.6436 - acc: 0.9175 - val_loss: 1.4235 - val_acc: 0.4612
Epoch 5/10
 - 149s - loss: 0.6014 - acc: 0.9356 - val_loss: 1.3677 - val_acc: 0.4449

Epoch 00005: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00005: early stopping
Test accuracy:0.376
current auc_score ------------------> 0.347
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 68, 24, 24)   9248        activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 68, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 68, 12, 12)   272         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 68, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  8160        activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 98, 12, 12)   0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 98, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 128, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 158, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 158, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 94, 12, 12)   17672       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 94, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 94, 6, 6)     376         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 94, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    11280       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 124, 6, 6)    496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 124, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    14880       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 154, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 154, 6, 6)    616         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 154, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    18480       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 184, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    22080       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 214, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 214, 6, 6)    856         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 214, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 107, 6, 6)    22898       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 107, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 107, 3, 3)    428         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 107, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    12840       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 137, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 137, 3, 3)    548         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 137, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    16440       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 167, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 167, 3, 3)    668         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 167, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    20040       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 197, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 197, 3, 3)    788         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 197, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    23640       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 227, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 227, 3, 3)    908         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 227, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2043)         0           activation_37[0][0]              
==================================================================================================
Total params: 810,446
Trainable params: 801,324
Non-trainable params: 9,122
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2043)         810446      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4086)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2092544     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 2,905,551
Trainable params: 2,895,405
Non-trainable params: 10,146
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 169s - loss: 1.1195 - acc: 0.6865 - val_loss: 1.4257 - val_acc: 0.5850
Epoch 2/10
 - 154s - loss: 0.8776 - acc: 0.7960 - val_loss: 1.4305 - val_acc: 0.6304
Epoch 3/10
 - 153s - loss: 0.7492 - acc: 0.8645 - val_loss: 0.9796 - val_acc: 0.7700
Epoch 4/10
 - 154s - loss: 0.6565 - acc: 0.9106 - val_loss: 0.7206 - val_acc: 0.8761
Epoch 5/10
 - 155s - loss: 0.5749 - acc: 0.9453 - val_loss: 0.6009 - val_acc: 0.9286
Epoch 6/10
 - 154s - loss: 0.5118 - acc: 0.9695 - val_loss: 0.5613 - val_acc: 0.9414
Epoch 7/10
 - 154s - loss: 0.4741 - acc: 0.9801 - val_loss: 0.5606 - val_acc: 0.9424
Epoch 8/10
 - 153s - loss: 0.4435 - acc: 0.9885 - val_loss: 0.4258 - val_acc: 0.9928
Epoch 9/10
 - 153s - loss: 0.4221 - acc: 0.9912 - val_loss: 0.4131 - val_acc: 0.9923
Epoch 10/10
 - 154s - loss: 0.3983 - acc: 0.9956 - val_loss: 0.3811 - val_acc: 0.9984
Test accuracy:0.630
current auc_score ------------------> 0.850
accuracies:  [0.5229838709677419, 0.4310483870967742, 0.6432795698924731, 0.37594086021505374, 0.6303763440860215]
aucs:  [0.7315243453000347, 0.43093034599375646, 0.7759819054225923, 0.34675027459821944, 0.849615851543531]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 116, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 116, 12, 12)  464         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 116, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 152, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 152, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 188, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 224, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    16128       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 148, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 148, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    21312       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 184, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 184, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    26496       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 220, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 220, 6, 6)    880         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 220, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    31680       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 256, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    18432       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 164, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 164, 3, 3)    656         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 164, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    23616       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 200, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 200, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    28800       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 236, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 236, 3, 3)    944         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 236, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    33984       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 272, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_37[0][0]              
==================================================================================================
Total params: 1,157,648
Trainable params: 1,146,768
Non-trainable params: 10,880
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         1157648     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 3,667,473
Trainable params: 3,655,569
Non-trainable params: 11,904
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 212s - loss: 1.1657 - acc: 0.7018 - val_loss: 1.2549 - val_acc: 0.6742
Epoch 2/10
 - 198s - loss: 0.9234 - acc: 0.8209 - val_loss: 1.0918 - val_acc: 0.7617
Epoch 3/10
 - 195s - loss: 0.7685 - acc: 0.8963 - val_loss: 0.8022 - val_acc: 0.8837
Epoch 4/10
 - 197s - loss: 0.6631 - acc: 0.9432 - val_loss: 0.6397 - val_acc: 0.9516
Epoch 5/10
 - 197s - loss: 0.5878 - acc: 0.9720 - val_loss: 0.5607 - val_acc: 0.9777
Epoch 6/10
 - 195s - loss: 0.5438 - acc: 0.9842 - val_loss: 0.5219 - val_acc: 0.9858
Epoch 7/10
 - 196s - loss: 0.5105 - acc: 0.9911 - val_loss: 0.5176 - val_acc: 0.9849
Epoch 8/10
 - 195s - loss: 0.4845 - acc: 0.9941 - val_loss: 0.4703 - val_acc: 0.9942
Epoch 9/10
 - 195s - loss: 0.4602 - acc: 0.9960 - val_loss: 0.4463 - val_acc: 0.9964
Epoch 10/10
 - 195s - loss: 0.4370 - acc: 0.9970 - val_loss: 0.4195 - val_acc: 0.9990
Test accuracy:0.621
current auc_score ------------------> 0.845
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 116, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 116, 12, 12)  464         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 116, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 152, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 152, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 188, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 224, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    16128       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 148, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 148, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    21312       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 184, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 184, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    26496       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 220, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 220, 6, 6)    880         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 220, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    31680       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 256, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    18432       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 164, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 164, 3, 3)    656         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 164, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    23616       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 200, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 200, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    28800       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 236, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 236, 3, 3)    944         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 236, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    33984       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 272, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_37[0][0]              
==================================================================================================
Total params: 1,157,648
Trainable params: 1,146,768
Non-trainable params: 10,880
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         1157648     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 3,667,473
Trainable params: 3,655,569
Non-trainable params: 11,904
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 213s - loss: 1.1304 - acc: 0.7193 - val_loss: 1.2648 - val_acc: 0.6718
Epoch 2/10
 - 196s - loss: 0.8994 - acc: 0.8311 - val_loss: 0.9193 - val_acc: 0.8184
Epoch 3/10
 - 194s - loss: 0.7608 - acc: 0.8991 - val_loss: 0.7538 - val_acc: 0.9006
Epoch 4/10
 - 194s - loss: 0.6622 - acc: 0.9429 - val_loss: 0.7212 - val_acc: 0.9083
Epoch 5/10
 - 196s - loss: 0.5865 - acc: 0.9716 - val_loss: 0.6271 - val_acc: 0.9484
Epoch 6/10
 - 196s - loss: 0.5391 - acc: 0.9856 - val_loss: 0.5602 - val_acc: 0.9714
Epoch 7/10
 - 196s - loss: 0.5061 - acc: 0.9916 - val_loss: 0.5148 - val_acc: 0.9873
Epoch 8/10
 - 198s - loss: 0.4793 - acc: 0.9950 - val_loss: 0.4814 - val_acc: 0.9905
Epoch 9/10
 - 196s - loss: 0.4549 - acc: 0.9968 - val_loss: 0.4412 - val_acc: 0.9981
Epoch 10/10
 - 196s - loss: 0.4337 - acc: 0.9970 - val_loss: 0.4197 - val_acc: 0.9972
Test accuracy:0.576
current auc_score ------------------> 0.814
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 116, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 116, 12, 12)  464         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 116, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 152, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 152, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 188, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 224, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    16128       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 148, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 148, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    21312       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 184, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 184, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    26496       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 220, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 220, 6, 6)    880         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 220, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    31680       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 256, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    18432       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 164, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 164, 3, 3)    656         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 164, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    23616       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 200, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 200, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    28800       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 236, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 236, 3, 3)    944         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 236, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    33984       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 272, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_37[0][0]              
==================================================================================================
Total params: 1,157,648
Trainable params: 1,146,768
Non-trainable params: 10,880
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         1157648     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 3,667,473
Trainable params: 3,655,569
Non-trainable params: 11,904
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 207s - loss: 1.1618 - acc: 0.7070 - val_loss: 3.5587 - val_acc: 0.5043
Epoch 2/10
 - 192s - loss: 0.9109 - acc: 0.8216 - val_loss: 1.3984 - val_acc: 0.4960
Epoch 3/10
 - 192s - loss: 0.7657 - acc: 0.8982 - val_loss: 1.2090 - val_acc: 0.5774
Epoch 4/10
 - 192s - loss: 0.6592 - acc: 0.9442 - val_loss: 0.7275 - val_acc: 0.9182
Epoch 5/10
 - 191s - loss: 0.5878 - acc: 0.9719 - val_loss: 0.5735 - val_acc: 0.9757
Epoch 6/10
 - 192s - loss: 0.5444 - acc: 0.9840 - val_loss: 0.5283 - val_acc: 0.9867
Epoch 7/10
 - 192s - loss: 0.5136 - acc: 0.9902 - val_loss: 0.5304 - val_acc: 0.9808
Epoch 8/10
 - 192s - loss: 0.4865 - acc: 0.9938 - val_loss: 0.4689 - val_acc: 0.9962
Epoch 9/10
 - 191s - loss: 0.4631 - acc: 0.9959 - val_loss: 0.4454 - val_acc: 0.9985
Epoch 10/10
 - 191s - loss: 0.4372 - acc: 0.9981 - val_loss: 0.4378 - val_acc: 0.9928
Test accuracy:0.734
current auc_score ------------------> 0.851
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 116, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 116, 12, 12)  464         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 116, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 152, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 152, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 188, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 224, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    16128       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 148, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 148, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    21312       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 184, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 184, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    26496       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 220, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 220, 6, 6)    880         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 220, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    31680       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 256, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    18432       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 164, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 164, 3, 3)    656         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 164, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    23616       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 200, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 200, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    28800       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 236, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 236, 3, 3)    944         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 236, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    33984       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 272, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_37[0][0]              
==================================================================================================
Total params: 1,157,648
Trainable params: 1,146,768
Non-trainable params: 10,880
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         1157648     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 3,667,473
Trainable params: 3,655,569
Non-trainable params: 11,904
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 206s - loss: 1.1817 - acc: 0.7005 - val_loss: 1.2787 - val_acc: 0.6492
Epoch 2/10
 - 190s - loss: 0.9362 - acc: 0.8113 - val_loss: 1.2556 - val_acc: 0.5722
Epoch 3/10
 - 190s - loss: 0.7872 - acc: 0.8877 - val_loss: 1.2287 - val_acc: 0.6104
Epoch 4/10
 - 190s - loss: 0.6782 - acc: 0.9360 - val_loss: 1.5799 - val_acc: 0.4977
Epoch 5/10
 - 190s - loss: 0.6019 - acc: 0.9660 - val_loss: 1.1279 - val_acc: 0.6386
Epoch 00005: early stopping
Test accuracy:0.680
current auc_score ------------------> 0.651
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [4, 4, 4, 4]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_10[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  11520       activation_11[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 116, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 116, 12, 12)  464         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 116, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_13[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 152, 12, 12)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 152, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 188, 12, 12)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 224, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_19[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    16128       activation_20[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 148, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 148, 6, 6)    592         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 148, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    21312       activation_22[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 184, 6, 6)    0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 184, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    26496       activation_24[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 220, 6, 6)    0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 220, 6, 6)    880         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 220, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    31680       activation_26[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 256, 6, 6)    0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_28[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    18432       activation_29[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 164, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 164, 3, 3)    656         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 164, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    23616       activation_31[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 200, 3, 3)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 200, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    28800       activation_33[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_34[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 236, 3, 3)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 236, 3, 3)    944         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 236, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    33984       activation_35[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_36[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 272, 3, 3)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_37[0][0]              
==================================================================================================
Total params: 1,157,648
Trainable params: 1,146,768
Non-trainable params: 10,880
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         1157648     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_38[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_17[0][0]                 
==================================================================================================
Total params: 3,667,473
Trainable params: 3,655,569
Non-trainable params: 11,904
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 210s - loss: 1.1594 - acc: 0.7079 - val_loss: 1.4073 - val_acc: 0.6042
Epoch 2/10
 - 193s - loss: 0.9183 - acc: 0.8203 - val_loss: 0.9831 - val_acc: 0.8122
Epoch 3/10
 - 192s - loss: 0.7729 - acc: 0.8920 - val_loss: 0.7200 - val_acc: 0.9236
Epoch 4/10
 - 193s - loss: 0.6602 - acc: 0.9439 - val_loss: 0.6254 - val_acc: 0.9585
Epoch 5/10
 - 193s - loss: 0.5873 - acc: 0.9712 - val_loss: 0.5703 - val_acc: 0.9753
Epoch 6/10
 - 193s - loss: 0.5424 - acc: 0.9845 - val_loss: 0.5385 - val_acc: 0.9833
Epoch 7/10
 - 193s - loss: 0.5114 - acc: 0.9911 - val_loss: 0.4983 - val_acc: 0.9921
Epoch 8/10
 - 193s - loss: 0.4879 - acc: 0.9940 - val_loss: 0.4758 - val_acc: 0.9947
Epoch 9/10
 - 193s - loss: 0.4617 - acc: 0.9965 - val_loss: 0.4780 - val_acc: 0.9876
Epoch 10/10
 - 194s - loss: 0.4403 - acc: 0.9967 - val_loss: 0.4289 - val_acc: 0.9974
Test accuracy:0.589
current auc_score ------------------> 0.871
accuracies:  [0.6205645161290323, 0.5763440860215053, 0.7341397849462366, 0.6798387096774193, 0.5888440860215054]
aucs:  [0.8448033009596485, 0.8139344866458551, 0.8512596832003699, 0.6509076193779628, 0.8711358249508616]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 104, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 104, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 128, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 152, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 152, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   14592       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 176, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 176, 12, 12)  704         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 176, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 96, 12, 12)   16896       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 12, 12)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 200, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 200, 12, 12)  800         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 200, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 96, 12, 12)   19200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 12, 12)   0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 224, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     10752       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 136, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 136, 6, 6)    544         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 136, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     13056       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 160, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 160, 6, 6)    640         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 160, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     15360       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 184, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     17664       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 208, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 208, 6, 6)    832         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 208, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 96, 6, 6)     19968       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 96, 6, 6)     0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 24, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 232, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 232, 6, 6)    928         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 232, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 96, 6, 6)     22272       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 96, 6, 6)     0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 24, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 256, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     12288       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 152, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 152, 3, 3)    608         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 152, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     14592       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 176, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 176, 3, 3)    704         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 176, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     16896       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 200, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 200, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     19200       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 224, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 224, 3, 3)    896         concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 224, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 96, 3, 3)     21504       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 96, 3, 3)     0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 24, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 248, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 248, 3, 3)    992         concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 248, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 96, 3, 3)     23808       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 96, 3, 3)     0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 24, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 272, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_53[0][0]              
==================================================================================================
Total params: 927,632
Trainable params: 914,256
Non-trainable params: 13,376
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         927632      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 3,437,457
Trainable params: 3,423,057
Non-trainable params: 14,400
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 202s - loss: 1.1829 - acc: 0.6920 - val_loss: 3.8764 - val_acc: 0.4965
Epoch 2/10
 - 179s - loss: 0.9478 - acc: 0.8045 - val_loss: 1.2933 - val_acc: 0.5628
Epoch 3/10
 - 179s - loss: 0.8170 - acc: 0.8737 - val_loss: 1.9702 - val_acc: 0.4971
Epoch 4/10
 - 179s - loss: 0.7231 - acc: 0.9179 - val_loss: 1.2992 - val_acc: 0.5374

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 179s - loss: 0.6571 - acc: 0.9446 - val_loss: 2.2160 - val_acc: 0.4972
Epoch 6/10
 - 180s - loss: 0.6260 - acc: 0.9561 - val_loss: 1.6571 - val_acc: 0.5026

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00006: early stopping
Test accuracy:0.492
current auc_score ------------------> 0.434
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 104, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 104, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 128, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 152, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 152, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   14592       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 176, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 176, 12, 12)  704         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 176, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 96, 12, 12)   16896       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 12, 12)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 200, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 200, 12, 12)  800         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 200, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 96, 12, 12)   19200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 12, 12)   0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 224, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     10752       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 136, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 136, 6, 6)    544         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 136, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     13056       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 160, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 160, 6, 6)    640         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 160, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     15360       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 184, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     17664       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 208, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 208, 6, 6)    832         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 208, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 96, 6, 6)     19968       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 96, 6, 6)     0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 24, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 232, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 232, 6, 6)    928         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 232, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 96, 6, 6)     22272       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 96, 6, 6)     0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 24, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 256, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     12288       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 152, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 152, 3, 3)    608         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 152, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     14592       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 176, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 176, 3, 3)    704         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 176, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     16896       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 200, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 200, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     19200       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 224, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 224, 3, 3)    896         concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 224, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 96, 3, 3)     21504       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 96, 3, 3)     0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 24, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 248, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 248, 3, 3)    992         concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 248, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 96, 3, 3)     23808       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 96, 3, 3)     0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 24, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 272, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_53[0][0]              
==================================================================================================
Total params: 927,632
Trainable params: 914,256
Non-trainable params: 13,376
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         927632      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 3,437,457
Trainable params: 3,423,057
Non-trainable params: 14,400
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 203s - loss: 1.1727 - acc: 0.6971 - val_loss: 3.3606 - val_acc: 0.4947
Epoch 2/10
 - 180s - loss: 0.9453 - acc: 0.8050 - val_loss: 1.5347 - val_acc: 0.4986
Epoch 3/10
 - 180s - loss: 0.8004 - acc: 0.8771 - val_loss: 1.1295 - val_acc: 0.6723
Epoch 4/10
 - 180s - loss: 0.7002 - acc: 0.9260 - val_loss: 1.1565 - val_acc: 0.5886
Epoch 5/10
 - 179s - loss: 0.6223 - acc: 0.9571 - val_loss: 1.4866 - val_acc: 0.4982

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/10
 - 179s - loss: 0.5727 - acc: 0.9741 - val_loss: 1.1307 - val_acc: 0.6472
Epoch 7/10
 - 179s - loss: 0.5530 - acc: 0.9816 - val_loss: 1.2056 - val_acc: 0.5655

Epoch 00007: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00007: early stopping
Test accuracy:0.598
current auc_score ------------------> 0.750
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 104, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 104, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 128, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 152, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 152, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   14592       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 176, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 176, 12, 12)  704         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 176, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 96, 12, 12)   16896       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 12, 12)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 200, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 200, 12, 12)  800         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 200, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 96, 12, 12)   19200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 12, 12)   0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 224, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     10752       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 136, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 136, 6, 6)    544         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 136, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     13056       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 160, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 160, 6, 6)    640         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 160, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     15360       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 184, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     17664       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 208, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 208, 6, 6)    832         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 208, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 96, 6, 6)     19968       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 96, 6, 6)     0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 24, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 232, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 232, 6, 6)    928         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 232, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 96, 6, 6)     22272       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 96, 6, 6)     0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 24, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 256, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     12288       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 152, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 152, 3, 3)    608         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 152, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     14592       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 176, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 176, 3, 3)    704         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 176, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     16896       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 200, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 200, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     19200       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 224, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 224, 3, 3)    896         concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 224, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 96, 3, 3)     21504       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 96, 3, 3)     0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 24, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 248, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 248, 3, 3)    992         concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 248, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 96, 3, 3)     23808       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 96, 3, 3)     0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 24, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 272, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_53[0][0]              
==================================================================================================
Total params: 927,632
Trainable params: 914,256
Non-trainable params: 13,376
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         927632      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 3,437,457
Trainable params: 3,423,057
Non-trainable params: 14,400
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 206s - loss: 1.1657 - acc: 0.7060 - val_loss: 1.6648 - val_acc: 0.5325
Epoch 2/10
 - 179s - loss: 0.9183 - acc: 0.8217 - val_loss: 1.2331 - val_acc: 0.5961
Epoch 3/10
 - 180s - loss: 0.7921 - acc: 0.8839 - val_loss: 1.9816 - val_acc: 0.4991
Epoch 4/10
 - 179s - loss: 0.6932 - acc: 0.9287 - val_loss: 1.7907 - val_acc: 0.4962

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 179s - loss: 0.6268 - acc: 0.9575 - val_loss: 1.5613 - val_acc: 0.5000
Epoch 6/10
 - 180s - loss: 0.6005 - acc: 0.9665 - val_loss: 1.2377 - val_acc: 0.5796

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00006: early stopping
Test accuracy:0.593
current auc_score ------------------> 0.690
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 104, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 104, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 128, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 152, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 152, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   14592       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 176, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 176, 12, 12)  704         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 176, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 96, 12, 12)   16896       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 12, 12)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 200, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 200, 12, 12)  800         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 200, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 96, 12, 12)   19200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 12, 12)   0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 224, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     10752       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 136, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 136, 6, 6)    544         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 136, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     13056       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 160, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 160, 6, 6)    640         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 160, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     15360       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 184, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     17664       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 208, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 208, 6, 6)    832         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 208, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 96, 6, 6)     19968       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 96, 6, 6)     0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 24, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 232, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 232, 6, 6)    928         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 232, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 96, 6, 6)     22272       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 96, 6, 6)     0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 24, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 256, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     12288       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 152, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 152, 3, 3)    608         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 152, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     14592       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 176, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 176, 3, 3)    704         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 176, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     16896       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 200, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 200, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     19200       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 224, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 224, 3, 3)    896         concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 224, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 96, 3, 3)     21504       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 96, 3, 3)     0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 24, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 248, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 248, 3, 3)    992         concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 248, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 96, 3, 3)     23808       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 96, 3, 3)     0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 24, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 272, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_53[0][0]              
==================================================================================================
Total params: 927,632
Trainable params: 914,256
Non-trainable params: 13,376
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         927632      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 3,437,457
Trainable params: 3,423,057
Non-trainable params: 14,400
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 203s - loss: 1.1902 - acc: 0.6914 - val_loss: 1.6300 - val_acc: 0.5158
Epoch 2/10
 - 180s - loss: 0.9574 - acc: 0.7998 - val_loss: 1.2334 - val_acc: 0.5481
Epoch 3/10
 - 180s - loss: 0.8266 - acc: 0.8654 - val_loss: 1.8159 - val_acc: 0.5036
Epoch 4/10
 - 180s - loss: 0.7231 - acc: 0.9172 - val_loss: 1.7069 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 180s - loss: 0.6558 - acc: 0.9460 - val_loss: 1.2383 - val_acc: 0.5323
Epoch 6/10
 - 180s - loss: 0.6264 - acc: 0.9574 - val_loss: 1.3546 - val_acc: 0.5210

Epoch 00006: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00006: early stopping
Test accuracy:0.505
current auc_score ------------------> 0.620
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  24  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 24, 24)   1536        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 96, 24, 24)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 24, 24)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 40, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 24, 24)   3840        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 96, 24, 24)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 64, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 24, 24)   6144        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 96, 24, 24)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 24, 24)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 88, 24, 24)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 24, 24)   8448        activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 96, 24, 24)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 96, 24, 24)   10752       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 24, 24)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 136, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 136, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 96, 24, 24)   13056       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 24, 24)   0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 160, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 160, 24, 24)  640         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 160, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 80, 24, 24)   12800       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 80, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 80, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 12, 12)   7680        activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 96, 12, 12)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 104, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 104, 12, 12)  416         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 104, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 12, 12)   9984        activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 96, 12, 12)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 128, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 128, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 12, 12)   12288       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 12, 12)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 152, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 152, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 12, 12)   14592       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 96, 12, 12)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 176, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 176, 12, 12)  704         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 176, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 96, 12, 12)   16896       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 12, 12)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 200, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 200, 12, 12)  800         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 200, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 96, 12, 12)   19200       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 12, 12)   0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 224, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 224, 12, 12)  896         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 224, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 112, 12, 12)  25088       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 112, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 112, 6, 6)    448         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 112, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 6, 6)     10752       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 96, 6, 6)     0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 136, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 136, 6, 6)    544         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 136, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 6, 6)     13056       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 96, 6, 6)     0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 160, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 160, 6, 6)    640         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 160, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 6, 6)     15360       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 96, 6, 6)     0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 184, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 6, 6)    736         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 184, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 6, 6)     17664       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 96, 6, 6)     0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 208, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 208, 6, 6)    832         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 208, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 96, 6, 6)     19968       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 96, 6, 6)     0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 24, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 232, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 232, 6, 6)    928         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 232, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 96, 6, 6)     22272       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 96, 6, 6)     384         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 96, 6, 6)     0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 24, 6, 6)     20736       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 24, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 256, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 256, 6, 6)    1024        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 256, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 128, 6, 6)    32768       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 128, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 128, 3, 3)    512         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 128, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 3, 3)     12288       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 96, 3, 3)     0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 24, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 152, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 152, 3, 3)    608         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 152, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 3, 3)     14592       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 96, 3, 3)     0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 24, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 176, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 176, 3, 3)    704         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 176, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 3, 3)     16896       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 96, 3, 3)     0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 24, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 200, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 200, 3, 3)    800         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 200, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 3, 3)     19200       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 96, 3, 3)     0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 24, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 224, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 224, 3, 3)    896         concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 224, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 96, 3, 3)     21504       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 96, 3, 3)     0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 24, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 248, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 248, 3, 3)    992         concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 248, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 96, 3, 3)     23808       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 96, 3, 3)     384         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 96, 3, 3)     0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 24, 3, 3)     20736       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 24, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 272, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 272, 3, 3)    1088        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 272, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2448)         0           activation_53[0][0]              
==================================================================================================
Total params: 927,632
Trainable params: 914,256
Non-trainable params: 13,376
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 2448)         927632      input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 4896)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          2507264     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 3,437,457
Trainable params: 3,423,057
Non-trainable params: 14,400
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 203s - loss: 1.1724 - acc: 0.7013 - val_loss: 1.2785 - val_acc: 0.6136
Epoch 2/10
 - 179s - loss: 0.9287 - acc: 0.8147 - val_loss: 1.2282 - val_acc: 0.6875
Epoch 3/10
 - 179s - loss: 0.8075 - acc: 0.8768 - val_loss: 0.8282 - val_acc: 0.8534
Epoch 4/10
 - 179s - loss: 0.7053 - acc: 0.9246 - val_loss: 0.7207 - val_acc: 0.9099
Epoch 5/10
 - 181s - loss: 0.6306 - acc: 0.9546 - val_loss: 0.6592 - val_acc: 0.9352
Epoch 6/10
 - 181s - loss: 0.5750 - acc: 0.9738 - val_loss: 0.6321 - val_acc: 0.9401
Epoch 7/10
 - 180s - loss: 0.5341 - acc: 0.9854 - val_loss: 0.5425 - val_acc: 0.9736
Epoch 8/10
 - 179s - loss: 0.5059 - acc: 0.9906 - val_loss: 0.5136 - val_acc: 0.9826
Epoch 9/10
 - 179s - loss: 0.4790 - acc: 0.9940 - val_loss: 0.5197 - val_acc: 0.9748
Epoch 10/10
 - 179s - loss: 0.4563 - acc: 0.9958 - val_loss: 0.4658 - val_acc: 0.9867
Test accuracy:0.555
current auc_score ------------------> 0.823
accuracies:  [0.4918010752688172, 0.5975806451612903, 0.5931451612903226, 0.5048387096774194, 0.5551075268817204]
aucs:  [0.4342461556249277, 0.7502702985894323, 0.6902258209041507, 0.6196541146375304, 0.8230793299803447]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  22560       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 12, 12)  26160       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 120, 12, 12)  29760       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    16680       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    20280       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    23880       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    27480       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 6, 6)    31080       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 120, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 120, 6, 6)    34680       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 120, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    19080       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    22680       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    26280       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    29880       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 3, 3)    33480       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 120, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 120, 3, 3)    37080       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 120, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3051)         0           activation_53[0][0]              
==================================================================================================
Total params: 1,432,795
Trainable params: 1,416,195
Non-trainable params: 16,600
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3051)         1432795     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 6102)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3124736     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 4,560,092
Trainable params: 4,542,468
Non-trainable params: 17,624
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 261s - loss: 1.2936 - acc: 0.7024 - val_loss: 4.4796 - val_acc: 0.4965
Epoch 2/10
 - 238s - loss: 1.0589 - acc: 0.8115 - val_loss: 1.7330 - val_acc: 0.5031
Epoch 3/10
 - 238s - loss: 0.9079 - acc: 0.8904 - val_loss: 2.6109 - val_acc: 0.4965
Epoch 4/10
 - 238s - loss: 0.7974 - acc: 0.9398 - val_loss: 1.4186 - val_acc: 0.5648
Epoch 5/10
 - 237s - loss: 0.7215 - acc: 0.9657 - val_loss: 1.3238 - val_acc: 0.5674
Epoch 6/10
 - 237s - loss: 0.6692 - acc: 0.9808 - val_loss: 1.4803 - val_acc: 0.5579
Epoch 7/10
 - 237s - loss: 0.6307 - acc: 0.9886 - val_loss: 1.2239 - val_acc: 0.6035
Epoch 8/10
 - 237s - loss: 0.5980 - acc: 0.9925 - val_loss: 1.6900 - val_acc: 0.5144
Epoch 9/10
 - 238s - loss: 0.5647 - acc: 0.9957 - val_loss: 1.1476 - val_acc: 0.6581
Epoch 10/10
 - 238s - loss: 0.5361 - acc: 0.9962 - val_loss: 1.3078 - val_acc: 0.5264
Test accuracy:0.517
current auc_score ------------------> 0.610
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  22560       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 12, 12)  26160       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 120, 12, 12)  29760       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    16680       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    20280       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    23880       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    27480       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 6, 6)    31080       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 120, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 120, 6, 6)    34680       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 120, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    19080       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    22680       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    26280       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    29880       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 3, 3)    33480       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 120, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 120, 3, 3)    37080       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 120, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3051)         0           activation_53[0][0]              
==================================================================================================
Total params: 1,432,795
Trainable params: 1,416,195
Non-trainable params: 16,600
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3051)         1432795     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 6102)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3124736     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 4,560,092
Trainable params: 4,542,468
Non-trainable params: 17,624
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 260s - loss: 1.2936 - acc: 0.7085 - val_loss: 4.8289 - val_acc: 0.5038
Epoch 2/10
 - 239s - loss: 1.0636 - acc: 0.8114 - val_loss: 1.5897 - val_acc: 0.5237
Epoch 3/10
 - 238s - loss: 0.9190 - acc: 0.8856 - val_loss: 1.5651 - val_acc: 0.5390
Epoch 4/10
 - 238s - loss: 0.8108 - acc: 0.9337 - val_loss: 2.3943 - val_acc: 0.5109
Epoch 5/10
 - 239s - loss: 0.7233 - acc: 0.9658 - val_loss: 2.4999 - val_acc: 0.5115

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 6/10
 - 238s - loss: 0.6744 - acc: 0.9821 - val_loss: 2.5009 - val_acc: 0.5107
Epoch 7/10
 - 237s - loss: 0.6564 - acc: 0.9864 - val_loss: 2.0895 - val_acc: 0.5231

Epoch 00007: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00007: early stopping
Test accuracy:0.506
current auc_score ------------------> 0.642
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  22560       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 12, 12)  26160       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 120, 12, 12)  29760       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    16680       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    20280       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    23880       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    27480       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 6, 6)    31080       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 120, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 120, 6, 6)    34680       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 120, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    19080       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    22680       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    26280       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    29880       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 3, 3)    33480       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 120, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 120, 3, 3)    37080       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 120, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3051)         0           activation_53[0][0]              
==================================================================================================
Total params: 1,432,795
Trainable params: 1,416,195
Non-trainable params: 16,600
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3051)         1432795     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 6102)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3124736     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 4,560,092
Trainable params: 4,542,468
Non-trainable params: 17,624
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 261s - loss: 1.3007 - acc: 0.7028 - val_loss: 1.8729 - val_acc: 0.5353
Epoch 2/10
 - 238s - loss: 1.0703 - acc: 0.8090 - val_loss: 1.3853 - val_acc: 0.6776
Epoch 3/10
 - 238s - loss: 0.9230 - acc: 0.8838 - val_loss: 1.0601 - val_acc: 0.8038
Epoch 4/10
 - 238s - loss: 0.8140 - acc: 0.9335 - val_loss: 0.8002 - val_acc: 0.9349
Epoch 5/10
 - 238s - loss: 0.7297 - acc: 0.9646 - val_loss: 0.7218 - val_acc: 0.9616
Epoch 6/10
 - 238s - loss: 0.6714 - acc: 0.9820 - val_loss: 0.6648 - val_acc: 0.9805
Epoch 7/10
 - 237s - loss: 0.6277 - acc: 0.9913 - val_loss: 0.6143 - val_acc: 0.9906
Epoch 8/10
 - 237s - loss: 0.5952 - acc: 0.9952 - val_loss: 0.5810 - val_acc: 0.9942
Epoch 9/10
 - 238s - loss: 0.5669 - acc: 0.9965 - val_loss: 0.5605 - val_acc: 0.9926
Epoch 10/10
 - 237s - loss: 0.5353 - acc: 0.9976 - val_loss: 0.5236 - val_acc: 0.9960
Test accuracy:0.570
current auc_score ------------------> 0.813
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  22560       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 12, 12)  26160       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 120, 12, 12)  29760       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    16680       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    20280       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    23880       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    27480       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 6, 6)    31080       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 120, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 120, 6, 6)    34680       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 120, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    19080       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    22680       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    26280       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    29880       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 3, 3)    33480       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 120, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 120, 3, 3)    37080       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 120, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3051)         0           activation_53[0][0]              
==================================================================================================
Total params: 1,432,795
Trainable params: 1,416,195
Non-trainable params: 16,600
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3051)         1432795     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 6102)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3124736     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 4,560,092
Trainable params: 4,542,468
Non-trainable params: 17,624
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 261s - loss: 1.2697 - acc: 0.7201 - val_loss: 1.6464 - val_acc: 0.6161
Epoch 2/10
 - 238s - loss: 1.0215 - acc: 0.8323 - val_loss: 1.3157 - val_acc: 0.7146
Epoch 3/10
 - 238s - loss: 0.9023 - acc: 0.8931 - val_loss: 0.9806 - val_acc: 0.8451
Epoch 4/10
 - 238s - loss: 0.7994 - acc: 0.9371 - val_loss: 0.9227 - val_acc: 0.8751
Epoch 5/10
 - 238s - loss: 0.7159 - acc: 0.9691 - val_loss: 0.6926 - val_acc: 0.9715
Epoch 6/10
 - 238s - loss: 0.6608 - acc: 0.9840 - val_loss: 0.6479 - val_acc: 0.9826
Epoch 7/10
 - 238s - loss: 0.6221 - acc: 0.9913 - val_loss: 0.6334 - val_acc: 0.9804
Epoch 8/10
 - 238s - loss: 0.5881 - acc: 0.9955 - val_loss: 0.6217 - val_acc: 0.9783
Epoch 9/10
 - 239s - loss: 0.5599 - acc: 0.9966 - val_loss: 0.6040 - val_acc: 0.9767
Epoch 10/10
 - 238s - loss: 0.5291 - acc: 0.9980 - val_loss: 0.5613 - val_acc: 0.9812
Epoch 00010: early stopping
Test accuracy:0.602
current auc_score ------------------> 0.777
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 24, 24)  1920        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 120, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 24, 24)  5520        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 120, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 24, 24)  9120        activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 120, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 24, 24)  12720       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 24, 24)  16320       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 120, 24, 24)  19920       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 12, 12)  11760       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 12, 12)  15360       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 12, 12)  18960       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 12, 12)  22560       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 120, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 12, 12)  26160       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 120, 12, 12)  29760       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 6, 6)    16680       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 120, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 6, 6)    20280       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 120, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 6, 6)    23880       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 120, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 6, 6)    27480       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 6, 6)    31080       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 120, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 120, 6, 6)    34680       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 120, 6, 6)    480         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 120, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     32400       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 3, 3)    19080       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 120, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 3, 3)    22680       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 120, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 3, 3)    26280       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 120, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 3, 3)    29880       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 120, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 3, 3)    33480       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 120, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 120, 3, 3)    37080       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 120, 3, 3)    480         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 120, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     32400       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3051)         0           activation_53[0][0]              
==================================================================================================
Total params: 1,432,795
Trainable params: 1,416,195
Non-trainable params: 16,600
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3051)         1432795     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 6102)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3124736     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 4,560,092
Trainable params: 4,542,468
Non-trainable params: 17,624
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 260s - loss: 1.2752 - acc: 0.7142 - val_loss: 1.5974 - val_acc: 0.6133
Epoch 2/10
 - 238s - loss: 1.0312 - acc: 0.8283 - val_loss: 1.1153 - val_acc: 0.7923
Epoch 3/10
 - 238s - loss: 0.9068 - acc: 0.8887 - val_loss: 0.9140 - val_acc: 0.8869
Epoch 4/10
 - 238s - loss: 0.8018 - acc: 0.9344 - val_loss: 0.7981 - val_acc: 0.9277
Epoch 5/10
 - 238s - loss: 0.7205 - acc: 0.9658 - val_loss: 0.7158 - val_acc: 0.9654
Epoch 6/10
 - 237s - loss: 0.6650 - acc: 0.9825 - val_loss: 0.6565 - val_acc: 0.9810
Epoch 7/10
 - 237s - loss: 0.6268 - acc: 0.9892 - val_loss: 0.6289 - val_acc: 0.9838
Epoch 8/10
 - 237s - loss: 0.5946 - acc: 0.9931 - val_loss: 0.5902 - val_acc: 0.9891
Epoch 9/10
 - 238s - loss: 0.5642 - acc: 0.9954 - val_loss: 0.5486 - val_acc: 0.9954
Epoch 10/10
 - 238s - loss: 0.5333 - acc: 0.9971 - val_loss: 0.5258 - val_acc: 0.9935
Test accuracy:0.635
current auc_score ------------------> 0.843
accuracies:  [0.5168010752688172, 0.5063172043010753, 0.5704301075268817, 0.6018817204301076, 0.6345430107526882]
aucs:  [0.609615959937565, 0.6420384220719157, 0.8129718392299686, 0.7771267632096196, 0.843101225575211]
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 116, 24, 24)  26912       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 116, 12, 12)  0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 116, 12, 12)  464         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 152, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 152, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 224, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 224, 12, 12)  896         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 224, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  32256       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 260, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 260, 12, 12)  1040        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 260, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 144, 12, 12)  37440       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 296, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 296, 12, 12)  1184        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 296, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 144, 12, 12)  42624       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 332, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 332, 12, 12)  1328        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 332, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 166, 12, 12)  55112       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 166, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 166, 6, 6)    664         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 166, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    23904       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 202, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 202, 6, 6)    808         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 202, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    29088       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 238, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 238, 6, 6)    952         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 238, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    34272       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 274, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 274, 6, 6)    1096        concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 274, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    39456       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 310, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 310, 6, 6)    1240        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 310, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 144, 6, 6)    44640       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 144, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 36, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 346, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 346, 6, 6)    1384        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 346, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 144, 6, 6)    49824       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 144, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 36, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 382, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 382, 6, 6)    1528        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 382, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 191, 6, 6)    72962       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 191, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 191, 3, 3)    764         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 191, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    27504       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 227, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 227, 3, 3)    908         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 227, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    32688       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 263, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 263, 3, 3)    1052        concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 263, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    37872       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 299, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 299, 3, 3)    1196        concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 299, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    43056       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 335, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 335, 3, 3)    1340        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 335, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 144, 3, 3)    48240       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 144, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 36, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 371, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 371, 3, 3)    1484        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 371, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 144, 3, 3)    53424       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 144, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 36, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 407, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 407, 3, 3)    1628        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 407, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3663)         0           activation_53[0][0]              
==================================================================================================
Total params: 2,048,726
Trainable params: 2,028,888
Non-trainable params: 19,838
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3663)         2048726     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 7326)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3751424     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 5,802,711
Trainable params: 5,781,849
Non-trainable params: 20,862
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 337s - loss: 1.4328 - acc: 0.7035 - val_loss: 1.7467 - val_acc: 0.6122
Epoch 2/10
 - 310s - loss: 1.1780 - acc: 0.8204 - val_loss: 1.2801 - val_acc: 0.7877
Epoch 3/10
 - 310s - loss: 1.0259 - acc: 0.8935 - val_loss: 1.1049 - val_acc: 0.8534
Epoch 4/10
 - 310s - loss: 0.9119 - acc: 0.9402 - val_loss: 0.9220 - val_acc: 0.9394
Epoch 5/10
 - 311s - loss: 0.8240 - acc: 0.9720 - val_loss: 0.9081 - val_acc: 0.9327
Epoch 6/10
 - 311s - loss: 0.7678 - acc: 0.9849 - val_loss: 0.8223 - val_acc: 0.9538
Epoch 7/10
 - 310s - loss: 0.7235 - acc: 0.9912 - val_loss: 0.7893 - val_acc: 0.9561
Epoch 8/10
 - 310s - loss: 0.6818 - acc: 0.9956 - val_loss: 0.6636 - val_acc: 0.9945
Epoch 9/10
 - 310s - loss: 0.6434 - acc: 0.9971 - val_loss: 0.6500 - val_acc: 0.9859
Epoch 10/10
 - 311s - loss: 0.6049 - acc: 0.9978 - val_loss: 0.5944 - val_acc: 0.9936
Test accuracy:0.579
current auc_score ------------------> 0.852
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 116, 24, 24)  26912       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 116, 12, 12)  0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 116, 12, 12)  464         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 152, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 152, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 224, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 224, 12, 12)  896         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 224, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  32256       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 260, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 260, 12, 12)  1040        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 260, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 144, 12, 12)  37440       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 296, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 296, 12, 12)  1184        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 296, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 144, 12, 12)  42624       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 332, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 332, 12, 12)  1328        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 332, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 166, 12, 12)  55112       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 166, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 166, 6, 6)    664         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 166, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    23904       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 202, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 202, 6, 6)    808         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 202, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    29088       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 238, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 238, 6, 6)    952         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 238, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    34272       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 274, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 274, 6, 6)    1096        concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 274, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    39456       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 310, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 310, 6, 6)    1240        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 310, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 144, 6, 6)    44640       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 144, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 36, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 346, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 346, 6, 6)    1384        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 346, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 144, 6, 6)    49824       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 144, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 36, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 382, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 382, 6, 6)    1528        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 382, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 191, 6, 6)    72962       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 191, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 191, 3, 3)    764         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 191, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    27504       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 227, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 227, 3, 3)    908         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 227, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    32688       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 263, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 263, 3, 3)    1052        concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 263, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    37872       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 299, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 299, 3, 3)    1196        concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 299, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    43056       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 335, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 335, 3, 3)    1340        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 335, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 144, 3, 3)    48240       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 144, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 36, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 371, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 371, 3, 3)    1484        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 371, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 144, 3, 3)    53424       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 144, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 36, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 407, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 407, 3, 3)    1628        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 407, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3663)         0           activation_53[0][0]              
==================================================================================================
Total params: 2,048,726
Trainable params: 2,028,888
Non-trainable params: 19,838
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3663)         2048726     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 7326)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3751424     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 5,802,711
Trainable params: 5,781,849
Non-trainable params: 20,862
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 336s - loss: 1.4183 - acc: 0.7070 - val_loss: 2.6188 - val_acc: 0.4962
Epoch 2/10
 - 312s - loss: 1.1708 - acc: 0.8240 - val_loss: 1.5348 - val_acc: 0.5319
Epoch 3/10
 - 313s - loss: 1.0128 - acc: 0.8999 - val_loss: 1.6848 - val_acc: 0.5107
Epoch 4/10
 - 312s - loss: 0.8921 - acc: 0.9498 - val_loss: 1.7912 - val_acc: 0.5338

Epoch 00004: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 5/10
 - 312s - loss: 0.8236 - acc: 0.9739 - val_loss: 1.4153 - val_acc: 0.6407
Epoch 6/10
 - 311s - loss: 0.7989 - acc: 0.9814 - val_loss: 1.5398 - val_acc: 0.6227
Epoch 7/10
 - 312s - loss: 0.7767 - acc: 0.9857 - val_loss: 1.7643 - val_acc: 0.5550

Epoch 00007: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 8/10
 - 312s - loss: 0.7578 - acc: 0.9896 - val_loss: 1.5903 - val_acc: 0.5717
Epoch 9/10
 - 311s - loss: 0.7503 - acc: 0.9913 - val_loss: 1.7809 - val_acc: 0.5466

Epoch 00009: ReduceLROnPlateau reducing learning rate to 6.324554585350098e-06.
Epoch 00009: early stopping
Test accuracy:0.534
current auc_score ------------------> 0.786
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 116, 24, 24)  26912       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 116, 12, 12)  0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 116, 12, 12)  464         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 152, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 152, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 224, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 224, 12, 12)  896         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 224, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  32256       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 260, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 260, 12, 12)  1040        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 260, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 144, 12, 12)  37440       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 296, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 296, 12, 12)  1184        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 296, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 144, 12, 12)  42624       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 332, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 332, 12, 12)  1328        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 332, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 166, 12, 12)  55112       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 166, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 166, 6, 6)    664         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 166, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    23904       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 202, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 202, 6, 6)    808         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 202, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    29088       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 238, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 238, 6, 6)    952         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 238, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    34272       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 274, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 274, 6, 6)    1096        concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 274, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    39456       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 310, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 310, 6, 6)    1240        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 310, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 144, 6, 6)    44640       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 144, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 36, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 346, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 346, 6, 6)    1384        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 346, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 144, 6, 6)    49824       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 144, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 36, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 382, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 382, 6, 6)    1528        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 382, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 191, 6, 6)    72962       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 191, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 191, 3, 3)    764         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 191, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    27504       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 227, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 227, 3, 3)    908         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 227, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    32688       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 263, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 263, 3, 3)    1052        concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 263, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    37872       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 299, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 299, 3, 3)    1196        concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 299, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    43056       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 335, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 335, 3, 3)    1340        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 335, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 144, 3, 3)    48240       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 144, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 36, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 371, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 371, 3, 3)    1484        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 371, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 144, 3, 3)    53424       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 144, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 36, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 407, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 407, 3, 3)    1628        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 407, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3663)         0           activation_53[0][0]              
==================================================================================================
Total params: 2,048,726
Trainable params: 2,028,888
Non-trainable params: 19,838
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3663)         2048726     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 7326)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3751424     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 5,802,711
Trainable params: 5,781,849
Non-trainable params: 20,862
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 335s - loss: 1.4064 - acc: 0.7134 - val_loss: 1.5379 - val_acc: 0.5756
Epoch 2/10
 - 312s - loss: 1.1591 - acc: 0.8299 - val_loss: 2.1154 - val_acc: 0.5006
Epoch 3/10
 - 312s - loss: 1.0081 - acc: 0.9047 - val_loss: 1.5098 - val_acc: 0.5384
Epoch 4/10
 - 312s - loss: 0.8847 - acc: 0.9527 - val_loss: 2.3676 - val_acc: 0.4967
Epoch 5/10
 - 312s - loss: 0.8099 - acc: 0.9762 - val_loss: 1.4124 - val_acc: 0.6058
Epoch 6/10
 - 312s - loss: 0.7526 - acc: 0.9887 - val_loss: 1.5762 - val_acc: 0.5343
Epoch 7/10
 - 312s - loss: 0.7122 - acc: 0.9927 - val_loss: 1.5406 - val_acc: 0.5763

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 8/10
 - 312s - loss: 0.6816 - acc: 0.9968 - val_loss: 1.5651 - val_acc: 0.5880
Epoch 9/10
 - 312s - loss: 0.6662 - acc: 0.9977 - val_loss: 1.3586 - val_acc: 0.6259
Epoch 10/10
 - 312s - loss: 0.6506 - acc: 0.9980 - val_loss: 1.7198 - val_acc: 0.5442
Test accuracy:0.506
current auc_score ------------------> 0.698
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 116, 24, 24)  26912       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 116, 12, 12)  0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 116, 12, 12)  464         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 152, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 152, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 224, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 224, 12, 12)  896         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 224, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  32256       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 260, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 260, 12, 12)  1040        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 260, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 144, 12, 12)  37440       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 296, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 296, 12, 12)  1184        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 296, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 144, 12, 12)  42624       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 332, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 332, 12, 12)  1328        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 332, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 166, 12, 12)  55112       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 166, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 166, 6, 6)    664         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 166, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    23904       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 202, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 202, 6, 6)    808         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 202, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    29088       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 238, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 238, 6, 6)    952         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 238, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    34272       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 274, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 274, 6, 6)    1096        concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 274, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    39456       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 310, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 310, 6, 6)    1240        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 310, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 144, 6, 6)    44640       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 144, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 36, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 346, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 346, 6, 6)    1384        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 346, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 144, 6, 6)    49824       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 144, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 36, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 382, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 382, 6, 6)    1528        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 382, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 191, 6, 6)    72962       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 191, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 191, 3, 3)    764         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 191, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    27504       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 227, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 227, 3, 3)    908         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 227, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    32688       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 263, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 263, 3, 3)    1052        concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 263, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    37872       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 299, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 299, 3, 3)    1196        concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 299, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    43056       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 335, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 335, 3, 3)    1340        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 335, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 144, 3, 3)    48240       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 144, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 36, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 371, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 371, 3, 3)    1484        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 371, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 144, 3, 3)    53424       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 144, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 36, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 407, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 407, 3, 3)    1628        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 407, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3663)         0           activation_53[0][0]              
==================================================================================================
Total params: 2,048,726
Trainable params: 2,028,888
Non-trainable params: 19,838
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3663)         2048726     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 7326)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3751424     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 5,802,711
Trainable params: 5,781,849
Non-trainable params: 20,862
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 338s - loss: 1.4199 - acc: 0.7022 - val_loss: 3.3148 - val_acc: 0.4984
Epoch 2/10
 - 312s - loss: 1.1718 - acc: 0.8238 - val_loss: 2.0641 - val_acc: 0.5153
Epoch 3/10
 - 313s - loss: 1.0308 - acc: 0.8924 - val_loss: 2.0074 - val_acc: 0.5264
Epoch 4/10
 - 313s - loss: 0.9171 - acc: 0.9408 - val_loss: 1.7561 - val_acc: 0.5499
Epoch 5/10
 - 312s - loss: 0.8272 - acc: 0.9730 - val_loss: 1.4281 - val_acc: 0.6067
Epoch 6/10
 - 312s - loss: 0.7671 - acc: 0.9866 - val_loss: 1.5695 - val_acc: 0.5699
Epoch 7/10
 - 312s - loss: 0.7236 - acc: 0.9931 - val_loss: 2.4338 - val_acc: 0.5137

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 8/10
 - 312s - loss: 0.6943 - acc: 0.9965 - val_loss: 1.7273 - val_acc: 0.5541
Epoch 9/10
 - 313s - loss: 0.6788 - acc: 0.9977 - val_loss: 1.7314 - val_acc: 0.5556

Epoch 00009: ReduceLROnPlateau reducing learning rate to 1.999999851818061e-05.
Epoch 00009: early stopping
Test accuracy:0.538
current auc_score ------------------> 0.657
Epochs  10  batch_size:  64  lr:  0.0002  es_patience:  4  lr_patience:  2
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  36  nb_filter:  16  dropout:  0.2
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------	  end of configs        -------------------------
pooling:flatten
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   784         input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 144, 24, 24)  2304        activation_2[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 144, 24, 24)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 36, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 52, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 52, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 144, 24, 24)  7488        activation_4[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 144, 24, 24)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 36, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 88, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 88, 24, 24)   352         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 88, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 144, 24, 24)  12672       activation_6[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 144, 24, 24)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 36, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 124, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 124, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 144, 24, 24)  17856       activation_8[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 144, 24, 24)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 36, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 160, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 160, 24, 24)  640         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 160, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 144, 24, 24)  23040       activation_10[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 144, 24, 24)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 36, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 196, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 196, 24, 24)  784         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 196, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_bottleneck_conv2D (Co (None, 144, 24, 24)  28224       activation_12[0][0]              
__________________________________________________________________________________________________
dense_0_5_bottleneck_bn (BatchN (None, 144, 24, 24)  576         dense_0_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 144, 24, 24)  0           dense_0_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 36, 24, 24)   46656       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 36, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 232, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 232, 24, 24)  928         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 232, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 116, 24, 24)  26912       activation_14[0][0]              
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 116, 12, 12)  0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 116, 12, 12)  464         max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 116, 12, 12)  0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 144, 12, 12)  16704       activation_15[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 144, 12, 12)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 36, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 152, 12, 12)  0           max_pooling2d_2[0][0]            
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 152, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 144, 12, 12)  21888       activation_17[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 144, 12, 12)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 36, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 188, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 144, 12, 12)  27072       activation_19[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 144, 12, 12)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 36, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 224, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 224, 12, 12)  896         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 224, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 144, 12, 12)  32256       activation_21[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 144, 12, 12)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 36, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 260, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 260, 12, 12)  1040        concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 260, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 144, 12, 12)  37440       activation_23[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 144, 12, 12)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 36, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 296, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 296, 12, 12)  1184        concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 296, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_bottleneck_conv2D (Co (None, 144, 12, 12)  42624       activation_25[0][0]              
__________________________________________________________________________________________________
dense_1_5_bottleneck_bn (BatchN (None, 144, 12, 12)  576         dense_1_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 144, 12, 12)  0           dense_1_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 36, 12, 12)   46656       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 36, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 332, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 332, 12, 12)  1328        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 332, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 166, 12, 12)  55112       activation_27[0][0]              
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 166, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 166, 6, 6)    664         max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 166, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 144, 6, 6)    23904       activation_28[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 144, 6, 6)    0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 36, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 202, 6, 6)    0           max_pooling2d_3[0][0]            
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 202, 6, 6)    808         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 202, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 144, 6, 6)    29088       activation_30[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 144, 6, 6)    0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 36, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 238, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 238, 6, 6)    952         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 238, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 144, 6, 6)    34272       activation_32[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 144, 6, 6)    0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 36, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 274, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 274, 6, 6)    1096        concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 274, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 144, 6, 6)    39456       activation_34[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 144, 6, 6)    0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 36, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 310, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 310, 6, 6)    1240        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 310, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 144, 6, 6)    44640       activation_36[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 144, 6, 6)    0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 36, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 346, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 346, 6, 6)    1384        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 346, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_bottleneck_conv2D (Co (None, 144, 6, 6)    49824       activation_38[0][0]              
__________________________________________________________________________________________________
dense_2_5_bottleneck_bn (BatchN (None, 144, 6, 6)    576         dense_2_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 144, 6, 6)    0           dense_2_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 36, 6, 6)     46656       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 36, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 382, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 382, 6, 6)    1528        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 382, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 191, 6, 6)    72962       activation_40[0][0]              
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 191, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 191, 3, 3)    764         max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 191, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 144, 3, 3)    27504       activation_41[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 144, 3, 3)    0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_42[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 36, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 227, 3, 3)    0           max_pooling2d_4[0][0]            
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 227, 3, 3)    908         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 227, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 144, 3, 3)    32688       activation_43[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 144, 3, 3)    0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_44[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 36, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 263, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 263, 3, 3)    1052        concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 263, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 144, 3, 3)    37872       activation_45[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 144, 3, 3)    0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_46[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 36, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 299, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 299, 3, 3)    1196        concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 299, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 144, 3, 3)    43056       activation_47[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 144, 3, 3)    0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_48[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 36, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 335, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 335, 3, 3)    1340        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 335, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 144, 3, 3)    48240       activation_49[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 144, 3, 3)    0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_50[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 36, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 371, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 371, 3, 3)    1484        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 371, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_bottleneck_conv2D (Co (None, 144, 3, 3)    53424       activation_51[0][0]              
__________________________________________________________________________________________________
dense_3_5_bottleneck_bn (BatchN (None, 144, 3, 3)    576         dense_3_5_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 144, 3, 3)    0           dense_3_5_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 36, 3, 3)     46656       activation_52[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 36, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 407, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 407, 3, 3)    1628        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 407, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 3663)         0           activation_53[0][0]              
==================================================================================================
Total params: 2,048,726
Trainable params: 2,028,888
Non-trainable params: 19,838
__________________________________________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
densenet (Model)                (None, 3663)         2048726     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 7326)         0           densenet[1][0]                   
                                                                 densenet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          3751424     merge_features[0][0]             
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 512)          2048        activation_54[0][0]              
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 512)          0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            513         dropout_25[0][0]                 
==================================================================================================
Total params: 5,802,711
Trainable params: 5,781,849
Non-trainable params: 20,862
__________________________________________________________________________________________________
Finished compiling
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 334s - loss: 1.4146 - acc: 0.7054 - val_loss: 1.8753 - val_acc: 0.5270
Epoch 2/10
 - 313s - loss: 1.1845 - acc: 0.8136 - val_loss: 2.5318 - val_acc: 0.5039
Epoch 3/10
 - 313s - loss: 1.0327 - acc: 0.8915 - val_loss: 1.3796 - val_acc: 0.6738
Epoch 4/10
 - 312s - loss: 0.9101 - acc: 0.9418 - val_loss: 1.5375 - val_acc: 0.5410
Epoch 5/10
 - 312s - loss: 0.8321 - acc: 0.9692 - val_loss: 1.3686 - val_acc: 0.6392
Epoch 6/10
 - 311s - loss: 0.7718 - acc: 0.9840 - val_loss: 1.4564 - val_acc: 0.5909
Epoch 7/10
 - 312s - loss: 0.7251 - acc: 0.9915 - val_loss: 1.3985 - val_acc: 0.5939

Epoch 00007: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 00007: early stopping
Test accuracy:0.537
current auc_score ------------------> 0.693
accuracies:  [0.5788978494623656, 0.5344086021505376, 0.505510752688172, 0.5384408602150538, 0.5373655913978495]
aucs:  [0.8516544542721701, 0.7855344548502716, 0.6981648890045092, 0.6573886793270898, 0.6927386836628512]
