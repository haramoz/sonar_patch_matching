python hello-world.py
python hyperas_contrastive_loss.py
>>> Imports:
#coding=utf-8

try:
    import numpy as np
except:
    pass

try:
    import random
except:
    pass

try:
    import h5py
except:
    pass

try:
    import tensorflow as tf
except:
    pass

try:
    import matplotlib.pyplot as plt
except:
    pass

try:
    import keras.backend as K
except:
    pass

try:
    from keras.initializers import RandomNormal
except:
    pass

try:
    from keras.layers.core import Dense, Dropout, Activation
except:
    pass

try:
    from keras.layers.pooling import AveragePooling2D, GlobalAveragePooling2D
except:
    pass

try:
    from keras.layers import Input, concatenate, Concatenate
except:
    pass

try:
    from keras.layers import normalization, BatchNormalization, Lambda
except:
    pass

try:
    from keras.layers import Flatten, Conv2D, MaxPooling2D
except:
    pass

try:
    from keras.regularizers import l2
except:
    pass

try:
    from keras.optimizers import RMSprop, Adam
except:
    pass

try:
    from keras.utils import np_utils
except:
    pass

try:
    from keras.models import Model, Sequential
except:
    pass

try:
    from keras.models import model_from_json
except:
    pass

try:
    import keras.initializers
except:
    pass

try:
    from keras.losses import binary_crossentropy
except:
    pass

try:
    from keras.callbacks import EarlyStopping, ModelCheckpoint
except:
    pass

try:
    from sklearn.metrics import accuracy_score
except:
    pass

try:
    from sklearn.metrics import roc_auc_score
except:
    pass

try:
    from hyperopt import Trials, STATUS_OK, tpe
except:
    pass

try:
    from hyperas import optim
except:
    pass

try:
    from hyperas.distributions import choice, uniform
except:
    pass

try:
    import densenet
except:
    pass

try:
    import pickle
except:
    pass

>>> Hyperas search space:

def get_space():
    return {
        'dropout': hp.uniform('dropout', 0,1),
        'dropout_1': hp.uniform('dropout_1', 0,1),
        'nb_filter': hp.choice('nb_filter', [16,18,20,22]),
    }

>>> Functions
   1: def process_data():
   2:     filename = 'sonar_data'
   3:     infile = open(filename,'rb')
   4:     sonar_data_dict = pickle.load(infile)
   5: 
   6:     infile.close()
   7:     x_train1 = sonar_data_dict.get("x_train1")
   8:     x_train2 = sonar_data_dict.get("x_train2")
   9:     y_train = sonar_data_dict.get("y_train")
  10: 
  11:     x_val1 = sonar_data_dict.get("x_val1")
  12:     x_val2 = sonar_data_dict.get("x_val2")
  13:     y_val = sonar_data_dict.get("y_val")
  14: 
  15:     x_test1 = sonar_data_dict.get("x_test1")
  16:     x_test2 = sonar_data_dict.get("x_test2")
  17:     y_test = sonar_data_dict.get("y_test")
  18: 
  19:     y_test_inverted = 1 - y_test
  20:     y_train_inverted = 1 - y_train
  21:     y_val_inverted = 1 - y_val
  22: 
  23:     return x_train1, x_train2, y_train, x_val1, x_val2, y_val, x_test1, x_test2, y_test
  24: 
  25: def create_base_network(img_dim,depth,nb_filter,nb_dense_block,growth_rate,dropout1,weight_decay):
  26:     '''Base network to be shared (eq. to feature extraction).
  27:     '''    
  28:     #default values
  29:     nb_classes = 2 
  30:     img_dim = (1,96,96) 
  31:     n_channels = 1 
  32: 
  33:     #depth =  7 #40 #3N+4
  34:     #nb_filter = 16 #16 #increasing this worsens the result
  35:     #nb_dense_block = 1 #3
  36:     #growth_rate = 12
  37:     #dropout_rate = 0.3
  38: 
  39:     net = densenet.DenseNet(nb_classes,
  40:                   img_dim,
  41:                   depth,
  42:                   nb_dense_block,
  43:                   growth_rate,
  44:                   nb_filter,
  45:                   dropout_rate=dropout1,
  46:                   weight_decay=weight_decay)
  47:     
  48:     return net
  49: 
  50: def euclidean_distance(vects):
  51:     x, y = vects
  52:     return K.sqrt(K.maximum(K.sum(K.square(x - y), axis=1, keepdims=True), K.epsilon()))
  53: 
  54: def eucl_dist_output_shape(shapes):
  55:     shape1, shape2 = shapes
  56:     return (shape1[0], 1)
  57: 
  58: def contrastive_loss_altered(y_true, y_pred):
  59:     margin = 1.0
  60:     return K.mean((1-y_true) * K.square(y_pred) +
  61:                   y_true * K.square(K.maximum(margin - y_pred, 0)))
  62: 
  63: 
>>> Data
 1: 
 2: x_train1, x_train2, y_train, x_val1, x_val2, y_val, x_test1, x_test2, y_test = process_data()
 3: 
 4: 
 5: 
>>> Resulting replaced keras model:

   1: def keras_fmin_fnct(space):
   2: 
   3:     epochs = 3
   4:     input_shape = (1,96,96)
   5:     patience_ = 1
   6:     dense_filter = 512
   7:     dropout = space['dropout']
   8:     dropout1 = space['dropout_1']
   9:     depth = 10
  10:     nb_dense_block = 2
  11:     nb_filter = space['nb_filter']
  12:     growth_rate = 10
  13:     weight_decay = 1E-3
  14:     lr = 1E-4
  15: 
  16:     base_network = create_base_network(input_shape,depth,nb_filter,nb_dense_block,growth_rate,dropout1,weight_decay)
  17:     use_distance = False
  18: 
  19:     input_a = Input(shape=input_shape)
  20:     input_b = Input(shape=input_shape)
  21: 
  22:     processed_a = base_network(input_a)
  23:     processed_b = base_network(input_b)
  24: 
  25:     combined_features = concatenate([processed_a, processed_b], name = 'merge_features')
  26:     combined_features = Dense(dense_filter, kernel_initializer=keras.initializers.he_normal())(combined_features)
  27:     combined_features = Dropout(dropout)(combined_features)
  28:     combined_features = Dense(dense_filter, kernel_initializer=keras.initializers.he_normal())(combined_features)
  29:     combined_features = Activation('relu')(combined_features)
  30:     combined_features = BatchNormalization()(combined_features)
  31:     
  32:     combined_features = Dense(1, activation = 'sigmoid')(combined_features)
  33: 
  34:     model = Model(inputs = [input_a, input_b], outputs = [combined_features], name = 'model')
  35: 
  36:     model.summary()
  37:     opt = Adam(lr=lr)
  38:     model.compile(loss=binary_crossentropy, optimizer=opt, metrics=['accuracy'])
  39: 
  40:     es = EarlyStopping(monitor='val_acc', patience=patience_,verbose=1)
  41:     checkpointer = ModelCheckpoint(filepath='keras_weights.hdf5',
  42:                                    verbose=1,
  43:                                    save_best_only=True)
  44:     model.fit([x_train1, x_train2],y_train,
  45:           batch_size=128,
  46:           epochs=epochs,
  47:           validation_data=([x_val1,x_val2], y_val),
  48:           callbacks=[es],
  49:           verbose=0)
  50: 
  51:     score, acc = model.evaluate([x_test1, x_test2], y_test,verbose=0)
  52:     print('Test accuracy:', acc)
  53:     pred = model.predict([x_test1, x_test2],verbose=0)
  54: 
  55: 
  56:     threshold = 0.4
  57:     pred_scores2 = (pred>threshold).astype(int) 
  58: 
  59:     test_acc2 = accuracy_score(y_test,pred_scores2)
  60: 
  61:     auc_score = roc_auc_score(y_test,pred)
  62:     print("score new --------------- >",test_acc2)
  63:     print("auc_score ------------------> ",auc_score)
  64: 
  65: 
  66:     return {'loss': -auc_score, 'status': STATUS_OK, 'model': model}
  67: 
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 57600)        30880       input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 115200)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 512)          58982912    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 512)          0           dense_1[0][0]                    
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          262656      dropout_6[0][0]                  
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 512)          0           dense_2[0][0]                    
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 512)          2048        activation_7[0][0]               
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 1)            513         batch_normalization_7[0][0]      
==================================================================================================
Total params: 59,279,009
Trainable params: 59,277,505
Non-trainable params: 1,504
__________________________________________________________________________________________________
Test accuracy: 0.7201612903225807
score new --------------- > 0.730510752688172
auc_score ------------------>  0.8473544990750376
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 48384)        25884       input_5[0][0]                    
                                                                 input_6[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 96768)        0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 512)          49545728    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 512)          0           dense_4[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 512)          262656      dropout_12[0][0]                 
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 512)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 512)          2048        activation_14[0][0]              
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1)            513         batch_normalization_14[0][0]     
==================================================================================================
Total params: 49,836,829
Trainable params: 49,835,373
Non-trainable params: 1,456
__________________________________________________________________________________________________
Test accuracy: 0.7569892473118279
score new --------------- > 0.766263440860215
auc_score ------------------>  0.8633754624812118
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_8 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_9 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 52896)        28382       input_8[0][0]                    
                                                                 input_9[0][0]                    
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 105792)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 512)          54166016    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 512)          0           dense_7[0][0]                    
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 512)          262656      dropout_18[0][0]                 
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 512)          0           dense_8[0][0]                    
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 512)          2048        activation_21[0][0]              
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 1)            513         batch_normalization_21[0][0]     
==================================================================================================
Total params: 54,459,615
Trainable params: 54,458,135
Non-trainable params: 1,480
__________________________________________________________________________________________________
Test accuracy: 0.6104838709677419
score new --------------- > 0.6358870967741935
auc_score ------------------>  0.7201372268470344
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_11 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_12 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 62496)        33378       input_11[0][0]                   
                                                                 input_12[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 124992)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 512)          63996416    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 512)          0           dense_10[0][0]                   
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 512)          262656      dropout_24[0][0]                 
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 512)          0           dense_11[0][0]                   
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 512)          2048        activation_28[0][0]              
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 1)            513         batch_normalization_28[0][0]     
==================================================================================================
Total params: 64,295,011
Trainable params: 64,293,483
Non-trainable params: 1,528
__________________________________________________________________________________________________
Epoch 00003: early stopping
Test accuracy: 0.5502688172043011
score new --------------- > 0.5900537634408602
auc_score ------------------>  0.7736133151231356
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_14 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_15 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 62496)        33378       input_14[0][0]                   
                                                                 input_15[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 124992)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_13 (Dense)                (None, 512)          63996416    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_30 (Dropout)            (None, 512)          0           dense_13[0][0]                   
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 512)          262656      dropout_30[0][0]                 
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 512)          0           dense_14[0][0]                   
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 512)          2048        activation_35[0][0]              
__________________________________________________________________________________________________
dense_15 (Dense)                (None, 1)            513         batch_normalization_35[0][0]     
==================================================================================================
Total params: 64,295,011
Trainable params: 64,293,483
Non-trainable params: 1,528
__________________________________________________________________________________________________
Test accuracy: 0.7345430107526881
score new --------------- > 0.7311827956989247
auc_score ------------------>  0.8337195774077929
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_17 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_18 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 57600)        30880       input_17[0][0]                   
                                                                 input_18[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 115200)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_16 (Dense)                (None, 512)          58982912    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_36 (Dropout)            (None, 512)          0           dense_16[0][0]                   
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 512)          262656      dropout_36[0][0]                 
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 512)          0           dense_17[0][0]                   
__________________________________________________________________________________________________
batch_normalization_42 (BatchNo (None, 512)          2048        activation_42[0][0]              
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 1)            513         batch_normalization_42[0][0]     
==================================================================================================
Total params: 59,279,009
Trainable params: 59,277,505
Non-trainable params: 1,504
__________________________________________________________________________________________________
Test accuracy: 0.7295698924731183
score new --------------- > 0.7307795698924732
auc_score ------------------>  0.7991044123598103
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_20 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_21 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 62496)        33378       input_20[0][0]                   
                                                                 input_21[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 124992)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_19 (Dense)                (None, 512)          63996416    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_42 (Dropout)            (None, 512)          0           dense_19[0][0]                   
__________________________________________________________________________________________________
dense_20 (Dense)                (None, 512)          262656      dropout_42[0][0]                 
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 512)          0           dense_20[0][0]                   
__________________________________________________________________________________________________
batch_normalization_49 (BatchNo (None, 512)          2048        activation_49[0][0]              
__________________________________________________________________________________________________
dense_21 (Dense)                (None, 1)            513         batch_normalization_49[0][0]     
==================================================================================================
Total params: 64,295,011
Trainable params: 64,293,483
Non-trainable params: 1,528
__________________________________________________________________________________________________
Test accuracy: 0.6990591397849463
score new --------------- > 0.7208333333333333
auc_score ------------------>  0.8588695947508382
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_23 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_24 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 57600)        30880       input_23[0][0]                   
                                                                 input_24[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 115200)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_22 (Dense)                (None, 512)          58982912    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_48 (Dropout)            (None, 512)          0           dense_22[0][0]                   
__________________________________________________________________________________________________
dense_23 (Dense)                (None, 512)          262656      dropout_48[0][0]                 
__________________________________________________________________________________________________
activation_56 (Activation)      (None, 512)          0           dense_23[0][0]                   
__________________________________________________________________________________________________
batch_normalization_56 (BatchNo (None, 512)          2048        activation_56[0][0]              
__________________________________________________________________________________________________
dense_24 (Dense)                (None, 1)            513         batch_normalization_56[0][0]     
==================================================================================================
Total params: 59,279,009
Trainable params: 59,277,505
Non-trainable params: 1,504
__________________________________________________________________________________________________
Test accuracy: 0.7172043010752688
score new --------------- > 0.7321236559139785
auc_score ------------------>  0.8524051552202567
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_26 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_27 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 48384)        25884       input_26[0][0]                   
                                                                 input_27[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 96768)        0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_25 (Dense)                (None, 512)          49545728    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_54 (Dropout)            (None, 512)          0           dense_25[0][0]                   
__________________________________________________________________________________________________
dense_26 (Dense)                (None, 512)          262656      dropout_54[0][0]                 
__________________________________________________________________________________________________
activation_63 (Activation)      (None, 512)          0           dense_26[0][0]                   
__________________________________________________________________________________________________
batch_normalization_63 (BatchNo (None, 512)          2048        activation_63[0][0]              
__________________________________________________________________________________________________
dense_27 (Dense)                (None, 1)            513         batch_normalization_63[0][0]     
==================================================================================================
Total params: 49,836,829
Trainable params: 49,835,373
Non-trainable params: 1,456
__________________________________________________________________________________________________
Test accuracy: 0.646236559139785
score new --------------- > 0.6743279569892473
auc_score ------------------>  0.8116263440860215
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_29 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_30 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 52896)        28382       input_29[0][0]                   
                                                                 input_30[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 105792)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_28 (Dense)                (None, 512)          54166016    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_60 (Dropout)            (None, 512)          0           dense_28[0][0]                   
__________________________________________________________________________________________________
dense_29 (Dense)                (None, 512)          262656      dropout_60[0][0]                 
__________________________________________________________________________________________________
activation_70 (Activation)      (None, 512)          0           dense_29[0][0]                   
__________________________________________________________________________________________________
batch_normalization_70 (BatchNo (None, 512)          2048        activation_70[0][0]              
__________________________________________________________________________________________________
dense_30 (Dense)                (None, 1)            513         batch_normalization_70[0][0]     
==================================================================================================
Total params: 54,459,615
Trainable params: 54,458,135
Non-trainable params: 1,480
__________________________________________________________________________________________________
Test accuracy: 0.7426075268817204
score new --------------- > 0.7416666666666667
auc_score ------------------>  0.864634350791999
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_32 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_33 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 62496)        33378       input_32[0][0]                   
                                                                 input_33[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 124992)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_31 (Dense)                (None, 512)          63996416    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_66 (Dropout)            (None, 512)          0           dense_31[0][0]                   
__________________________________________________________________________________________________
dense_32 (Dense)                (None, 512)          262656      dropout_66[0][0]                 
__________________________________________________________________________________________________
activation_77 (Activation)      (None, 512)          0           dense_32[0][0]                   
__________________________________________________________________________________________________
batch_normalization_77 (BatchNo (None, 512)          2048        activation_77[0][0]              
__________________________________________________________________________________________________
dense_33 (Dense)                (None, 1)            513         batch_normalization_77[0][0]     
==================================================================================================
Total params: 64,295,011
Trainable params: 64,293,483
Non-trainable params: 1,528
__________________________________________________________________________________________________
Epoch 00003: early stopping
Test accuracy: 0.5618279569892473
score new --------------- > 0.6030913978494624
auc_score ------------------>  0.8058391143484797
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_35 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_36 (InputLayer)           (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
DenseNet (Model)                (None, 52896)        28382       input_35[0][0]                   
                                                                 input_36[0][0]                   
__________________________________________________________________________________________________
merge_features (Concatenate)    (None, 105792)       0           DenseNet[1][0]                   
                                                                 DenseNet[2][0]                   
__________________________________________________________________________________________________
dense_34 (Dense)                (None, 512)          54166016    merge_features[0][0]             
__________________________________________________________________________________________________
dropout_72 (Dropout)            (None, 512)          0           dense_34[0][0]                   
__________________________________________________________________________________________________
dense_35 (Dense)                (None, 512)          262656      dropout_72[0][0]                 
__________________________________________________________________________________________________
activation_84 (Activation)      (None, 512)          0           dense_35[0][0]                   
__________________________________________________________________________________________________
batch_normalization_84 (BatchNo (None, 512)          2048        activation_84[0][0]              
__________________________________________________________________________________________________
dense_36 (Dense)                (None, 1)            513         batch_normalization_84[0][0]     
==================================================================================================
Total params: 54,459,615
Trainable params: 54,458,135
Non-trainable params: 1,480
__________________________________________________________________________________________________
Test accuracy: 0.7548387096774194
score new --------------- > 0.7690860215053763
auc_score ------------------>  0.9171034223609666
best model <keras.engine.training.Model object at 0x7f8e37272b70>
best run {'dropout': 0.3050671811830158, 'dropout_1': 0.020696295427029887, 'nb_filter': 1}
Evalutation of best performing model:
[0.9583345619581078, 0.7548387096774194]
val roc_auc_score 0.917
----------trials-------------
{'dropout': [0.692539034315719], 'dropout_1': [0.21280043312755825], 'nb_filter': [2]} -0.8473544990750376
{'dropout': [0.42522861686845626], 'dropout_1': [0.23316134447477344], 'nb_filter': [0]} -0.8633754624812118
{'dropout': [0.7275581656084844], 'dropout_1': [0.7628124303271064], 'nb_filter': [1]} -0.7201372268470344
{'dropout': [0.5350807190884803], 'dropout_1': [0.9203644803497606], 'nb_filter': [3]} -0.7736133151231356
{'dropout': [0.2330896882313117], 'dropout_1': [0.9132270930992928], 'nb_filter': [3]} -0.8337195774077929
{'dropout': [0.7428344092396598], 'dropout_1': [0.16046181714460095], 'nb_filter': [2]} -0.7991044123598103
{'dropout': [0.39730440328653105], 'dropout_1': [0.820223414192403], 'nb_filter': [3]} -0.8588695947508382
{'dropout': [0.08078306361277332], 'dropout_1': [0.8231073400537193], 'nb_filter': [2]} -0.8524051552202567
{'dropout': [0.7357738125603991], 'dropout_1': [0.16569507053868804], 'nb_filter': [0]} -0.8116263440860215
{'dropout': [0.20946774700477522], 'dropout_1': [0.22780041552649732], 'nb_filter': [1]} -0.864634350791999
{'dropout': [0.10413125537798329], 'dropout_1': [0.8777848727518659], 'nb_filter': [3]} -0.8058391143484797
{'dropout': [0.3050671811830158], 'dropout_1': [0.020696295427029887], 'nb_filter': [1]} -0.9171034223609666
python densenet_siamese_best_run.py
