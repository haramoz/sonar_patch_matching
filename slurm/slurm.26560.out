python keras_dn_simple_multigpu.py
python keras_dn_simple.py
python custom_gridsearch_dn_siamese.py
python custom_gs_dn_siamese_layers_multi.py -g 1
python custom_gridsearch_dn_siamese_layers_avg.py
python custom_gridsearch_dn_siamese_layers.py
Column names are nb_layers_per_block, growth_rate, nb_dense_block, nb_filter, dropout, lr, epochs, opt, reduction, bn, batch_size, pooling
['2-2-2', '30', '3', '16', '0.2', '0.07', '21', 'adadelta', '0.5', 'FALSE', '64', 'avg']
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 25s - loss: 0.5013 - acc: 0.7580 - val_loss: 0.4362 - val_acc: 0.7917
Epoch 2/21
 - 20s - loss: 0.4097 - acc: 0.8118 - val_loss: 0.4080 - val_acc: 0.8026
Epoch 3/21
 - 20s - loss: 0.3714 - acc: 0.8340 - val_loss: 0.3652 - val_acc: 0.8353
Epoch 4/21
 - 20s - loss: 0.3460 - acc: 0.8501 - val_loss: 0.3161 - val_acc: 0.8683
Epoch 5/21
 - 20s - loss: 0.3254 - acc: 0.8623 - val_loss: 0.3554 - val_acc: 0.8371
Epoch 6/21
 - 20s - loss: 0.3083 - acc: 0.8718 - val_loss: 0.3617 - val_acc: 0.8309
Epoch 7/21
 - 20s - loss: 0.2936 - acc: 0.8800 - val_loss: 0.2893 - val_acc: 0.8794
Epoch 8/21
 - 20s - loss: 0.2762 - acc: 0.8886 - val_loss: 0.2600 - val_acc: 0.8996
Epoch 9/21
 - 20s - loss: 0.2643 - acc: 0.8965 - val_loss: 0.2375 - val_acc: 0.9074
Epoch 10/21
 - 20s - loss: 0.2549 - acc: 0.9016 - val_loss: 0.2324 - val_acc: 0.9127
Epoch 11/21
 - 20s - loss: 0.2450 - acc: 0.9049 - val_loss: 0.3130 - val_acc: 0.8630
Epoch 12/21
 - 20s - loss: 0.2345 - acc: 0.9115 - val_loss: 0.2465 - val_acc: 0.9031
Epoch 13/21
 - 20s - loss: 0.2260 - acc: 0.9168 - val_loss: 0.1958 - val_acc: 0.9321
Epoch 14/21
 - 20s - loss: 0.2192 - acc: 0.9184 - val_loss: 0.2336 - val_acc: 0.9133
Epoch 15/21
 - 20s - loss: 0.2084 - acc: 0.9240 - val_loss: 0.1924 - val_acc: 0.9302
Epoch 16/21
 - 20s - loss: 0.2031 - acc: 0.9266 - val_loss: 0.2123 - val_acc: 0.9174
Epoch 17/21
 - 20s - loss: 0.1952 - acc: 0.9307 - val_loss: 0.2199 - val_acc: 0.9123
Epoch 00017: early stopping
Test accuracy:0.830
current auc_score ------------------> 0.930
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 22s - loss: 0.5123 - acc: 0.7566 - val_loss: 0.7630 - val_acc: 0.6073
Epoch 2/21
 - 21s - loss: 0.4201 - acc: 0.8045 - val_loss: 0.4773 - val_acc: 0.7612
Epoch 3/21
 - 20s - loss: 0.3801 - acc: 0.8297 - val_loss: 0.5414 - val_acc: 0.7136
Epoch 4/21
 - 20s - loss: 0.3525 - acc: 0.8465 - val_loss: 0.4905 - val_acc: 0.7523
Epoch 5/21
 - 21s - loss: 0.3315 - acc: 0.8613 - val_loss: 0.3237 - val_acc: 0.8640
Epoch 6/21
 - 21s - loss: 0.3122 - acc: 0.8700 - val_loss: 0.3518 - val_acc: 0.8427
Epoch 7/21
 - 21s - loss: 0.2956 - acc: 0.8793 - val_loss: 0.2859 - val_acc: 0.8852
Epoch 8/21
 - 21s - loss: 0.2816 - acc: 0.8856 - val_loss: 0.3475 - val_acc: 0.8420
Epoch 9/21
 - 21s - loss: 0.2681 - acc: 0.8930 - val_loss: 0.2985 - val_acc: 0.8769
Epoch 10/21
 - 21s - loss: 0.2544 - acc: 0.9004 - val_loss: 0.2549 - val_acc: 0.9022
Epoch 11/21
 - 21s - loss: 0.2448 - acc: 0.9048 - val_loss: 0.2315 - val_acc: 0.9108
Epoch 12/21
 - 20s - loss: 0.2348 - acc: 0.9102 - val_loss: 0.2152 - val_acc: 0.9199
Epoch 13/21
 - 20s - loss: 0.2236 - acc: 0.9164 - val_loss: 0.2112 - val_acc: 0.9221
Epoch 14/21
 - 20s - loss: 0.2159 - acc: 0.9193 - val_loss: 0.2601 - val_acc: 0.8940
Epoch 15/21
 - 20s - loss: 0.2103 - acc: 0.9217 - val_loss: 0.2609 - val_acc: 0.8943
Epoch 16/21
 - 20s - loss: 0.2014 - acc: 0.9272 - val_loss: 0.2110 - val_acc: 0.9197
Epoch 17/21
 - 20s - loss: 0.1942 - acc: 0.9298 - val_loss: 0.2234 - val_acc: 0.9135
Epoch 00017: early stopping
Test accuracy:0.810
current auc_score ------------------> 0.943
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 22s - loss: 0.5212 - acc: 0.7473 - val_loss: 0.4381 - val_acc: 0.7949
Epoch 2/21
 - 20s - loss: 0.4202 - acc: 0.8044 - val_loss: 0.4373 - val_acc: 0.7915
Epoch 3/21
 - 20s - loss: 0.3799 - acc: 0.8306 - val_loss: 0.3476 - val_acc: 0.8419
Epoch 4/21
 - 20s - loss: 0.3513 - acc: 0.8453 - val_loss: 0.3408 - val_acc: 0.8446
Epoch 5/21
 - 20s - loss: 0.3303 - acc: 0.8592 - val_loss: 0.2981 - val_acc: 0.8761
Epoch 6/21
 - 20s - loss: 0.3133 - acc: 0.8692 - val_loss: 0.2897 - val_acc: 0.8839
Epoch 7/21
 - 20s - loss: 0.2955 - acc: 0.8785 - val_loss: 0.2564 - val_acc: 0.8970
Epoch 8/21
 - 20s - loss: 0.2822 - acc: 0.8859 - val_loss: 0.2801 - val_acc: 0.8799
Epoch 9/21
 - 20s - loss: 0.2688 - acc: 0.8946 - val_loss: 0.2348 - val_acc: 0.9098
Epoch 10/21
 - 20s - loss: 0.2586 - acc: 0.8989 - val_loss: 0.3074 - val_acc: 0.8741
Epoch 11/21
 - 20s - loss: 0.2448 - acc: 0.9053 - val_loss: 0.2479 - val_acc: 0.9012
Epoch 12/21
 - 20s - loss: 0.2344 - acc: 0.9113 - val_loss: 0.2834 - val_acc: 0.8911

Epoch 00012: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 13/21
 - 20s - loss: 0.2225 - acc: 0.9165 - val_loss: 0.2053 - val_acc: 0.9221
Epoch 14/21
 - 20s - loss: 0.2184 - acc: 0.9196 - val_loss: 0.2016 - val_acc: 0.9228
Epoch 15/21
 - 20s - loss: 0.2154 - acc: 0.9209 - val_loss: 0.1994 - val_acc: 0.9265
Epoch 16/21
 - 20s - loss: 0.2127 - acc: 0.9224 - val_loss: 0.2197 - val_acc: 0.9158
Epoch 17/21
 - 20s - loss: 0.2104 - acc: 0.9241 - val_loss: 0.1934 - val_acc: 0.9283
Epoch 18/21
 - 20s - loss: 0.2074 - acc: 0.9248 - val_loss: 0.2033 - val_acc: 0.9211
Epoch 19/21
 - 20s - loss: 0.2049 - acc: 0.9260 - val_loss: 0.1840 - val_acc: 0.9310
Epoch 20/21
 - 20s - loss: 0.2008 - acc: 0.9270 - val_loss: 0.2035 - val_acc: 0.9218
Epoch 21/21
 - 20s - loss: 0.1997 - acc: 0.9294 - val_loss: 0.1851 - val_acc: 0.9312
Test accuracy:0.856
current auc_score ------------------> 0.937
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 22s - loss: 0.5131 - acc: 0.7579 - val_loss: 0.4356 - val_acc: 0.7961
Epoch 2/21
 - 21s - loss: 0.4164 - acc: 0.8078 - val_loss: 0.4482 - val_acc: 0.7806
Epoch 3/21
 - 20s - loss: 0.3771 - acc: 0.8315 - val_loss: 0.3898 - val_acc: 0.8151
Epoch 4/21
 - 21s - loss: 0.3510 - acc: 0.8478 - val_loss: 0.3487 - val_acc: 0.8426
Epoch 5/21
 - 21s - loss: 0.3289 - acc: 0.8598 - val_loss: 0.3729 - val_acc: 0.8311
Epoch 6/21
 - 21s - loss: 0.3121 - acc: 0.8709 - val_loss: 0.2844 - val_acc: 0.8852
Epoch 7/21
 - 21s - loss: 0.2980 - acc: 0.8786 - val_loss: 0.3326 - val_acc: 0.8539
Epoch 8/21
 - 21s - loss: 0.2840 - acc: 0.8873 - val_loss: 0.2984 - val_acc: 0.8751
Epoch 9/21
 - 21s - loss: 0.2765 - acc: 0.8891 - val_loss: 0.2994 - val_acc: 0.8766

Epoch 00009: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 10/21
 - 20s - loss: 0.2619 - acc: 0.8969 - val_loss: 0.2752 - val_acc: 0.8886
Epoch 11/21
 - 20s - loss: 0.2574 - acc: 0.8985 - val_loss: 0.2495 - val_acc: 0.9066
Epoch 12/21
 - 20s - loss: 0.2562 - acc: 0.9000 - val_loss: 0.2596 - val_acc: 0.8976
Epoch 13/21
 - 20s - loss: 0.2497 - acc: 0.9025 - val_loss: 0.2613 - val_acc: 0.8982
Epoch 14/21
 - 20s - loss: 0.2479 - acc: 0.9052 - val_loss: 0.2405 - val_acc: 0.9093
Epoch 15/21
 - 20s - loss: 0.2455 - acc: 0.9055 - val_loss: 0.2693 - val_acc: 0.8926
Epoch 16/21
 - 20s - loss: 0.2401 - acc: 0.9075 - val_loss: 0.2576 - val_acc: 0.8966
Epoch 17/21
 - 20s - loss: 0.2400 - acc: 0.9075 - val_loss: 0.2670 - val_acc: 0.8952

Epoch 00017: ReduceLROnPlateau reducing learning rate to 0.006999999858704226.
Epoch 18/21
 - 20s - loss: 0.2340 - acc: 0.9110 - val_loss: 0.2473 - val_acc: 0.9051
Epoch 00018: early stopping
Test accuracy:0.827
current auc_score ------------------> 0.946
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 22s - loss: 0.4958 - acc: 0.7633 - val_loss: 0.6143 - val_acc: 0.7070
Epoch 2/21
 - 20s - loss: 0.4121 - acc: 0.8028 - val_loss: 0.4697 - val_acc: 0.7735
Epoch 3/21
 - 20s - loss: 0.3745 - acc: 0.8295 - val_loss: 0.4292 - val_acc: 0.7978
Epoch 4/21
 - 20s - loss: 0.3515 - acc: 0.8461 - val_loss: 0.3723 - val_acc: 0.8303
Epoch 5/21
 - 20s - loss: 0.3303 - acc: 0.8568 - val_loss: 0.3198 - val_acc: 0.8655
Epoch 6/21
 - 21s - loss: 0.3110 - acc: 0.8692 - val_loss: 0.2867 - val_acc: 0.8843
Epoch 7/21
 - 20s - loss: 0.2999 - acc: 0.8742 - val_loss: 0.3708 - val_acc: 0.8351
Epoch 8/21
 - 20s - loss: 0.2845 - acc: 0.8847 - val_loss: 0.2894 - val_acc: 0.8776
Epoch 9/21
 - 21s - loss: 0.2725 - acc: 0.8888 - val_loss: 0.3209 - val_acc: 0.8648

Epoch 00009: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 10/21
 - 21s - loss: 0.2571 - acc: 0.8989 - val_loss: 0.2451 - val_acc: 0.9045
Epoch 11/21
 - 20s - loss: 0.2531 - acc: 0.9011 - val_loss: 0.2436 - val_acc: 0.9047
Epoch 12/21
 - 20s - loss: 0.2522 - acc: 0.9021 - val_loss: 0.2401 - val_acc: 0.9068
Epoch 13/21
 - 20s - loss: 0.2465 - acc: 0.9051 - val_loss: 0.2275 - val_acc: 0.9148
Epoch 14/21
 - 20s - loss: 0.2419 - acc: 0.9068 - val_loss: 0.2480 - val_acc: 0.9024
Epoch 15/21
 - 21s - loss: 0.2405 - acc: 0.9068 - val_loss: 0.2452 - val_acc: 0.9045
Epoch 16/21
 - 21s - loss: 0.2348 - acc: 0.9103 - val_loss: 0.2159 - val_acc: 0.9213
Epoch 17/21
 - 21s - loss: 0.2303 - acc: 0.9130 - val_loss: 0.2122 - val_acc: 0.9236
Epoch 18/21
 - 21s - loss: 0.2279 - acc: 0.9146 - val_loss: 0.2434 - val_acc: 0.9069
Epoch 19/21
 - 20s - loss: 0.2268 - acc: 0.9129 - val_loss: 0.2099 - val_acc: 0.9218
Epoch 20/21
 - 21s - loss: 0.2236 - acc: 0.9164 - val_loss: 0.2519 - val_acc: 0.9027
Epoch 21/21
 - 21s - loss: 0.2227 - acc: 0.9145 - val_loss: 0.2023 - val_acc: 0.9255
Test accuracy:0.847
current auc_score ------------------> 0.950
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 22s - loss: 0.5134 - acc: 0.7585 - val_loss: 0.4361 - val_acc: 0.7913
Epoch 2/21
 - 21s - loss: 0.4113 - acc: 0.8079 - val_loss: 0.3752 - val_acc: 0.8257
Epoch 3/21
 - 21s - loss: 0.3706 - acc: 0.8354 - val_loss: 0.3361 - val_acc: 0.8461
Epoch 4/21
 - 21s - loss: 0.3431 - acc: 0.8510 - val_loss: 0.3114 - val_acc: 0.8681
Epoch 5/21
 - 20s - loss: 0.3241 - acc: 0.8644 - val_loss: 0.3426 - val_acc: 0.8463
Epoch 6/21
 - 20s - loss: 0.3062 - acc: 0.8718 - val_loss: 0.2756 - val_acc: 0.8909
Epoch 7/21
 - 20s - loss: 0.2913 - acc: 0.8807 - val_loss: 0.2524 - val_acc: 0.9019
Epoch 8/21
 - 21s - loss: 0.2765 - acc: 0.8896 - val_loss: 0.2561 - val_acc: 0.8938
Epoch 9/21
 - 21s - loss: 0.2671 - acc: 0.8945 - val_loss: 0.2307 - val_acc: 0.9124
Epoch 10/21
 - 21s - loss: 0.2545 - acc: 0.9015 - val_loss: 0.2527 - val_acc: 0.8967
Epoch 11/21
 - 22s - loss: 0.2435 - acc: 0.9065 - val_loss: 0.2040 - val_acc: 0.9271
Epoch 12/21
 - 22s - loss: 0.2356 - acc: 0.9092 - val_loss: 0.2334 - val_acc: 0.9040
Epoch 13/21
 - 21s - loss: 0.2259 - acc: 0.9155 - val_loss: 0.1972 - val_acc: 0.9258
Epoch 14/21
 - 21s - loss: 0.2183 - acc: 0.9173 - val_loss: 0.2096 - val_acc: 0.9233
Epoch 15/21
 - 21s - loss: 0.2113 - acc: 0.9214 - val_loss: 0.1882 - val_acc: 0.9292
Epoch 16/21
 - 21s - loss: 0.2053 - acc: 0.9257 - val_loss: 0.1588 - val_acc: 0.9426
Epoch 17/21
 - 21s - loss: 0.1992 - acc: 0.9280 - val_loss: 0.1616 - val_acc: 0.9449
Epoch 18/21
 - 21s - loss: 0.1924 - acc: 0.9310 - val_loss: 0.1824 - val_acc: 0.9308
Epoch 19/21
 - 21s - loss: 0.1860 - acc: 0.9338 - val_loss: 0.1412 - val_acc: 0.9516
Epoch 20/21
 - 21s - loss: 0.1818 - acc: 0.9367 - val_loss: 0.1569 - val_acc: 0.9450
Epoch 21/21
 - 21s - loss: 0.1784 - acc: 0.9358 - val_loss: 0.1368 - val_acc: 0.9519
Test accuracy:0.838
current auc_score ------------------> 0.956
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 23s - loss: 0.4993 - acc: 0.7622 - val_loss: 0.4304 - val_acc: 0.7909
Epoch 2/21
 - 21s - loss: 0.4152 - acc: 0.8027 - val_loss: 0.4051 - val_acc: 0.8065
Epoch 3/21
 - 21s - loss: 0.3765 - acc: 0.8303 - val_loss: 0.3412 - val_acc: 0.8455
Epoch 4/21
 - 21s - loss: 0.3469 - acc: 0.8488 - val_loss: 0.4603 - val_acc: 0.7807
Epoch 5/21
 - 21s - loss: 0.3266 - acc: 0.8617 - val_loss: 0.4378 - val_acc: 0.7964
Epoch 6/21
 - 21s - loss: 0.3098 - acc: 0.8698 - val_loss: 0.2958 - val_acc: 0.8780
Epoch 7/21
 - 21s - loss: 0.2961 - acc: 0.8781 - val_loss: 0.3276 - val_acc: 0.8563
Epoch 8/21
 - 21s - loss: 0.2802 - acc: 0.8856 - val_loss: 0.2384 - val_acc: 0.9064
Epoch 9/21
 - 21s - loss: 0.2663 - acc: 0.8949 - val_loss: 0.4103 - val_acc: 0.8186
Epoch 10/21
 - 21s - loss: 0.2544 - acc: 0.8989 - val_loss: 0.2563 - val_acc: 0.8942
Epoch 11/21
 - 21s - loss: 0.2428 - acc: 0.9070 - val_loss: 0.2265 - val_acc: 0.9088
Epoch 12/21
 - 21s - loss: 0.2340 - acc: 0.9102 - val_loss: 0.2668 - val_acc: 0.8878
Epoch 13/21
 - 21s - loss: 0.2253 - acc: 0.9164 - val_loss: 0.2124 - val_acc: 0.9178
Epoch 14/21
 - 21s - loss: 0.2172 - acc: 0.9190 - val_loss: 0.3169 - val_acc: 0.8705
Epoch 15/21
 - 21s - loss: 0.2090 - acc: 0.9241 - val_loss: 0.2010 - val_acc: 0.9247
Epoch 16/21
 - 21s - loss: 0.2006 - acc: 0.9278 - val_loss: 0.1748 - val_acc: 0.9364
Epoch 17/21
 - 20s - loss: 0.1939 - acc: 0.9288 - val_loss: 0.1654 - val_acc: 0.9406
Epoch 18/21
 - 21s - loss: 0.1856 - acc: 0.9333 - val_loss: 0.1869 - val_acc: 0.9292
Epoch 19/21
 - 21s - loss: 0.1814 - acc: 0.9349 - val_loss: 0.1909 - val_acc: 0.9272
Epoch 20/21
 - 21s - loss: 0.1751 - acc: 0.9393 - val_loss: 0.1736 - val_acc: 0.9390

Epoch 00020: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 21/21
 - 21s - loss: 0.1660 - acc: 0.9419 - val_loss: 0.1305 - val_acc: 0.9572
Test accuracy:0.829
current auc_score ------------------> 0.947
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 23s - loss: 0.5029 - acc: 0.7576 - val_loss: 0.5874 - val_acc: 0.7052
Epoch 2/21
 - 21s - loss: 0.4263 - acc: 0.7975 - val_loss: 0.4749 - val_acc: 0.7669
Epoch 3/21
 - 21s - loss: 0.3914 - acc: 0.8192 - val_loss: 0.4278 - val_acc: 0.7913
Epoch 4/21
 - 21s - loss: 0.3629 - acc: 0.8374 - val_loss: 0.4150 - val_acc: 0.7994
Epoch 5/21
 - 21s - loss: 0.3408 - acc: 0.8531 - val_loss: 0.3496 - val_acc: 0.8443
Epoch 6/21
 - 21s - loss: 0.3214 - acc: 0.8641 - val_loss: 0.3302 - val_acc: 0.8475
Epoch 7/21
 - 21s - loss: 0.3048 - acc: 0.8743 - val_loss: 0.2817 - val_acc: 0.8810
Epoch 8/21
 - 21s - loss: 0.2885 - acc: 0.8812 - val_loss: 0.2618 - val_acc: 0.8962
Epoch 9/21
 - 21s - loss: 0.2752 - acc: 0.8882 - val_loss: 0.2456 - val_acc: 0.8996
Epoch 10/21
 - 21s - loss: 0.2599 - acc: 0.8971 - val_loss: 0.2265 - val_acc: 0.9104
Epoch 11/21
 - 21s - loss: 0.2518 - acc: 0.9014 - val_loss: 0.2094 - val_acc: 0.9209
Epoch 12/21
 - 21s - loss: 0.2389 - acc: 0.9075 - val_loss: 0.2155 - val_acc: 0.9160
Epoch 13/21
 - 21s - loss: 0.2311 - acc: 0.9123 - val_loss: 0.2630 - val_acc: 0.8967
Epoch 14/21
 - 21s - loss: 0.2197 - acc: 0.9164 - val_loss: 0.1882 - val_acc: 0.9297
Epoch 15/21
 - 21s - loss: 0.2122 - acc: 0.9203 - val_loss: 0.1936 - val_acc: 0.9272
Epoch 16/21
 - 21s - loss: 0.2060 - acc: 0.9235 - val_loss: 0.2387 - val_acc: 0.9070
Epoch 17/21
 - 21s - loss: 0.1971 - acc: 0.9299 - val_loss: 0.1867 - val_acc: 0.9308
Epoch 18/21
 - 21s - loss: 0.1902 - acc: 0.9334 - val_loss: 0.1758 - val_acc: 0.9361
Epoch 19/21
 - 21s - loss: 0.1844 - acc: 0.9344 - val_loss: 0.1739 - val_acc: 0.9365
Epoch 20/21
 - 21s - loss: 0.1792 - acc: 0.9368 - val_loss: 0.2188 - val_acc: 0.9193
Epoch 21/21
 - 21s - loss: 0.1713 - acc: 0.9398 - val_loss: 0.1827 - val_acc: 0.9325
Test accuracy:0.858
current auc_score ------------------> 0.939
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 23s - loss: 0.5221 - acc: 0.7526 - val_loss: 0.4512 - val_acc: 0.7888
Epoch 2/21
 - 21s - loss: 0.4137 - acc: 0.8097 - val_loss: 0.4226 - val_acc: 0.7989
Epoch 3/21
 - 21s - loss: 0.3756 - acc: 0.8324 - val_loss: 0.5463 - val_acc: 0.7361
Epoch 4/21
 - 21s - loss: 0.3503 - acc: 0.8489 - val_loss: 0.3396 - val_acc: 0.8443
Epoch 5/21
 - 21s - loss: 0.3291 - acc: 0.8602 - val_loss: 0.3751 - val_acc: 0.8262
Epoch 6/21
 - 21s - loss: 0.3145 - acc: 0.8683 - val_loss: 0.2946 - val_acc: 0.8729
Epoch 7/21
 - 21s - loss: 0.3000 - acc: 0.8755 - val_loss: 0.2946 - val_acc: 0.8799
Epoch 8/21
 - 21s - loss: 0.2854 - acc: 0.8836 - val_loss: 0.3590 - val_acc: 0.8548
Epoch 9/21
 - 21s - loss: 0.2743 - acc: 0.8911 - val_loss: 0.2940 - val_acc: 0.8745
Epoch 10/21
 - 21s - loss: 0.2624 - acc: 0.8954 - val_loss: 0.2311 - val_acc: 0.9091
Epoch 11/21
 - 21s - loss: 0.2492 - acc: 0.9038 - val_loss: 0.2447 - val_acc: 0.8998
Epoch 12/21
 - 21s - loss: 0.2429 - acc: 0.9065 - val_loss: 0.2100 - val_acc: 0.9231
Epoch 13/21
 - 21s - loss: 0.2335 - acc: 0.9113 - val_loss: 0.2409 - val_acc: 0.9060
Epoch 14/21
 - 21s - loss: 0.2270 - acc: 0.9141 - val_loss: 0.2055 - val_acc: 0.9221
Epoch 15/21
 - 21s - loss: 0.2166 - acc: 0.9194 - val_loss: 0.2179 - val_acc: 0.9202
Epoch 16/21
 - 21s - loss: 0.2092 - acc: 0.9239 - val_loss: 0.1832 - val_acc: 0.9311
Epoch 17/21
 - 21s - loss: 0.2014 - acc: 0.9271 - val_loss: 0.1625 - val_acc: 0.9434
Epoch 18/21
 - 21s - loss: 0.1956 - acc: 0.9286 - val_loss: 0.1821 - val_acc: 0.9352
Epoch 19/21
 - 21s - loss: 0.1893 - acc: 0.9322 - val_loss: 0.2296 - val_acc: 0.9076
Epoch 20/21
 - 21s - loss: 0.1816 - acc: 0.9353 - val_loss: 0.1443 - val_acc: 0.9504
Epoch 21/21
 - 21s - loss: 0.1797 - acc: 0.9364 - val_loss: 0.1645 - val_acc: 0.9403
Test accuracy:0.848
current auc_score ------------------> 0.951
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  21  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 109)          0           activation_10[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            110         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 91,668
Trainable params: 90,478
Non-trainable params: 1,190
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/21
 - 22s - loss: 0.5044 - acc: 0.7542 - val_loss: 0.4369 - val_acc: 0.7923
Epoch 2/21
 - 21s - loss: 0.4030 - acc: 0.8141 - val_loss: 0.4653 - val_acc: 0.7892
Epoch 3/21
 - 21s - loss: 0.3632 - acc: 0.8398 - val_loss: 0.3458 - val_acc: 0.8481
Epoch 4/21
 - 21s - loss: 0.3385 - acc: 0.8558 - val_loss: 0.3269 - val_acc: 0.8631
Epoch 5/21
 - 21s - loss: 0.3160 - acc: 0.8689 - val_loss: 0.3084 - val_acc: 0.8739
Epoch 6/21
 - 21s - loss: 0.2993 - acc: 0.8796 - val_loss: 0.3098 - val_acc: 0.8759
Epoch 7/21
 - 21s - loss: 0.2812 - acc: 0.8874 - val_loss: 0.3075 - val_acc: 0.8726
Epoch 8/21
 - 21s - loss: 0.2715 - acc: 0.8933 - val_loss: 0.3529 - val_acc: 0.8534
Epoch 9/21
 - 21s - loss: 0.2562 - acc: 0.9018 - val_loss: 0.3158 - val_acc: 0.8745
Epoch 10/21
 - 21s - loss: 0.2447 - acc: 0.9079 - val_loss: 0.2444 - val_acc: 0.9049
Epoch 11/21
 - 20s - loss: 0.2392 - acc: 0.9102 - val_loss: 0.3671 - val_acc: 0.8581
Epoch 12/21
 - 21s - loss: 0.2268 - acc: 0.9155 - val_loss: 0.2942 - val_acc: 0.8872
Epoch 13/21
 - 21s - loss: 0.2205 - acc: 0.9199 - val_loss: 0.2234 - val_acc: 0.9163
Epoch 14/21
 - 21s - loss: 0.2111 - acc: 0.9222 - val_loss: 0.2326 - val_acc: 0.9089
Epoch 15/21
 - 21s - loss: 0.2019 - acc: 0.9265 - val_loss: 0.2274 - val_acc: 0.9158
Epoch 16/21
 - 21s - loss: 0.1932 - acc: 0.9319 - val_loss: 0.2259 - val_acc: 0.9182

Epoch 00016: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 17/21
 - 21s - loss: 0.1858 - acc: 0.9345 - val_loss: 0.1991 - val_acc: 0.9266
Epoch 18/21
 - 21s - loss: 0.1835 - acc: 0.9368 - val_loss: 0.2014 - val_acc: 0.9222
Epoch 19/21
 - 21s - loss: 0.1822 - acc: 0.9366 - val_loss: 0.2101 - val_acc: 0.9212
Epoch 20/21
 - 21s - loss: 0.1775 - acc: 0.9383 - val_loss: 0.2145 - val_acc: 0.9194

Epoch 00020: ReduceLROnPlateau reducing learning rate to 0.006999999858704226.
Epoch 21/21
 - 21s - loss: 0.1762 - acc: 0.9388 - val_loss: 0.2090 - val_acc: 0.9236
Epoch 00021: early stopping
Test accuracy:0.897
current auc_score ------------------> 0.959
Saved model to disk
accuracies:  [0.8302419354838709, 0.8104838709677419, 0.855510752688172, 0.826747311827957, 0.8471774193548387, 0.8381720430107527, 0.8290322580645161, 0.8575268817204301, 0.847983870967742, 0.8973118279569893]
aucs:  [0.9302, 0.9433, 0.9372, 0.946, 0.9503, 0.9559, 0.9471, 0.9389, 0.9512, 0.9593]
mean and std AUC:  0.946+/-0.008  max:   0.9593
['6-6-6', '30', '3', '16', '0.2', '0.07', '15', 'adadelta', '0.5', 'FALSE', '64', 'avg']
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 38s - loss: 0.4757 - acc: 0.7894 - val_loss: 0.4089 - val_acc: 0.8199
Epoch 2/15
 - 34s - loss: 0.3580 - acc: 0.8603 - val_loss: 0.3366 - val_acc: 0.8744
Epoch 3/15
 - 34s - loss: 0.2964 - acc: 0.8944 - val_loss: 0.2494 - val_acc: 0.9196
Epoch 4/15
 - 34s - loss: 0.2543 - acc: 0.9159 - val_loss: 0.2295 - val_acc: 0.9258
Epoch 5/15
 - 34s - loss: 0.2237 - acc: 0.9293 - val_loss: 0.2307 - val_acc: 0.9208
Epoch 6/15
 - 34s - loss: 0.2019 - acc: 0.9388 - val_loss: 0.1908 - val_acc: 0.9436
Epoch 7/15
 - 34s - loss: 0.1803 - acc: 0.9489 - val_loss: 0.2521 - val_acc: 0.9191
Epoch 8/15
 - 34s - loss: 0.1652 - acc: 0.9556 - val_loss: 0.1796 - val_acc: 0.9462
Epoch 9/15
 - 34s - loss: 0.1524 - acc: 0.9618 - val_loss: 0.1959 - val_acc: 0.9405
Epoch 10/15
 - 34s - loss: 0.1412 - acc: 0.9649 - val_loss: 0.1114 - val_acc: 0.9777
Epoch 11/15
 - 34s - loss: 0.1314 - acc: 0.9694 - val_loss: 0.1122 - val_acc: 0.9748
Epoch 12/15
 - 34s - loss: 0.1238 - acc: 0.9717 - val_loss: 0.1564 - val_acc: 0.9595
Epoch 13/15
 - 34s - loss: 0.1169 - acc: 0.9751 - val_loss: 0.1545 - val_acc: 0.9586

Epoch 00013: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 14/15
 - 33s - loss: 0.1018 - acc: 0.9812 - val_loss: 0.0834 - val_acc: 0.9869
Epoch 15/15
 - 33s - loss: 0.0960 - acc: 0.9832 - val_loss: 0.0825 - val_acc: 0.9867
Test accuracy:0.828
current auc_score ------------------> 0.914
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 39s - loss: 0.4572 - acc: 0.8005 - val_loss: 0.4052 - val_acc: 0.8385
Epoch 2/15
 - 34s - loss: 0.3354 - acc: 0.8729 - val_loss: 0.3702 - val_acc: 0.8574
Epoch 3/15
 - 34s - loss: 0.2733 - acc: 0.9083 - val_loss: 0.2568 - val_acc: 0.9158
Epoch 4/15
 - 33s - loss: 0.2351 - acc: 0.9256 - val_loss: 0.1908 - val_acc: 0.9429
Epoch 5/15
 - 34s - loss: 0.2065 - acc: 0.9381 - val_loss: 0.1915 - val_acc: 0.9444
Epoch 6/15
 - 34s - loss: 0.1831 - acc: 0.9489 - val_loss: 0.2095 - val_acc: 0.9287
Epoch 7/15
 - 33s - loss: 0.1657 - acc: 0.9560 - val_loss: 0.1422 - val_acc: 0.9649
Epoch 8/15
 - 34s - loss: 0.1509 - acc: 0.9608 - val_loss: 0.1198 - val_acc: 0.9736
Epoch 9/15
 - 34s - loss: 0.1379 - acc: 0.9666 - val_loss: 0.0998 - val_acc: 0.9832
Epoch 10/15
 - 34s - loss: 0.1296 - acc: 0.9699 - val_loss: 0.1188 - val_acc: 0.9736
Epoch 11/15
 - 34s - loss: 0.1202 - acc: 0.9739 - val_loss: 0.0970 - val_acc: 0.9826
Epoch 12/15
 - 34s - loss: 0.1130 - acc: 0.9765 - val_loss: 0.1022 - val_acc: 0.9792
Epoch 13/15
 - 34s - loss: 0.1065 - acc: 0.9783 - val_loss: 0.0852 - val_acc: 0.9851
Epoch 14/15
 - 34s - loss: 0.1004 - acc: 0.9811 - val_loss: 0.0714 - val_acc: 0.9928
Epoch 15/15
 - 33s - loss: 0.0971 - acc: 0.9820 - val_loss: 0.0702 - val_acc: 0.9926
Test accuracy:0.808
current auc_score ------------------> 0.934
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 39s - loss: 0.4690 - acc: 0.7927 - val_loss: 0.5138 - val_acc: 0.7695
Epoch 2/15
 - 35s - loss: 0.3578 - acc: 0.8579 - val_loss: 0.3295 - val_acc: 0.8720
Epoch 3/15
 - 36s - loss: 0.2996 - acc: 0.8923 - val_loss: 0.2749 - val_acc: 0.9035
Epoch 4/15
 - 35s - loss: 0.2610 - acc: 0.9120 - val_loss: 0.3265 - val_acc: 0.8817
Epoch 5/15
 - 35s - loss: 0.2259 - acc: 0.9283 - val_loss: 0.2181 - val_acc: 0.9356
Epoch 6/15
 - 35s - loss: 0.2052 - acc: 0.9379 - val_loss: 0.1954 - val_acc: 0.9452
Epoch 7/15
 - 35s - loss: 0.1834 - acc: 0.9483 - val_loss: 0.2432 - val_acc: 0.9184
Epoch 8/15
 - 35s - loss: 0.1652 - acc: 0.9550 - val_loss: 0.1488 - val_acc: 0.9631
Epoch 9/15
 - 35s - loss: 0.1547 - acc: 0.9592 - val_loss: 0.1611 - val_acc: 0.9582
Epoch 10/15
 - 35s - loss: 0.1461 - acc: 0.9630 - val_loss: 0.1616 - val_acc: 0.9556
Epoch 11/15
 - 35s - loss: 0.1358 - acc: 0.9667 - val_loss: 0.2151 - val_acc: 0.9352

Epoch 00011: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 12/15
 - 35s - loss: 0.1161 - acc: 0.9756 - val_loss: 0.1046 - val_acc: 0.9808
Epoch 13/15
 - 35s - loss: 0.1106 - acc: 0.9776 - val_loss: 0.1049 - val_acc: 0.9797
Epoch 14/15
 - 35s - loss: 0.1090 - acc: 0.9774 - val_loss: 0.0981 - val_acc: 0.9821
Epoch 15/15
 - 35s - loss: 0.1030 - acc: 0.9805 - val_loss: 0.0915 - val_acc: 0.9852
Test accuracy:0.778
current auc_score ------------------> 0.934
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 39s - loss: 0.4763 - acc: 0.7898 - val_loss: 0.7022 - val_acc: 0.6916
Epoch 2/15
 - 35s - loss: 0.3610 - acc: 0.8581 - val_loss: 0.3901 - val_acc: 0.8465
Epoch 3/15
 - 35s - loss: 0.3030 - acc: 0.8903 - val_loss: 0.2632 - val_acc: 0.9069
Epoch 4/15
 - 35s - loss: 0.2628 - acc: 0.9118 - val_loss: 0.3417 - val_acc: 0.8690
Epoch 5/15
 - 35s - loss: 0.2316 - acc: 0.9258 - val_loss: 0.2336 - val_acc: 0.9280
Epoch 6/15
 - 36s - loss: 0.2054 - acc: 0.9380 - val_loss: 0.1961 - val_acc: 0.9425
Epoch 7/15
 - 35s - loss: 0.1857 - acc: 0.9468 - val_loss: 0.1757 - val_acc: 0.9478
Epoch 8/15
 - 35s - loss: 0.1696 - acc: 0.9532 - val_loss: 0.1443 - val_acc: 0.9617
Epoch 9/15
 - 36s - loss: 0.1551 - acc: 0.9597 - val_loss: 0.1397 - val_acc: 0.9627
Epoch 10/15
 - 35s - loss: 0.1451 - acc: 0.9634 - val_loss: 0.1156 - val_acc: 0.9755
Epoch 11/15
 - 35s - loss: 0.1354 - acc: 0.9664 - val_loss: 0.1395 - val_acc: 0.9634
Epoch 12/15
 - 35s - loss: 0.1280 - acc: 0.9706 - val_loss: 0.1286 - val_acc: 0.9664
Epoch 13/15
 - 35s - loss: 0.1189 - acc: 0.9741 - val_loss: 0.1001 - val_acc: 0.9821
Epoch 14/15
 - 35s - loss: 0.1139 - acc: 0.9755 - val_loss: 0.1676 - val_acc: 0.9506
Epoch 15/15
 - 35s - loss: 0.1076 - acc: 0.9780 - val_loss: 0.1138 - val_acc: 0.9738
Test accuracy:0.797
current auc_score ------------------> 0.909
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 38s - loss: 0.4716 - acc: 0.7930 - val_loss: 0.3812 - val_acc: 0.8434
Epoch 2/15
 - 34s - loss: 0.3495 - acc: 0.8654 - val_loss: 0.3335 - val_acc: 0.8779
Epoch 3/15
 - 35s - loss: 0.2887 - acc: 0.9001 - val_loss: 0.2667 - val_acc: 0.9109
Epoch 4/15
 - 34s - loss: 0.2439 - acc: 0.9221 - val_loss: 0.2304 - val_acc: 0.9301
Epoch 5/15
 - 34s - loss: 0.2151 - acc: 0.9340 - val_loss: 0.4093 - val_acc: 0.8479
Epoch 6/15
 - 35s - loss: 0.1890 - acc: 0.9457 - val_loss: 0.1873 - val_acc: 0.9458
Epoch 7/15
 - 34s - loss: 0.1682 - acc: 0.9554 - val_loss: 0.1739 - val_acc: 0.9521
Epoch 8/15
 - 34s - loss: 0.1545 - acc: 0.9610 - val_loss: 0.1946 - val_acc: 0.9409
Epoch 9/15
 - 34s - loss: 0.1416 - acc: 0.9659 - val_loss: 0.1212 - val_acc: 0.9743
Epoch 10/15
 - 34s - loss: 0.1312 - acc: 0.9697 - val_loss: 0.1606 - val_acc: 0.9554
Epoch 11/15
 - 34s - loss: 0.1222 - acc: 0.9726 - val_loss: 0.1069 - val_acc: 0.9807
Epoch 12/15
 - 34s - loss: 0.1138 - acc: 0.9768 - val_loss: 0.1035 - val_acc: 0.9805
Epoch 13/15
 - 34s - loss: 0.1071 - acc: 0.9786 - val_loss: 0.0973 - val_acc: 0.9810
Epoch 14/15
 - 34s - loss: 0.1064 - acc: 0.9795 - val_loss: 0.0925 - val_acc: 0.9827
Epoch 15/15
 - 35s - loss: 0.1014 - acc: 0.9815 - val_loss: 0.0900 - val_acc: 0.9861
Test accuracy:0.756
current auc_score ------------------> 0.918
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 39s - loss: 0.4736 - acc: 0.7915 - val_loss: 0.5433 - val_acc: 0.7674
Epoch 2/15
 - 35s - loss: 0.3543 - acc: 0.8610 - val_loss: 0.3762 - val_acc: 0.8504
Epoch 3/15
 - 35s - loss: 0.2957 - acc: 0.8941 - val_loss: 0.2612 - val_acc: 0.9096
Epoch 4/15
 - 35s - loss: 0.2547 - acc: 0.9139 - val_loss: 0.2537 - val_acc: 0.9179
Epoch 5/15
 - 35s - loss: 0.2245 - acc: 0.9317 - val_loss: 0.1995 - val_acc: 0.9379
Epoch 6/15
 - 35s - loss: 0.1992 - acc: 0.9410 - val_loss: 0.1752 - val_acc: 0.9522
Epoch 7/15
 - 35s - loss: 0.1803 - acc: 0.9495 - val_loss: 0.1362 - val_acc: 0.9670
Epoch 8/15
 - 35s - loss: 0.1617 - acc: 0.9571 - val_loss: 0.2303 - val_acc: 0.9301
Epoch 9/15
 - 35s - loss: 0.1502 - acc: 0.9613 - val_loss: 0.1271 - val_acc: 0.9693
Epoch 10/15
 - 35s - loss: 0.1381 - acc: 0.9665 - val_loss: 0.1047 - val_acc: 0.9818
Epoch 11/15
 - 35s - loss: 0.1292 - acc: 0.9699 - val_loss: 0.0985 - val_acc: 0.9827
Epoch 12/15
 - 35s - loss: 0.1220 - acc: 0.9727 - val_loss: 0.1109 - val_acc: 0.9755
Epoch 13/15
 - 35s - loss: 0.1172 - acc: 0.9752 - val_loss: 0.0985 - val_acc: 0.9813
Epoch 14/15
 - 35s - loss: 0.1085 - acc: 0.9780 - val_loss: 0.0960 - val_acc: 0.9824
Epoch 15/15
 - 35s - loss: 0.1042 - acc: 0.9798 - val_loss: 0.0865 - val_acc: 0.9863
Test accuracy:0.830
current auc_score ------------------> 0.938
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 37s - loss: 0.4732 - acc: 0.7928 - val_loss: 0.4309 - val_acc: 0.8321
Epoch 2/15
 - 33s - loss: 0.3511 - acc: 0.8641 - val_loss: 0.3279 - val_acc: 0.8736
Epoch 3/15
 - 32s - loss: 0.2944 - acc: 0.8931 - val_loss: 0.3421 - val_acc: 0.8689
Epoch 4/15
 - 33s - loss: 0.2491 - acc: 0.9163 - val_loss: 0.2613 - val_acc: 0.9070
Epoch 5/15
 - 32s - loss: 0.2220 - acc: 0.9299 - val_loss: 0.2183 - val_acc: 0.9296
Epoch 6/15
 - 33s - loss: 0.1990 - acc: 0.9413 - val_loss: 0.1804 - val_acc: 0.9464
Epoch 7/15
 - 33s - loss: 0.1786 - acc: 0.9490 - val_loss: 0.1473 - val_acc: 0.9642
Epoch 8/15
 - 32s - loss: 0.1629 - acc: 0.9562 - val_loss: 0.1677 - val_acc: 0.9521
Epoch 9/15
 - 33s - loss: 0.1516 - acc: 0.9597 - val_loss: 0.1254 - val_acc: 0.9704
Epoch 10/15
 - 33s - loss: 0.1391 - acc: 0.9665 - val_loss: 0.1386 - val_acc: 0.9641
Epoch 11/15
 - 32s - loss: 0.1305 - acc: 0.9686 - val_loss: 0.1566 - val_acc: 0.9591
Epoch 12/15
 - 33s - loss: 0.1205 - acc: 0.9733 - val_loss: 0.1011 - val_acc: 0.9798
Epoch 13/15
 - 32s - loss: 0.1167 - acc: 0.9743 - val_loss: 0.1163 - val_acc: 0.9741
Epoch 14/15
 - 33s - loss: 0.1074 - acc: 0.9778 - val_loss: 0.0898 - val_acc: 0.9856
Epoch 15/15
 - 32s - loss: 0.1052 - acc: 0.9781 - val_loss: 0.0801 - val_acc: 0.9881
Test accuracy:0.795
current auc_score ------------------> 0.938
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 39s - loss: 0.4719 - acc: 0.7924 - val_loss: 0.4216 - val_acc: 0.8240
Epoch 2/15
 - 34s - loss: 0.3574 - acc: 0.8604 - val_loss: 0.3220 - val_acc: 0.8742
Epoch 3/15
 - 33s - loss: 0.3009 - acc: 0.8921 - val_loss: 0.5489 - val_acc: 0.8057
Epoch 4/15
 - 33s - loss: 0.2590 - acc: 0.9127 - val_loss: 0.2193 - val_acc: 0.9351
Epoch 5/15
 - 33s - loss: 0.2264 - acc: 0.9298 - val_loss: 0.2120 - val_acc: 0.9319
Epoch 6/15
 - 34s - loss: 0.1997 - acc: 0.9415 - val_loss: 0.1883 - val_acc: 0.9439
Epoch 7/15
 - 34s - loss: 0.1833 - acc: 0.9484 - val_loss: 0.2140 - val_acc: 0.9341
Epoch 8/15
 - 34s - loss: 0.1660 - acc: 0.9552 - val_loss: 0.1609 - val_acc: 0.9578
Epoch 9/15
 - 34s - loss: 0.1519 - acc: 0.9610 - val_loss: 0.1279 - val_acc: 0.9700
Epoch 10/15
 - 33s - loss: 0.1397 - acc: 0.9669 - val_loss: 0.1132 - val_acc: 0.9748
Epoch 11/15
 - 33s - loss: 0.1343 - acc: 0.9685 - val_loss: 0.1646 - val_acc: 0.9526
Epoch 12/15
 - 34s - loss: 0.1214 - acc: 0.9725 - val_loss: 0.0875 - val_acc: 0.9880
Epoch 13/15
 - 34s - loss: 0.1173 - acc: 0.9741 - val_loss: 0.1285 - val_acc: 0.9694
Epoch 14/15
 - 34s - loss: 0.1096 - acc: 0.9770 - val_loss: 0.1014 - val_acc: 0.9807
Epoch 15/15
 - 34s - loss: 0.1059 - acc: 0.9780 - val_loss: 0.0879 - val_acc: 0.9863

Epoch 00015: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Test accuracy:0.824
current auc_score ------------------> 0.944
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 39s - loss: 0.4771 - acc: 0.7921 - val_loss: 0.4095 - val_acc: 0.8313
Epoch 2/15
 - 34s - loss: 0.3530 - acc: 0.8635 - val_loss: 0.3571 - val_acc: 0.8594
Epoch 3/15
 - 34s - loss: 0.2872 - acc: 0.8992 - val_loss: 0.2676 - val_acc: 0.9068
Epoch 4/15
 - 34s - loss: 0.2459 - acc: 0.9209 - val_loss: 0.2342 - val_acc: 0.9222
Epoch 5/15
 - 35s - loss: 0.2168 - acc: 0.9331 - val_loss: 0.2000 - val_acc: 0.9370
Epoch 6/15
 - 34s - loss: 0.1915 - acc: 0.9446 - val_loss: 0.2272 - val_acc: 0.9292
Epoch 7/15
 - 34s - loss: 0.1722 - acc: 0.9526 - val_loss: 0.1357 - val_acc: 0.9656
Epoch 8/15
 - 34s - loss: 0.1604 - acc: 0.9574 - val_loss: 0.1508 - val_acc: 0.9644
Epoch 9/15
 - 34s - loss: 0.1460 - acc: 0.9643 - val_loss: 0.1225 - val_acc: 0.9703
Epoch 10/15
 - 34s - loss: 0.1353 - acc: 0.9681 - val_loss: 0.1147 - val_acc: 0.9750
Epoch 11/15
 - 34s - loss: 0.1260 - acc: 0.9709 - val_loss: 0.1051 - val_acc: 0.9783
Epoch 12/15
 - 34s - loss: 0.1198 - acc: 0.9736 - val_loss: 0.0930 - val_acc: 0.9838
Epoch 13/15
 - 35s - loss: 0.1122 - acc: 0.9770 - val_loss: 0.0792 - val_acc: 0.9897
Epoch 14/15
 - 34s - loss: 0.1096 - acc: 0.9786 - val_loss: 0.0932 - val_acc: 0.9832
Epoch 15/15
 - 35s - loss: 0.0994 - acc: 0.9808 - val_loss: 0.0840 - val_acc: 0.9859
Test accuracy:0.824
current auc_score ------------------> 0.923
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  3  reduction:  0.5  bottleneck:  False
Epochs  15  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 319)          0           activation_22[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            320         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 848,806
Trainable params: 841,452
Non-trainable params: 7,354
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/15
 - 39s - loss: 0.4809 - acc: 0.7899 - val_loss: 0.7807 - val_acc: 0.7120
Epoch 2/15
 - 35s - loss: 0.3586 - acc: 0.8598 - val_loss: 0.3244 - val_acc: 0.8719
Epoch 3/15
 - 34s - loss: 0.2948 - acc: 0.8959 - val_loss: 0.2996 - val_acc: 0.8914
Epoch 4/15
 - 35s - loss: 0.2531 - acc: 0.9174 - val_loss: 0.2528 - val_acc: 0.9163
Epoch 5/15
 - 34s - loss: 0.2257 - acc: 0.9307 - val_loss: 0.1974 - val_acc: 0.9396
Epoch 6/15
 - 34s - loss: 0.1991 - acc: 0.9409 - val_loss: 0.1753 - val_acc: 0.9502
Epoch 7/15
 - 34s - loss: 0.1812 - acc: 0.9503 - val_loss: 0.1361 - val_acc: 0.9671
Epoch 8/15
 - 34s - loss: 0.1656 - acc: 0.9561 - val_loss: 0.1583 - val_acc: 0.9577
Epoch 9/15
 - 34s - loss: 0.1520 - acc: 0.9607 - val_loss: 0.2352 - val_acc: 0.9307
Epoch 10/15
 - 35s - loss: 0.1454 - acc: 0.9625 - val_loss: 0.1266 - val_acc: 0.9725
Epoch 11/15
 - 35s - loss: 0.1328 - acc: 0.9692 - val_loss: 0.0993 - val_acc: 0.9808
Epoch 12/15
 - 34s - loss: 0.1258 - acc: 0.9718 - val_loss: 0.1191 - val_acc: 0.9715
Epoch 13/15
 - 35s - loss: 0.1210 - acc: 0.9724 - val_loss: 0.1077 - val_acc: 0.9792
Epoch 14/15
 - 35s - loss: 0.1149 - acc: 0.9759 - val_loss: 0.0907 - val_acc: 0.9834
Epoch 15/15
 - 34s - loss: 0.1079 - acc: 0.9772 - val_loss: 0.0906 - val_acc: 0.9829
Test accuracy:0.759
current auc_score ------------------> 0.919
accuracies:  [0.8279569892473119, 0.8077956989247311, 0.7779569892473118, 0.7966397849462366, 0.755510752688172, 0.8301075268817204, 0.7950268817204301, 0.8240591397849463, 0.8236559139784946, 0.7586021505376344]
aucs:  [0.9137, 0.9342, 0.934, 0.9092, 0.9183, 0.9382, 0.9382, 0.944, 0.9227, 0.9188]
mean and std AUC:  0.927+/-0.011  max:   0.944
['2-2-2-2', '30', '4', '16', '0.2', '0.07', '20', 'adadelta', '0.5', 'FALSE', '64', 'avg']
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 27s - loss: 0.4877 - acc: 0.7732 - val_loss: 0.6171 - val_acc: 0.6916
Epoch 2/20
 - 25s - loss: 0.3899 - acc: 0.8266 - val_loss: 0.3540 - val_acc: 0.8439
Epoch 3/20
 - 25s - loss: 0.3411 - acc: 0.8581 - val_loss: 0.3973 - val_acc: 0.8252
Epoch 4/20
 - 25s - loss: 0.3080 - acc: 0.8779 - val_loss: 0.3803 - val_acc: 0.8342
Epoch 5/20
 - 25s - loss: 0.2792 - acc: 0.8924 - val_loss: 0.2597 - val_acc: 0.8976
Epoch 6/20
 - 25s - loss: 0.2579 - acc: 0.9052 - val_loss: 0.2805 - val_acc: 0.8878
Epoch 7/20
 - 25s - loss: 0.2373 - acc: 0.9152 - val_loss: 0.2599 - val_acc: 0.8992
Epoch 8/20
 - 25s - loss: 0.2220 - acc: 0.9216 - val_loss: 0.1755 - val_acc: 0.9449
Epoch 9/20
 - 24s - loss: 0.2068 - acc: 0.9289 - val_loss: 0.1772 - val_acc: 0.9423
Epoch 10/20
 - 24s - loss: 0.1933 - acc: 0.9349 - val_loss: 0.1717 - val_acc: 0.9439
Epoch 11/20
 - 24s - loss: 0.1841 - acc: 0.9397 - val_loss: 0.1738 - val_acc: 0.9400
Epoch 12/20
 - 24s - loss: 0.1736 - acc: 0.9447 - val_loss: 0.1431 - val_acc: 0.9558
Epoch 13/20
 - 24s - loss: 0.1654 - acc: 0.9480 - val_loss: 0.1228 - val_acc: 0.9671
Epoch 14/20
 - 24s - loss: 0.1577 - acc: 0.9511 - val_loss: 0.1099 - val_acc: 0.9731
Epoch 15/20
 - 24s - loss: 0.1515 - acc: 0.9529 - val_loss: 0.1072 - val_acc: 0.9716
Epoch 16/20
 - 24s - loss: 0.1422 - acc: 0.9574 - val_loss: 0.1037 - val_acc: 0.9745
Epoch 17/20
 - 24s - loss: 0.1366 - acc: 0.9598 - val_loss: 0.0964 - val_acc: 0.9779
Epoch 18/20
 - 24s - loss: 0.1311 - acc: 0.9622 - val_loss: 0.0941 - val_acc: 0.9777
Epoch 19/20
 - 24s - loss: 0.1303 - acc: 0.9614 - val_loss: 0.0931 - val_acc: 0.9759
Epoch 20/20
 - 24s - loss: 0.1238 - acc: 0.9650 - val_loss: 0.0892 - val_acc: 0.9795
Test accuracy:0.785
current auc_score ------------------> 0.926
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.5037 - acc: 0.7620 - val_loss: 0.6065 - val_acc: 0.7097
Epoch 2/20
 - 24s - loss: 0.3957 - acc: 0.8267 - val_loss: 0.5621 - val_acc: 0.7376
Epoch 3/20
 - 23s - loss: 0.3525 - acc: 0.8520 - val_loss: 0.4532 - val_acc: 0.8038
Epoch 4/20
 - 23s - loss: 0.3213 - acc: 0.8717 - val_loss: 0.4726 - val_acc: 0.7858
Epoch 5/20
 - 23s - loss: 0.2949 - acc: 0.8858 - val_loss: 0.4956 - val_acc: 0.7874
Epoch 6/20
 - 23s - loss: 0.2719 - acc: 0.8982 - val_loss: 0.4134 - val_acc: 0.8385
Epoch 7/20
 - 23s - loss: 0.2548 - acc: 0.9067 - val_loss: 0.4626 - val_acc: 0.8011
Epoch 8/20
 - 23s - loss: 0.2359 - acc: 0.9155 - val_loss: 0.4413 - val_acc: 0.8253
Epoch 9/20
 - 23s - loss: 0.2248 - acc: 0.9214 - val_loss: 0.3344 - val_acc: 0.8746
Epoch 10/20
 - 23s - loss: 0.2090 - acc: 0.9294 - val_loss: 0.3553 - val_acc: 0.8677
Epoch 11/20
 - 23s - loss: 0.1988 - acc: 0.9339 - val_loss: 0.2743 - val_acc: 0.9009
Epoch 12/20
 - 23s - loss: 0.1861 - acc: 0.9390 - val_loss: 0.2403 - val_acc: 0.9159
Epoch 13/20
 - 23s - loss: 0.1799 - acc: 0.9408 - val_loss: 0.2177 - val_acc: 0.9285
Epoch 14/20
 - 23s - loss: 0.1683 - acc: 0.9464 - val_loss: 0.1876 - val_acc: 0.9391
Epoch 15/20
 - 23s - loss: 0.1581 - acc: 0.9496 - val_loss: 0.1769 - val_acc: 0.9395
Epoch 16/20
 - 23s - loss: 0.1550 - acc: 0.9519 - val_loss: 0.1635 - val_acc: 0.9473
Epoch 17/20
 - 23s - loss: 0.1475 - acc: 0.9553 - val_loss: 0.1487 - val_acc: 0.9534
Epoch 18/20
 - 23s - loss: 0.1440 - acc: 0.9577 - val_loss: 0.1268 - val_acc: 0.9618
Epoch 19/20
 - 23s - loss: 0.1361 - acc: 0.9600 - val_loss: 0.1578 - val_acc: 0.9470
Epoch 20/20
 - 23s - loss: 0.1332 - acc: 0.9607 - val_loss: 0.1767 - val_acc: 0.9403
Test accuracy:0.695
current auc_score ------------------> 0.923
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.5024 - acc: 0.7590 - val_loss: 0.4734 - val_acc: 0.7678
Epoch 2/20
 - 24s - loss: 0.3869 - acc: 0.8303 - val_loss: 0.3608 - val_acc: 0.8390
Epoch 3/20
 - 24s - loss: 0.3410 - acc: 0.8563 - val_loss: 0.3266 - val_acc: 0.8721
Epoch 4/20
 - 24s - loss: 0.3118 - acc: 0.8751 - val_loss: 0.2703 - val_acc: 0.8981
Epoch 5/20
 - 24s - loss: 0.2878 - acc: 0.8882 - val_loss: 0.2803 - val_acc: 0.8945
Epoch 6/20
 - 24s - loss: 0.2634 - acc: 0.9038 - val_loss: 0.2223 - val_acc: 0.9228
Epoch 7/20
 - 24s - loss: 0.2455 - acc: 0.9096 - val_loss: 0.2196 - val_acc: 0.9204
Epoch 8/20
 - 24s - loss: 0.2308 - acc: 0.9183 - val_loss: 0.1842 - val_acc: 0.9390
Epoch 9/20
 - 24s - loss: 0.2168 - acc: 0.9248 - val_loss: 0.1854 - val_acc: 0.9376
Epoch 10/20
 - 24s - loss: 0.2033 - acc: 0.9306 - val_loss: 0.1589 - val_acc: 0.9511
Epoch 11/20
 - 24s - loss: 0.1925 - acc: 0.9350 - val_loss: 0.1455 - val_acc: 0.9552
Epoch 12/20
 - 24s - loss: 0.1825 - acc: 0.9408 - val_loss: 0.1390 - val_acc: 0.9578
Epoch 13/20
 - 24s - loss: 0.1733 - acc: 0.9440 - val_loss: 0.1401 - val_acc: 0.9572
Epoch 14/20
 - 24s - loss: 0.1634 - acc: 0.9480 - val_loss: 0.1290 - val_acc: 0.9662
Epoch 15/20
 - 24s - loss: 0.1591 - acc: 0.9514 - val_loss: 0.1106 - val_acc: 0.9713
Epoch 16/20
 - 24s - loss: 0.1527 - acc: 0.9521 - val_loss: 0.1131 - val_acc: 0.9709
Epoch 17/20
 - 24s - loss: 0.1445 - acc: 0.9561 - val_loss: 0.0975 - val_acc: 0.9772
Epoch 18/20
 - 24s - loss: 0.1411 - acc: 0.9575 - val_loss: 0.1096 - val_acc: 0.9694
Epoch 19/20
 - 24s - loss: 0.1354 - acc: 0.9602 - val_loss: 0.0997 - val_acc: 0.9748
Epoch 20/20
 - 24s - loss: 0.1287 - acc: 0.9630 - val_loss: 0.0967 - val_acc: 0.9753
Test accuracy:0.827
current auc_score ------------------> 0.942
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.4968 - acc: 0.7646 - val_loss: 0.4924 - val_acc: 0.7725
Epoch 2/20
 - 24s - loss: 0.3867 - acc: 0.8323 - val_loss: 0.3683 - val_acc: 0.8367
Epoch 3/20
 - 24s - loss: 0.3451 - acc: 0.8570 - val_loss: 0.2841 - val_acc: 0.8897
Epoch 4/20
 - 24s - loss: 0.3133 - acc: 0.8749 - val_loss: 0.4336 - val_acc: 0.8122
Epoch 5/20
 - 24s - loss: 0.2853 - acc: 0.8917 - val_loss: 0.3167 - val_acc: 0.8725
Epoch 6/20
 - 24s - loss: 0.2643 - acc: 0.9011 - val_loss: 0.2159 - val_acc: 0.9202
Epoch 7/20
 - 24s - loss: 0.2424 - acc: 0.9130 - val_loss: 0.2425 - val_acc: 0.9098
Epoch 8/20
 - 24s - loss: 0.2237 - acc: 0.9209 - val_loss: 0.1771 - val_acc: 0.9406
Epoch 9/20
 - 24s - loss: 0.2109 - acc: 0.9264 - val_loss: 0.1653 - val_acc: 0.9480
Epoch 10/20
 - 24s - loss: 0.1994 - acc: 0.9331 - val_loss: 0.1464 - val_acc: 0.9559
Epoch 11/20
 - 24s - loss: 0.1883 - acc: 0.9365 - val_loss: 0.1494 - val_acc: 0.9531
Epoch 12/20
 - 24s - loss: 0.1779 - acc: 0.9424 - val_loss: 0.1622 - val_acc: 0.9465
Epoch 13/20
 - 24s - loss: 0.1699 - acc: 0.9457 - val_loss: 0.1363 - val_acc: 0.9585
Epoch 14/20
 - 24s - loss: 0.1600 - acc: 0.9489 - val_loss: 0.1214 - val_acc: 0.9656
Epoch 15/20
 - 24s - loss: 0.1540 - acc: 0.9520 - val_loss: 0.1054 - val_acc: 0.9741
Epoch 16/20
 - 24s - loss: 0.1467 - acc: 0.9553 - val_loss: 0.1096 - val_acc: 0.9706
Epoch 17/20
 - 24s - loss: 0.1406 - acc: 0.9586 - val_loss: 0.0950 - val_acc: 0.9769
Epoch 18/20
 - 24s - loss: 0.1344 - acc: 0.9610 - val_loss: 0.1140 - val_acc: 0.9681
Epoch 19/20
 - 24s - loss: 0.1282 - acc: 0.9640 - val_loss: 0.0889 - val_acc: 0.9794
Epoch 20/20
 - 24s - loss: 0.1241 - acc: 0.9644 - val_loss: 0.0848 - val_acc: 0.9808
Test accuracy:0.792
current auc_score ------------------> 0.916
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.4936 - acc: 0.7703 - val_loss: 0.4620 - val_acc: 0.7845
Epoch 2/20
 - 24s - loss: 0.3795 - acc: 0.8363 - val_loss: 0.3890 - val_acc: 0.8407
Epoch 3/20
 - 24s - loss: 0.3305 - acc: 0.8675 - val_loss: 0.3137 - val_acc: 0.8810
Epoch 4/20
 - 24s - loss: 0.2946 - acc: 0.8871 - val_loss: 0.2871 - val_acc: 0.8932
Epoch 5/20
 - 24s - loss: 0.2692 - acc: 0.8990 - val_loss: 0.2147 - val_acc: 0.9257
Epoch 6/20
 - 24s - loss: 0.2474 - acc: 0.9100 - val_loss: 0.2236 - val_acc: 0.9241
Epoch 7/20
 - 24s - loss: 0.2285 - acc: 0.9197 - val_loss: 0.1834 - val_acc: 0.9416
Epoch 8/20
 - 24s - loss: 0.2111 - acc: 0.9283 - val_loss: 0.1715 - val_acc: 0.9425
Epoch 9/20
 - 24s - loss: 0.1995 - acc: 0.9321 - val_loss: 0.1657 - val_acc: 0.9458
Epoch 10/20
 - 24s - loss: 0.1884 - acc: 0.9379 - val_loss: 0.1476 - val_acc: 0.9537
Epoch 11/20
 - 24s - loss: 0.1772 - acc: 0.9430 - val_loss: 0.1300 - val_acc: 0.9610
Epoch 12/20
 - 24s - loss: 0.1663 - acc: 0.9473 - val_loss: 0.1255 - val_acc: 0.9608
Epoch 13/20
 - 24s - loss: 0.1586 - acc: 0.9514 - val_loss: 0.1221 - val_acc: 0.9626
Epoch 14/20
 - 24s - loss: 0.1534 - acc: 0.9525 - val_loss: 0.1052 - val_acc: 0.9718
Epoch 15/20
 - 24s - loss: 0.1457 - acc: 0.9561 - val_loss: 0.1019 - val_acc: 0.9715
Epoch 16/20
 - 24s - loss: 0.1402 - acc: 0.9588 - val_loss: 0.0954 - val_acc: 0.9757
Epoch 17/20
 - 24s - loss: 0.1335 - acc: 0.9613 - val_loss: 0.1017 - val_acc: 0.9721
Epoch 18/20
 - 24s - loss: 0.1277 - acc: 0.9634 - val_loss: 0.0833 - val_acc: 0.9810
Epoch 19/20
 - 24s - loss: 0.1254 - acc: 0.9642 - val_loss: 0.0894 - val_acc: 0.9764
Epoch 20/20
 - 24s - loss: 0.1206 - acc: 0.9665 - val_loss: 0.0780 - val_acc: 0.9821
Test accuracy:0.815
current auc_score ------------------> 0.951
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.4778 - acc: 0.7809 - val_loss: 0.4182 - val_acc: 0.8080
Epoch 2/20
 - 23s - loss: 0.3752 - acc: 0.8382 - val_loss: 0.3650 - val_acc: 0.8394
Epoch 3/20
 - 24s - loss: 0.3239 - acc: 0.8703 - val_loss: 0.3376 - val_acc: 0.8584
Epoch 4/20
 - 24s - loss: 0.2896 - acc: 0.8884 - val_loss: 0.2704 - val_acc: 0.8956
Epoch 5/20
 - 23s - loss: 0.2597 - acc: 0.9046 - val_loss: 0.2310 - val_acc: 0.9138
Epoch 6/20
 - 23s - loss: 0.2355 - acc: 0.9181 - val_loss: 0.1995 - val_acc: 0.9291
Epoch 7/20
 - 23s - loss: 0.2185 - acc: 0.9259 - val_loss: 0.1893 - val_acc: 0.9359
Epoch 8/20
 - 24s - loss: 0.2012 - acc: 0.9333 - val_loss: 0.2001 - val_acc: 0.9300
Epoch 9/20
 - 23s - loss: 0.1900 - acc: 0.9381 - val_loss: 0.1847 - val_acc: 0.9394
Epoch 10/20
 - 23s - loss: 0.1780 - acc: 0.9433 - val_loss: 0.1838 - val_acc: 0.9346
Epoch 11/20
 - 24s - loss: 0.1671 - acc: 0.9476 - val_loss: 0.1508 - val_acc: 0.9521
Epoch 12/20
 - 24s - loss: 0.1599 - acc: 0.9512 - val_loss: 0.1314 - val_acc: 0.9622
Epoch 13/20
 - 24s - loss: 0.1492 - acc: 0.9560 - val_loss: 0.1227 - val_acc: 0.9661
Epoch 14/20
 - 23s - loss: 0.1432 - acc: 0.9572 - val_loss: 0.1444 - val_acc: 0.9576
Epoch 15/20
 - 23s - loss: 0.1346 - acc: 0.9619 - val_loss: 0.1141 - val_acc: 0.9693
Epoch 16/20
 - 23s - loss: 0.1328 - acc: 0.9613 - val_loss: 0.1040 - val_acc: 0.9736
Epoch 17/20
 - 23s - loss: 0.1255 - acc: 0.9648 - val_loss: 0.1240 - val_acc: 0.9655
Epoch 18/20
 - 23s - loss: 0.1187 - acc: 0.9668 - val_loss: 0.1155 - val_acc: 0.9691
Epoch 19/20
 - 23s - loss: 0.1164 - acc: 0.9686 - val_loss: 0.0948 - val_acc: 0.9783
Epoch 20/20
 - 23s - loss: 0.1116 - acc: 0.9698 - val_loss: 0.0966 - val_acc: 0.9768
Test accuracy:0.763
current auc_score ------------------> 0.911
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.5034 - acc: 0.7623 - val_loss: 0.4490 - val_acc: 0.7943
Epoch 2/20
 - 24s - loss: 0.3930 - acc: 0.8301 - val_loss: 0.3401 - val_acc: 0.8560
Epoch 3/20
 - 23s - loss: 0.3489 - acc: 0.8559 - val_loss: 0.3038 - val_acc: 0.8815
Epoch 4/20
 - 24s - loss: 0.3141 - acc: 0.8767 - val_loss: 0.2981 - val_acc: 0.8809
Epoch 5/20
 - 23s - loss: 0.2825 - acc: 0.8923 - val_loss: 0.2635 - val_acc: 0.9012
Epoch 6/20
 - 24s - loss: 0.2653 - acc: 0.9016 - val_loss: 0.2249 - val_acc: 0.9170
Epoch 7/20
 - 23s - loss: 0.2461 - acc: 0.9101 - val_loss: 0.2208 - val_acc: 0.9246
Epoch 8/20
 - 23s - loss: 0.2266 - acc: 0.9205 - val_loss: 0.1900 - val_acc: 0.9341
Epoch 9/20
 - 23s - loss: 0.2101 - acc: 0.9278 - val_loss: 0.1959 - val_acc: 0.9322
Epoch 10/20
 - 23s - loss: 0.1969 - acc: 0.9332 - val_loss: 0.1638 - val_acc: 0.9469
Epoch 11/20
 - 23s - loss: 0.1902 - acc: 0.9371 - val_loss: 0.1539 - val_acc: 0.9511
Epoch 12/20
 - 24s - loss: 0.1779 - acc: 0.9433 - val_loss: 0.1530 - val_acc: 0.9509
Epoch 13/20
 - 24s - loss: 0.1707 - acc: 0.9457 - val_loss: 0.1234 - val_acc: 0.9642
Epoch 14/20
 - 23s - loss: 0.1598 - acc: 0.9513 - val_loss: 0.1253 - val_acc: 0.9636
Epoch 15/20
 - 23s - loss: 0.1549 - acc: 0.9513 - val_loss: 0.1267 - val_acc: 0.9610
Epoch 16/20
 - 23s - loss: 0.1472 - acc: 0.9551 - val_loss: 0.1063 - val_acc: 0.9701
Epoch 17/20
 - 23s - loss: 0.1391 - acc: 0.9587 - val_loss: 0.0960 - val_acc: 0.9773
Epoch 18/20
 - 23s - loss: 0.1327 - acc: 0.9618 - val_loss: 0.0935 - val_acc: 0.9764
Epoch 19/20
 - 24s - loss: 0.1280 - acc: 0.9638 - val_loss: 0.0978 - val_acc: 0.9738
Epoch 20/20
 - 24s - loss: 0.1244 - acc: 0.9641 - val_loss: 0.0876 - val_acc: 0.9790
Test accuracy:0.827
current auc_score ------------------> 0.931
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.5003 - acc: 0.7530 - val_loss: 0.4727 - val_acc: 0.7820
Epoch 2/20
 - 24s - loss: 0.3951 - acc: 0.8232 - val_loss: 0.3548 - val_acc: 0.8436
Epoch 3/20
 - 23s - loss: 0.3472 - acc: 0.8553 - val_loss: 0.3119 - val_acc: 0.8707
Epoch 4/20
 - 23s - loss: 0.3116 - acc: 0.8755 - val_loss: 0.2788 - val_acc: 0.8873
Epoch 5/20
 - 24s - loss: 0.2857 - acc: 0.8904 - val_loss: 0.2387 - val_acc: 0.9169
Epoch 6/20
 - 23s - loss: 0.2639 - acc: 0.9016 - val_loss: 0.2241 - val_acc: 0.9167
Epoch 7/20
 - 23s - loss: 0.2432 - acc: 0.9126 - val_loss: 0.2000 - val_acc: 0.9312
Epoch 8/20
 - 23s - loss: 0.2285 - acc: 0.9202 - val_loss: 0.1815 - val_acc: 0.9410
Epoch 9/20
 - 23s - loss: 0.2121 - acc: 0.9275 - val_loss: 0.1653 - val_acc: 0.9469
Epoch 10/20
 - 23s - loss: 0.2008 - acc: 0.9316 - val_loss: 0.1636 - val_acc: 0.9507
Epoch 11/20
 - 23s - loss: 0.1852 - acc: 0.9397 - val_loss: 0.1633 - val_acc: 0.9458
Epoch 12/20
 - 23s - loss: 0.1783 - acc: 0.9422 - val_loss: 0.1464 - val_acc: 0.9542
Epoch 13/20
 - 23s - loss: 0.1683 - acc: 0.9460 - val_loss: 0.1297 - val_acc: 0.9630
Epoch 14/20
 - 23s - loss: 0.1618 - acc: 0.9480 - val_loss: 0.1695 - val_acc: 0.9398
Epoch 15/20
 - 23s - loss: 0.1520 - acc: 0.9535 - val_loss: 0.1381 - val_acc: 0.9551
Epoch 16/20
 - 23s - loss: 0.1433 - acc: 0.9572 - val_loss: 0.1132 - val_acc: 0.9670
Epoch 17/20
 - 23s - loss: 0.1386 - acc: 0.9593 - val_loss: 0.1415 - val_acc: 0.9543
Epoch 18/20
 - 23s - loss: 0.1330 - acc: 0.9619 - val_loss: 0.0943 - val_acc: 0.9767
Epoch 19/20
 - 23s - loss: 0.1276 - acc: 0.9641 - val_loss: 0.0902 - val_acc: 0.9770
Epoch 20/20
 - 23s - loss: 0.1213 - acc: 0.9646 - val_loss: 0.0936 - val_acc: 0.9764
Test accuracy:0.802
current auc_score ------------------> 0.923
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 27s - loss: 0.4994 - acc: 0.7684 - val_loss: 0.5083 - val_acc: 0.7568
Epoch 2/20
 - 24s - loss: 0.3904 - acc: 0.8313 - val_loss: 0.3739 - val_acc: 0.8340
Epoch 3/20
 - 24s - loss: 0.3462 - acc: 0.8568 - val_loss: 0.3433 - val_acc: 0.8552
Epoch 4/20
 - 25s - loss: 0.3136 - acc: 0.8743 - val_loss: 0.3339 - val_acc: 0.8665
Epoch 5/20
 - 25s - loss: 0.2852 - acc: 0.8917 - val_loss: 0.2955 - val_acc: 0.8867
Epoch 6/20
 - 25s - loss: 0.2604 - acc: 0.9033 - val_loss: 0.2499 - val_acc: 0.9059
Epoch 7/20
 - 25s - loss: 0.2377 - acc: 0.9148 - val_loss: 0.3308 - val_acc: 0.8686
Epoch 8/20
 - 25s - loss: 0.2278 - acc: 0.9198 - val_loss: 0.2341 - val_acc: 0.9162
Epoch 9/20
 - 24s - loss: 0.2087 - acc: 0.9292 - val_loss: 0.1969 - val_acc: 0.9308
Epoch 10/20
 - 24s - loss: 0.1969 - acc: 0.9331 - val_loss: 0.1524 - val_acc: 0.9526
Epoch 11/20
 - 25s - loss: 0.1840 - acc: 0.9391 - val_loss: 0.1675 - val_acc: 0.9453
Epoch 12/20
 - 25s - loss: 0.1761 - acc: 0.9426 - val_loss: 0.1794 - val_acc: 0.9439
Epoch 13/20
 - 24s - loss: 0.1649 - acc: 0.9485 - val_loss: 0.2020 - val_acc: 0.9302

Epoch 00013: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 14/20
 - 25s - loss: 0.1554 - acc: 0.9521 - val_loss: 0.1275 - val_acc: 0.9632
Epoch 15/20
 - 24s - loss: 0.1510 - acc: 0.9539 - val_loss: 0.1344 - val_acc: 0.9603
Epoch 16/20
 - 25s - loss: 0.1491 - acc: 0.9543 - val_loss: 0.1300 - val_acc: 0.9625
Epoch 17/20
 - 24s - loss: 0.1457 - acc: 0.9573 - val_loss: 0.1395 - val_acc: 0.9570

Epoch 00017: ReduceLROnPlateau reducing learning rate to 0.006999999858704226.
Epoch 18/20
 - 24s - loss: 0.1459 - acc: 0.9567 - val_loss: 0.1307 - val_acc: 0.9625
Epoch 00018: early stopping
Test accuracy:0.768
current auc_score ------------------> 0.923
------------------------ current config for the test -------------------------
Layers:  [2, 2, 2, 2]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  20  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 24, 24)   2888        activation_4[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 38, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 12, 12)   152         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 38, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   10260       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 68, 12, 12)   0           average_pooling2d_1[0][0]        
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 68, 12, 12)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   18360       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 98, 12, 12)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 12, 12)   392         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 98, 12, 12)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 12, 12)   4802        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 49, 6, 6)     0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 6, 6)     196         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 49, 6, 6)     0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     13230       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 79, 6, 6)     0           average_pooling2d_2[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 6, 6)     316         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 79, 6, 6)     0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     21330       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 109, 6, 6)    0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 6, 6)    436         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 109, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 6, 6)     5886        activation_10[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 54, 3, 3)     0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 3, 3)     216         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 54, 3, 3)     0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     14580       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 84, 3, 3)     0           average_pooling2d_3[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 3, 3)     336         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 84, 3, 3)     0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     22680       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 114, 3, 3)    0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 3, 3)    456         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 114, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 114)          0           activation_13[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            115         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 135,827
Trainable params: 134,133
Non-trainable params: 1,694
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/20
 - 26s - loss: 0.4880 - acc: 0.7713 - val_loss: 0.3964 - val_acc: 0.8309
Epoch 2/20
 - 24s - loss: 0.3849 - acc: 0.8325 - val_loss: 0.3466 - val_acc: 0.8507
Epoch 3/20
 - 24s - loss: 0.3430 - acc: 0.8570 - val_loss: 0.3366 - val_acc: 0.8599
Epoch 4/20
 - 24s - loss: 0.3109 - acc: 0.8761 - val_loss: 0.2932 - val_acc: 0.8783
Epoch 5/20
 - 23s - loss: 0.2867 - acc: 0.8905 - val_loss: 0.2688 - val_acc: 0.8953
Epoch 6/20
 - 24s - loss: 0.2641 - acc: 0.9038 - val_loss: 0.2160 - val_acc: 0.9257
Epoch 7/20
 - 24s - loss: 0.2456 - acc: 0.9120 - val_loss: 0.2388 - val_acc: 0.9109
Epoch 8/20
 - 24s - loss: 0.2273 - acc: 0.9193 - val_loss: 0.2114 - val_acc: 0.9282
Epoch 9/20
 - 24s - loss: 0.2149 - acc: 0.9259 - val_loss: 0.1911 - val_acc: 0.9371
Epoch 10/20
 - 24s - loss: 0.2016 - acc: 0.9316 - val_loss: 0.1816 - val_acc: 0.9395
Epoch 11/20
 - 24s - loss: 0.1903 - acc: 0.9372 - val_loss: 0.1760 - val_acc: 0.9389
Epoch 12/20
 - 24s - loss: 0.1826 - acc: 0.9411 - val_loss: 0.1412 - val_acc: 0.9587
Epoch 13/20
 - 24s - loss: 0.1716 - acc: 0.9453 - val_loss: 0.1578 - val_acc: 0.9482
Epoch 14/20
 - 24s - loss: 0.1650 - acc: 0.9486 - val_loss: 0.1414 - val_acc: 0.9570
Epoch 15/20
 - 24s - loss: 0.1581 - acc: 0.9511 - val_loss: 0.1501 - val_acc: 0.9531

Epoch 00015: ReduceLROnPlateau reducing learning rate to 0.022135943715421873.
Epoch 16/20
 - 24s - loss: 0.1483 - acc: 0.9552 - val_loss: 0.1185 - val_acc: 0.9674
Epoch 17/20
 - 24s - loss: 0.1463 - acc: 0.9561 - val_loss: 0.1175 - val_acc: 0.9659
Epoch 18/20
 - 24s - loss: 0.1435 - acc: 0.9575 - val_loss: 0.1169 - val_acc: 0.9680
Epoch 19/20
 - 24s - loss: 0.1386 - acc: 0.9590 - val_loss: 0.1176 - val_acc: 0.9682
Epoch 20/20
 - 24s - loss: 0.1384 - acc: 0.9591 - val_loss: 0.1167 - val_acc: 0.9670
Test accuracy:0.859
current auc_score ------------------> 0.939
accuracies:  [0.7848118279569892, 0.6946236559139785, 0.8270161290322581, 0.7924731182795699, 0.8146505376344086, 0.7626344086021506, 0.8268817204301075, 0.8016129032258065, 0.7676075268817204, 0.8586021505376344]
aucs:  [0.9256, 0.9235, 0.9415, 0.916, 0.9513, 0.9115, 0.9306, 0.9235, 0.9227, 0.9393]
mean and std AUC:  0.929+/-0.012  max:   0.9513
['6-6-6-6', '30', '4', '16', '0.2', '0.07', '14', 'adadelta', '0.5', 'FALSE', '64', 'avg']
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 44s - loss: 0.4697 - acc: 0.8127 - val_loss: 0.4355 - val_acc: 0.8419
Epoch 2/14
 - 37s - loss: 0.3329 - acc: 0.8924 - val_loss: 0.3468 - val_acc: 0.8750
Epoch 3/14
 - 38s - loss: 0.2658 - acc: 0.9260 - val_loss: 0.2567 - val_acc: 0.9265
Epoch 4/14
 - 38s - loss: 0.2259 - acc: 0.9427 - val_loss: 0.2035 - val_acc: 0.9483
Epoch 5/14
 - 38s - loss: 0.1950 - acc: 0.9565 - val_loss: 0.1516 - val_acc: 0.9720
Epoch 6/14
 - 37s - loss: 0.1740 - acc: 0.9646 - val_loss: 0.1550 - val_acc: 0.9713
Epoch 7/14
 - 37s - loss: 0.1577 - acc: 0.9711 - val_loss: 0.1302 - val_acc: 0.9824
Epoch 8/14
 - 36s - loss: 0.1457 - acc: 0.9763 - val_loss: 0.1164 - val_acc: 0.9874
Epoch 9/14
 - 37s - loss: 0.1351 - acc: 0.9797 - val_loss: 0.1095 - val_acc: 0.9891
Epoch 10/14
 - 37s - loss: 0.1285 - acc: 0.9824 - val_loss: 0.1517 - val_acc: 0.9731
Epoch 11/14
 - 36s - loss: 0.1210 - acc: 0.9843 - val_loss: 0.0937 - val_acc: 0.9957
Epoch 12/14
 - 37s - loss: 0.1145 - acc: 0.9867 - val_loss: 0.1082 - val_acc: 0.9892
Epoch 13/14
 - 37s - loss: 0.1102 - acc: 0.9885 - val_loss: 0.1020 - val_acc: 0.9906
Epoch 14/14
 - 36s - loss: 0.1055 - acc: 0.9896 - val_loss: 0.0914 - val_acc: 0.9949
Test accuracy:0.793
current auc_score ------------------> 0.936
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 43s - loss: 0.4748 - acc: 0.8100 - val_loss: 0.3903 - val_acc: 0.8594
Epoch 2/14
 - 36s - loss: 0.3403 - acc: 0.8866 - val_loss: 0.3467 - val_acc: 0.8862
Epoch 3/14
 - 37s - loss: 0.2679 - acc: 0.9238 - val_loss: 0.3034 - val_acc: 0.9095
Epoch 4/14
 - 37s - loss: 0.2284 - acc: 0.9420 - val_loss: 0.2239 - val_acc: 0.9404
Epoch 5/14
 - 37s - loss: 0.1982 - acc: 0.9546 - val_loss: 0.2359 - val_acc: 0.9384
Epoch 6/14
 - 37s - loss: 0.1783 - acc: 0.9646 - val_loss: 0.1656 - val_acc: 0.9634
Epoch 7/14
 - 38s - loss: 0.1594 - acc: 0.9711 - val_loss: 0.1487 - val_acc: 0.9728
Epoch 8/14
 - 37s - loss: 0.1484 - acc: 0.9749 - val_loss: 0.1508 - val_acc: 0.9726
Epoch 9/14
 - 38s - loss: 0.1360 - acc: 0.9806 - val_loss: 0.1190 - val_acc: 0.9842
Epoch 10/14
 - 37s - loss: 0.1302 - acc: 0.9818 - val_loss: 0.1266 - val_acc: 0.9817
Epoch 11/14
 - 38s - loss: 0.1242 - acc: 0.9838 - val_loss: 0.1214 - val_acc: 0.9839
Epoch 12/14
 - 37s - loss: 0.1190 - acc: 0.9857 - val_loss: 0.1179 - val_acc: 0.9868
Epoch 13/14
 - 38s - loss: 0.1130 - acc: 0.9875 - val_loss: 0.1163 - val_acc: 0.9861
Epoch 14/14
 - 37s - loss: 0.1086 - acc: 0.9884 - val_loss: 0.0954 - val_acc: 0.9936
Test accuracy:0.818
current auc_score ------------------> 0.936
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 45s - loss: 0.4678 - acc: 0.8140 - val_loss: 0.4639 - val_acc: 0.8316
Epoch 2/14
 - 39s - loss: 0.3368 - acc: 0.8898 - val_loss: 0.3142 - val_acc: 0.9090
Epoch 3/14
 - 39s - loss: 0.2734 - acc: 0.9226 - val_loss: 0.2398 - val_acc: 0.9371
Epoch 4/14
 - 40s - loss: 0.2301 - acc: 0.9408 - val_loss: 0.2097 - val_acc: 0.9464
Epoch 5/14
 - 39s - loss: 0.2029 - acc: 0.9552 - val_loss: 0.1737 - val_acc: 0.9656
Epoch 6/14
 - 40s - loss: 0.1804 - acc: 0.9627 - val_loss: 0.1425 - val_acc: 0.9777
Epoch 7/14
 - 40s - loss: 0.1615 - acc: 0.9704 - val_loss: 0.1496 - val_acc: 0.9734
Epoch 8/14
 - 39s - loss: 0.1463 - acc: 0.9758 - val_loss: 0.1287 - val_acc: 0.9814
Epoch 9/14
 - 39s - loss: 0.1402 - acc: 0.9773 - val_loss: 0.1252 - val_acc: 0.9812
Epoch 10/14
 - 39s - loss: 0.1302 - acc: 0.9813 - val_loss: 0.1440 - val_acc: 0.9735
Epoch 11/14
 - 39s - loss: 0.1229 - acc: 0.9836 - val_loss: 0.1127 - val_acc: 0.9868
Epoch 12/14
 - 40s - loss: 0.1160 - acc: 0.9866 - val_loss: 0.0985 - val_acc: 0.9913
Epoch 13/14
 - 40s - loss: 0.1113 - acc: 0.9879 - val_loss: 0.1072 - val_acc: 0.9873
Epoch 14/14
 - 39s - loss: 0.1064 - acc: 0.9898 - val_loss: 0.0884 - val_acc: 0.9960
Test accuracy:0.713
current auc_score ------------------> 0.909
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 43s - loss: 0.4636 - acc: 0.8174 - val_loss: 0.3761 - val_acc: 0.8687
Epoch 2/14
 - 37s - loss: 0.3197 - acc: 0.8988 - val_loss: 0.3101 - val_acc: 0.9103
Epoch 3/14
 - 37s - loss: 0.2546 - acc: 0.9307 - val_loss: 0.2324 - val_acc: 0.9383
Epoch 4/14
 - 37s - loss: 0.2182 - acc: 0.9476 - val_loss: 0.2117 - val_acc: 0.9470
Epoch 5/14
 - 37s - loss: 0.1896 - acc: 0.9590 - val_loss: 0.1821 - val_acc: 0.9615
Epoch 6/14
 - 37s - loss: 0.1738 - acc: 0.9657 - val_loss: 0.1588 - val_acc: 0.9689
Epoch 7/14
 - 38s - loss: 0.1559 - acc: 0.9718 - val_loss: 0.1343 - val_acc: 0.9782
Epoch 8/14
 - 37s - loss: 0.1430 - acc: 0.9766 - val_loss: 0.1652 - val_acc: 0.9674
Epoch 9/14
 - 38s - loss: 0.1337 - acc: 0.9805 - val_loss: 0.1213 - val_acc: 0.9852
Epoch 10/14
 - 37s - loss: 0.1264 - acc: 0.9832 - val_loss: 0.1096 - val_acc: 0.9873
Epoch 11/14
 - 37s - loss: 0.1201 - acc: 0.9845 - val_loss: 0.1178 - val_acc: 0.9846
Epoch 12/14
 - 37s - loss: 0.1169 - acc: 0.9854 - val_loss: 0.0993 - val_acc: 0.9930
Epoch 13/14
 - 38s - loss: 0.1096 - acc: 0.9880 - val_loss: 0.0969 - val_acc: 0.9935
Epoch 14/14
 - 38s - loss: 0.1062 - acc: 0.9896 - val_loss: 0.0901 - val_acc: 0.9952
Test accuracy:0.806
current auc_score ------------------> 0.923
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 43s - loss: 0.4651 - acc: 0.8152 - val_loss: 0.4740 - val_acc: 0.8112
Epoch 2/14
 - 37s - loss: 0.3341 - acc: 0.8912 - val_loss: 0.2726 - val_acc: 0.9208
Epoch 3/14
 - 37s - loss: 0.2710 - acc: 0.9231 - val_loss: 0.2427 - val_acc: 0.9322
Epoch 4/14
 - 38s - loss: 0.2294 - acc: 0.9416 - val_loss: 0.1947 - val_acc: 0.9539
Epoch 5/14
 - 37s - loss: 0.2005 - acc: 0.9532 - val_loss: 0.2430 - val_acc: 0.9404
Epoch 6/14
 - 38s - loss: 0.1801 - acc: 0.9630 - val_loss: 0.1423 - val_acc: 0.9785
Epoch 7/14
 - 38s - loss: 0.1650 - acc: 0.9682 - val_loss: 0.1378 - val_acc: 0.9783
Epoch 8/14
 - 38s - loss: 0.1491 - acc: 0.9733 - val_loss: 0.1233 - val_acc: 0.9832
Epoch 9/14
 - 38s - loss: 0.1374 - acc: 0.9792 - val_loss: 0.1169 - val_acc: 0.9853
Epoch 10/14
 - 38s - loss: 0.1307 - acc: 0.9813 - val_loss: 0.1059 - val_acc: 0.9896
Epoch 11/14
 - 39s - loss: 0.1244 - acc: 0.9833 - val_loss: 0.1128 - val_acc: 0.9867
Epoch 12/14
 - 38s - loss: 0.1179 - acc: 0.9859 - val_loss: 0.0916 - val_acc: 0.9952
Epoch 13/14
 - 38s - loss: 0.1146 - acc: 0.9865 - val_loss: 0.0926 - val_acc: 0.9946
Epoch 14/14
 - 38s - loss: 0.1101 - acc: 0.9880 - val_loss: 0.1312 - val_acc: 0.9808
Test accuracy:0.851
current auc_score ------------------> 0.948
Saved model to disk
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 46s - loss: 0.4686 - acc: 0.8130 - val_loss: 0.3886 - val_acc: 0.8616
Epoch 2/14
 - 40s - loss: 0.3237 - acc: 0.8954 - val_loss: 0.2955 - val_acc: 0.9034
Epoch 3/14
 - 40s - loss: 0.2577 - acc: 0.9286 - val_loss: 0.2769 - val_acc: 0.9276
Epoch 4/14
 - 39s - loss: 0.2171 - acc: 0.9466 - val_loss: 0.1914 - val_acc: 0.9586
Epoch 5/14
 - 40s - loss: 0.1886 - acc: 0.9584 - val_loss: 0.1991 - val_acc: 0.9537
Epoch 6/14
 - 39s - loss: 0.1689 - acc: 0.9670 - val_loss: 0.1370 - val_acc: 0.9780
Epoch 7/14
 - 40s - loss: 0.1540 - acc: 0.9735 - val_loss: 0.1333 - val_acc: 0.9774
Epoch 8/14
 - 40s - loss: 0.1413 - acc: 0.9768 - val_loss: 0.1210 - val_acc: 0.9833
Epoch 9/14
 - 40s - loss: 0.1346 - acc: 0.9792 - val_loss: 0.1100 - val_acc: 0.9878
Epoch 10/14
 - 40s - loss: 0.1264 - acc: 0.9829 - val_loss: 0.1181 - val_acc: 0.9837
Epoch 11/14
 - 40s - loss: 0.1192 - acc: 0.9848 - val_loss: 0.0973 - val_acc: 0.9930
Epoch 12/14
 - 40s - loss: 0.1160 - acc: 0.9858 - val_loss: 0.1064 - val_acc: 0.9898
Epoch 13/14
 - 40s - loss: 0.1110 - acc: 0.9877 - val_loss: 0.1121 - val_acc: 0.9876
Epoch 14/14
 - 40s - loss: 0.1056 - acc: 0.9894 - val_loss: 0.0884 - val_acc: 0.9957
Test accuracy:0.824
current auc_score ------------------> 0.924
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 44s - loss: 0.4697 - acc: 0.8154 - val_loss: 0.3840 - val_acc: 0.8624
Epoch 2/14
 - 38s - loss: 0.3306 - acc: 0.8931 - val_loss: 0.5106 - val_acc: 0.8045
Epoch 3/14
 - 38s - loss: 0.2673 - acc: 0.9264 - val_loss: 0.2766 - val_acc: 0.9184
Epoch 4/14
 - 38s - loss: 0.2281 - acc: 0.9430 - val_loss: 0.2264 - val_acc: 0.9393
Epoch 5/14
 - 38s - loss: 0.1969 - acc: 0.9566 - val_loss: 0.1914 - val_acc: 0.9566
Epoch 6/14
 - 38s - loss: 0.1795 - acc: 0.9631 - val_loss: 0.1531 - val_acc: 0.9738
Epoch 7/14
 - 38s - loss: 0.1604 - acc: 0.9708 - val_loss: 0.1508 - val_acc: 0.9768
Epoch 8/14
 - 38s - loss: 0.1508 - acc: 0.9742 - val_loss: 0.1518 - val_acc: 0.9723
Epoch 9/14
 - 38s - loss: 0.1380 - acc: 0.9790 - val_loss: 0.1340 - val_acc: 0.9814
Epoch 10/14
 - 38s - loss: 0.1306 - acc: 0.9810 - val_loss: 0.1224 - val_acc: 0.9828
Epoch 11/14
 - 38s - loss: 0.1219 - acc: 0.9849 - val_loss: 0.1316 - val_acc: 0.9799
Epoch 12/14
 - 38s - loss: 0.1166 - acc: 0.9867 - val_loss: 0.0959 - val_acc: 0.9936
Epoch 13/14
 - 38s - loss: 0.1128 - acc: 0.9881 - val_loss: 0.0959 - val_acc: 0.9936
Epoch 14/14
 - 38s - loss: 0.1084 - acc: 0.9887 - val_loss: 0.0889 - val_acc: 0.9966
Test accuracy:0.814
current auc_score ------------------> 0.934
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 44s - loss: 0.4730 - acc: 0.8115 - val_loss: 0.3878 - val_acc: 0.8638
Epoch 2/14
 - 38s - loss: 0.3295 - acc: 0.8940 - val_loss: 0.3783 - val_acc: 0.8773
Epoch 3/14
 - 37s - loss: 0.2608 - acc: 0.9280 - val_loss: 0.2317 - val_acc: 0.9403
Epoch 4/14
 - 37s - loss: 0.2213 - acc: 0.9447 - val_loss: 0.1842 - val_acc: 0.9582
Epoch 5/14
 - 38s - loss: 0.1923 - acc: 0.9593 - val_loss: 0.1842 - val_acc: 0.9602
Epoch 6/14
 - 38s - loss: 0.1719 - acc: 0.9644 - val_loss: 0.1292 - val_acc: 0.9833
Epoch 7/14
 - 37s - loss: 0.1559 - acc: 0.9712 - val_loss: 0.1314 - val_acc: 0.9817
Epoch 8/14
 - 37s - loss: 0.1447 - acc: 0.9771 - val_loss: 0.1171 - val_acc: 0.9862
Epoch 9/14
 - 37s - loss: 0.1345 - acc: 0.9797 - val_loss: 0.1122 - val_acc: 0.9862
Epoch 10/14
 - 37s - loss: 0.1264 - acc: 0.9826 - val_loss: 0.1047 - val_acc: 0.9930
Epoch 11/14
 - 37s - loss: 0.1215 - acc: 0.9848 - val_loss: 0.0940 - val_acc: 0.9941
Epoch 12/14
 - 38s - loss: 0.1136 - acc: 0.9867 - val_loss: 0.1046 - val_acc: 0.9917
Epoch 13/14
 - 38s - loss: 0.1093 - acc: 0.9884 - val_loss: 0.0902 - val_acc: 0.9949
Epoch 14/14
 - 38s - loss: 0.1071 - acc: 0.9894 - val_loss: 0.0927 - val_acc: 0.9947
Test accuracy:0.805
current auc_score ------------------> 0.930
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 44s - loss: 0.4795 - acc: 0.8062 - val_loss: 0.7424 - val_acc: 0.7152
Epoch 2/14
 - 38s - loss: 0.3440 - acc: 0.8881 - val_loss: 0.3093 - val_acc: 0.9032
Epoch 3/14
 - 38s - loss: 0.2754 - acc: 0.9217 - val_loss: 0.2943 - val_acc: 0.9080
Epoch 4/14
 - 38s - loss: 0.2287 - acc: 0.9420 - val_loss: 0.2527 - val_acc: 0.9291
Epoch 5/14
 - 38s - loss: 0.1991 - acc: 0.9550 - val_loss: 0.1652 - val_acc: 0.9705
Epoch 6/14
 - 38s - loss: 0.1766 - acc: 0.9640 - val_loss: 0.1466 - val_acc: 0.9773
Epoch 7/14
 - 38s - loss: 0.1590 - acc: 0.9714 - val_loss: 0.1757 - val_acc: 0.9640
Epoch 8/14
 - 37s - loss: 0.1471 - acc: 0.9750 - val_loss: 0.1345 - val_acc: 0.9823
Epoch 9/14
 - 38s - loss: 0.1391 - acc: 0.9783 - val_loss: 0.1621 - val_acc: 0.9679
Epoch 10/14
 - 38s - loss: 0.1273 - acc: 0.9829 - val_loss: 0.1184 - val_acc: 0.9854
Epoch 11/14
 - 38s - loss: 0.1221 - acc: 0.9845 - val_loss: 0.1109 - val_acc: 0.9877
Epoch 12/14
 - 37s - loss: 0.1169 - acc: 0.9865 - val_loss: 0.0987 - val_acc: 0.9933
Epoch 13/14
 - 38s - loss: 0.1135 - acc: 0.9869 - val_loss: 0.1106 - val_acc: 0.9880
Epoch 14/14
 - 38s - loss: 0.1070 - acc: 0.9897 - val_loss: 0.0906 - val_acc: 0.9964
Test accuracy:0.759
current auc_score ------------------> 0.925
------------------------ current config for the test -------------------------
Layers:  [6, 6, 6, 6]  Growth_rate:  30  nb_filter:  16  dropout:  0.2
dense_block  4  reduction:  0.5  bottleneck:  False
Epochs  14  batch_size:  64  lr:  0.07  optimizer:  adadelta
 es_patience:  4  lr_patience:  3
------------------------	  end of configs        -------------------------
pooling:avg
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 48, 48)   1568        input_1[0][0]                    
__________________________________________________________________________________________________
initial_bn (BatchNormalization) (None, 16, 48, 48)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 48, 48)   0           initial_bn[0][0]                 
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 24, 24)   0           activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 24, 24)   64          max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 16, 24, 24)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 24, 24)   4320        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 24, 24)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 24, 24)   0           max_pooling2d_1[0][0]            
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 24, 24)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 24, 24)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 24, 24)   12420       activation_3[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 24, 24)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 24, 24)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 76, 24, 24)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 24, 24)   20520       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 24, 24)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 24, 24)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 24, 24)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 106, 24, 24)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 24, 24)   28620       activation_5[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 24, 24)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 24, 24)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 24, 24)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 136, 24, 24)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 24, 24)   36720       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 24, 24)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 24, 24)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_0_5_bn (BatchNormalizatio (None, 166, 24, 24)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 166, 24, 24)  0           dense_0_5_bn[0][0]               
__________________________________________________________________________________________________
dense_0_5_conv2D (Conv2D)       (None, 30, 24, 24)   44820       activation_7[0][0]               
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 24, 24)   0           dense_0_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 196, 24, 24)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 196, 24, 24)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_8[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 98, 12, 12)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 98, 12, 12)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 12, 12)   26460       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 12, 12)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 12, 12)  0           average_pooling2d_1[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 128, 12, 12)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 128, 12, 12)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 12, 12)   34560       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 12, 12)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 158, 12, 12)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 158, 12, 12)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 12, 12)   42660       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 12, 12)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 188, 12, 12)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 188, 12, 12)  752         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 188, 12, 12)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 12, 12)   50760       activation_12[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 218, 12, 12)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 218, 12, 12)  872         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 218, 12, 12)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 12, 12)   58860       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 248, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_1_5_bn (BatchNormalizatio (None, 248, 12, 12)  992         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 248, 12, 12)  0           dense_1_5_bn[0][0]               
__________________________________________________________________________________________________
dense_1_5_conv2D (Conv2D)       (None, 30, 12, 12)   66960       activation_14[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_1_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 278, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 278, 12, 12)  1112        concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 278, 12, 12)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 139, 12, 12)  38642       activation_15[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 139, 6, 6)    0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 139, 6, 6)    556         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 139, 6, 6)    0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 6, 6)     37530       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 6, 6)     0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 169, 6, 6)    0           average_pooling2d_2[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 169, 6, 6)    676         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 169, 6, 6)    0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 6, 6)     45630       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 6, 6)     0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 199, 6, 6)    0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 199, 6, 6)    796         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 199, 6, 6)    0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 6, 6)     53730       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 6, 6)     0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 229, 6, 6)    0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 229, 6, 6)    916         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 229, 6, 6)    0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 6, 6)     61830       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 6, 6)     0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 259, 6, 6)    0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 259, 6, 6)    1036        concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 259, 6, 6)    0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 6, 6)     69930       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 6, 6)     0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 289, 6, 6)    0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_2_5_bn (BatchNormalizatio (None, 289, 6, 6)    1156        concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 289, 6, 6)    0           dense_2_5_bn[0][0]               
__________________________________________________________________________________________________
dense_2_5_conv2D (Conv2D)       (None, 30, 6, 6)     78030       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 6, 6)     0           dense_2_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 319, 6, 6)    0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 319, 6, 6)    1276        concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 319, 6, 6)    0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 159, 6, 6)    50721       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 159, 3, 3)    0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 159, 3, 3)    636         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 159, 3, 3)    0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 3, 3)     42930       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 3, 3)     0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 189, 3, 3)    0           average_pooling2d_3[0][0]        
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 189, 3, 3)    756         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 189, 3, 3)    0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 3, 3)     51030       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 3, 3)     0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 219, 3, 3)    0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 219, 3, 3)    876         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 219, 3, 3)    0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 3, 3)     59130       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 30, 3, 3)     0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 249, 3, 3)    0           concatenate_20[0][0]             
                                                                 dropout_21[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 249, 3, 3)    996         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 249, 3, 3)    0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 3, 3)     67230       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 30, 3, 3)     0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 279, 3, 3)    0           concatenate_21[0][0]             
                                                                 dropout_22[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 279, 3, 3)    1116        concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 279, 3, 3)    0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 3, 3)     75330       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 30, 3, 3)     0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 309, 3, 3)    0           concatenate_22[0][0]             
                                                                 dropout_23[0][0]                 
__________________________________________________________________________________________________
dense_3_5_bn (BatchNormalizatio (None, 309, 3, 3)    1236        concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 309, 3, 3)    0           dense_3_5_bn[0][0]               
__________________________________________________________________________________________________
dense_3_5_conv2D (Conv2D)       (None, 30, 3, 3)     83430       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 30, 3, 3)     0           dense_3_5_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 339, 3, 3)    0           concatenate_23[0][0]             
                                                                 dropout_24[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 339, 3, 3)    1356        concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 339, 3, 3)    0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 339)          0           activation_29[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            340         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,285,599
Trainable params: 1,274,759
Non-trainable params: 10,840
__________________________________________________________________________________________________
Finished compiling
Train on 39840 samples, validate on 7968 samples
Epoch 1/14
 - 44s - loss: 0.4690 - acc: 0.8139 - val_loss: 0.4096 - val_acc: 0.8469
Epoch 2/14
 - 38s - loss: 0.3292 - acc: 0.8936 - val_loss: 0.3393 - val_acc: 0.8937
Epoch 3/14
 - 38s - loss: 0.2674 - acc: 0.9239 - val_loss: 0.2943 - val_acc: 0.9081
Epoch 4/14
 - 37s - loss: 0.2258 - acc: 0.9432 - val_loss: 0.2576 - val_acc: 0.9275
Epoch 5/14
 - 38s - loss: 0.1953 - acc: 0.9560 - val_loss: 0.1610 - val_acc: 0.9719
Epoch 6/14
 - 38s - loss: 0.1737 - acc: 0.9647 - val_loss: 0.1566 - val_acc: 0.9723
Epoch 7/14
 - 38s - loss: 0.1613 - acc: 0.9692 - val_loss: 0.1558 - val_acc: 0.9719
Epoch 8/14
 - 38s - loss: 0.1456 - acc: 0.9764 - val_loss: 0.1252 - val_acc: 0.9837
Epoch 9/14
 - 38s - loss: 0.1364 - acc: 0.9793 - val_loss: 0.1180 - val_acc: 0.9857
Epoch 10/14
 - 36s - loss: 0.1297 - acc: 0.9815 - val_loss: 0.1221 - val_acc: 0.9831
Epoch 11/14
 - 37s - loss: 0.1222 - acc: 0.9840 - val_loss: 0.0974 - val_acc: 0.9931
Epoch 12/14
 - 37s - loss: 0.1172 - acc: 0.9857 - val_loss: 0.1192 - val_acc: 0.9859
Epoch 13/14
 - 36s - loss: 0.1122 - acc: 0.9875 - val_loss: 0.0903 - val_acc: 0.9957
Epoch 14/14
 - 36s - loss: 0.1109 - acc: 0.9875 - val_loss: 0.0986 - val_acc: 0.9935
Test accuracy:0.722
current auc_score ------------------> 0.937
accuracies:  [0.7932795698924732, 0.8176075268817204, 0.7126344086021505, 0.8063172043010752, 0.8512096774193548, 0.8237903225806451, 0.8143817204301075, 0.8048387096774193, 0.759005376344086, 0.7223118279569892]
aucs:  [0.9365, 0.9357, 0.9094, 0.9229, 0.9478, 0.9243, 0.9339, 0.93, 0.9247, 0.9371]
mean and std AUC:  0.93+/-0.01  max:   0.9478
(['2-2-2', '30', '3', '16', '0.2', '0.07', '21', 'adadelta', '0.5', 'FALSE', '64', 'avg'], '0.946+/-0.008', 0.959)
(['6-6-6', '30', '3', '16', '0.2', '0.07', '15', 'adadelta', '0.5', 'FALSE', '64', 'avg'], '0.927+/-0.011', 0.944)
(['2-2-2-2', '30', '4', '16', '0.2', '0.07', '20', 'adadelta', '0.5', 'FALSE', '64', 'avg'], '0.929+/-0.012', 0.951)
(['6-6-6-6', '30', '4', '16', '0.2', '0.07', '14', 'adadelta', '0.5', 'FALSE', '64', 'avg'], '0.93+/-0.01', 0.948)
