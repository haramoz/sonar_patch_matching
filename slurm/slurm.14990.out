python keras_dn_simple_multigpu.py -g 4
no of  evals 40
>>> Imports:
#coding=utf-8

try:
    import numpy as np
except:
    pass

try:
    import random
except:
    pass

try:
    import h5py
except:
    pass

try:
    import tensorflow as tf
except:
    pass

try:
    import matplotlib.pyplot as plt
except:
    pass

try:
    import keras.backend as K
except:
    pass

try:
    from keras.initializers import RandomNormal
except:
    pass

try:
    from keras.layers.core import Dense, Dropout, Activation
except:
    pass

try:
    from keras.layers.pooling import AveragePooling2D, GlobalAveragePooling2D
except:
    pass

try:
    from keras.layers import Input, concatenate, Concatenate
except:
    pass

try:
    from keras.layers import normalization, BatchNormalization, Lambda
except:
    pass

try:
    from keras.layers import Flatten, Conv2D, MaxPooling2D
except:
    pass

try:
    from keras.regularizers import l2
except:
    pass

try:
    from keras.optimizers import RMSprop, Adam
except:
    pass

try:
    from keras.utils import np_utils
except:
    pass

try:
    from keras.models import Model, Sequential
except:
    pass

try:
    from keras.models import model_from_json
except:
    pass

try:
    from keras.models import load_model
except:
    pass

try:
    import keras.initializers
except:
    pass

try:
    from keras.losses import binary_crossentropy
except:
    pass

try:
    from keras.callbacks import EarlyStopping, ModelCheckpoint, ReduceLROnPlateau
except:
    pass

try:
    from keras.utils import multi_gpu_model
except:
    pass

try:
    from sklearn.metrics import accuracy_score
except:
    pass

try:
    from sklearn.metrics import roc_auc_score
except:
    pass

try:
    from sklearn.model_selection import train_test_split
except:
    pass

try:
    from hyperopt import Trials, STATUS_OK, tpe
except:
    pass

try:
    from hyperas import optim
except:
    pass

try:
    from hyperas.distributions import choice, uniform
except:
    pass

try:
    from keras_contrib.applications import DenseNet
except:
    pass

try:
    import argparse
except:
    pass

>>> Hyperas search space:

def get_space():
    return {
        'depth': hp.choice('depth', [7,16,25,34]),
        'nb_dense_block': hp.choice('nb_dense_block', [2,3,4]),
        'growth_rate': hp.choice('growth_rate', [6,14,22,30]),
        'lr': hp.choice('lr', [1E-2,5E-2,1E-3,5E-3,1E-4,5E-4,1E-5,5E-5]),
    }

>>> Functions
  1: def process_data():
  2:     random_seed = 7
  3: 
  4:     f = h5py.File('/home/amalli2s/thesis/keras/matchedImagesSplitClasses-2017-02-24-17-39-44-96-96-split-val0.15-tr0.7-tst0.15.hdf5','r')
  5:     X_train = f['X_train'].value
  6:     y_train = f['y_train'].value
  7:     X_test = f['X_val'].value
  8:     y_test = f['y_val'].value
  9:     X_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size=0.2, random_state=random_seed)
 10:  
 11:     return X_train,y_train,X_val,y_val,X_test,y_test
 12: 
 13: 
>>> Data
 1: 
 2: X_train,y_train,X_val,y_val,X_test,y_test = process_data()
 3: 
 4: 
 5: 
>>> Resulting replaced keras model:

   1: def keras_fmin_fnct(space):
   2: 
   3:     epochs = 30
   4:     es_patience = 5
   5:     lr_patience = 3
   6:     dropout = None
   7:     depth = space['depth']
   8:     nb_dense_block = space['nb_dense_block']
   9:     nb_filter = 16
  10:     growth_rate = space['growth_rate']
  11:     bn = True
  12:     reduction_ = 0.5
  13:     bs = 32
  14:     lr = space['lr']
  15:     weight_file = 'keras_densenet_simple_wt_02Oct_1300.h5'
  16:     nb_classes = 1
  17:     img_dim = (2,96,96) 
  18:     n_channels = 2
  19:  
  20:     model  = DenseNet(depth=depth, nb_dense_block=nb_dense_block,
  21:                  growth_rate=growth_rate, nb_filter=nb_filter,
  22:                  dropout_rate=dropout,activation='sigmoid',
  23:                  input_shape=img_dim,include_top=True,
  24:                  bottleneck=bn,reduction=reduction_,
  25:                  classes=nb_classes,pooling='avg',
  26:                  weights=None)
  27:     
  28: 
  29:     model.summary()
  30:     opt = Adam(lr=lr)
  31:     model.compile(loss=binary_crossentropy, optimizer=opt, metrics=['accuracy'])
  32: 
  33:     es = EarlyStopping(monitor='val_loss', patience=es_patience,verbose=1)
  34:     checkpointer = ModelCheckpoint(filepath=weight_file,verbose=1, save_best_only=True)
  35: 
  36:     lr_reducer = ReduceLROnPlateau(monitor='val_loss', factor=np.sqrt(0.1), cooldown=0, patience=lr_patience, min_lr=0.5e-6,verbose=1)
  37: 
  38:     model.fit(X_train,y_train,
  39:           batch_size=bs,
  40:           epochs=epochs,
  41:           callbacks=[lr_reducer,es],
  42:           validation_data=(X_val,y_val),
  43:           verbose=2)
  44:     
  45:     score, acc = model.evaluate(X_val,y_val)
  46:     print('current val accuracy:', acc)
  47:     pred = model.predict(X_val)
  48:     auc_score = roc_auc_score(y_val,pred)
  49:     print("current auc_score ------------------> ",auc_score)
  50: 
  51:     #model = load_model(weight_file) #This is the best model
  52:     #score, acc = model.evaluate(X_val,y_val)
  53:     #print('Best saved model val accuracy:', acc)
  54:     #pred = model.predict(X_val)
  55:     #auc_score = roc_auc_score(y_val,pred)
  56:     #print("best saved model auc_score ------------------> ",auc_score)
  57: 
  58:     
  59:     return {'loss': -auc_score, 'status': STATUS_OK, 'model': model}  
  60: 
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_2[0][0]               
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_4[0][0]               
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 28, 96, 96)   0           concatenate_1[0][0]              
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 96, 96)   112         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 28, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 96, 96)   672         activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 24, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_6[0][0]               
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 34, 96, 96)   0           concatenate_2[0][0]              
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 34, 96, 96)   136         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 34, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 17, 96, 96)   578         activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 17, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 17, 48, 48)   68          average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 17, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   408         activation_8[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_9[0][0]               
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 23, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 23, 48, 48)   92          concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 23, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   552         activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_11[0][0]              
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 29, 48, 48)   0           concatenate_4[0][0]              
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 29, 48, 48)   116         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 29, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 24, 48, 48)   696         activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 24, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_13[0][0]              
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 35, 48, 48)   0           concatenate_5[0][0]              
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 35, 48, 48)   140         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 35, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 17, 48, 48)   595         activation_14[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 17, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 17, 24, 24)   68          average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 17, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 24, 24, 24)   408         activation_15[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 24, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_16[0][0]              
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 23, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 23, 24, 24)   92          concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 23, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 24, 24, 24)   552         activation_17[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 24, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_18[0][0]              
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 29, 24, 24)   0           concatenate_7[0][0]              
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 29, 24, 24)   116         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 29, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 24, 24, 24)   696         activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 24, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_20[0][0]              
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 35, 24, 24)   0           concatenate_8[0][0]              
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 35, 24, 24)   140         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 35, 24, 24)   0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 17, 24, 24)   595         activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 17, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 17, 12, 12)   68          average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 17, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 24, 12, 12)   408         activation_22[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 24, 12, 12)   96          dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 24, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 6, 12, 12)    1296        activation_23[0][0]              
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 23, 12, 12)   0           average_pooling2d_3[0][0]        
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 23, 12, 12)   92          concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 23, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 24, 12, 12)   552         activation_24[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 24, 12, 12)   96          dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 24, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 6, 12, 12)    1296        activation_25[0][0]              
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 29, 12, 12)   0           concatenate_10[0][0]             
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 29, 12, 12)   116         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 29, 12, 12)   0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 24, 12, 12)   696         activation_26[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 24, 12, 12)   96          dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 24, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 6, 12, 12)    1296        activation_27[0][0]              
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 35, 12, 12)   0           concatenate_11[0][0]             
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 35, 12, 12)   140         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 35, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 35)           0           activation_28[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            36          global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 26,996
Trainable params: 25,596
Non-trainable params: 1,400
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 40s - loss: 0.5442 - acc: 0.7417 - val_loss: 1.2003 - val_acc: 0.5446
Epoch 2/30
 - 34s - loss: 0.4718 - acc: 0.7758 - val_loss: 1.5455 - val_acc: 0.5821
Epoch 3/30
 - 34s - loss: 0.4583 - acc: 0.7834 - val_loss: 0.6249 - val_acc: 0.6845
Epoch 4/30
 - 34s - loss: 0.4382 - acc: 0.7973 - val_loss: 1.7534 - val_acc: 0.5917
Epoch 5/30
 - 34s - loss: 0.4218 - acc: 0.8063 - val_loss: 0.6144 - val_acc: 0.6817
Epoch 6/30
 - 34s - loss: 0.4107 - acc: 0.8176 - val_loss: 0.5259 - val_acc: 0.7368
Epoch 7/30
 - 34s - loss: 0.4008 - acc: 0.8198 - val_loss: 0.4291 - val_acc: 0.8170
Epoch 8/30
 - 34s - loss: 0.3769 - acc: 0.8390 - val_loss: 0.5944 - val_acc: 0.7203
Epoch 9/30
 - 34s - loss: 0.3769 - acc: 0.8386 - val_loss: 0.3941 - val_acc: 0.8348
Epoch 10/30
 - 34s - loss: 0.3685 - acc: 0.8446 - val_loss: 0.4025 - val_acc: 0.8179
Epoch 11/30
 - 34s - loss: 0.3632 - acc: 0.8482 - val_loss: 0.5948 - val_acc: 0.7797
Epoch 12/30
 - 34s - loss: 0.3601 - acc: 0.8462 - val_loss: 0.6363 - val_acc: 0.6461

Epoch 00012: ReduceLROnPlateau reducing learning rate to 0.015811388536449943.
Epoch 13/30
 - 34s - loss: 0.3173 - acc: 0.8693 - val_loss: 0.3298 - val_acc: 0.8628
Epoch 14/30
 - 33s - loss: 0.3110 - acc: 0.8731 - val_loss: 0.5793 - val_acc: 0.7477
Epoch 15/30
 - 33s - loss: 0.3074 - acc: 0.8748 - val_loss: 0.6020 - val_acc: 0.8017
Epoch 16/30
 - 33s - loss: 0.3040 - acc: 0.8749 - val_loss: 0.4673 - val_acc: 0.7838

Epoch 00016: ReduceLROnPlateau reducing learning rate to 0.0050000003198031.
Epoch 17/30
 - 34s - loss: 0.2890 - acc: 0.8817 - val_loss: 0.2755 - val_acc: 0.8879
Epoch 18/30
 - 34s - loss: 0.2836 - acc: 0.8852 - val_loss: 0.2783 - val_acc: 0.8897
Epoch 19/30
 - 34s - loss: 0.2846 - acc: 0.8829 - val_loss: 0.5096 - val_acc: 0.7664
Epoch 20/30
 - 34s - loss: 0.2845 - acc: 0.8822 - val_loss: 0.3028 - val_acc: 0.8769

Epoch 00020: ReduceLROnPlateau reducing learning rate to 0.0015811389419980114.
Epoch 21/30
 - 34s - loss: 0.2764 - acc: 0.8870 - val_loss: 0.2705 - val_acc: 0.8897
Epoch 22/30
 - 34s - loss: 0.2722 - acc: 0.8876 - val_loss: 0.2816 - val_acc: 0.8840
Epoch 23/30
 - 34s - loss: 0.2748 - acc: 0.8884 - val_loss: 0.2786 - val_acc: 0.8825
Epoch 24/30
 - 34s - loss: 0.2749 - acc: 0.8889 - val_loss: 0.2659 - val_acc: 0.8909
Epoch 25/30
 - 34s - loss: 0.2708 - acc: 0.8895 - val_loss: 0.2660 - val_acc: 0.8914
Epoch 26/30
 - 34s - loss: 0.2713 - acc: 0.8890 - val_loss: 0.2656 - val_acc: 0.8904
Epoch 27/30
 - 34s - loss: 0.2698 - acc: 0.8902 - val_loss: 0.2652 - val_acc: 0.8950
Epoch 28/30
 - 34s - loss: 0.2693 - acc: 0.8892 - val_loss: 0.2780 - val_acc: 0.8876
Epoch 29/30
 - 34s - loss: 0.2682 - acc: 0.8901 - val_loss: 0.2652 - val_acc: 0.8917
Epoch 30/30
 - 34s - loss: 0.2664 - acc: 0.8903 - val_loss: 0.2702 - val_acc: 0.8894

Epoch 00030: ReduceLROnPlateau reducing learning rate to 0.00050000003198031.

  32/7968 [..............................] - ETA: 2s
 224/7968 [..............................] - ETA: 2s
 416/7968 [>.............................] - ETA: 2s
 608/7968 [=>............................] - ETA: 2s
 800/7968 [==>...........................] - ETA: 1s
 992/7968 [==>...........................] - ETA: 1s
1216/7968 [===>..........................] - ETA: 1s
1440/7968 [====>.........................] - ETA: 1s
1632/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2016/7968 [======>.......................] - ETA: 1s
2208/7968 [=======>......................] - ETA: 1s
2432/7968 [========>.....................] - ETA: 1s
2656/7968 [=========>....................] - ETA: 1s
2880/7968 [=========>....................] - ETA: 1s
3104/7968 [==========>...................] - ETA: 1s
3296/7968 [===========>..................] - ETA: 1s
3488/7968 [============>.................] - ETA: 1s
3680/7968 [============>.................] - ETA: 1s
3872/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 1s
4256/7968 [===============>..............] - ETA: 0s
4448/7968 [===============>..............] - ETA: 0s
4640/7968 [================>.............] - ETA: 0s
4832/7968 [=================>............] - ETA: 0s
5056/7968 [==================>...........] - ETA: 0s
5248/7968 [==================>...........] - ETA: 0s
5440/7968 [===================>..........] - ETA: 0s
5632/7968 [====================>.........] - ETA: 0s
5824/7968 [====================>.........] - ETA: 0s
6016/7968 [=====================>........] - ETA: 0s
6208/7968 [======================>.......] - ETA: 0s
6400/7968 [=======================>......] - ETA: 0s
6592/7968 [=======================>......] - ETA: 0s
6816/7968 [========================>.....] - ETA: 0s
7040/7968 [=========================>....] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 265us/step
current val accuracy: 0.8894327309236948
current auc_score ------------------>  0.9590021013803887
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 2, 96, 96)         0         
_________________________________________________________________
initial_conv2D (Conv2D)      (None, 16, 96, 96)        288       
_________________________________________________________________
tr_0_bn (BatchNormalization) (None, 16, 96, 96)        64        
_________________________________________________________________
activation_29 (Activation)   (None, 16, 96, 96)        0         
_________________________________________________________________
tr_0_conv2D (Conv2D)         (None, 8, 96, 96)         128       
_________________________________________________________________
average_pooling2d_4 (Average (None, 8, 48, 48)         0         
_________________________________________________________________
final_bn (BatchNormalization (None, 8, 48, 48)         32        
_________________________________________________________________
activation_30 (Activation)   (None, 8, 48, 48)         0         
_________________________________________________________________
global_average_pooling2d_2 ( (None, 8)                 0         
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 9         
=================================================================
Total params: 521
Trainable params: 473
Non-trainable params: 48
_________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 7s - loss: 0.7738 - acc: 0.5009 - val_loss: 0.7640 - val_acc: 0.4965
Epoch 2/30
 - 6s - loss: 0.7539 - acc: 0.5009 - val_loss: 0.7479 - val_acc: 0.4970
Epoch 3/30
 - 6s - loss: 0.7370 - acc: 0.5030 - val_loss: 0.7347 - val_acc: 0.5035
Epoch 4/30
 - 6s - loss: 0.7234 - acc: 0.5096 - val_loss: 0.7199 - val_acc: 0.5085
Epoch 5/30
 - 6s - loss: 0.7109 - acc: 0.5164 - val_loss: 0.7094 - val_acc: 0.5188
Epoch 6/30
 - 6s - loss: 0.7007 - acc: 0.5272 - val_loss: 0.7002 - val_acc: 0.5305
Epoch 7/30
 - 6s - loss: 0.6916 - acc: 0.5384 - val_loss: 0.6903 - val_acc: 0.5454
Epoch 8/30
 - 6s - loss: 0.6839 - acc: 0.5525 - val_loss: 0.6843 - val_acc: 0.5584
Epoch 9/30
 - 6s - loss: 0.6765 - acc: 0.5670 - val_loss: 0.6765 - val_acc: 0.5772
Epoch 10/30
 - 6s - loss: 0.6706 - acc: 0.5845 - val_loss: 0.6712 - val_acc: 0.5931
Epoch 11/30
 - 6s - loss: 0.6658 - acc: 0.5991 - val_loss: 0.6670 - val_acc: 0.6073
Epoch 12/30
 - 6s - loss: 0.6611 - acc: 0.6110 - val_loss: 0.6615 - val_acc: 0.6229
Epoch 13/30
 - 6s - loss: 0.6575 - acc: 0.6240 - val_loss: 0.6580 - val_acc: 0.6333
Epoch 14/30
 - 6s - loss: 0.6538 - acc: 0.6359 - val_loss: 0.6546 - val_acc: 0.6465
Epoch 15/30
 - 6s - loss: 0.6508 - acc: 0.6461 - val_loss: 0.6513 - val_acc: 0.6571
Epoch 16/30
 - 6s - loss: 0.6486 - acc: 0.6565 - val_loss: 0.6490 - val_acc: 0.6635
Epoch 17/30
 - 6s - loss: 0.6456 - acc: 0.6635 - val_loss: 0.6468 - val_acc: 0.6654
Epoch 18/30
 - 6s - loss: 0.6441 - acc: 0.6701 - val_loss: 0.6447 - val_acc: 0.6707
Epoch 19/30
 - 6s - loss: 0.6417 - acc: 0.6736 - val_loss: 0.6422 - val_acc: 0.6752
Epoch 20/30
 - 6s - loss: 0.6403 - acc: 0.6789 - val_loss: 0.6404 - val_acc: 0.6781
Epoch 21/30
 - 6s - loss: 0.6384 - acc: 0.6803 - val_loss: 0.6381 - val_acc: 0.6773
Epoch 22/30
 - 6s - loss: 0.6367 - acc: 0.6835 - val_loss: 0.6359 - val_acc: 0.6807
Epoch 23/30
 - 6s - loss: 0.6353 - acc: 0.6857 - val_loss: 0.6352 - val_acc: 0.6830
Epoch 24/30
 - 6s - loss: 0.6341 - acc: 0.6880 - val_loss: 0.6333 - val_acc: 0.6860
Epoch 25/30
 - 6s - loss: 0.6333 - acc: 0.6867 - val_loss: 0.6320 - val_acc: 0.6876
Epoch 26/30
 - 6s - loss: 0.6311 - acc: 0.6904 - val_loss: 0.6308 - val_acc: 0.6886
Epoch 27/30
 - 6s - loss: 0.6310 - acc: 0.6888 - val_loss: 0.6298 - val_acc: 0.6889
Epoch 28/30
 - 6s - loss: 0.6293 - acc: 0.6887 - val_loss: 0.6290 - val_acc: 0.6918
Epoch 29/30
 - 6s - loss: 0.6279 - acc: 0.6914 - val_loss: 0.6273 - val_acc: 0.6918
Epoch 30/30
 - 6s - loss: 0.6270 - acc: 0.6920 - val_loss: 0.6265 - val_acc: 0.6930

  32/7968 [..............................] - ETA: 0s
 640/7968 [=>............................] - ETA: 0s
1280/7968 [===>..........................] - ETA: 0s
1888/7968 [======>.......................] - ETA: 0s
2496/7968 [========>.....................] - ETA: 0s
3072/7968 [==========>...................] - ETA: 0s
3712/7968 [============>.................] - ETA: 0s
4352/7968 [===============>..............] - ETA: 0s
4992/7968 [=================>............] - ETA: 0s
5664/7968 [====================>.........] - ETA: 0s
6336/7968 [======================>.......] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7552/7968 [===========================>..] - ETA: 0s
7968/7968 [==============================] - 1s 82us/step
current val accuracy: 0.6930220883534136
current auc_score ------------------>  0.743369109053023
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 2, 96, 96)         0         
_________________________________________________________________
initial_conv2D (Conv2D)      (None, 16, 96, 96)        288       
_________________________________________________________________
tr_0_bn (BatchNormalization) (None, 16, 96, 96)        64        
_________________________________________________________________
activation_31 (Activation)   (None, 16, 96, 96)        0         
_________________________________________________________________
tr_0_conv2D (Conv2D)         (None, 8, 96, 96)         128       
_________________________________________________________________
average_pooling2d_5 (Average (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_bn (BatchNormalization) (None, 8, 48, 48)         32        
_________________________________________________________________
activation_32 (Activation)   (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_conv2D (Conv2D)         (None, 4, 48, 48)         32        
_________________________________________________________________
average_pooling2d_6 (Average (None, 4, 24, 24)         0         
_________________________________________________________________
final_bn (BatchNormalization (None, 4, 24, 24)         16        
_________________________________________________________________
activation_33 (Activation)   (None, 4, 24, 24)         0         
_________________________________________________________________
global_average_pooling2d_3 ( (None, 4)                 0         
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 5         
=================================================================
Total params: 565
Trainable params: 509
Non-trainable params: 56
_________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 8s - loss: 0.6152 - acc: 0.6986 - val_loss: 0.5758 - val_acc: 0.7336
Epoch 2/30
 - 7s - loss: 0.5429 - acc: 0.7497 - val_loss: 0.5470 - val_acc: 0.7367
Epoch 3/30
 - 7s - loss: 0.5189 - acc: 0.7558 - val_loss: 0.6476 - val_acc: 0.7107
Epoch 4/30
 - 7s - loss: 0.5065 - acc: 0.7566 - val_loss: 0.5043 - val_acc: 0.7514
Epoch 5/30
 - 7s - loss: 0.4976 - acc: 0.7603 - val_loss: 0.4982 - val_acc: 0.7550
Epoch 6/30
 - 7s - loss: 0.4922 - acc: 0.7625 - val_loss: 0.7118 - val_acc: 0.7228
Epoch 7/30
 - 7s - loss: 0.4861 - acc: 0.7648 - val_loss: 0.5091 - val_acc: 0.7582
Epoch 8/30
 - 7s - loss: 0.4826 - acc: 0.7677 - val_loss: 0.4849 - val_acc: 0.7687
Epoch 9/30
 - 7s - loss: 0.4796 - acc: 0.7687 - val_loss: 0.5003 - val_acc: 0.7677
Epoch 10/30
 - 7s - loss: 0.4766 - acc: 0.7706 - val_loss: 0.4766 - val_acc: 0.7629
Epoch 11/30
 - 7s - loss: 0.4729 - acc: 0.7706 - val_loss: 0.5105 - val_acc: 0.7371
Epoch 12/30
 - 7s - loss: 0.4693 - acc: 0.7731 - val_loss: 0.5051 - val_acc: 0.7636
Epoch 13/30
 - 7s - loss: 0.4677 - acc: 0.7742 - val_loss: 0.4826 - val_acc: 0.7703

Epoch 00013: ReduceLROnPlateau reducing learning rate to 0.00031622778103685084.
Epoch 14/30
 - 6s - loss: 0.4616 - acc: 0.7788 - val_loss: 0.4549 - val_acc: 0.7779
Epoch 15/30
 - 7s - loss: 0.4601 - acc: 0.7791 - val_loss: 0.4569 - val_acc: 0.7811
Epoch 16/30
 - 7s - loss: 0.4599 - acc: 0.7794 - val_loss: 0.4643 - val_acc: 0.7794
Epoch 17/30
 - 6s - loss: 0.4573 - acc: 0.7820 - val_loss: 0.4926 - val_acc: 0.7513

Epoch 00017: ReduceLROnPlateau reducing learning rate to 0.00010000000639606199.
Epoch 18/30
 - 7s - loss: 0.4566 - acc: 0.7822 - val_loss: 0.4661 - val_acc: 0.7662
Epoch 19/30
 - 7s - loss: 0.4547 - acc: 0.7821 - val_loss: 0.4495 - val_acc: 0.7833
Epoch 20/30
 - 7s - loss: 0.4534 - acc: 0.7840 - val_loss: 0.4483 - val_acc: 0.7830
Epoch 21/30
 - 7s - loss: 0.4562 - acc: 0.7802 - val_loss: 0.4531 - val_acc: 0.7771
Epoch 22/30
 - 7s - loss: 0.4527 - acc: 0.7829 - val_loss: 0.4516 - val_acc: 0.7792
Epoch 23/30
 - 7s - loss: 0.4535 - acc: 0.7830 - val_loss: 0.4498 - val_acc: 0.7836

Epoch 00023: ReduceLROnPlateau reducing learning rate to 3.1622778103685084e-05.
Epoch 24/30
 - 7s - loss: 0.4515 - acc: 0.7846 - val_loss: 0.4469 - val_acc: 0.7840
Epoch 25/30
 - 7s - loss: 0.4544 - acc: 0.7830 - val_loss: 0.4485 - val_acc: 0.7844
Epoch 26/30
 - 7s - loss: 0.4535 - acc: 0.7813 - val_loss: 0.4484 - val_acc: 0.7849
Epoch 27/30
 - 7s - loss: 0.4516 - acc: 0.7837 - val_loss: 0.4462 - val_acc: 0.7835
Epoch 28/30
 - 7s - loss: 0.4517 - acc: 0.7831 - val_loss: 0.4468 - val_acc: 0.7856
Epoch 29/30
 - 7s - loss: 0.4520 - acc: 0.7819 - val_loss: 0.4478 - val_acc: 0.7826
Epoch 30/30
 - 6s - loss: 0.4508 - acc: 0.7835 - val_loss: 0.4463 - val_acc: 0.7865

Epoch 00030: ReduceLROnPlateau reducing learning rate to 1.0000000409520217e-05.

  32/7968 [..............................] - ETA: 0s
 736/7968 [=>............................] - ETA: 0s
1440/7968 [====>.........................] - ETA: 0s
2144/7968 [=======>......................] - ETA: 0s
2784/7968 [=========>....................] - ETA: 0s
3456/7968 [============>.................] - ETA: 0s
4128/7968 [==============>...............] - ETA: 0s
4800/7968 [=================>............] - ETA: 0s
5440/7968 [===================>..........] - ETA: 0s
6112/7968 [======================>.......] - ETA: 0s
6816/7968 [========================>.....] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7968/7968 [==============================] - 1s 76us/step
current val accuracy: 0.7865210843373494
current auc_score ------------------>  0.873519986047923
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_4[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 56, 96, 96)   896         activation_34[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 56, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_35[0][0]              
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 30, 96, 96)   120         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 30, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 56, 96, 96)   1680        activation_36[0][0]              
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 56, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_37[0][0]              
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 44, 96, 96)   0           concatenate_13[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 44, 96, 96)   176         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 44, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 22, 96, 96)   968         activation_38[0][0]              
__________________________________________________________________________________________________
average_pooling2d_7 (AveragePoo (None, 22, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 22, 48, 48)   88          average_pooling2d_7[0][0]        
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 22, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 56, 48, 48)   1232        activation_39[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 56, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_40[0][0]              
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 36, 48, 48)   0           average_pooling2d_7[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 36, 48, 48)   144         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 36, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 56, 48, 48)   2016        activation_41[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 56, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_42[0][0]              
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 50, 48, 48)   0           concatenate_15[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 50, 48, 48)   200         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 50, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 25, 48, 48)   1250        activation_43[0][0]              
__________________________________________________________________________________________________
average_pooling2d_8 (AveragePoo (None, 25, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 25, 24, 24)   100         average_pooling2d_8[0][0]        
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 25, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 56, 24, 24)   1400        activation_44[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 56, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_45[0][0]              
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 39, 24, 24)   0           average_pooling2d_8[0][0]        
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 39, 24, 24)   156         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 39, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 56, 24, 24)   2184        activation_46[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 56, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_47[0][0]              
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 53, 24, 24)   0           concatenate_17[0][0]             
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 53, 24, 24)   212         concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 53, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 53)           0           activation_48[0][0]              
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 1)            54          global_average_pooling2d_4[0][0] 
==================================================================================================
Total params: 56,908
Trainable params: 55,606
Non-trainable params: 1,302
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 32s - loss: 0.5504 - acc: 0.7682 - val_loss: 0.5516 - val_acc: 0.7764
Epoch 2/30
 - 28s - loss: 0.4577 - acc: 0.8126 - val_loss: 0.8365 - val_acc: 0.7364
Epoch 3/30
 - 28s - loss: 0.4205 - acc: 0.8316 - val_loss: 0.4652 - val_acc: 0.8094
Epoch 4/30
 - 28s - loss: 0.3912 - acc: 0.8488 - val_loss: 0.4506 - val_acc: 0.8214
Epoch 5/30
 - 28s - loss: 0.3652 - acc: 0.8624 - val_loss: 0.3599 - val_acc: 0.8643
Epoch 6/30
 - 28s - loss: 0.3410 - acc: 0.8742 - val_loss: 0.3870 - val_acc: 0.8466
Epoch 7/30
 - 28s - loss: 0.3189 - acc: 0.8852 - val_loss: 0.2969 - val_acc: 0.8960
Epoch 8/30
 - 28s - loss: 0.2987 - acc: 0.8943 - val_loss: 0.3104 - val_acc: 0.8902
Epoch 9/30
 - 28s - loss: 0.2834 - acc: 0.9013 - val_loss: 0.2915 - val_acc: 0.8966
Epoch 10/30
 - 28s - loss: 0.2669 - acc: 0.9095 - val_loss: 0.3072 - val_acc: 0.8937
Epoch 11/30
 - 28s - loss: 0.2511 - acc: 0.9174 - val_loss: 0.4541 - val_acc: 0.8478
Epoch 12/30
 - 28s - loss: 0.2402 - acc: 0.9221 - val_loss: 0.3038 - val_acc: 0.8980

Epoch 00012: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 13/30
 - 28s - loss: 0.2011 - acc: 0.9405 - val_loss: 0.2456 - val_acc: 0.9204
Epoch 14/30
 - 28s - loss: 0.1927 - acc: 0.9446 - val_loss: 0.2150 - val_acc: 0.9326
Epoch 15/30
 - 28s - loss: 0.1861 - acc: 0.9473 - val_loss: 0.2061 - val_acc: 0.9345
Epoch 16/30
 - 28s - loss: 0.1822 - acc: 0.9480 - val_loss: 0.2535 - val_acc: 0.9155
Epoch 17/30
 - 28s - loss: 0.1747 - acc: 0.9509 - val_loss: 0.2002 - val_acc: 0.9404
Epoch 18/30
 - 28s - loss: 0.1697 - acc: 0.9543 - val_loss: 0.2741 - val_acc: 0.9010
Epoch 19/30
 - 28s - loss: 0.1659 - acc: 0.9549 - val_loss: 0.2013 - val_acc: 0.9360
Epoch 20/30
 - 28s - loss: 0.1637 - acc: 0.9557 - val_loss: 0.2207 - val_acc: 0.9263

Epoch 00020: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 21/30
 - 28s - loss: 0.1484 - acc: 0.9629 - val_loss: 0.1819 - val_acc: 0.9447
Epoch 22/30
 - 28s - loss: 0.1455 - acc: 0.9640 - val_loss: 0.1825 - val_acc: 0.9426
Epoch 23/30
 - 28s - loss: 0.1401 - acc: 0.9671 - val_loss: 0.1874 - val_acc: 0.9428
Epoch 24/30
 - 28s - loss: 0.1416 - acc: 0.9661 - val_loss: 0.1832 - val_acc: 0.9457

Epoch 00024: ReduceLROnPlateau reducing learning rate to 1.5811389051842542e-05.
Epoch 25/30
 - 28s - loss: 0.1358 - acc: 0.9688 - val_loss: 0.1771 - val_acc: 0.9478
Epoch 26/30
 - 28s - loss: 0.1359 - acc: 0.9689 - val_loss: 0.1767 - val_acc: 0.9475
Epoch 27/30
 - 28s - loss: 0.1343 - acc: 0.9698 - val_loss: 0.1779 - val_acc: 0.9459
Epoch 28/30
 - 28s - loss: 0.1348 - acc: 0.9685 - val_loss: 0.1793 - val_acc: 0.9463
Epoch 29/30
 - 28s - loss: 0.1349 - acc: 0.9680 - val_loss: 0.1779 - val_acc: 0.9460

Epoch 00029: ReduceLROnPlateau reducing learning rate to 5.000000204760109e-06.
Epoch 30/30
 - 28s - loss: 0.1335 - acc: 0.9694 - val_loss: 0.1754 - val_acc: 0.9469

  32/7968 [..............................] - ETA: 2s
 224/7968 [..............................] - ETA: 2s
 416/7968 [>.............................] - ETA: 2s
 608/7968 [=>............................] - ETA: 2s
 800/7968 [==>...........................] - ETA: 1s
 992/7968 [==>...........................] - ETA: 1s
1184/7968 [===>..........................] - ETA: 1s
1376/7968 [====>.........................] - ETA: 1s
1568/7968 [====>.........................] - ETA: 1s
1760/7968 [=====>........................] - ETA: 1s
1952/7968 [======>.......................] - ETA: 1s
2144/7968 [=======>......................] - ETA: 1s
2336/7968 [=======>......................] - ETA: 1s
2528/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2912/7968 [=========>....................] - ETA: 1s
3104/7968 [==========>...................] - ETA: 1s
3296/7968 [===========>..................] - ETA: 1s
3488/7968 [============>.................] - ETA: 1s
3680/7968 [============>.................] - ETA: 1s
3872/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 1s
4256/7968 [===============>..............] - ETA: 1s
4448/7968 [===============>..............] - ETA: 0s
4640/7968 [================>.............] - ETA: 0s
4832/7968 [=================>............] - ETA: 0s
5024/7968 [=================>............] - ETA: 0s
5216/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5600/7968 [====================>.........] - ETA: 0s
5792/7968 [====================>.........] - ETA: 0s
5984/7968 [=====================>........] - ETA: 0s
6176/7968 [======================>.......] - ETA: 0s
6368/7968 [======================>.......] - ETA: 0s
6560/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 280us/step
current val accuracy: 0.9469126506024096
current auc_score ------------------>  0.9889789680503485
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_5[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 88, 96, 96)   1408        activation_49[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 88, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_50[0][0]              
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 38, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 38, 96, 96)   152         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 38, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 88, 96, 96)   3344        activation_51[0][0]              
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 88, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_52[0][0]              
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 60, 96, 96)   0           concatenate_19[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 60, 96, 96)   240         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_53 (Activation)      (None, 60, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 88, 96, 96)   5280        activation_53[0][0]              
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_54 (Activation)      (None, 88, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_54[0][0]              
__________________________________________________________________________________________________
concatenate_21 (Concatenate)    (None, 82, 96, 96)   0           concatenate_20[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 82, 96, 96)   328         concatenate_21[0][0]             
__________________________________________________________________________________________________
activation_55 (Activation)      (None, 82, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 88, 96, 96)   7216        activation_55[0][0]              
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_56 (Activation)      (None, 88, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_56[0][0]              
__________________________________________________________________________________________________
concatenate_22 (Concatenate)    (None, 104, 96, 96)  0           concatenate_21[0][0]             
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 104, 96, 96)  416         concatenate_22[0][0]             
__________________________________________________________________________________________________
activation_57 (Activation)      (None, 104, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 88, 96, 96)   9152        activation_57[0][0]              
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_58 (Activation)      (None, 88, 96, 96)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_58[0][0]              
__________________________________________________________________________________________________
concatenate_23 (Concatenate)    (None, 126, 96, 96)  0           concatenate_22[0][0]             
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 126, 96, 96)  504         concatenate_23[0][0]             
__________________________________________________________________________________________________
activation_59 (Activation)      (None, 126, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 63, 96, 96)   7938        activation_59[0][0]              
__________________________________________________________________________________________________
average_pooling2d_9 (AveragePoo (None, 63, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 63, 48, 48)   252         average_pooling2d_9[0][0]        
__________________________________________________________________________________________________
activation_60 (Activation)      (None, 63, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 88, 48, 48)   5544        activation_60[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_61 (Activation)      (None, 88, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_61[0][0]              
__________________________________________________________________________________________________
concatenate_24 (Concatenate)    (None, 85, 48, 48)   0           average_pooling2d_9[0][0]        
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 85, 48, 48)   340         concatenate_24[0][0]             
__________________________________________________________________________________________________
activation_62 (Activation)      (None, 85, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 88, 48, 48)   7480        activation_62[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_63 (Activation)      (None, 88, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_63[0][0]              
__________________________________________________________________________________________________
concatenate_25 (Concatenate)    (None, 107, 48, 48)  0           concatenate_24[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 107, 48, 48)  428         concatenate_25[0][0]             
__________________________________________________________________________________________________
activation_64 (Activation)      (None, 107, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 88, 48, 48)   9416        activation_64[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_65 (Activation)      (None, 88, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_65[0][0]              
__________________________________________________________________________________________________
concatenate_26 (Concatenate)    (None, 129, 48, 48)  0           concatenate_25[0][0]             
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 129, 48, 48)  516         concatenate_26[0][0]             
__________________________________________________________________________________________________
activation_66 (Activation)      (None, 129, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 88, 48, 48)   11352       activation_66[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_67 (Activation)      (None, 88, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_67[0][0]              
__________________________________________________________________________________________________
concatenate_27 (Concatenate)    (None, 151, 48, 48)  0           concatenate_26[0][0]             
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 151, 48, 48)  604         concatenate_27[0][0]             
__________________________________________________________________________________________________
activation_68 (Activation)      (None, 151, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 88, 48, 48)   13288       activation_68[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_69 (Activation)      (None, 88, 48, 48)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_69[0][0]              
__________________________________________________________________________________________________
concatenate_28 (Concatenate)    (None, 173, 48, 48)  0           concatenate_27[0][0]             
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 173, 48, 48)  692         concatenate_28[0][0]             
__________________________________________________________________________________________________
activation_70 (Activation)      (None, 173, 48, 48)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 173)          0           activation_70[0][0]              
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 1)            174         global_average_pooling2d_5[0][0] 
==================================================================================================
Total params: 264,176
Trainable params: 260,148
Non-trainable params: 4,028
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 96s - loss: 0.5446 - acc: 0.7567 - val_loss: 0.6158 - val_acc: 0.6649
Epoch 2/30
 - 91s - loss: 0.4745 - acc: 0.7795 - val_loss: 1.3817 - val_acc: 0.5079
Epoch 3/30
 - 91s - loss: 0.4597 - acc: 0.7858 - val_loss: 0.6655 - val_acc: 0.6609
Epoch 4/30
 - 91s - loss: 0.4439 - acc: 0.7948 - val_loss: 0.5765 - val_acc: 0.7304
Epoch 5/30
 - 91s - loss: 0.4347 - acc: 0.7990 - val_loss: 0.5840 - val_acc: 0.7764
Epoch 6/30
 - 91s - loss: 0.4204 - acc: 0.8054 - val_loss: 0.4701 - val_acc: 0.7962
Epoch 7/30
 - 91s - loss: 0.4160 - acc: 0.8109 - val_loss: 1.6662 - val_acc: 0.6219
Epoch 8/30
 - 91s - loss: 0.4108 - acc: 0.8136 - val_loss: 0.4338 - val_acc: 0.8053
Epoch 9/30
 - 91s - loss: 0.4053 - acc: 0.8167 - val_loss: 0.5136 - val_acc: 0.7534
Epoch 10/30
 - 91s - loss: 0.3993 - acc: 0.8218 - val_loss: 0.8534 - val_acc: 0.6239
Epoch 11/30
 - 91s - loss: 0.3960 - acc: 0.8239 - val_loss: 0.4432 - val_acc: 0.7987

Epoch 00011: ReduceLROnPlateau reducing learning rate to 0.0015811387947429827.
Epoch 12/30
 - 91s - loss: 0.3652 - acc: 0.8397 - val_loss: 0.5543 - val_acc: 0.7690
Epoch 13/30
 - 91s - loss: 0.3551 - acc: 0.8435 - val_loss: 0.4069 - val_acc: 0.8232
Epoch 14/30
 - 91s - loss: 0.3493 - acc: 0.8500 - val_loss: 0.3822 - val_acc: 0.8361
Epoch 15/30
 - 91s - loss: 0.3464 - acc: 0.8488 - val_loss: 0.4290 - val_acc: 0.8067
Epoch 16/30
 - 91s - loss: 0.3395 - acc: 0.8547 - val_loss: 0.3615 - val_acc: 0.8459
Epoch 17/30
 - 92s - loss: 0.3361 - acc: 0.8543 - val_loss: 0.3567 - val_acc: 0.8469
Epoch 18/30
 - 91s - loss: 0.3296 - acc: 0.8584 - val_loss: 0.3449 - val_acc: 0.8538
Epoch 19/30
 - 91s - loss: 0.3281 - acc: 0.8607 - val_loss: 0.3845 - val_acc: 0.8296
Epoch 20/30
 - 92s - loss: 0.3234 - acc: 0.8620 - val_loss: 0.4791 - val_acc: 0.7897
Epoch 21/30
 - 91s - loss: 0.3236 - acc: 0.8629 - val_loss: 0.4788 - val_acc: 0.7706

Epoch 00021: ReduceLROnPlateau reducing learning rate to 0.0004999999951665528.
Epoch 22/30
 - 91s - loss: 0.3011 - acc: 0.8755 - val_loss: 0.3886 - val_acc: 0.8394
Epoch 23/30
 - 91s - loss: 0.2982 - acc: 0.8763 - val_loss: 0.5202 - val_acc: 0.7777
Epoch 00023: early stopping

  32/7968 [..............................] - ETA: 7s
  96/7968 [..............................] - ETA: 7s
 160/7968 [..............................] - ETA: 7s
 224/7968 [..............................] - ETA: 7s
 288/7968 [>.............................] - ETA: 6s
 352/7968 [>.............................] - ETA: 6s
 416/7968 [>.............................] - ETA: 6s
 480/7968 [>.............................] - ETA: 6s
 544/7968 [=>............................] - ETA: 6s
 608/7968 [=>............................] - ETA: 6s
 672/7968 [=>............................] - ETA: 6s
 736/7968 [=>............................] - ETA: 6s
 800/7968 [==>...........................] - ETA: 6s
 864/7968 [==>...........................] - ETA: 6s
 928/7968 [==>...........................] - ETA: 6s
 992/7968 [==>...........................] - ETA: 6s
1056/7968 [==>...........................] - ETA: 6s
1120/7968 [===>..........................] - ETA: 6s
1184/7968 [===>..........................] - ETA: 6s
1248/7968 [===>..........................] - ETA: 6s
1312/7968 [===>..........................] - ETA: 6s
1376/7968 [====>.........................] - ETA: 5s
1440/7968 [====>.........................] - ETA: 5s
1504/7968 [====>.........................] - ETA: 5s
1568/7968 [====>.........................] - ETA: 5s
1632/7968 [=====>........................] - ETA: 5s
1696/7968 [=====>........................] - ETA: 5s
1760/7968 [=====>........................] - ETA: 5s
1824/7968 [=====>........................] - ETA: 5s
1888/7968 [======>.......................] - ETA: 5s
1952/7968 [======>.......................] - ETA: 5s
2016/7968 [======>.......................] - ETA: 5s
2080/7968 [======>.......................] - ETA: 5s
2144/7968 [=======>......................] - ETA: 5s
2208/7968 [=======>......................] - ETA: 5s
2272/7968 [=======>......................] - ETA: 5s
2336/7968 [=======>......................] - ETA: 5s
2400/7968 [========>.....................] - ETA: 5s
2464/7968 [========>.....................] - ETA: 4s
2528/7968 [========>.....................] - ETA: 4s
2592/7968 [========>.....................] - ETA: 4s
2656/7968 [=========>....................] - ETA: 4s
2720/7968 [=========>....................] - ETA: 4s
2784/7968 [=========>....................] - ETA: 4s
2848/7968 [=========>....................] - ETA: 4s
2912/7968 [=========>....................] - ETA: 4s
2976/7968 [==========>...................] - ETA: 4s
3040/7968 [==========>...................] - ETA: 4s
3104/7968 [==========>...................] - ETA: 4s
3168/7968 [==========>...................] - ETA: 4s
3232/7968 [===========>..................] - ETA: 4s
3296/7968 [===========>..................] - ETA: 4s
3360/7968 [===========>..................] - ETA: 4s
3424/7968 [===========>..................] - ETA: 4s
3488/7968 [============>.................] - ETA: 4s
3552/7968 [============>.................] - ETA: 3s
3616/7968 [============>.................] - ETA: 3s
3680/7968 [============>.................] - ETA: 3s
3744/7968 [=============>................] - ETA: 3s
3808/7968 [=============>................] - ETA: 3s
3872/7968 [=============>................] - ETA: 3s
3936/7968 [=============>................] - ETA: 3s
4000/7968 [==============>...............] - ETA: 3s
4064/7968 [==============>...............] - ETA: 3s
4128/7968 [==============>...............] - ETA: 3s
4192/7968 [==============>...............] - ETA: 3s
4256/7968 [===============>..............] - ETA: 3s
4320/7968 [===============>..............] - ETA: 3s
4384/7968 [===============>..............] - ETA: 3s
4448/7968 [===============>..............] - ETA: 3s
4512/7968 [===============>..............] - ETA: 3s
4576/7968 [================>.............] - ETA: 3s
4640/7968 [================>.............] - ETA: 2s
4704/7968 [================>.............] - ETA: 2s
4768/7968 [================>.............] - ETA: 2s
4832/7968 [=================>............] - ETA: 2s
4896/7968 [=================>............] - ETA: 2s
4960/7968 [=================>............] - ETA: 2s
5024/7968 [=================>............] - ETA: 2s
5088/7968 [==================>...........] - ETA: 2s
5152/7968 [==================>...........] - ETA: 2s
5216/7968 [==================>...........] - ETA: 2s
5280/7968 [==================>...........] - ETA: 2s
5344/7968 [===================>..........] - ETA: 2s
5408/7968 [===================>..........] - ETA: 2s
5472/7968 [===================>..........] - ETA: 2s
5536/7968 [===================>..........] - ETA: 2s
5600/7968 [====================>.........] - ETA: 2s
5664/7968 [====================>.........] - ETA: 2s
5728/7968 [====================>.........] - ETA: 2s
5792/7968 [====================>.........] - ETA: 1s
5856/7968 [=====================>........] - ETA: 1s
5920/7968 [=====================>........] - ETA: 1s
5984/7968 [=====================>........] - ETA: 1s
6048/7968 [=====================>........] - ETA: 1s
6112/7968 [======================>.......] - ETA: 1s
6176/7968 [======================>.......] - ETA: 1s
6240/7968 [======================>.......] - ETA: 1s
6304/7968 [======================>.......] - ETA: 1s
6368/7968 [======================>.......] - ETA: 1s
6432/7968 [=======================>......] - ETA: 1s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7008/7968 [=========================>....] - ETA: 0s
7072/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 7s 898us/step
current val accuracy: 0.7777359437751004
current auc_score ------------------>  0.9401376885521395
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_6 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_6[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_71 (Activation)      (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 88, 96, 96)   1408        activation_71[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_72 (Activation)      (None, 88, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_72[0][0]              
__________________________________________________________________________________________________
concatenate_29 (Concatenate)    (None, 38, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 38, 96, 96)   152         concatenate_29[0][0]             
__________________________________________________________________________________________________
activation_73 (Activation)      (None, 38, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 88, 96, 96)   3344        activation_73[0][0]              
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_74 (Activation)      (None, 88, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_74[0][0]              
__________________________________________________________________________________________________
concatenate_30 (Concatenate)    (None, 60, 96, 96)   0           concatenate_29[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 60, 96, 96)   240         concatenate_30[0][0]             
__________________________________________________________________________________________________
activation_75 (Activation)      (None, 60, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 88, 96, 96)   5280        activation_75[0][0]              
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_76 (Activation)      (None, 88, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_76[0][0]              
__________________________________________________________________________________________________
concatenate_31 (Concatenate)    (None, 82, 96, 96)   0           concatenate_30[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 82, 96, 96)   328         concatenate_31[0][0]             
__________________________________________________________________________________________________
activation_77 (Activation)      (None, 82, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 41, 96, 96)   3362        activation_77[0][0]              
__________________________________________________________________________________________________
average_pooling2d_10 (AveragePo (None, 41, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 41, 48, 48)   164         average_pooling2d_10[0][0]       
__________________________________________________________________________________________________
activation_78 (Activation)      (None, 41, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 88, 48, 48)   3608        activation_78[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_79 (Activation)      (None, 88, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_79[0][0]              
__________________________________________________________________________________________________
concatenate_32 (Concatenate)    (None, 63, 48, 48)   0           average_pooling2d_10[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 63, 48, 48)   252         concatenate_32[0][0]             
__________________________________________________________________________________________________
activation_80 (Activation)      (None, 63, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 88, 48, 48)   5544        activation_80[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_81 (Activation)      (None, 88, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_81[0][0]              
__________________________________________________________________________________________________
concatenate_33 (Concatenate)    (None, 85, 48, 48)   0           concatenate_32[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 85, 48, 48)   340         concatenate_33[0][0]             
__________________________________________________________________________________________________
activation_82 (Activation)      (None, 85, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 88, 48, 48)   7480        activation_82[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_83 (Activation)      (None, 88, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_83[0][0]              
__________________________________________________________________________________________________
concatenate_34 (Concatenate)    (None, 107, 48, 48)  0           concatenate_33[0][0]             
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 107, 48, 48)  428         concatenate_34[0][0]             
__________________________________________________________________________________________________
activation_84 (Activation)      (None, 107, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 53, 48, 48)   5671        activation_84[0][0]              
__________________________________________________________________________________________________
average_pooling2d_11 (AveragePo (None, 53, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 53, 24, 24)   212         average_pooling2d_11[0][0]       
__________________________________________________________________________________________________
activation_85 (Activation)      (None, 53, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 88, 24, 24)   4664        activation_85[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_86 (Activation)      (None, 88, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_86[0][0]              
__________________________________________________________________________________________________
concatenate_35 (Concatenate)    (None, 75, 24, 24)   0           average_pooling2d_11[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 75, 24, 24)   300         concatenate_35[0][0]             
__________________________________________________________________________________________________
activation_87 (Activation)      (None, 75, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 88, 24, 24)   6600        activation_87[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_88 (Activation)      (None, 88, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_88[0][0]              
__________________________________________________________________________________________________
concatenate_36 (Concatenate)    (None, 97, 24, 24)   0           concatenate_35[0][0]             
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 97, 24, 24)   388         concatenate_36[0][0]             
__________________________________________________________________________________________________
activation_89 (Activation)      (None, 97, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 88, 24, 24)   8536        activation_89[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_90 (Activation)      (None, 88, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_90[0][0]              
__________________________________________________________________________________________________
concatenate_37 (Concatenate)    (None, 119, 24, 24)  0           concatenate_36[0][0]             
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 119, 24, 24)  476         concatenate_37[0][0]             
__________________________________________________________________________________________________
activation_91 (Activation)      (None, 119, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 59, 24, 24)   7021        activation_91[0][0]              
__________________________________________________________________________________________________
average_pooling2d_12 (AveragePo (None, 59, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 59, 12, 12)   236         average_pooling2d_12[0][0]       
__________________________________________________________________________________________________
activation_92 (Activation)      (None, 59, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 88, 12, 12)   5192        activation_92[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_93 (Activation)      (None, 88, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_93[0][0]              
__________________________________________________________________________________________________
concatenate_38 (Concatenate)    (None, 81, 12, 12)   0           average_pooling2d_12[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 81, 12, 12)   324         concatenate_38[0][0]             
__________________________________________________________________________________________________
activation_94 (Activation)      (None, 81, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 88, 12, 12)   7128        activation_94[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_95 (Activation)      (None, 88, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_95[0][0]              
__________________________________________________________________________________________________
concatenate_39 (Concatenate)    (None, 103, 12, 12)  0           concatenate_38[0][0]             
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 103, 12, 12)  412         concatenate_39[0][0]             
__________________________________________________________________________________________________
activation_96 (Activation)      (None, 103, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 88, 12, 12)   9064        activation_96[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_97 (Activation)      (None, 88, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_97[0][0]              
__________________________________________________________________________________________________
concatenate_40 (Concatenate)    (None, 125, 12, 12)  0           concatenate_39[0][0]             
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 125, 12, 12)  500         concatenate_40[0][0]             
__________________________________________________________________________________________________
activation_98 (Activation)      (None, 125, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 125)          0           activation_98[0][0]              
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1)            126         global_average_pooling2d_6[0][0] 
==================================================================================================
Total params: 302,444
Trainable params: 297,924
Non-trainable params: 4,520
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 69s - loss: 0.7076 - acc: 0.7742 - val_loss: 0.6432 - val_acc: 0.8025
Epoch 2/30
 - 63s - loss: 0.5933 - acc: 0.8365 - val_loss: 0.5705 - val_acc: 0.8522
Epoch 3/30
 - 63s - loss: 0.5419 - acc: 0.8655 - val_loss: 0.5630 - val_acc: 0.8517
Epoch 4/30
 - 63s - loss: 0.5068 - acc: 0.8828 - val_loss: 0.5600 - val_acc: 0.8500
Epoch 5/30
 - 63s - loss: 0.4749 - acc: 0.8993 - val_loss: 0.5091 - val_acc: 0.8771
Epoch 6/30
 - 63s - loss: 0.4462 - acc: 0.9141 - val_loss: 0.5531 - val_acc: 0.8474
Epoch 7/30
 - 63s - loss: 0.4239 - acc: 0.9224 - val_loss: 0.4786 - val_acc: 0.8980
Epoch 8/30
 - 63s - loss: 0.4056 - acc: 0.9301 - val_loss: 0.4268 - val_acc: 0.9160
Epoch 9/30
 - 63s - loss: 0.3876 - acc: 0.9374 - val_loss: 0.4302 - val_acc: 0.9101
Epoch 10/30
 - 63s - loss: 0.3765 - acc: 0.9426 - val_loss: 0.4028 - val_acc: 0.9312
Epoch 11/30
 - 63s - loss: 0.3606 - acc: 0.9482 - val_loss: 0.4503 - val_acc: 0.9025
Epoch 12/30
 - 63s - loss: 0.3507 - acc: 0.9516 - val_loss: 0.4116 - val_acc: 0.9290
Epoch 13/30
 - 63s - loss: 0.3388 - acc: 0.9566 - val_loss: 0.3937 - val_acc: 0.9340
Epoch 14/30
 - 63s - loss: 0.3303 - acc: 0.9597 - val_loss: 0.3881 - val_acc: 0.9339
Epoch 15/30
 - 63s - loss: 0.3206 - acc: 0.9617 - val_loss: 0.3750 - val_acc: 0.9384
Epoch 16/30
 - 63s - loss: 0.3142 - acc: 0.9653 - val_loss: 0.3789 - val_acc: 0.9337
Epoch 17/30
 - 63s - loss: 0.3081 - acc: 0.9668 - val_loss: 0.4936 - val_acc: 0.8873
Epoch 18/30
 - 63s - loss: 0.2990 - acc: 0.9693 - val_loss: 0.4760 - val_acc: 0.9099

Epoch 00018: ReduceLROnPlateau reducing learning rate to 1.5811387901412632e-05.
Epoch 19/30
 - 63s - loss: 0.2739 - acc: 0.9816 - val_loss: 0.3368 - val_acc: 0.9557
Epoch 20/30
 - 63s - loss: 0.2697 - acc: 0.9828 - val_loss: 0.3389 - val_acc: 0.9546
Epoch 21/30
 - 63s - loss: 0.2650 - acc: 0.9845 - val_loss: 0.3344 - val_acc: 0.9556
Epoch 22/30
 - 63s - loss: 0.2658 - acc: 0.9837 - val_loss: 0.3465 - val_acc: 0.9494
Epoch 23/30
 - 63s - loss: 0.2615 - acc: 0.9855 - val_loss: 0.3343 - val_acc: 0.9553
Epoch 24/30
 - 63s - loss: 0.2587 - acc: 0.9865 - val_loss: 0.3540 - val_acc: 0.9474
Epoch 25/30
 - 63s - loss: 0.2569 - acc: 0.9871 - val_loss: 0.3378 - val_acc: 0.9546
Epoch 26/30
 - 63s - loss: 0.2548 - acc: 0.9874 - val_loss: 0.3362 - val_acc: 0.9538

Epoch 00026: ReduceLROnPlateau reducing learning rate to 4.999999629545153e-06.
Epoch 27/30
 - 63s - loss: 0.2488 - acc: 0.9899 - val_loss: 0.3295 - val_acc: 0.9595
Epoch 28/30
 - 63s - loss: 0.2479 - acc: 0.9907 - val_loss: 0.3335 - val_acc: 0.9571
Epoch 29/30
 - 63s - loss: 0.2446 - acc: 0.9925 - val_loss: 0.3290 - val_acc: 0.9601
Epoch 30/30
 - 63s - loss: 0.2472 - acc: 0.9902 - val_loss: 0.3300 - val_acc: 0.9587

  32/7968 [..............................] - ETA: 4s
 128/7968 [..............................] - ETA: 4s
 224/7968 [..............................] - ETA: 4s
 320/7968 [>.............................] - ETA: 4s
 416/7968 [>.............................] - ETA: 4s
 512/7968 [>.............................] - ETA: 4s
 608/7968 [=>............................] - ETA: 4s
 704/7968 [=>............................] - ETA: 4s
 800/7968 [==>...........................] - ETA: 4s
 896/7968 [==>...........................] - ETA: 4s
 992/7968 [==>...........................] - ETA: 4s
1088/7968 [===>..........................] - ETA: 4s
1184/7968 [===>..........................] - ETA: 3s
1280/7968 [===>..........................] - ETA: 3s
1376/7968 [====>.........................] - ETA: 3s
1472/7968 [====>.........................] - ETA: 3s
1568/7968 [====>.........................] - ETA: 3s
1664/7968 [=====>........................] - ETA: 3s
1760/7968 [=====>........................] - ETA: 3s
1856/7968 [=====>........................] - ETA: 3s
1952/7968 [======>.......................] - ETA: 3s
2048/7968 [======>.......................] - ETA: 3s
2144/7968 [=======>......................] - ETA: 3s
2240/7968 [=======>......................] - ETA: 3s
2336/7968 [=======>......................] - ETA: 3s
2432/7968 [========>.....................] - ETA: 3s
2528/7968 [========>.....................] - ETA: 3s
2624/7968 [========>.....................] - ETA: 3s
2720/7968 [=========>....................] - ETA: 3s
2816/7968 [=========>....................] - ETA: 3s
2912/7968 [=========>....................] - ETA: 2s
3008/7968 [==========>...................] - ETA: 2s
3104/7968 [==========>...................] - ETA: 2s
3200/7968 [===========>..................] - ETA: 2s
3296/7968 [===========>..................] - ETA: 2s
3392/7968 [===========>..................] - ETA: 2s
3488/7968 [============>.................] - ETA: 2s
3584/7968 [============>.................] - ETA: 2s
3680/7968 [============>.................] - ETA: 2s
3776/7968 [=============>................] - ETA: 2s
3872/7968 [=============>................] - ETA: 2s
3968/7968 [=============>................] - ETA: 2s
4064/7968 [==============>...............] - ETA: 2s
4160/7968 [==============>...............] - ETA: 2s
4256/7968 [===============>..............] - ETA: 2s
4352/7968 [===============>..............] - ETA: 2s
4448/7968 [===============>..............] - ETA: 2s
4544/7968 [================>.............] - ETA: 2s
4640/7968 [================>.............] - ETA: 1s
4736/7968 [================>.............] - ETA: 1s
4832/7968 [=================>............] - ETA: 1s
4928/7968 [=================>............] - ETA: 1s
5024/7968 [=================>............] - ETA: 1s
5120/7968 [==================>...........] - ETA: 1s
5216/7968 [==================>...........] - ETA: 1s
5312/7968 [===================>..........] - ETA: 1s
5408/7968 [===================>..........] - ETA: 1s
5504/7968 [===================>..........] - ETA: 1s
5600/7968 [====================>.........] - ETA: 1s
5696/7968 [====================>.........] - ETA: 1s
5792/7968 [====================>.........] - ETA: 1s
5888/7968 [=====================>........] - ETA: 1s
5984/7968 [=====================>........] - ETA: 1s
6080/7968 [=====================>........] - ETA: 1s
6176/7968 [======================>.......] - ETA: 1s
6272/7968 [======================>.......] - ETA: 0s
6368/7968 [======================>.......] - ETA: 0s
6464/7968 [=======================>......] - ETA: 0s
6560/7968 [=======================>......] - ETA: 0s
6656/7968 [========================>.....] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6848/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7040/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7232/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7616/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7808/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 5s 586us/step
current val accuracy: 0.9587098393574297
current auc_score ------------------>  0.9907287427404338
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_7 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_7[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_99 (Activation)      (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_99[0][0]              
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_100 (Activation)     (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_100[0][0]             
__________________________________________________________________________________________________
concatenate_41 (Concatenate)    (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_41[0][0]             
__________________________________________________________________________________________________
activation_101 (Activation)     (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_101[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_102 (Activation)     (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_102[0][0]             
__________________________________________________________________________________________________
concatenate_42 (Concatenate)    (None, 28, 96, 96)   0           concatenate_41[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 96, 96)   112         concatenate_42[0][0]             
__________________________________________________________________________________________________
activation_103 (Activation)     (None, 28, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 96, 96)   672         activation_103[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_104 (Activation)     (None, 24, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_104[0][0]             
__________________________________________________________________________________________________
concatenate_43 (Concatenate)    (None, 34, 96, 96)   0           concatenate_42[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 34, 96, 96)   136         concatenate_43[0][0]             
__________________________________________________________________________________________________
activation_105 (Activation)     (None, 34, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 17, 96, 96)   578         activation_105[0][0]             
__________________________________________________________________________________________________
average_pooling2d_13 (AveragePo (None, 17, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 17, 48, 48)   68          average_pooling2d_13[0][0]       
__________________________________________________________________________________________________
activation_106 (Activation)     (None, 17, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   408         activation_106[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_107 (Activation)     (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_107[0][0]             
__________________________________________________________________________________________________
concatenate_44 (Concatenate)    (None, 23, 48, 48)   0           average_pooling2d_13[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 23, 48, 48)   92          concatenate_44[0][0]             
__________________________________________________________________________________________________
activation_108 (Activation)     (None, 23, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   552         activation_108[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_109 (Activation)     (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_109[0][0]             
__________________________________________________________________________________________________
concatenate_45 (Concatenate)    (None, 29, 48, 48)   0           concatenate_44[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 29, 48, 48)   116         concatenate_45[0][0]             
__________________________________________________________________________________________________
activation_110 (Activation)     (None, 29, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 24, 48, 48)   696         activation_110[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_111 (Activation)     (None, 24, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_111[0][0]             
__________________________________________________________________________________________________
concatenate_46 (Concatenate)    (None, 35, 48, 48)   0           concatenate_45[0][0]             
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 35, 48, 48)   140         concatenate_46[0][0]             
__________________________________________________________________________________________________
activation_112 (Activation)     (None, 35, 48, 48)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 35)           0           activation_112[0][0]             
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1)            36          global_average_pooling2d_7[0][0] 
==================================================================================================
Total params: 13,310
Trainable params: 12,614
Non-trainable params: 696
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 30s - loss: 0.6549 - acc: 0.6691 - val_loss: 0.6192 - val_acc: 0.7223
Epoch 2/30
 - 26s - loss: 0.5987 - acc: 0.7347 - val_loss: 0.5806 - val_acc: 0.7459
Epoch 3/30
 - 26s - loss: 0.5681 - acc: 0.7532 - val_loss: 0.5611 - val_acc: 0.7556
Epoch 4/30
 - 26s - loss: 0.5504 - acc: 0.7624 - val_loss: 0.5408 - val_acc: 0.7615
Epoch 5/30
 - 25s - loss: 0.5346 - acc: 0.7673 - val_loss: 0.5298 - val_acc: 0.7589
Epoch 6/30
 - 26s - loss: 0.5225 - acc: 0.7731 - val_loss: 0.5288 - val_acc: 0.7525
Epoch 7/30
 - 25s - loss: 0.5124 - acc: 0.7757 - val_loss: 0.5019 - val_acc: 0.7756
Epoch 8/30
 - 26s - loss: 0.5063 - acc: 0.7754 - val_loss: 0.5110 - val_acc: 0.7585
Epoch 9/30
 - 26s - loss: 0.4995 - acc: 0.7780 - val_loss: 0.4892 - val_acc: 0.7800
Epoch 10/30
 - 26s - loss: 0.4935 - acc: 0.7786 - val_loss: 0.4836 - val_acc: 0.7838
Epoch 11/30
 - 25s - loss: 0.4880 - acc: 0.7823 - val_loss: 0.4760 - val_acc: 0.7869
Epoch 12/30
 - 25s - loss: 0.4848 - acc: 0.7847 - val_loss: 0.4821 - val_acc: 0.7820
Epoch 13/30
 - 25s - loss: 0.4816 - acc: 0.7845 - val_loss: 0.4714 - val_acc: 0.7870
Epoch 14/30
 - 25s - loss: 0.4762 - acc: 0.7869 - val_loss: 0.4679 - val_acc: 0.7927
Epoch 15/30
 - 25s - loss: 0.4743 - acc: 0.7882 - val_loss: 0.4621 - val_acc: 0.7905
Epoch 16/30
 - 25s - loss: 0.4718 - acc: 0.7879 - val_loss: 0.4662 - val_acc: 0.7928
Epoch 17/30
 - 25s - loss: 0.4667 - acc: 0.7908 - val_loss: 0.4540 - val_acc: 0.7948
Epoch 18/30
 - 25s - loss: 0.4634 - acc: 0.7931 - val_loss: 0.4615 - val_acc: 0.7953
Epoch 19/30
 - 25s - loss: 0.4600 - acc: 0.7955 - val_loss: 0.4489 - val_acc: 0.7964
Epoch 20/30
 - 25s - loss: 0.4581 - acc: 0.7959 - val_loss: 0.4546 - val_acc: 0.7871
Epoch 21/30
 - 25s - loss: 0.4550 - acc: 0.7959 - val_loss: 0.4453 - val_acc: 0.7979
Epoch 22/30
 - 25s - loss: 0.4536 - acc: 0.7976 - val_loss: 0.4381 - val_acc: 0.8032
Epoch 23/30
 - 25s - loss: 0.4502 - acc: 0.8005 - val_loss: 0.4456 - val_acc: 0.7962
Epoch 24/30
 - 25s - loss: 0.4484 - acc: 0.7994 - val_loss: 0.4347 - val_acc: 0.8071
Epoch 25/30
 - 26s - loss: 0.4461 - acc: 0.8007 - val_loss: 0.4354 - val_acc: 0.8045
Epoch 26/30
 - 25s - loss: 0.4441 - acc: 0.8005 - val_loss: 0.4350 - val_acc: 0.8096
Epoch 27/30
 - 25s - loss: 0.4397 - acc: 0.8058 - val_loss: 0.4397 - val_acc: 0.7986

Epoch 00027: ReduceLROnPlateau reducing learning rate to 1.5811387901412632e-05.
Epoch 28/30
 - 26s - loss: 0.4367 - acc: 0.8070 - val_loss: 0.4325 - val_acc: 0.8053
Epoch 29/30
 - 26s - loss: 0.4352 - acc: 0.8062 - val_loss: 0.4267 - val_acc: 0.8065
Epoch 30/30
 - 26s - loss: 0.4348 - acc: 0.8067 - val_loss: 0.4267 - val_acc: 0.8114

  32/7968 [..............................] - ETA: 2s
 224/7968 [..............................] - ETA: 2s
 416/7968 [>.............................] - ETA: 2s
 608/7968 [=>............................] - ETA: 2s
 800/7968 [==>...........................] - ETA: 1s
 992/7968 [==>...........................] - ETA: 1s
1184/7968 [===>..........................] - ETA: 1s
1408/7968 [====>.........................] - ETA: 1s
1632/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2016/7968 [======>.......................] - ETA: 1s
2208/7968 [=======>......................] - ETA: 1s
2400/7968 [========>.....................] - ETA: 1s
2592/7968 [========>.....................] - ETA: 1s
2784/7968 [=========>....................] - ETA: 1s
2976/7968 [==========>...................] - ETA: 1s
3168/7968 [==========>...................] - ETA: 1s
3360/7968 [===========>..................] - ETA: 1s
3584/7968 [============>.................] - ETA: 1s
3776/7968 [=============>................] - ETA: 1s
3968/7968 [=============>................] - ETA: 1s
4160/7968 [==============>...............] - ETA: 1s
4352/7968 [===============>..............] - ETA: 0s
4576/7968 [================>.............] - ETA: 0s
4800/7968 [=================>............] - ETA: 0s
4992/7968 [=================>............] - ETA: 0s
5184/7968 [==================>...........] - ETA: 0s
5376/7968 [===================>..........] - ETA: 0s
5568/7968 [===================>..........] - ETA: 0s
5760/7968 [====================>.........] - ETA: 0s
5952/7968 [=====================>........] - ETA: 0s
6144/7968 [======================>.......] - ETA: 0s
6336/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6720/7968 [========================>.....] - ETA: 0s
6912/7968 [=========================>....] - ETA: 0s
7104/7968 [=========================>....] - ETA: 0s
7296/7968 [==========================>...] - ETA: 0s
7488/7968 [===========================>..] - ETA: 0s
7680/7968 [===========================>..] - ETA: 0s
7872/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 267us/step
current val accuracy: 0.8113704819277109
current auc_score ------------------>  0.9021347862378485
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_8 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_8[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_113 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_113[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_114 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_114[0][0]             
__________________________________________________________________________________________________
concatenate_47 (Concatenate)    (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_47[0][0]             
__________________________________________________________________________________________________
activation_115 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_115[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_116 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_116[0][0]             
__________________________________________________________________________________________________
concatenate_48 (Concatenate)    (None, 76, 96, 96)   0           concatenate_47[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 76, 96, 96)   304         concatenate_48[0][0]             
__________________________________________________________________________________________________
activation_117 (Activation)     (None, 76, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 38, 96, 96)   2888        activation_117[0][0]             
__________________________________________________________________________________________________
average_pooling2d_14 (AveragePo (None, 38, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 38, 48, 48)   152         average_pooling2d_14[0][0]       
__________________________________________________________________________________________________
activation_118 (Activation)     (None, 38, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  4560        activation_118[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_119 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_119[0][0]             
__________________________________________________________________________________________________
concatenate_49 (Concatenate)    (None, 68, 48, 48)   0           average_pooling2d_14[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 68, 48, 48)   272         concatenate_49[0][0]             
__________________________________________________________________________________________________
activation_120 (Activation)     (None, 68, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  8160        activation_120[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_121 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_121[0][0]             
__________________________________________________________________________________________________
concatenate_50 (Concatenate)    (None, 98, 48, 48)   0           concatenate_49[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 98, 48, 48)   392         concatenate_50[0][0]             
__________________________________________________________________________________________________
activation_122 (Activation)     (None, 98, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 49, 48, 48)   4802        activation_122[0][0]             
__________________________________________________________________________________________________
average_pooling2d_15 (AveragePo (None, 49, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 49, 24, 24)   196         average_pooling2d_15[0][0]       
__________________________________________________________________________________________________
activation_123 (Activation)     (None, 49, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  5880        activation_123[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_124 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_124[0][0]             
__________________________________________________________________________________________________
concatenate_51 (Concatenate)    (None, 79, 24, 24)   0           average_pooling2d_15[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 79, 24, 24)   316         concatenate_51[0][0]             
__________________________________________________________________________________________________
activation_125 (Activation)     (None, 79, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  9480        activation_125[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_126 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_126[0][0]             
__________________________________________________________________________________________________
concatenate_52 (Concatenate)    (None, 109, 24, 24)  0           concatenate_51[0][0]             
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 109, 24, 24)  436         concatenate_52[0][0]             
__________________________________________________________________________________________________
activation_127 (Activation)     (None, 109, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 54, 24, 24)   5886        activation_127[0][0]             
__________________________________________________________________________________________________
average_pooling2d_16 (AveragePo (None, 54, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 54, 12, 12)   216         average_pooling2d_16[0][0]       
__________________________________________________________________________________________________
activation_128 (Activation)     (None, 54, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  6480        activation_128[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_129 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_129[0][0]             
__________________________________________________________________________________________________
concatenate_53 (Concatenate)    (None, 84, 12, 12)   0           average_pooling2d_16[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 84, 12, 12)   336         concatenate_53[0][0]             
__________________________________________________________________________________________________
activation_130 (Activation)     (None, 84, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  10080       activation_130[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_131 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_131[0][0]             
__________________________________________________________________________________________________
concatenate_54 (Concatenate)    (None, 114, 12, 12)  0           concatenate_53[0][0]             
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 114, 12, 12)  456         concatenate_54[0][0]             
__________________________________________________________________________________________________
activation_132 (Activation)     (None, 114, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 114)          0           activation_132[0][0]             
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 1)            115         global_average_pooling2d_8[0][0] 
==================================================================================================
Total params: 332,423
Trainable params: 328,841
Non-trainable params: 3,582
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 58s - loss: 0.6051 - acc: 0.7995 - val_loss: 0.6528 - val_acc: 0.7905
Epoch 2/30
 - 51s - loss: 0.4364 - acc: 0.8798 - val_loss: 0.4567 - val_acc: 0.8667
Epoch 3/30
 - 51s - loss: 0.3486 - acc: 0.9140 - val_loss: 0.3672 - val_acc: 0.9016
Epoch 4/30
 - 51s - loss: 0.2928 - acc: 0.9331 - val_loss: 0.2767 - val_acc: 0.9435
Epoch 5/30
 - 51s - loss: 0.2570 - acc: 0.9454 - val_loss: 0.3982 - val_acc: 0.8825
Epoch 6/30
 - 51s - loss: 0.2219 - acc: 0.9561 - val_loss: 0.2731 - val_acc: 0.9291
Epoch 7/30
 - 51s - loss: 0.2051 - acc: 0.9599 - val_loss: 0.2101 - val_acc: 0.9557
Epoch 8/30
 - 51s - loss: 0.1832 - acc: 0.9678 - val_loss: 0.3232 - val_acc: 0.9207
Epoch 9/30
 - 51s - loss: 0.1704 - acc: 0.9697 - val_loss: 0.1860 - val_acc: 0.9647
Epoch 10/30
 - 50s - loss: 0.1529 - acc: 0.9766 - val_loss: 0.2002 - val_acc: 0.9557
Epoch 11/30
 - 51s - loss: 0.1476 - acc: 0.9756 - val_loss: 0.1731 - val_acc: 0.9642
Epoch 12/30
 - 51s - loss: 0.1324 - acc: 0.9799 - val_loss: 0.1958 - val_acc: 0.9552
Epoch 13/30
 - 51s - loss: 0.1321 - acc: 0.9793 - val_loss: 0.2111 - val_acc: 0.9542
Epoch 14/30
 - 51s - loss: 0.1230 - acc: 0.9816 - val_loss: 0.1408 - val_acc: 0.9755
Epoch 15/30
 - 51s - loss: 0.1171 - acc: 0.9826 - val_loss: 0.1422 - val_acc: 0.9729
Epoch 16/30
 - 51s - loss: 0.1107 - acc: 0.9847 - val_loss: 0.1283 - val_acc: 0.9778
Epoch 17/30
 - 51s - loss: 0.1052 - acc: 0.9850 - val_loss: 0.1448 - val_acc: 0.9708
Epoch 18/30
 - 51s - loss: 0.1054 - acc: 0.9853 - val_loss: 0.1505 - val_acc: 0.9684
Epoch 19/30
 - 51s - loss: 0.0929 - acc: 0.9891 - val_loss: 0.1532 - val_acc: 0.9694

Epoch 00019: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 20/30
 - 51s - loss: 0.0729 - acc: 0.9966 - val_loss: 0.1009 - val_acc: 0.9856
Epoch 21/30
 - 51s - loss: 0.0662 - acc: 0.9981 - val_loss: 0.0968 - val_acc: 0.9866
Epoch 22/30
 - 50s - loss: 0.0633 - acc: 0.9987 - val_loss: 0.1116 - val_acc: 0.9818
Epoch 23/30
 - 51s - loss: 0.0646 - acc: 0.9973 - val_loss: 0.0917 - val_acc: 0.9881
Epoch 24/30
 - 50s - loss: 0.0598 - acc: 0.9986 - val_loss: 0.1055 - val_acc: 0.9838
Epoch 25/30
 - 50s - loss: 0.0596 - acc: 0.9977 - val_loss: 0.1037 - val_acc: 0.9849
Epoch 26/30
 - 50s - loss: 0.0563 - acc: 0.9988 - val_loss: 0.0969 - val_acc: 0.9848

Epoch 00026: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 27/30
 - 50s - loss: 0.0533 - acc: 0.9993 - val_loss: 0.0837 - val_acc: 0.9898
Epoch 28/30
 - 50s - loss: 0.0513 - acc: 0.9998 - val_loss: 0.0846 - val_acc: 0.9892
Epoch 29/30
 - 50s - loss: 0.0507 - acc: 0.9996 - val_loss: 0.0841 - val_acc: 0.9897
Epoch 30/30
 - 51s - loss: 0.0499 - acc: 0.9997 - val_loss: 0.0853 - val_acc: 0.9893

Epoch 00030: ReduceLROnPlateau reducing learning rate to 1.5811389051842542e-05.

  32/7968 [..............................] - ETA: 3s
 160/7968 [..............................] - ETA: 3s
 288/7968 [>.............................] - ETA: 3s
 416/7968 [>.............................] - ETA: 3s
 544/7968 [=>............................] - ETA: 3s
 672/7968 [=>............................] - ETA: 3s
 800/7968 [==>...........................] - ETA: 3s
 928/7968 [==>...........................] - ETA: 3s
1056/7968 [==>...........................] - ETA: 3s
1184/7968 [===>..........................] - ETA: 3s
1312/7968 [===>..........................] - ETA: 3s
1440/7968 [====>.........................] - ETA: 3s
1568/7968 [====>.........................] - ETA: 3s
1696/7968 [=====>........................] - ETA: 3s
1824/7968 [=====>........................] - ETA: 2s
1952/7968 [======>.......................] - ETA: 2s
2080/7968 [======>.......................] - ETA: 2s
2208/7968 [=======>......................] - ETA: 2s
2336/7968 [=======>......................] - ETA: 2s
2464/7968 [========>.....................] - ETA: 2s
2592/7968 [========>.....................] - ETA: 2s
2720/7968 [=========>....................] - ETA: 2s
2848/7968 [=========>....................] - ETA: 2s
2976/7968 [==========>...................] - ETA: 2s
3104/7968 [==========>...................] - ETA: 2s
3232/7968 [===========>..................] - ETA: 2s
3360/7968 [===========>..................] - ETA: 2s
3488/7968 [============>.................] - ETA: 2s
3616/7968 [============>.................] - ETA: 2s
3744/7968 [=============>................] - ETA: 2s
3872/7968 [=============>................] - ETA: 1s
4000/7968 [==============>...............] - ETA: 1s
4128/7968 [==============>...............] - ETA: 1s
4256/7968 [===============>..............] - ETA: 1s
4384/7968 [===============>..............] - ETA: 1s
4512/7968 [===============>..............] - ETA: 1s
4640/7968 [================>.............] - ETA: 1s
4768/7968 [================>.............] - ETA: 1s
4896/7968 [=================>............] - ETA: 1s
5024/7968 [=================>............] - ETA: 1s
5152/7968 [==================>...........] - ETA: 1s
5280/7968 [==================>...........] - ETA: 1s
5408/7968 [===================>..........] - ETA: 1s
5536/7968 [===================>..........] - ETA: 1s
5664/7968 [====================>.........] - ETA: 1s
5792/7968 [====================>.........] - ETA: 1s
5920/7968 [=====================>........] - ETA: 0s
6048/7968 [=====================>........] - ETA: 0s
6176/7968 [======================>.......] - ETA: 0s
6304/7968 [======================>.......] - ETA: 0s
6432/7968 [=======================>......] - ETA: 0s
6560/7968 [=======================>......] - ETA: 0s
6688/7968 [========================>.....] - ETA: 0s
6816/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7072/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 4s 487us/step
current val accuracy: 0.9893323293172691
current auc_score ------------------>  0.9988922577565584
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_9 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_9[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_133 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_133[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_134 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_134[0][0]             
__________________________________________________________________________________________________
concatenate_55 (Concatenate)    (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_55[0][0]             
__________________________________________________________________________________________________
activation_135 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_135[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_136 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_136[0][0]             
__________________________________________________________________________________________________
concatenate_56 (Concatenate)    (None, 76, 96, 96)   0           concatenate_55[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_56[0][0]             
__________________________________________________________________________________________________
activation_137 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_137[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_138 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_138[0][0]             
__________________________________________________________________________________________________
concatenate_57 (Concatenate)    (None, 106, 96, 96)  0           concatenate_56[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_57[0][0]             
__________________________________________________________________________________________________
activation_139 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_139[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_140 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_140[0][0]             
__________________________________________________________________________________________________
concatenate_58 (Concatenate)    (None, 136, 96, 96)  0           concatenate_57[0][0]             
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_58[0][0]             
__________________________________________________________________________________________________
activation_141 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_141[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_142 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_142[0][0]             
__________________________________________________________________________________________________
concatenate_59 (Concatenate)    (None, 166, 96, 96)  0           concatenate_58[0][0]             
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_59[0][0]             
__________________________________________________________________________________________________
activation_143 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_143[0][0]             
__________________________________________________________________________________________________
average_pooling2d_17 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_17[0][0]       
__________________________________________________________________________________________________
activation_144 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_144[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_145 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_145[0][0]             
__________________________________________________________________________________________________
concatenate_60 (Concatenate)    (None, 113, 48, 48)  0           average_pooling2d_17[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_60[0][0]             
__________________________________________________________________________________________________
activation_146 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_146[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_147 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_147[0][0]             
__________________________________________________________________________________________________
concatenate_61 (Concatenate)    (None, 143, 48, 48)  0           concatenate_60[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_61[0][0]             
__________________________________________________________________________________________________
activation_148 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_148[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_149 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_149[0][0]             
__________________________________________________________________________________________________
concatenate_62 (Concatenate)    (None, 173, 48, 48)  0           concatenate_61[0][0]             
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_62[0][0]             
__________________________________________________________________________________________________
activation_150 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_150[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_151 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_151[0][0]             
__________________________________________________________________________________________________
concatenate_63 (Concatenate)    (None, 203, 48, 48)  0           concatenate_62[0][0]             
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_63[0][0]             
__________________________________________________________________________________________________
activation_152 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_152[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_153 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_153[0][0]             
__________________________________________________________________________________________________
concatenate_64 (Concatenate)    (None, 233, 48, 48)  0           concatenate_63[0][0]             
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 233, 48, 48)  932         concatenate_64[0][0]             
__________________________________________________________________________________________________
activation_154 (Activation)     (None, 233, 48, 48)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_9 (Glo (None, 233)          0           activation_154[0][0]             
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 1)            234         global_average_pooling2d_9[0][0] 
==================================================================================================
Total params: 480,476
Trainable params: 475,088
Non-trainable params: 5,388
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 123s - loss: 0.7501 - acc: 0.7588 - val_loss: 0.7121 - val_acc: 0.7818
Epoch 2/30
 - 117s - loss: 0.6692 - acc: 0.7961 - val_loss: 0.6319 - val_acc: 0.8154
Epoch 3/30
 - 117s - loss: 0.6240 - acc: 0.8161 - val_loss: 0.5990 - val_acc: 0.8336
Epoch 4/30
 - 117s - loss: 0.5965 - acc: 0.8312 - val_loss: 0.5811 - val_acc: 0.8419
Epoch 5/30
 - 117s - loss: 0.5730 - acc: 0.8384 - val_loss: 0.6016 - val_acc: 0.8284
Epoch 6/30
 - 117s - loss: 0.5519 - acc: 0.8487 - val_loss: 0.5598 - val_acc: 0.8455
Epoch 7/30
 - 117s - loss: 0.5363 - acc: 0.8555 - val_loss: 0.5510 - val_acc: 0.8444
Epoch 8/30
 - 117s - loss: 0.5204 - acc: 0.8616 - val_loss: 0.5503 - val_acc: 0.8386
Epoch 9/30
 - 117s - loss: 0.5061 - acc: 0.8687 - val_loss: 0.5266 - val_acc: 0.8505
Epoch 10/30
 - 117s - loss: 0.4899 - acc: 0.8768 - val_loss: 0.5421 - val_acc: 0.8668
Epoch 11/30
 - 117s - loss: 0.4804 - acc: 0.8808 - val_loss: 0.5211 - val_acc: 0.8567
Epoch 12/30
 - 117s - loss: 0.4663 - acc: 0.8867 - val_loss: 0.4823 - val_acc: 0.8848
Epoch 13/30
 - 117s - loss: 0.4531 - acc: 0.8926 - val_loss: 0.5291 - val_acc: 0.8602
Epoch 14/30
 - 117s - loss: 0.4421 - acc: 0.8979 - val_loss: 0.4652 - val_acc: 0.8786
Epoch 15/30
 - 117s - loss: 0.4302 - acc: 0.9032 - val_loss: 0.4382 - val_acc: 0.8965
Epoch 16/30
 - 117s - loss: 0.4191 - acc: 0.9079 - val_loss: 0.4278 - val_acc: 0.9012
Epoch 17/30
 - 117s - loss: 0.4084 - acc: 0.9126 - val_loss: 0.5146 - val_acc: 0.8714
Epoch 18/30
 - 117s - loss: 0.3995 - acc: 0.9161 - val_loss: 0.4653 - val_acc: 0.8870
Epoch 19/30
 - 117s - loss: 0.3898 - acc: 0.9220 - val_loss: 0.4163 - val_acc: 0.9030
Epoch 20/30
 - 117s - loss: 0.3781 - acc: 0.9257 - val_loss: 0.4231 - val_acc: 0.9051
Epoch 21/30
 - 117s - loss: 0.3724 - acc: 0.9283 - val_loss: 0.5811 - val_acc: 0.8458
Epoch 22/30
 - 117s - loss: 0.3591 - acc: 0.9343 - val_loss: 0.5636 - val_acc: 0.8283

Epoch 00022: ReduceLROnPlateau reducing learning rate to 1.5811387901412632e-05.
Epoch 23/30
 - 117s - loss: 0.3324 - acc: 0.9489 - val_loss: 0.3799 - val_acc: 0.9241
Epoch 24/30
 - 117s - loss: 0.3264 - acc: 0.9517 - val_loss: 0.3827 - val_acc: 0.9243
Epoch 25/30
 - 117s - loss: 0.3209 - acc: 0.9536 - val_loss: 0.3824 - val_acc: 0.9206
Epoch 26/30
 - 117s - loss: 0.3178 - acc: 0.9545 - val_loss: 0.3746 - val_acc: 0.9239
Epoch 27/30
 - 117s - loss: 0.3126 - acc: 0.9565 - val_loss: 0.3946 - val_acc: 0.9144
Epoch 28/30
 - 117s - loss: 0.3089 - acc: 0.9592 - val_loss: 0.3869 - val_acc: 0.9201
Epoch 29/30
 - 117s - loss: 0.3066 - acc: 0.9587 - val_loss: 0.3755 - val_acc: 0.9242

Epoch 00029: ReduceLROnPlateau reducing learning rate to 4.999999629545153e-06.
Epoch 30/30
 - 117s - loss: 0.2964 - acc: 0.9661 - val_loss: 0.3648 - val_acc: 0.9288

  32/7968 [..............................] - ETA: 9s
  96/7968 [..............................] - ETA: 9s
 160/7968 [..............................] - ETA: 9s
 224/7968 [..............................] - ETA: 9s
 288/7968 [>.............................] - ETA: 8s
 352/7968 [>.............................] - ETA: 8s
 416/7968 [>.............................] - ETA: 8s
 480/7968 [>.............................] - ETA: 8s
 544/7968 [=>............................] - ETA: 8s
 608/7968 [=>............................] - ETA: 8s
 672/7968 [=>............................] - ETA: 8s
 736/7968 [=>............................] - ETA: 8s
 800/7968 [==>...........................] - ETA: 8s
 864/7968 [==>...........................] - ETA: 8s
 928/7968 [==>...........................] - ETA: 8s
 992/7968 [==>...........................] - ETA: 8s
1056/7968 [==>...........................] - ETA: 8s
1120/7968 [===>..........................] - ETA: 7s
1184/7968 [===>..........................] - ETA: 7s
1248/7968 [===>..........................] - ETA: 7s
1312/7968 [===>..........................] - ETA: 7s
1376/7968 [====>.........................] - ETA: 7s
1440/7968 [====>.........................] - ETA: 7s
1504/7968 [====>.........................] - ETA: 7s
1568/7968 [====>.........................] - ETA: 7s
1632/7968 [=====>........................] - ETA: 7s
1696/7968 [=====>........................] - ETA: 7s
1760/7968 [=====>........................] - ETA: 7s
1824/7968 [=====>........................] - ETA: 7s
1888/7968 [======>.......................] - ETA: 7s
1952/7968 [======>.......................] - ETA: 6s
2016/7968 [======>.......................] - ETA: 6s
2080/7968 [======>.......................] - ETA: 6s
2144/7968 [=======>......................] - ETA: 6s
2208/7968 [=======>......................] - ETA: 6s
2272/7968 [=======>......................] - ETA: 6s
2336/7968 [=======>......................] - ETA: 6s
2400/7968 [========>.....................] - ETA: 6s
2464/7968 [========>.....................] - ETA: 6s
2528/7968 [========>.....................] - ETA: 6s
2592/7968 [========>.....................] - ETA: 6s
2656/7968 [=========>....................] - ETA: 6s
2720/7968 [=========>....................] - ETA: 6s
2784/7968 [=========>....................] - ETA: 6s
2848/7968 [=========>....................] - ETA: 5s
2912/7968 [=========>....................] - ETA: 5s
2976/7968 [==========>...................] - ETA: 5s
3040/7968 [==========>...................] - ETA: 5s
3104/7968 [==========>...................] - ETA: 5s
3168/7968 [==========>...................] - ETA: 5s
3232/7968 [===========>..................] - ETA: 5s
3296/7968 [===========>..................] - ETA: 5s
3360/7968 [===========>..................] - ETA: 5s
3424/7968 [===========>..................] - ETA: 5s
3488/7968 [============>.................] - ETA: 5s
3552/7968 [============>.................] - ETA: 5s
3616/7968 [============>.................] - ETA: 5s
3680/7968 [============>.................] - ETA: 4s
3744/7968 [=============>................] - ETA: 4s
3808/7968 [=============>................] - ETA: 4s
3872/7968 [=============>................] - ETA: 4s
3936/7968 [=============>................] - ETA: 4s
4000/7968 [==============>...............] - ETA: 4s
4064/7968 [==============>...............] - ETA: 4s
4128/7968 [==============>...............] - ETA: 4s
4192/7968 [==============>...............] - ETA: 4s
4256/7968 [===============>..............] - ETA: 4s
4320/7968 [===============>..............] - ETA: 4s
4384/7968 [===============>..............] - ETA: 4s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 3s
4640/7968 [================>.............] - ETA: 3s
4704/7968 [================>.............] - ETA: 3s
4768/7968 [================>.............] - ETA: 3s
4832/7968 [=================>............] - ETA: 3s
4896/7968 [=================>............] - ETA: 3s
4960/7968 [=================>............] - ETA: 3s
5024/7968 [=================>............] - ETA: 3s
5088/7968 [==================>...........] - ETA: 3s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 2s
5472/7968 [===================>..........] - ETA: 2s
5536/7968 [===================>..........] - ETA: 2s
5600/7968 [====================>.........] - ETA: 2s
5664/7968 [====================>.........] - ETA: 2s
5728/7968 [====================>.........] - ETA: 2s
5792/7968 [====================>.........] - ETA: 2s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 1s
6368/7968 [======================>.......] - ETA: 1s
6432/7968 [=======================>......] - ETA: 1s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 9s 1ms/step
current val accuracy: 0.9288403614457831
current auc_score ------------------>  0.9804813945423587
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_10 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_10[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_155 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_155[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_156 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_156[0][0]             
__________________________________________________________________________________________________
concatenate_65 (Concatenate)    (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_65[0][0]             
__________________________________________________________________________________________________
activation_157 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_157[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_158 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_158[0][0]             
__________________________________________________________________________________________________
concatenate_66 (Concatenate)    (None, 76, 96, 96)   0           concatenate_65[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_66[0][0]             
__________________________________________________________________________________________________
activation_159 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_159[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_160 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_160[0][0]             
__________________________________________________________________________________________________
concatenate_67 (Concatenate)    (None, 106, 96, 96)  0           concatenate_66[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_67[0][0]             
__________________________________________________________________________________________________
activation_161 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_161[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_162 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_162[0][0]             
__________________________________________________________________________________________________
concatenate_68 (Concatenate)    (None, 136, 96, 96)  0           concatenate_67[0][0]             
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_68[0][0]             
__________________________________________________________________________________________________
activation_163 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_163[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_164 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_164[0][0]             
__________________________________________________________________________________________________
concatenate_69 (Concatenate)    (None, 166, 96, 96)  0           concatenate_68[0][0]             
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_69[0][0]             
__________________________________________________________________________________________________
activation_165 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_165[0][0]             
__________________________________________________________________________________________________
average_pooling2d_18 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_18[0][0]       
__________________________________________________________________________________________________
activation_166 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_166[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_167 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_167[0][0]             
__________________________________________________________________________________________________
concatenate_70 (Concatenate)    (None, 113, 48, 48)  0           average_pooling2d_18[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_70[0][0]             
__________________________________________________________________________________________________
activation_168 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_168[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_169 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_169[0][0]             
__________________________________________________________________________________________________
concatenate_71 (Concatenate)    (None, 143, 48, 48)  0           concatenate_70[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_71[0][0]             
__________________________________________________________________________________________________
activation_170 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_170[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_171 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_171[0][0]             
__________________________________________________________________________________________________
concatenate_72 (Concatenate)    (None, 173, 48, 48)  0           concatenate_71[0][0]             
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_72[0][0]             
__________________________________________________________________________________________________
activation_172 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_172[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_173 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_173[0][0]             
__________________________________________________________________________________________________
concatenate_73 (Concatenate)    (None, 203, 48, 48)  0           concatenate_72[0][0]             
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_73[0][0]             
__________________________________________________________________________________________________
activation_174 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_174[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_175 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_175[0][0]             
__________________________________________________________________________________________________
concatenate_74 (Concatenate)    (None, 233, 48, 48)  0           concatenate_73[0][0]             
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_74[0][0]             
__________________________________________________________________________________________________
activation_176 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_176[0][0]             
__________________________________________________________________________________________________
average_pooling2d_19 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_19[0][0]       
__________________________________________________________________________________________________
activation_177 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_177[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_178 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_178[0][0]             
__________________________________________________________________________________________________
concatenate_75 (Concatenate)    (None, 146, 24, 24)  0           average_pooling2d_19[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_75[0][0]             
__________________________________________________________________________________________________
activation_179 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_179[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_180 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_180[0][0]             
__________________________________________________________________________________________________
concatenate_76 (Concatenate)    (None, 176, 24, 24)  0           concatenate_75[0][0]             
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_76[0][0]             
__________________________________________________________________________________________________
activation_181 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_181[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_182 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_182[0][0]             
__________________________________________________________________________________________________
concatenate_77 (Concatenate)    (None, 206, 24, 24)  0           concatenate_76[0][0]             
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_77[0][0]             
__________________________________________________________________________________________________
activation_183 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_183[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_184 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_184[0][0]             
__________________________________________________________________________________________________
concatenate_78 (Concatenate)    (None, 236, 24, 24)  0           concatenate_77[0][0]             
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_78[0][0]             
__________________________________________________________________________________________________
activation_185 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_185[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_186 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_186[0][0]             
__________________________________________________________________________________________________
concatenate_79 (Concatenate)    (None, 266, 24, 24)  0           concatenate_78[0][0]             
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 266, 24, 24)  1064        concatenate_79[0][0]             
__________________________________________________________________________________________________
activation_187 (Activation)     (None, 266, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_10 (Gl (None, 266)          0           activation_187[0][0]             
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 1)            267         global_average_pooling2d_10[0][0]
==================================================================================================
Total params: 782,121
Trainable params: 773,241
Non-trainable params: 8,880
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 138s - loss: 0.5833 - acc: 0.7486 - val_loss: 1.0083 - val_acc: 0.6707
Epoch 2/30
 - 130s - loss: 0.4953 - acc: 0.7790 - val_loss: 1.4944 - val_acc: 0.6756
Epoch 3/30
 - 130s - loss: 0.4730 - acc: 0.7843 - val_loss: 1.9479 - val_acc: 0.5624
Epoch 4/30
 - 130s - loss: 0.4592 - acc: 0.7907 - val_loss: 0.5375 - val_acc: 0.7368
Epoch 5/30
 - 130s - loss: 0.4508 - acc: 0.7956 - val_loss: 0.5520 - val_acc: 0.7354
Epoch 6/30
 - 130s - loss: 0.4403 - acc: 0.7987 - val_loss: 0.5196 - val_acc: 0.7835
Epoch 7/30
 - 130s - loss: 0.4330 - acc: 0.8032 - val_loss: 0.5896 - val_acc: 0.7464
Epoch 8/30
 - 130s - loss: 0.4259 - acc: 0.8076 - val_loss: 0.9690 - val_acc: 0.6058
Epoch 9/30
 - 130s - loss: 0.4187 - acc: 0.8124 - val_loss: 0.5303 - val_acc: 0.7540

Epoch 00009: ReduceLROnPlateau reducing learning rate to 0.0031622775894859655.
Epoch 10/30
 - 130s - loss: 0.3886 - acc: 0.8261 - val_loss: 0.5231 - val_acc: 0.7863
Epoch 11/30
 - 130s - loss: 0.3729 - acc: 0.8361 - val_loss: 0.4279 - val_acc: 0.8069
Epoch 12/30
 - 130s - loss: 0.3650 - acc: 0.8402 - val_loss: 0.3667 - val_acc: 0.8390
Epoch 13/30
 - 130s - loss: 0.3596 - acc: 0.8422 - val_loss: 0.3710 - val_acc: 0.8341
Epoch 14/30
 - 130s - loss: 0.3523 - acc: 0.8476 - val_loss: 0.6624 - val_acc: 0.7400
Epoch 15/30
 - 130s - loss: 0.3464 - acc: 0.8507 - val_loss: 0.4198 - val_acc: 0.8092

Epoch 00015: ReduceLROnPlateau reducing learning rate to 0.0009999999903331056.
Epoch 16/30
 - 130s - loss: 0.3275 - acc: 0.8637 - val_loss: 0.3398 - val_acc: 0.8542
Epoch 17/30
 - 130s - loss: 0.3192 - acc: 0.8663 - val_loss: 0.3354 - val_acc: 0.8523
Epoch 18/30
 - 130s - loss: 0.3152 - acc: 0.8710 - val_loss: 0.3165 - val_acc: 0.8682
Epoch 19/30
 - 130s - loss: 0.3100 - acc: 0.8719 - val_loss: 0.3901 - val_acc: 0.8350
Epoch 20/30
 - 130s - loss: 0.3055 - acc: 0.8741 - val_loss: 0.4511 - val_acc: 0.8031
Epoch 21/30
 - 130s - loss: 0.3032 - acc: 0.8742 - val_loss: 0.3289 - val_acc: 0.8586

Epoch 00021: ReduceLROnPlateau reducing learning rate to 0.00031622778103685084.
Epoch 22/30
 - 130s - loss: 0.2913 - acc: 0.8812 - val_loss: 0.3109 - val_acc: 0.8755
Epoch 23/30
 - 130s - loss: 0.2844 - acc: 0.8853 - val_loss: 0.3106 - val_acc: 0.8716
Epoch 24/30
 - 130s - loss: 0.2814 - acc: 0.8863 - val_loss: 0.2910 - val_acc: 0.8838
Epoch 25/30
 - 130s - loss: 0.2826 - acc: 0.8860 - val_loss: 0.2817 - val_acc: 0.8847
Epoch 26/30
 - 130s - loss: 0.2788 - acc: 0.8870 - val_loss: 0.2912 - val_acc: 0.8803
Epoch 27/30
 - 130s - loss: 0.2761 - acc: 0.8885 - val_loss: 0.2780 - val_acc: 0.8860
Epoch 28/30
 - 130s - loss: 0.2755 - acc: 0.8878 - val_loss: 0.2860 - val_acc: 0.8814
Epoch 29/30
 - 130s - loss: 0.2716 - acc: 0.8902 - val_loss: 0.3208 - val_acc: 0.8682
Epoch 30/30
 - 130s - loss: 0.2715 - acc: 0.8919 - val_loss: 0.2752 - val_acc: 0.8878

  32/7968 [..............................] - ETA: 10s
  96/7968 [..............................] - ETA: 9s 
 160/7968 [..............................] - ETA: 9s
 224/7968 [..............................] - ETA: 9s
 288/7968 [>.............................] - ETA: 9s
 352/7968 [>.............................] - ETA: 9s
 416/7968 [>.............................] - ETA: 9s
 480/7968 [>.............................] - ETA: 9s
 544/7968 [=>............................] - ETA: 9s
 608/7968 [=>............................] - ETA: 9s
 672/7968 [=>............................] - ETA: 9s
 736/7968 [=>............................] - ETA: 9s
 800/7968 [==>...........................] - ETA: 9s
 864/7968 [==>...........................] - ETA: 8s
 928/7968 [==>...........................] - ETA: 8s
 992/7968 [==>...........................] - ETA: 8s
1056/7968 [==>...........................] - ETA: 8s
1120/7968 [===>..........................] - ETA: 8s
1184/7968 [===>..........................] - ETA: 8s
1248/7968 [===>..........................] - ETA: 8s
1312/7968 [===>..........................] - ETA: 8s
1376/7968 [====>.........................] - ETA: 8s
1440/7968 [====>.........................] - ETA: 8s
1504/7968 [====>.........................] - ETA: 8s
1568/7968 [====>.........................] - ETA: 8s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 7s
1760/7968 [=====>........................] - ETA: 7s
1824/7968 [=====>........................] - ETA: 7s
1888/7968 [======>.......................] - ETA: 7s
1952/7968 [======>.......................] - ETA: 7s
2016/7968 [======>.......................] - ETA: 7s
2080/7968 [======>.......................] - ETA: 7s
2144/7968 [=======>......................] - ETA: 7s
2208/7968 [=======>......................] - ETA: 7s
2272/7968 [=======>......................] - ETA: 7s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 6s
2528/7968 [========>.....................] - ETA: 6s
2592/7968 [========>.....................] - ETA: 6s
2656/7968 [=========>....................] - ETA: 6s
2720/7968 [=========>....................] - ETA: 6s
2784/7968 [=========>....................] - ETA: 6s
2848/7968 [=========>....................] - ETA: 6s
2912/7968 [=========>....................] - ETA: 6s
2976/7968 [==========>...................] - ETA: 6s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 5s
3296/7968 [===========>..................] - ETA: 5s
3360/7968 [===========>..................] - ETA: 5s
3424/7968 [===========>..................] - ETA: 5s
3488/7968 [============>.................] - ETA: 5s
3552/7968 [============>.................] - ETA: 5s
3616/7968 [============>.................] - ETA: 5s
3680/7968 [============>.................] - ETA: 5s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 4s
4128/7968 [==============>...............] - ETA: 4s
4192/7968 [==============>...............] - ETA: 4s
4256/7968 [===============>..............] - ETA: 4s
4320/7968 [===============>..............] - ETA: 4s
4384/7968 [===============>..............] - ETA: 4s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 3s
4896/7968 [=================>............] - ETA: 3s
4960/7968 [=================>............] - ETA: 3s
5024/7968 [=================>............] - ETA: 3s
5088/7968 [==================>...........] - ETA: 3s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 2s
5664/7968 [====================>.........] - ETA: 2s
5728/7968 [====================>.........] - ETA: 2s
5792/7968 [====================>.........] - ETA: 2s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 1s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 10s 1ms/step
current val accuracy: 0.8878012048192772
current auc_score ------------------>  0.9575626003687623
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_11 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_11[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_188 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_188[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_189 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_189[0][0]             
__________________________________________________________________________________________________
concatenate_80 (Concatenate)    (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_80[0][0]             
__________________________________________________________________________________________________
activation_190 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_190[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_191 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_191[0][0]             
__________________________________________________________________________________________________
concatenate_81 (Concatenate)    (None, 76, 96, 96)   0           concatenate_80[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_81[0][0]             
__________________________________________________________________________________________________
activation_192 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_192[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_193 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_193[0][0]             
__________________________________________________________________________________________________
concatenate_82 (Concatenate)    (None, 106, 96, 96)  0           concatenate_81[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 96, 96)  424         concatenate_82[0][0]             
__________________________________________________________________________________________________
activation_194 (Activation)     (None, 106, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 96, 96)   5618        activation_194[0][0]             
__________________________________________________________________________________________________
average_pooling2d_20 (AveragePo (None, 53, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 48, 48)   212         average_pooling2d_20[0][0]       
__________________________________________________________________________________________________
activation_195 (Activation)     (None, 53, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  6360        activation_195[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_196 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_196[0][0]             
__________________________________________________________________________________________________
concatenate_83 (Concatenate)    (None, 83, 48, 48)   0           average_pooling2d_20[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 48, 48)   332         concatenate_83[0][0]             
__________________________________________________________________________________________________
activation_197 (Activation)     (None, 83, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_197[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_198 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_198[0][0]             
__________________________________________________________________________________________________
concatenate_84 (Concatenate)    (None, 113, 48, 48)  0           concatenate_83[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_84[0][0]             
__________________________________________________________________________________________________
activation_199 (Activation)     (None, 113, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_199[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_200 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_200[0][0]             
__________________________________________________________________________________________________
concatenate_85 (Concatenate)    (None, 143, 48, 48)  0           concatenate_84[0][0]             
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 48, 48)  572         concatenate_85[0][0]             
__________________________________________________________________________________________________
activation_201 (Activation)     (None, 143, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 48, 48)   10153       activation_201[0][0]             
__________________________________________________________________________________________________
average_pooling2d_21 (AveragePo (None, 71, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 24, 24)   284         average_pooling2d_21[0][0]       
__________________________________________________________________________________________________
activation_202 (Activation)     (None, 71, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  8520        activation_202[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_203 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_203[0][0]             
__________________________________________________________________________________________________
concatenate_86 (Concatenate)    (None, 101, 24, 24)  0           average_pooling2d_21[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 24, 24)  404         concatenate_86[0][0]             
__________________________________________________________________________________________________
activation_204 (Activation)     (None, 101, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  12120       activation_204[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_205 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_205[0][0]             
__________________________________________________________________________________________________
concatenate_87 (Concatenate)    (None, 131, 24, 24)  0           concatenate_86[0][0]             
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 24, 24)  524         concatenate_87[0][0]             
__________________________________________________________________________________________________
activation_206 (Activation)     (None, 131, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  15720       activation_206[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_207 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_207[0][0]             
__________________________________________________________________________________________________
concatenate_88 (Concatenate)    (None, 161, 24, 24)  0           concatenate_87[0][0]             
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 161, 24, 24)  644         concatenate_88[0][0]             
__________________________________________________________________________________________________
activation_208 (Activation)     (None, 161, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_11 (Gl (None, 161)          0           activation_208[0][0]             
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 1)            162         global_average_pooling2d_11[0][0]
==================================================================================================
Total params: 399,341
Trainable params: 394,981
Non-trainable params: 4,360
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 80s - loss: 0.5530 - acc: 0.7617 - val_loss: 1.8629 - val_acc: 0.6040
Epoch 2/30
 - 72s - loss: 0.4587 - acc: 0.7889 - val_loss: 0.5589 - val_acc: 0.7349
Epoch 3/30
 - 72s - loss: 0.4280 - acc: 0.8082 - val_loss: 0.4509 - val_acc: 0.7987
Epoch 4/30
 - 72s - loss: 0.4085 - acc: 0.8184 - val_loss: 0.4606 - val_acc: 0.7924
Epoch 5/30
 - 72s - loss: 0.3852 - acc: 0.8346 - val_loss: 0.6489 - val_acc: 0.7166
Epoch 6/30
 - 72s - loss: 0.3681 - acc: 0.8431 - val_loss: 0.6761 - val_acc: 0.6575

Epoch 00006: ReduceLROnPlateau reducing learning rate to 0.0015811387947429827.
Epoch 7/30
 - 73s - loss: 0.3103 - acc: 0.8751 - val_loss: 0.3235 - val_acc: 0.8678
Epoch 8/30
 - 72s - loss: 0.2979 - acc: 0.8795 - val_loss: 0.3949 - val_acc: 0.8239
Epoch 9/30
 - 72s - loss: 0.2808 - acc: 0.8884 - val_loss: 0.3254 - val_acc: 0.8758
Epoch 10/30
 - 72s - loss: 0.2681 - acc: 0.8948 - val_loss: 0.2702 - val_acc: 0.8931
Epoch 11/30
 - 72s - loss: 0.2625 - acc: 0.8972 - val_loss: 0.2534 - val_acc: 0.9026
Epoch 12/30
 - 72s - loss: 0.2476 - acc: 0.9034 - val_loss: 0.3289 - val_acc: 0.8676
Epoch 13/30
 - 72s - loss: 0.2383 - acc: 0.9092 - val_loss: 0.2421 - val_acc: 0.9085
Epoch 14/30
 - 72s - loss: 0.2333 - acc: 0.9120 - val_loss: 0.3893 - val_acc: 0.8532
Epoch 15/30
 - 72s - loss: 0.2232 - acc: 0.9175 - val_loss: 0.2780 - val_acc: 0.8886
Epoch 16/30
 - 72s - loss: 0.2175 - acc: 0.9188 - val_loss: 0.3279 - val_acc: 0.8642

Epoch 00016: ReduceLROnPlateau reducing learning rate to 0.0004999999951665528.
Epoch 17/30
 - 72s - loss: 0.1868 - acc: 0.9353 - val_loss: 0.2040 - val_acc: 0.9297
Epoch 18/30
 - 73s - loss: 0.1787 - acc: 0.9376 - val_loss: 0.1966 - val_acc: 0.9278
Epoch 19/30
 - 73s - loss: 0.1718 - acc: 0.9394 - val_loss: 0.1883 - val_acc: 0.9354
Epoch 20/30
 - 73s - loss: 0.1654 - acc: 0.9411 - val_loss: 0.1801 - val_acc: 0.9374
Epoch 21/30
 - 72s - loss: 0.1610 - acc: 0.9458 - val_loss: 0.1805 - val_acc: 0.9384
Epoch 22/30
 - 72s - loss: 0.1576 - acc: 0.9457 - val_loss: 0.1772 - val_acc: 0.9394
Epoch 23/30
 - 73s - loss: 0.1544 - acc: 0.9474 - val_loss: 0.2565 - val_acc: 0.8981
Epoch 24/30
 - 73s - loss: 0.1519 - acc: 0.9493 - val_loss: 0.1727 - val_acc: 0.9381
Epoch 25/30
 - 72s - loss: 0.1521 - acc: 0.9467 - val_loss: 0.1969 - val_acc: 0.9292
Epoch 26/30
 - 72s - loss: 0.1453 - acc: 0.9503 - val_loss: 0.1818 - val_acc: 0.9361
Epoch 27/30
 - 73s - loss: 0.1408 - acc: 0.9532 - val_loss: 0.1721 - val_acc: 0.9391
Epoch 28/30
 - 72s - loss: 0.1380 - acc: 0.9535 - val_loss: 0.1719 - val_acc: 0.9413
Epoch 29/30
 - 72s - loss: 0.1331 - acc: 0.9552 - val_loss: 0.2186 - val_acc: 0.9206
Epoch 30/30
 - 73s - loss: 0.1311 - acc: 0.9567 - val_loss: 0.1647 - val_acc: 0.9421

  32/7968 [..............................] - ETA: 5s
 128/7968 [..............................] - ETA: 5s
 224/7968 [..............................] - ETA: 5s
 320/7968 [>.............................] - ETA: 5s
 416/7968 [>.............................] - ETA: 5s
 512/7968 [>.............................] - ETA: 5s
 608/7968 [=>............................] - ETA: 5s
 704/7968 [=>............................] - ETA: 5s
 800/7968 [==>...........................] - ETA: 5s
 896/7968 [==>...........................] - ETA: 5s
 992/7968 [==>...........................] - ETA: 5s
1088/7968 [===>..........................] - ETA: 4s
1184/7968 [===>..........................] - ETA: 4s
1280/7968 [===>..........................] - ETA: 4s
1376/7968 [====>.........................] - ETA: 4s
1472/7968 [====>.........................] - ETA: 4s
1568/7968 [====>.........................] - ETA: 4s
1664/7968 [=====>........................] - ETA: 4s
1760/7968 [=====>........................] - ETA: 4s
1856/7968 [=====>........................] - ETA: 4s
1952/7968 [======>.......................] - ETA: 4s
2048/7968 [======>.......................] - ETA: 4s
2144/7968 [=======>......................] - ETA: 4s
2240/7968 [=======>......................] - ETA: 4s
2336/7968 [=======>......................] - ETA: 4s
2432/7968 [========>.....................] - ETA: 3s
2528/7968 [========>.....................] - ETA: 3s
2624/7968 [========>.....................] - ETA: 3s
2720/7968 [=========>....................] - ETA: 3s
2816/7968 [=========>....................] - ETA: 3s
2912/7968 [=========>....................] - ETA: 3s
3008/7968 [==========>...................] - ETA: 3s
3104/7968 [==========>...................] - ETA: 3s
3200/7968 [===========>..................] - ETA: 3s
3296/7968 [===========>..................] - ETA: 3s
3392/7968 [===========>..................] - ETA: 3s
3488/7968 [============>.................] - ETA: 3s
3584/7968 [============>.................] - ETA: 3s
3680/7968 [============>.................] - ETA: 3s
3776/7968 [=============>................] - ETA: 3s
3872/7968 [=============>................] - ETA: 2s
3968/7968 [=============>................] - ETA: 2s
4064/7968 [==============>...............] - ETA: 2s
4160/7968 [==============>...............] - ETA: 2s
4256/7968 [===============>..............] - ETA: 2s
4352/7968 [===============>..............] - ETA: 2s
4448/7968 [===============>..............] - ETA: 2s
4544/7968 [================>.............] - ETA: 2s
4640/7968 [================>.............] - ETA: 2s
4736/7968 [================>.............] - ETA: 2s
4832/7968 [=================>............] - ETA: 2s
4928/7968 [=================>............] - ETA: 2s
5024/7968 [=================>............] - ETA: 2s
5120/7968 [==================>...........] - ETA: 2s
5216/7968 [==================>...........] - ETA: 1s
5312/7968 [===================>..........] - ETA: 1s
5408/7968 [===================>..........] - ETA: 1s
5504/7968 [===================>..........] - ETA: 1s
5600/7968 [====================>.........] - ETA: 1s
5696/7968 [====================>.........] - ETA: 1s
5792/7968 [====================>.........] - ETA: 1s
5888/7968 [=====================>........] - ETA: 1s
5984/7968 [=====================>........] - ETA: 1s
6080/7968 [=====================>........] - ETA: 1s
6176/7968 [======================>.......] - ETA: 1s
6272/7968 [======================>.......] - ETA: 1s
6368/7968 [======================>.......] - ETA: 1s
6464/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6656/7968 [========================>.....] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6848/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7040/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7232/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7616/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7808/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 6s 720us/step
current val accuracy: 0.9421435742971888
current auc_score ------------------>  0.9872348954148676
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_12 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_12[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_209 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_209[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_210 (Activation)     (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_210[0][0]             
__________________________________________________________________________________________________
concatenate_89 (Concatenate)    (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_89[0][0]             
__________________________________________________________________________________________________
activation_211 (Activation)     (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_211[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_212 (Activation)     (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_212[0][0]             
__________________________________________________________________________________________________
concatenate_90 (Concatenate)    (None, 28, 96, 96)   0           concatenate_89[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 96, 96)   112         concatenate_90[0][0]             
__________________________________________________________________________________________________
activation_213 (Activation)     (None, 28, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 96, 96)   672         activation_213[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_214 (Activation)     (None, 24, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_214[0][0]             
__________________________________________________________________________________________________
concatenate_91 (Concatenate)    (None, 34, 96, 96)   0           concatenate_90[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 34, 96, 96)   136         concatenate_91[0][0]             
__________________________________________________________________________________________________
activation_215 (Activation)     (None, 34, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 17, 96, 96)   578         activation_215[0][0]             
__________________________________________________________________________________________________
average_pooling2d_22 (AveragePo (None, 17, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 17, 48, 48)   68          average_pooling2d_22[0][0]       
__________________________________________________________________________________________________
activation_216 (Activation)     (None, 17, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   408         activation_216[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_217 (Activation)     (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_217[0][0]             
__________________________________________________________________________________________________
concatenate_92 (Concatenate)    (None, 23, 48, 48)   0           average_pooling2d_22[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 23, 48, 48)   92          concatenate_92[0][0]             
__________________________________________________________________________________________________
activation_218 (Activation)     (None, 23, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   552         activation_218[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_219 (Activation)     (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_219[0][0]             
__________________________________________________________________________________________________
concatenate_93 (Concatenate)    (None, 29, 48, 48)   0           concatenate_92[0][0]             
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 29, 48, 48)   116         concatenate_93[0][0]             
__________________________________________________________________________________________________
activation_220 (Activation)     (None, 29, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 24, 48, 48)   696         activation_220[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_221 (Activation)     (None, 24, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_221[0][0]             
__________________________________________________________________________________________________
concatenate_94 (Concatenate)    (None, 35, 48, 48)   0           concatenate_93[0][0]             
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 35, 48, 48)   140         concatenate_94[0][0]             
__________________________________________________________________________________________________
activation_222 (Activation)     (None, 35, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 17, 48, 48)   595         activation_222[0][0]             
__________________________________________________________________________________________________
average_pooling2d_23 (AveragePo (None, 17, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 17, 24, 24)   68          average_pooling2d_23[0][0]       
__________________________________________________________________________________________________
activation_223 (Activation)     (None, 17, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 24, 24, 24)   408         activation_223[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_224 (Activation)     (None, 24, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_224[0][0]             
__________________________________________________________________________________________________
concatenate_95 (Concatenate)    (None, 23, 24, 24)   0           average_pooling2d_23[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 23, 24, 24)   92          concatenate_95[0][0]             
__________________________________________________________________________________________________
activation_225 (Activation)     (None, 23, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 24, 24, 24)   552         activation_225[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_226 (Activation)     (None, 24, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_226[0][0]             
__________________________________________________________________________________________________
concatenate_96 (Concatenate)    (None, 29, 24, 24)   0           concatenate_95[0][0]             
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 29, 24, 24)   116         concatenate_96[0][0]             
__________________________________________________________________________________________________
activation_227 (Activation)     (None, 29, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 24, 24, 24)   696         activation_227[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_228 (Activation)     (None, 24, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_228[0][0]             
__________________________________________________________________________________________________
concatenate_97 (Concatenate)    (None, 35, 24, 24)   0           concatenate_96[0][0]             
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 35, 24, 24)   140         concatenate_97[0][0]             
__________________________________________________________________________________________________
activation_229 (Activation)     (None, 35, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_12 (Gl (None, 35)           0           activation_229[0][0]             
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 1)            36          global_average_pooling2d_12[0][0]
==================================================================================================
Total params: 20,153
Trainable params: 19,105
Non-trainable params: 1,048
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 37s - loss: 0.5972 - acc: 0.7380 - val_loss: 0.5564 - val_acc: 0.7687
Epoch 2/30
 - 30s - loss: 0.5238 - acc: 0.7766 - val_loss: 0.5103 - val_acc: 0.7750
Epoch 3/30
 - 30s - loss: 0.4944 - acc: 0.7863 - val_loss: 0.4679 - val_acc: 0.7920
Epoch 4/30
 - 30s - loss: 0.4733 - acc: 0.7963 - val_loss: 0.5409 - val_acc: 0.7651
Epoch 5/30
 - 30s - loss: 0.4522 - acc: 0.8079 - val_loss: 0.4448 - val_acc: 0.8107
Epoch 6/30
 - 30s - loss: 0.4371 - acc: 0.8171 - val_loss: 0.4399 - val_acc: 0.8181
Epoch 7/30
 - 30s - loss: 0.4253 - acc: 0.8225 - val_loss: 0.4289 - val_acc: 0.8154
Epoch 8/30
 - 30s - loss: 0.4156 - acc: 0.8289 - val_loss: 0.4274 - val_acc: 0.8197
Epoch 9/30
 - 30s - loss: 0.4052 - acc: 0.8363 - val_loss: 0.3953 - val_acc: 0.8361
Epoch 10/30
 - 30s - loss: 0.3982 - acc: 0.8386 - val_loss: 0.3913 - val_acc: 0.8414
Epoch 11/30
 - 29s - loss: 0.3894 - acc: 0.8411 - val_loss: 0.4079 - val_acc: 0.8330
Epoch 12/30
 - 30s - loss: 0.3850 - acc: 0.8435 - val_loss: 0.3783 - val_acc: 0.8488
Epoch 13/30
 - 30s - loss: 0.3756 - acc: 0.8522 - val_loss: 0.3839 - val_acc: 0.8456
Epoch 14/30
 - 30s - loss: 0.3714 - acc: 0.8531 - val_loss: 0.3665 - val_acc: 0.8524
Epoch 15/30
 - 30s - loss: 0.3650 - acc: 0.8555 - val_loss: 0.3575 - val_acc: 0.8609
Epoch 16/30
 - 30s - loss: 0.3587 - acc: 0.8595 - val_loss: 0.4260 - val_acc: 0.8382
Epoch 17/30
 - 30s - loss: 0.3544 - acc: 0.8630 - val_loss: 0.3819 - val_acc: 0.8424
Epoch 18/30
 - 30s - loss: 0.3489 - acc: 0.8649 - val_loss: 0.3738 - val_acc: 0.8582

Epoch 00018: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 19/30
 - 30s - loss: 0.3406 - acc: 0.8716 - val_loss: 0.3361 - val_acc: 0.8717
Epoch 20/30
 - 30s - loss: 0.3365 - acc: 0.8746 - val_loss: 0.3393 - val_acc: 0.8749
Epoch 21/30
 - 30s - loss: 0.3360 - acc: 0.8729 - val_loss: 0.3344 - val_acc: 0.8758
Epoch 22/30
 - 30s - loss: 0.3303 - acc: 0.8765 - val_loss: 0.3449 - val_acc: 0.8690
Epoch 23/30
 - 30s - loss: 0.3299 - acc: 0.8777 - val_loss: 0.3394 - val_acc: 0.8722
Epoch 24/30
 - 30s - loss: 0.3302 - acc: 0.8763 - val_loss: 0.3610 - val_acc: 0.8592

Epoch 00024: ReduceLROnPlateau reducing learning rate to 9.999999259090306e-06.
Epoch 25/30
 - 30s - loss: 0.3271 - acc: 0.8777 - val_loss: 0.3275 - val_acc: 0.8771
Epoch 26/30
 - 30s - loss: 0.3264 - acc: 0.8790 - val_loss: 0.3282 - val_acc: 0.8786
Epoch 27/30
 - 30s - loss: 0.3242 - acc: 0.8800 - val_loss: 0.3258 - val_acc: 0.8786
Epoch 28/30
 - 30s - loss: 0.3254 - acc: 0.8799 - val_loss: 0.3254 - val_acc: 0.8785
Epoch 29/30
 - 30s - loss: 0.3243 - acc: 0.8802 - val_loss: 0.3258 - val_acc: 0.8791
Epoch 30/30
 - 30s - loss: 0.3255 - acc: 0.8789 - val_loss: 0.3260 - val_acc: 0.8784

  32/7968 [..............................] - ETA: 2s
 224/7968 [..............................] - ETA: 2s
 416/7968 [>.............................] - ETA: 2s
 608/7968 [=>............................] - ETA: 2s
 800/7968 [==>...........................] - ETA: 2s
 992/7968 [==>...........................] - ETA: 2s
1184/7968 [===>..........................] - ETA: 2s
1376/7968 [====>.........................] - ETA: 2s
1568/7968 [====>.........................] - ETA: 1s
1760/7968 [=====>........................] - ETA: 1s
1952/7968 [======>.......................] - ETA: 1s
2144/7968 [=======>......................] - ETA: 1s
2336/7968 [=======>......................] - ETA: 1s
2528/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2912/7968 [=========>....................] - ETA: 1s
3104/7968 [==========>...................] - ETA: 1s
3296/7968 [===========>..................] - ETA: 1s
3488/7968 [============>.................] - ETA: 1s
3680/7968 [============>.................] - ETA: 1s
3872/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 1s
4256/7968 [===============>..............] - ETA: 1s
4448/7968 [===============>..............] - ETA: 1s
4640/7968 [================>.............] - ETA: 1s
4832/7968 [=================>............] - ETA: 0s
5024/7968 [=================>............] - ETA: 0s
5216/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5600/7968 [====================>.........] - ETA: 0s
5792/7968 [====================>.........] - ETA: 0s
5984/7968 [=====================>........] - ETA: 0s
6176/7968 [======================>.......] - ETA: 0s
6368/7968 [======================>.......] - ETA: 0s
6560/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 307us/step
current val accuracy: 0.8783885542168675
current auc_score ------------------>  0.9520455947627289
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_13 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_13[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_230 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_230[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_231 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_231[0][0]             
__________________________________________________________________________________________________
concatenate_98 (Concatenate)    (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_98[0][0]             
__________________________________________________________________________________________________
activation_232 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_232[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_233 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_233[0][0]             
__________________________________________________________________________________________________
concatenate_99 (Concatenate)    (None, 76, 96, 96)   0           concatenate_98[0][0]             
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_99[0][0]             
__________________________________________________________________________________________________
activation_234 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_234[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_235 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_235[0][0]             
__________________________________________________________________________________________________
concatenate_100 (Concatenate)   (None, 106, 96, 96)  0           concatenate_99[0][0]             
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_100[0][0]            
__________________________________________________________________________________________________
activation_236 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_236[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_237 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_237[0][0]             
__________________________________________________________________________________________________
concatenate_101 (Concatenate)   (None, 136, 96, 96)  0           concatenate_100[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_101[0][0]            
__________________________________________________________________________________________________
activation_238 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_238[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_239 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_239[0][0]             
__________________________________________________________________________________________________
concatenate_102 (Concatenate)   (None, 166, 96, 96)  0           concatenate_101[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_102[0][0]            
__________________________________________________________________________________________________
activation_240 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_240[0][0]             
__________________________________________________________________________________________________
average_pooling2d_24 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_24[0][0]       
__________________________________________________________________________________________________
activation_241 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_241[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_242 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_242[0][0]             
__________________________________________________________________________________________________
concatenate_103 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_24[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_103[0][0]            
__________________________________________________________________________________________________
activation_243 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_243[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_244 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_244[0][0]             
__________________________________________________________________________________________________
concatenate_104 (Concatenate)   (None, 143, 48, 48)  0           concatenate_103[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_104[0][0]            
__________________________________________________________________________________________________
activation_245 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_245[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_246 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_246[0][0]             
__________________________________________________________________________________________________
concatenate_105 (Concatenate)   (None, 173, 48, 48)  0           concatenate_104[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_105[0][0]            
__________________________________________________________________________________________________
activation_247 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_247[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_248 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_248[0][0]             
__________________________________________________________________________________________________
concatenate_106 (Concatenate)   (None, 203, 48, 48)  0           concatenate_105[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_106[0][0]            
__________________________________________________________________________________________________
activation_249 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_249[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_250 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_250[0][0]             
__________________________________________________________________________________________________
concatenate_107 (Concatenate)   (None, 233, 48, 48)  0           concatenate_106[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_107[0][0]            
__________________________________________________________________________________________________
activation_251 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_251[0][0]             
__________________________________________________________________________________________________
average_pooling2d_25 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_25[0][0]       
__________________________________________________________________________________________________
activation_252 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_252[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_253 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_253[0][0]             
__________________________________________________________________________________________________
concatenate_108 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_25[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_108[0][0]            
__________________________________________________________________________________________________
activation_254 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_254[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_255 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_255[0][0]             
__________________________________________________________________________________________________
concatenate_109 (Concatenate)   (None, 176, 24, 24)  0           concatenate_108[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_109[0][0]            
__________________________________________________________________________________________________
activation_256 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_256[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_257 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_257[0][0]             
__________________________________________________________________________________________________
concatenate_110 (Concatenate)   (None, 206, 24, 24)  0           concatenate_109[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_110[0][0]            
__________________________________________________________________________________________________
activation_258 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_258[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_259 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_259[0][0]             
__________________________________________________________________________________________________
concatenate_111 (Concatenate)   (None, 236, 24, 24)  0           concatenate_110[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_111[0][0]            
__________________________________________________________________________________________________
activation_260 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_260[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_261 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_261[0][0]             
__________________________________________________________________________________________________
concatenate_112 (Concatenate)   (None, 266, 24, 24)  0           concatenate_111[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 266, 24, 24)  1064        concatenate_112[0][0]            
__________________________________________________________________________________________________
activation_262 (Activation)     (None, 266, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_13 (Gl (None, 266)          0           activation_262[0][0]             
__________________________________________________________________________________________________
dense_13 (Dense)                (None, 1)            267         global_average_pooling2d_13[0][0]
==================================================================================================
Total params: 782,121
Trainable params: 773,241
Non-trainable params: 8,880
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 141s - loss: 0.8565 - acc: 0.7773 - val_loss: 0.7690 - val_acc: 0.8197
Epoch 2/30
 - 131s - loss: 0.7548 - acc: 0.8277 - val_loss: 0.7149 - val_acc: 0.8508
Epoch 3/30
 - 130s - loss: 0.6954 - acc: 0.8587 - val_loss: 0.6580 - val_acc: 0.8742
Epoch 4/30
 - 130s - loss: 0.6479 - acc: 0.8798 - val_loss: 0.6177 - val_acc: 0.8929
Epoch 5/30
 - 130s - loss: 0.6078 - acc: 0.8996 - val_loss: 0.7091 - val_acc: 0.8401
Epoch 6/30
 - 130s - loss: 0.5711 - acc: 0.9134 - val_loss: 0.5764 - val_acc: 0.9036
Epoch 7/30
 - 130s - loss: 0.5415 - acc: 0.9254 - val_loss: 0.6676 - val_acc: 0.8557
Epoch 8/30
 - 131s - loss: 0.5163 - acc: 0.9361 - val_loss: 0.9134 - val_acc: 0.7536
Epoch 9/30
 - 130s - loss: 0.4956 - acc: 0.9432 - val_loss: 0.5950 - val_acc: 0.8903

Epoch 00009: ReduceLROnPlateau reducing learning rate to 1.5811387901412632e-05.
Epoch 10/30
 - 130s - loss: 0.4512 - acc: 0.9646 - val_loss: 0.4836 - val_acc: 0.9436
Epoch 11/30
 - 131s - loss: 0.4412 - acc: 0.9674 - val_loss: 0.4819 - val_acc: 0.9463
Epoch 12/30
 - 131s - loss: 0.4347 - acc: 0.9705 - val_loss: 0.5408 - val_acc: 0.9174
Epoch 13/30
 - 131s - loss: 0.4263 - acc: 0.9735 - val_loss: 0.4820 - val_acc: 0.9447
Epoch 14/30
 - 131s - loss: 0.4168 - acc: 0.9773 - val_loss: 0.4712 - val_acc: 0.9488
Epoch 15/30
 - 131s - loss: 0.4109 - acc: 0.9778 - val_loss: 0.4897 - val_acc: 0.9405
Epoch 16/30
 - 131s - loss: 0.4046 - acc: 0.9795 - val_loss: 0.4732 - val_acc: 0.9487
Epoch 17/30
 - 131s - loss: 0.4002 - acc: 0.9813 - val_loss: 0.4622 - val_acc: 0.9509
Epoch 18/30
 - 130s - loss: 0.3921 - acc: 0.9841 - val_loss: 0.4656 - val_acc: 0.9490
Epoch 19/30
 - 131s - loss: 0.3886 - acc: 0.9850 - val_loss: 0.4687 - val_acc: 0.9464
Epoch 20/30
 - 131s - loss: 0.3840 - acc: 0.9866 - val_loss: 0.4927 - val_acc: 0.9408

Epoch 00020: ReduceLROnPlateau reducing learning rate to 4.999999629545153e-06.
Epoch 21/30
 - 131s - loss: 0.3742 - acc: 0.9907 - val_loss: 0.4531 - val_acc: 0.9506
Epoch 22/30
 - 130s - loss: 0.3714 - acc: 0.9919 - val_loss: 0.4513 - val_acc: 0.9539
Epoch 23/30
 - 131s - loss: 0.3687 - acc: 0.9927 - val_loss: 0.4504 - val_acc: 0.9523
Epoch 24/30
 - 130s - loss: 0.3666 - acc: 0.9927 - val_loss: 0.4565 - val_acc: 0.9516
Epoch 25/30
 - 130s - loss: 0.3669 - acc: 0.9924 - val_loss: 0.4482 - val_acc: 0.9531
Epoch 26/30
 - 130s - loss: 0.3659 - acc: 0.9925 - val_loss: 0.4499 - val_acc: 0.9537
Epoch 27/30
 - 130s - loss: 0.3643 - acc: 0.9928 - val_loss: 0.4488 - val_acc: 0.9533
Epoch 28/30
 - 130s - loss: 0.3634 - acc: 0.9933 - val_loss: 0.4557 - val_acc: 0.9522

Epoch 00028: ReduceLROnPlateau reducing learning rate to 1.5811386463375244e-06.
Epoch 29/30
 - 130s - loss: 0.3609 - acc: 0.9940 - val_loss: 0.4498 - val_acc: 0.9531
Epoch 30/30
 - 130s - loss: 0.3588 - acc: 0.9946 - val_loss: 0.4471 - val_acc: 0.9517

  32/7968 [..............................] - ETA: 10s
  96/7968 [..............................] - ETA: 10s
 160/7968 [..............................] - ETA: 10s
 224/7968 [..............................] - ETA: 9s 
 288/7968 [>.............................] - ETA: 9s
 352/7968 [>.............................] - ETA: 9s
 416/7968 [>.............................] - ETA: 9s
 480/7968 [>.............................] - ETA: 9s
 544/7968 [=>............................] - ETA: 9s
 608/7968 [=>............................] - ETA: 9s
 672/7968 [=>............................] - ETA: 9s
 736/7968 [=>............................] - ETA: 9s
 800/7968 [==>...........................] - ETA: 9s
 864/7968 [==>...........................] - ETA: 9s
 928/7968 [==>...........................] - ETA: 9s
 992/7968 [==>...........................] - ETA: 8s
1056/7968 [==>...........................] - ETA: 8s
1120/7968 [===>..........................] - ETA: 8s
1184/7968 [===>..........................] - ETA: 8s
1248/7968 [===>..........................] - ETA: 8s
1312/7968 [===>..........................] - ETA: 8s
1376/7968 [====>.........................] - ETA: 8s
1440/7968 [====>.........................] - ETA: 8s
1504/7968 [====>.........................] - ETA: 8s
1568/7968 [====>.........................] - ETA: 8s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 7s
1824/7968 [=====>........................] - ETA: 7s
1888/7968 [======>.......................] - ETA: 7s
1952/7968 [======>.......................] - ETA: 7s
2016/7968 [======>.......................] - ETA: 7s
2080/7968 [======>.......................] - ETA: 7s
2144/7968 [=======>......................] - ETA: 7s
2208/7968 [=======>......................] - ETA: 7s
2272/7968 [=======>......................] - ETA: 7s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 6s
2592/7968 [========>.....................] - ETA: 6s
2656/7968 [=========>....................] - ETA: 6s
2720/7968 [=========>....................] - ETA: 6s
2784/7968 [=========>....................] - ETA: 6s
2848/7968 [=========>....................] - ETA: 6s
2912/7968 [=========>....................] - ETA: 6s
2976/7968 [==========>...................] - ETA: 6s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 5s
3360/7968 [===========>..................] - ETA: 5s
3424/7968 [===========>..................] - ETA: 5s
3488/7968 [============>.................] - ETA: 5s
3552/7968 [============>.................] - ETA: 5s
3616/7968 [============>.................] - ETA: 5s
3680/7968 [============>.................] - ETA: 5s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 4s
4192/7968 [==============>...............] - ETA: 4s
4256/7968 [===============>..............] - ETA: 4s
4320/7968 [===============>..............] - ETA: 4s
4384/7968 [===============>..............] - ETA: 4s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 3s
4960/7968 [=================>............] - ETA: 3s
5024/7968 [=================>............] - ETA: 3s
5088/7968 [==================>...........] - ETA: 3s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 2s
5728/7968 [====================>.........] - ETA: 2s
5792/7968 [====================>.........] - ETA: 2s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 1s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 10s 1ms/step
current val accuracy: 0.9516817269076305
current auc_score ------------------>  0.9908203221478135
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_14 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_14[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_263 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_263[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_264 (Activation)     (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_264[0][0]             
__________________________________________________________________________________________________
concatenate_113 (Concatenate)   (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_113[0][0]            
__________________________________________________________________________________________________
activation_265 (Activation)     (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_265[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_266 (Activation)     (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_266[0][0]             
__________________________________________________________________________________________________
concatenate_114 (Concatenate)   (None, 28, 96, 96)   0           concatenate_113[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 28, 96, 96)   112         concatenate_114[0][0]            
__________________________________________________________________________________________________
activation_267 (Activation)     (None, 28, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 14, 96, 96)   392         activation_267[0][0]             
__________________________________________________________________________________________________
average_pooling2d_26 (AveragePo (None, 14, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 14, 48, 48)   56          average_pooling2d_26[0][0]       
__________________________________________________________________________________________________
activation_268 (Activation)     (None, 14, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   336         activation_268[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_269 (Activation)     (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_269[0][0]             
__________________________________________________________________________________________________
concatenate_115 (Concatenate)   (None, 20, 48, 48)   0           average_pooling2d_26[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 20, 48, 48)   80          concatenate_115[0][0]            
__________________________________________________________________________________________________
activation_270 (Activation)     (None, 20, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   480         activation_270[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_271 (Activation)     (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_271[0][0]             
__________________________________________________________________________________________________
concatenate_116 (Concatenate)   (None, 26, 48, 48)   0           concatenate_115[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 26, 48, 48)   104         concatenate_116[0][0]            
__________________________________________________________________________________________________
activation_272 (Activation)     (None, 26, 48, 48)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_14 (Gl (None, 26)           0           activation_272[0][0]             
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 1)            27          global_average_pooling2d_14[0][0]
==================================================================================================
Total params: 8,507
Trainable params: 8,063
Non-trainable params: 444
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 27s - loss: 0.5715 - acc: 0.7272 - val_loss: 0.6456 - val_acc: 0.6760
Epoch 2/30
 - 20s - loss: 0.5423 - acc: 0.7456 - val_loss: 3.4197 - val_acc: 0.6485
Epoch 3/30
 - 20s - loss: 0.5346 - acc: 0.7483 - val_loss: 0.6949 - val_acc: 0.6155
Epoch 4/30
 - 20s - loss: 0.5241 - acc: 0.7553 - val_loss: 1.7712 - val_acc: 0.5043

Epoch 00004: ReduceLROnPlateau reducing learning rate to 0.015811388536449943.
Epoch 5/30
 - 20s - loss: 0.4953 - acc: 0.7658 - val_loss: 0.8275 - val_acc: 0.5786
Epoch 6/30
 - 20s - loss: 0.4842 - acc: 0.7727 - val_loss: 0.5605 - val_acc: 0.7059
Epoch 7/30
 - 20s - loss: 0.4798 - acc: 0.7759 - val_loss: 0.5335 - val_acc: 0.7471
Epoch 8/30
 - 20s - loss: 0.4794 - acc: 0.7748 - val_loss: 0.4916 - val_acc: 0.7615
Epoch 9/30
 - 20s - loss: 0.4748 - acc: 0.7787 - val_loss: 0.5213 - val_acc: 0.7402
Epoch 10/30
 - 20s - loss: 0.4700 - acc: 0.7784 - val_loss: 1.0088 - val_acc: 0.5622
Epoch 11/30
 - 20s - loss: 0.4671 - acc: 0.7814 - val_loss: 0.6541 - val_acc: 0.7318

Epoch 00011: ReduceLROnPlateau reducing learning rate to 0.0050000003198031.
Epoch 12/30
 - 20s - loss: 0.4565 - acc: 0.7834 - val_loss: 0.4653 - val_acc: 0.7866
Epoch 13/30
 - 20s - loss: 0.4534 - acc: 0.7846 - val_loss: 0.6873 - val_acc: 0.7304
Epoch 14/30
 - 20s - loss: 0.4528 - acc: 0.7858 - val_loss: 0.6748 - val_acc: 0.6574
Epoch 15/30
 - 20s - loss: 0.4504 - acc: 0.7874 - val_loss: 0.5305 - val_acc: 0.7584

Epoch 00015: ReduceLROnPlateau reducing learning rate to 0.0015811389419980114.
Epoch 16/30
 - 20s - loss: 0.4438 - acc: 0.7910 - val_loss: 0.4553 - val_acc: 0.7883
Epoch 17/30
 - 20s - loss: 0.4442 - acc: 0.7896 - val_loss: 0.4808 - val_acc: 0.7871
Epoch 18/30
 - 20s - loss: 0.4430 - acc: 0.7899 - val_loss: 0.4487 - val_acc: 0.7935
Epoch 19/30
 - 20s - loss: 0.4397 - acc: 0.7937 - val_loss: 0.8007 - val_acc: 0.6962
Epoch 20/30
 - 20s - loss: 0.4438 - acc: 0.7905 - val_loss: 0.4401 - val_acc: 0.7927
Epoch 21/30
 - 20s - loss: 0.4399 - acc: 0.7926 - val_loss: 0.4514 - val_acc: 0.7927
Epoch 22/30
 - 20s - loss: 0.4382 - acc: 0.7939 - val_loss: 0.4719 - val_acc: 0.7818
Epoch 23/30
 - 20s - loss: 0.4409 - acc: 0.7942 - val_loss: 0.4958 - val_acc: 0.7582

Epoch 00023: ReduceLROnPlateau reducing learning rate to 0.00050000003198031.
Epoch 24/30
 - 20s - loss: 0.4367 - acc: 0.7942 - val_loss: 0.4451 - val_acc: 0.7829
Epoch 25/30
 - 20s - loss: 0.4365 - acc: 0.7946 - val_loss: 0.4356 - val_acc: 0.7941
Epoch 26/30
 - 20s - loss: 0.4365 - acc: 0.7935 - val_loss: 0.4953 - val_acc: 0.7580
Epoch 27/30
 - 20s - loss: 0.4357 - acc: 0.7948 - val_loss: 0.4361 - val_acc: 0.7948
Epoch 28/30
 - 20s - loss: 0.4343 - acc: 0.7967 - val_loss: 0.5018 - val_acc: 0.7578

Epoch 00028: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 29/30
 - 20s - loss: 0.4355 - acc: 0.7956 - val_loss: 0.4316 - val_acc: 0.7983
Epoch 30/30
 - 20s - loss: 0.4328 - acc: 0.7985 - val_loss: 0.4359 - val_acc: 0.7974

  32/7968 [..............................] - ETA: 1s
 256/7968 [..............................] - ETA: 1s
 480/7968 [>.............................] - ETA: 1s
 704/7968 [=>............................] - ETA: 1s
 928/7968 [==>...........................] - ETA: 1s
1152/7968 [===>..........................] - ETA: 1s
1376/7968 [====>.........................] - ETA: 1s
1600/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2048/7968 [======>.......................] - ETA: 1s
2272/7968 [=======>......................] - ETA: 1s
2496/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2944/7968 [==========>...................] - ETA: 1s
3168/7968 [==========>...................] - ETA: 1s
3392/7968 [===========>..................] - ETA: 1s
3616/7968 [============>.................] - ETA: 1s
3840/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 0s
4288/7968 [===============>..............] - ETA: 0s
4512/7968 [===============>..............] - ETA: 0s
4736/7968 [================>.............] - ETA: 0s
4960/7968 [=================>............] - ETA: 0s
5184/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5632/7968 [====================>.........] - ETA: 0s
5856/7968 [=====================>........] - ETA: 0s
6080/7968 [=====================>........] - ETA: 0s
6304/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6976/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7872/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 243us/step
current val accuracy: 0.7974397590361446
current auc_score ------------------>  0.8831678309359081
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_15 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_15[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_273 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_273[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_274 (Activation)     (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_274[0][0]             
__________________________________________________________________________________________________
concatenate_117 (Concatenate)   (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_117[0][0]            
__________________________________________________________________________________________________
activation_275 (Activation)     (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_275[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_276 (Activation)     (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_276[0][0]             
__________________________________________________________________________________________________
concatenate_118 (Concatenate)   (None, 28, 96, 96)   0           concatenate_117[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 28, 96, 96)   112         concatenate_118[0][0]            
__________________________________________________________________________________________________
activation_277 (Activation)     (None, 28, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 14, 96, 96)   392         activation_277[0][0]             
__________________________________________________________________________________________________
average_pooling2d_27 (AveragePo (None, 14, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 14, 48, 48)   56          average_pooling2d_27[0][0]       
__________________________________________________________________________________________________
activation_278 (Activation)     (None, 14, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   336         activation_278[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_279 (Activation)     (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_279[0][0]             
__________________________________________________________________________________________________
concatenate_119 (Concatenate)   (None, 20, 48, 48)   0           average_pooling2d_27[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 20, 48, 48)   80          concatenate_119[0][0]            
__________________________________________________________________________________________________
activation_280 (Activation)     (None, 20, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   480         activation_280[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_281 (Activation)     (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_281[0][0]             
__________________________________________________________________________________________________
concatenate_120 (Concatenate)   (None, 26, 48, 48)   0           concatenate_119[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 26, 48, 48)   104         concatenate_120[0][0]            
__________________________________________________________________________________________________
activation_282 (Activation)     (None, 26, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   338         activation_282[0][0]             
__________________________________________________________________________________________________
average_pooling2d_28 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_28[0][0]       
__________________________________________________________________________________________________
activation_283 (Activation)     (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 24, 24, 24)   312         activation_283[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_284 (Activation)     (None, 24, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_284[0][0]             
__________________________________________________________________________________________________
concatenate_121 (Concatenate)   (None, 19, 24, 24)   0           average_pooling2d_28[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 19, 24, 24)   76          concatenate_121[0][0]            
__________________________________________________________________________________________________
activation_285 (Activation)     (None, 19, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 24, 24, 24)   456         activation_285[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_286 (Activation)     (None, 24, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_286[0][0]             
__________________________________________________________________________________________________
concatenate_122 (Concatenate)   (None, 25, 24, 24)   0           concatenate_121[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_122[0][0]            
__________________________________________________________________________________________________
activation_287 (Activation)     (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_15 (Gl (None, 25)           0           activation_287[0][0]             
__________________________________________________________________________________________________
dense_15 (Dense)                (None, 1)            26          global_average_pooling2d_15[0][0]
==================================================================================================
Total params: 12,624
Trainable params: 11,970
Non-trainable params: 654
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 31s - loss: 0.6421 - acc: 0.6790 - val_loss: 0.5837 - val_acc: 0.7533
Epoch 2/30
 - 22s - loss: 0.5643 - acc: 0.7595 - val_loss: 0.5473 - val_acc: 0.7613
Epoch 3/30
 - 22s - loss: 0.5410 - acc: 0.7645 - val_loss: 0.5292 - val_acc: 0.7732
Epoch 4/30
 - 23s - loss: 0.5247 - acc: 0.7714 - val_loss: 0.5156 - val_acc: 0.7730
Epoch 5/30
 - 23s - loss: 0.5096 - acc: 0.7789 - val_loss: 0.4993 - val_acc: 0.7792
Epoch 6/30
 - 23s - loss: 0.4998 - acc: 0.7823 - val_loss: 0.4874 - val_acc: 0.7835
Epoch 7/30
 - 23s - loss: 0.4907 - acc: 0.7871 - val_loss: 0.4773 - val_acc: 0.7920
Epoch 8/30
 - 23s - loss: 0.4838 - acc: 0.7908 - val_loss: 0.4848 - val_acc: 0.7910
Epoch 9/30
 - 23s - loss: 0.4747 - acc: 0.7946 - val_loss: 0.4639 - val_acc: 0.7992
Epoch 10/30
 - 23s - loss: 0.4706 - acc: 0.7965 - val_loss: 0.4605 - val_acc: 0.7974
Epoch 11/30
 - 23s - loss: 0.4623 - acc: 0.7988 - val_loss: 0.4564 - val_acc: 0.7952
Epoch 12/30
 - 23s - loss: 0.4586 - acc: 0.8012 - val_loss: 0.4477 - val_acc: 0.8061
Epoch 13/30
 - 23s - loss: 0.4538 - acc: 0.8024 - val_loss: 0.4391 - val_acc: 0.8099
Epoch 14/30
 - 23s - loss: 0.4503 - acc: 0.8037 - val_loss: 0.4359 - val_acc: 0.8102
Epoch 15/30
 - 23s - loss: 0.4442 - acc: 0.8077 - val_loss: 0.4332 - val_acc: 0.8116
Epoch 16/30
 - 23s - loss: 0.4407 - acc: 0.8095 - val_loss: 0.4353 - val_acc: 0.8107
Epoch 17/30
 - 23s - loss: 0.4384 - acc: 0.8104 - val_loss: 0.4225 - val_acc: 0.8153
Epoch 18/30
 - 23s - loss: 0.4358 - acc: 0.8101 - val_loss: 0.4303 - val_acc: 0.8136
Epoch 19/30
 - 23s - loss: 0.4316 - acc: 0.8137 - val_loss: 0.4143 - val_acc: 0.8207
Epoch 20/30
 - 23s - loss: 0.4277 - acc: 0.8150 - val_loss: 0.4235 - val_acc: 0.8149
Epoch 21/30
 - 23s - loss: 0.4264 - acc: 0.8170 - val_loss: 0.4199 - val_acc: 0.8170
Epoch 22/30
 - 23s - loss: 0.4243 - acc: 0.8195 - val_loss: 0.4481 - val_acc: 0.8071

Epoch 00022: ReduceLROnPlateau reducing learning rate to 1.5811387901412632e-05.
Epoch 23/30
 - 23s - loss: 0.4181 - acc: 0.8227 - val_loss: 0.4047 - val_acc: 0.8271
Epoch 24/30
 - 23s - loss: 0.4165 - acc: 0.8234 - val_loss: 0.4034 - val_acc: 0.8274
Epoch 25/30
 - 23s - loss: 0.4176 - acc: 0.8217 - val_loss: 0.4051 - val_acc: 0.8239
Epoch 26/30
 - 22s - loss: 0.4152 - acc: 0.8243 - val_loss: 0.4015 - val_acc: 0.8307
Epoch 27/30
 - 23s - loss: 0.4135 - acc: 0.8247 - val_loss: 0.4008 - val_acc: 0.8292
Epoch 28/30
 - 23s - loss: 0.4117 - acc: 0.8245 - val_loss: 0.3998 - val_acc: 0.8299
Epoch 29/30
 - 23s - loss: 0.4115 - acc: 0.8258 - val_loss: 0.4016 - val_acc: 0.8274
Epoch 30/30
 - 23s - loss: 0.4093 - acc: 0.8283 - val_loss: 0.3987 - val_acc: 0.8287

  32/7968 [..............................] - ETA: 2s
 256/7968 [..............................] - ETA: 1s
 480/7968 [>.............................] - ETA: 1s
 704/7968 [=>............................] - ETA: 1s
 928/7968 [==>...........................] - ETA: 1s
1152/7968 [===>..........................] - ETA: 1s
1376/7968 [====>.........................] - ETA: 1s
1600/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2048/7968 [======>.......................] - ETA: 1s
2272/7968 [=======>......................] - ETA: 1s
2496/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2944/7968 [==========>...................] - ETA: 1s
3168/7968 [==========>...................] - ETA: 1s
3392/7968 [===========>..................] - ETA: 1s
3616/7968 [============>.................] - ETA: 1s
3840/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 0s
4288/7968 [===============>..............] - ETA: 0s
4512/7968 [===============>..............] - ETA: 0s
4736/7968 [================>.............] - ETA: 0s
4960/7968 [=================>............] - ETA: 0s
5184/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5632/7968 [====================>.........] - ETA: 0s
5856/7968 [=====================>........] - ETA: 0s
6080/7968 [=====================>........] - ETA: 0s
6304/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6976/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7872/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 250us/step
current val accuracy: 0.8286897590361446
current auc_score ------------------>  0.9180618218650419
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_16 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_16[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_288 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_288[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_289 (Activation)     (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_289[0][0]             
__________________________________________________________________________________________________
concatenate_123 (Concatenate)   (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_123[0][0]            
__________________________________________________________________________________________________
activation_290 (Activation)     (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_290[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_291 (Activation)     (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_291[0][0]             
__________________________________________________________________________________________________
concatenate_124 (Concatenate)   (None, 28, 96, 96)   0           concatenate_123[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 28, 96, 96)   112         concatenate_124[0][0]            
__________________________________________________________________________________________________
activation_292 (Activation)     (None, 28, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 14, 96, 96)   392         activation_292[0][0]             
__________________________________________________________________________________________________
average_pooling2d_29 (AveragePo (None, 14, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 14, 48, 48)   56          average_pooling2d_29[0][0]       
__________________________________________________________________________________________________
activation_293 (Activation)     (None, 14, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   336         activation_293[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_294 (Activation)     (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_294[0][0]             
__________________________________________________________________________________________________
concatenate_125 (Concatenate)   (None, 20, 48, 48)   0           average_pooling2d_29[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 20, 48, 48)   80          concatenate_125[0][0]            
__________________________________________________________________________________________________
activation_295 (Activation)     (None, 20, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   480         activation_295[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_296 (Activation)     (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_296[0][0]             
__________________________________________________________________________________________________
concatenate_126 (Concatenate)   (None, 26, 48, 48)   0           concatenate_125[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 26, 48, 48)   104         concatenate_126[0][0]            
__________________________________________________________________________________________________
activation_297 (Activation)     (None, 26, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 13, 48, 48)   338         activation_297[0][0]             
__________________________________________________________________________________________________
average_pooling2d_30 (AveragePo (None, 13, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 13, 24, 24)   52          average_pooling2d_30[0][0]       
__________________________________________________________________________________________________
activation_298 (Activation)     (None, 13, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 24, 24, 24)   312         activation_298[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_299 (Activation)     (None, 24, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_299[0][0]             
__________________________________________________________________________________________________
concatenate_127 (Concatenate)   (None, 19, 24, 24)   0           average_pooling2d_30[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 19, 24, 24)   76          concatenate_127[0][0]            
__________________________________________________________________________________________________
activation_300 (Activation)     (None, 19, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 24, 24, 24)   456         activation_300[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 24, 24, 24)   96          dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_301 (Activation)     (None, 24, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 6, 24, 24)    1296        activation_301[0][0]             
__________________________________________________________________________________________________
concatenate_128 (Concatenate)   (None, 25, 24, 24)   0           concatenate_127[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 25, 24, 24)   100         concatenate_128[0][0]            
__________________________________________________________________________________________________
activation_302 (Activation)     (None, 25, 24, 24)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_16 (Gl (None, 25)           0           activation_302[0][0]             
__________________________________________________________________________________________________
dense_16 (Dense)                (None, 1)            26          global_average_pooling2d_16[0][0]
==================================================================================================
Total params: 12,624
Trainable params: 11,970
Non-trainable params: 654
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 31s - loss: 0.5653 - acc: 0.7303 - val_loss: 0.5605 - val_acc: 0.7288
Epoch 2/30
 - 22s - loss: 0.5177 - acc: 0.7479 - val_loss: 0.7225 - val_acc: 0.5617
Epoch 3/30
 - 23s - loss: 0.5105 - acc: 0.7486 - val_loss: 3.6311 - val_acc: 0.5512
Epoch 4/30
 - 23s - loss: 0.5066 - acc: 0.7519 - val_loss: 1.1614 - val_acc: 0.4974

Epoch 00004: ReduceLROnPlateau reducing learning rate to 0.015811388536449943.
Epoch 5/30
 - 23s - loss: 0.4867 - acc: 0.7561 - val_loss: 0.5270 - val_acc: 0.7357
Epoch 6/30
 - 23s - loss: 0.4827 - acc: 0.7587 - val_loss: 0.5542 - val_acc: 0.7526
Epoch 7/30
 - 23s - loss: 0.4825 - acc: 0.7589 - val_loss: 0.6394 - val_acc: 0.6678
Epoch 8/30
 - 23s - loss: 0.4761 - acc: 0.7611 - val_loss: 0.6428 - val_acc: 0.6778

Epoch 00008: ReduceLROnPlateau reducing learning rate to 0.0050000003198031.
Epoch 9/30
 - 23s - loss: 0.4695 - acc: 0.7639 - val_loss: 0.5182 - val_acc: 0.7277
Epoch 10/30
 - 23s - loss: 0.4621 - acc: 0.7670 - val_loss: 0.4625 - val_acc: 0.7647
Epoch 11/30
 - 23s - loss: 0.4594 - acc: 0.7689 - val_loss: 0.7827 - val_acc: 0.6306
Epoch 12/30
 - 23s - loss: 0.4595 - acc: 0.7723 - val_loss: 0.5452 - val_acc: 0.7208
Epoch 13/30
 - 23s - loss: 0.4541 - acc: 0.7744 - val_loss: 0.4437 - val_acc: 0.7794
Epoch 14/30
 - 23s - loss: 0.4565 - acc: 0.7725 - val_loss: 0.4777 - val_acc: 0.7747
Epoch 15/30
 - 23s - loss: 0.4514 - acc: 0.7758 - val_loss: 0.5596 - val_acc: 0.7107
Epoch 16/30
 - 22s - loss: 0.4505 - acc: 0.7762 - val_loss: 0.7135 - val_acc: 0.6929

Epoch 00016: ReduceLROnPlateau reducing learning rate to 0.0015811389419980114.
Epoch 17/30
 - 23s - loss: 0.4414 - acc: 0.7799 - val_loss: 0.4418 - val_acc: 0.7781
Epoch 18/30
 - 23s - loss: 0.4413 - acc: 0.7806 - val_loss: 0.4934 - val_acc: 0.7477
Epoch 19/30
 - 23s - loss: 0.4410 - acc: 0.7824 - val_loss: 0.4536 - val_acc: 0.7657
Epoch 20/30
 - 23s - loss: 0.4382 - acc: 0.7838 - val_loss: 0.4458 - val_acc: 0.7839

Epoch 00020: ReduceLROnPlateau reducing learning rate to 0.00050000003198031.
Epoch 21/30
 - 23s - loss: 0.4352 - acc: 0.7859 - val_loss: 0.4364 - val_acc: 0.7873
Epoch 22/30
 - 23s - loss: 0.4353 - acc: 0.7815 - val_loss: 0.4260 - val_acc: 0.7888
Epoch 23/30
 - 23s - loss: 0.4337 - acc: 0.7826 - val_loss: 0.4332 - val_acc: 0.7787
Epoch 24/30
 - 23s - loss: 0.4326 - acc: 0.7846 - val_loss: 0.4253 - val_acc: 0.7844
Epoch 25/30
 - 23s - loss: 0.4330 - acc: 0.7841 - val_loss: 0.4268 - val_acc: 0.7863
Epoch 26/30
 - 23s - loss: 0.4312 - acc: 0.7839 - val_loss: 0.4503 - val_acc: 0.7681
Epoch 27/30
 - 23s - loss: 0.4311 - acc: 0.7862 - val_loss: 0.4277 - val_acc: 0.7870

Epoch 00027: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 28/30
 - 23s - loss: 0.4318 - acc: 0.7888 - val_loss: 0.4211 - val_acc: 0.7895
Epoch 29/30
 - 23s - loss: 0.4305 - acc: 0.7870 - val_loss: 0.4208 - val_acc: 0.7902
Epoch 30/30
 - 23s - loss: 0.4289 - acc: 0.7871 - val_loss: 0.4215 - val_acc: 0.7858

  32/7968 [..............................] - ETA: 2s
 256/7968 [..............................] - ETA: 1s
 480/7968 [>.............................] - ETA: 1s
 704/7968 [=>............................] - ETA: 1s
 928/7968 [==>...........................] - ETA: 1s
1152/7968 [===>..........................] - ETA: 1s
1376/7968 [====>.........................] - ETA: 1s
1600/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2048/7968 [======>.......................] - ETA: 1s
2272/7968 [=======>......................] - ETA: 1s
2496/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2944/7968 [==========>...................] - ETA: 1s
3168/7968 [==========>...................] - ETA: 1s
3392/7968 [===========>..................] - ETA: 1s
3616/7968 [============>.................] - ETA: 1s
3840/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 0s
4288/7968 [===============>..............] - ETA: 0s
4512/7968 [===============>..............] - ETA: 0s
4736/7968 [================>.............] - ETA: 0s
4960/7968 [=================>............] - ETA: 0s
5184/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5632/7968 [====================>.........] - ETA: 0s
5856/7968 [=====================>........] - ETA: 0s
6080/7968 [=====================>........] - ETA: 0s
6304/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6976/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7872/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 252us/step
current val accuracy: 0.7857680722891566
current auc_score ------------------>  0.887840680435942
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_17 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_17[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_303 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 56, 96, 96)   896         activation_303[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_304 (Activation)     (None, 56, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_304[0][0]             
__________________________________________________________________________________________________
concatenate_129 (Concatenate)   (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 30, 96, 96)   120         concatenate_129[0][0]            
__________________________________________________________________________________________________
activation_305 (Activation)     (None, 30, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 56, 96, 96)   1680        activation_305[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_306 (Activation)     (None, 56, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_306[0][0]             
__________________________________________________________________________________________________
concatenate_130 (Concatenate)   (None, 44, 96, 96)   0           concatenate_129[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 44, 96, 96)   176         concatenate_130[0][0]            
__________________________________________________________________________________________________
activation_307 (Activation)     (None, 44, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 56, 96, 96)   2464        activation_307[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_308 (Activation)     (None, 56, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_308[0][0]             
__________________________________________________________________________________________________
concatenate_131 (Concatenate)   (None, 58, 96, 96)   0           concatenate_130[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 58, 96, 96)   232         concatenate_131[0][0]            
__________________________________________________________________________________________________
activation_309 (Activation)     (None, 58, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 56, 96, 96)   3248        activation_309[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_310 (Activation)     (None, 56, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_310[0][0]             
__________________________________________________________________________________________________
concatenate_132 (Concatenate)   (None, 72, 96, 96)   0           concatenate_131[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 72, 96, 96)   288         concatenate_132[0][0]            
__________________________________________________________________________________________________
activation_311 (Activation)     (None, 72, 96, 96)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 56, 96, 96)   4032        activation_311[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_312 (Activation)     (None, 56, 96, 96)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_312[0][0]             
__________________________________________________________________________________________________
concatenate_133 (Concatenate)   (None, 86, 96, 96)   0           concatenate_132[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 86, 96, 96)   344         concatenate_133[0][0]            
__________________________________________________________________________________________________
activation_313 (Activation)     (None, 86, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 43, 96, 96)   3698        activation_313[0][0]             
__________________________________________________________________________________________________
average_pooling2d_31 (AveragePo (None, 43, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 43, 48, 48)   172         average_pooling2d_31[0][0]       
__________________________________________________________________________________________________
activation_314 (Activation)     (None, 43, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 56, 48, 48)   2408        activation_314[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_315 (Activation)     (None, 56, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_315[0][0]             
__________________________________________________________________________________________________
concatenate_134 (Concatenate)   (None, 57, 48, 48)   0           average_pooling2d_31[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 57, 48, 48)   228         concatenate_134[0][0]            
__________________________________________________________________________________________________
activation_316 (Activation)     (None, 57, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 56, 48, 48)   3192        activation_316[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_317 (Activation)     (None, 56, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_317[0][0]             
__________________________________________________________________________________________________
concatenate_135 (Concatenate)   (None, 71, 48, 48)   0           concatenate_134[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 71, 48, 48)   284         concatenate_135[0][0]            
__________________________________________________________________________________________________
activation_318 (Activation)     (None, 71, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 56, 48, 48)   3976        activation_318[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_319 (Activation)     (None, 56, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_319[0][0]             
__________________________________________________________________________________________________
concatenate_136 (Concatenate)   (None, 85, 48, 48)   0           concatenate_135[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 85, 48, 48)   340         concatenate_136[0][0]            
__________________________________________________________________________________________________
activation_320 (Activation)     (None, 85, 48, 48)   0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 56, 48, 48)   4760        activation_320[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_321 (Activation)     (None, 56, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_321[0][0]             
__________________________________________________________________________________________________
concatenate_137 (Concatenate)   (None, 99, 48, 48)   0           concatenate_136[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 99, 48, 48)   396         concatenate_137[0][0]            
__________________________________________________________________________________________________
activation_322 (Activation)     (None, 99, 48, 48)   0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 56, 48, 48)   5544        activation_322[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_323 (Activation)     (None, 56, 48, 48)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_323[0][0]             
__________________________________________________________________________________________________
concatenate_138 (Concatenate)   (None, 113, 48, 48)  0           concatenate_137[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 113, 48, 48)  452         concatenate_138[0][0]            
__________________________________________________________________________________________________
activation_324 (Activation)     (None, 113, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 56, 48, 48)   6328        activation_324[0][0]             
__________________________________________________________________________________________________
average_pooling2d_32 (AveragePo (None, 56, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 56, 24, 24)   224         average_pooling2d_32[0][0]       
__________________________________________________________________________________________________
activation_325 (Activation)     (None, 56, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 56, 24, 24)   3136        activation_325[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_326 (Activation)     (None, 56, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_326[0][0]             
__________________________________________________________________________________________________
concatenate_139 (Concatenate)   (None, 70, 24, 24)   0           average_pooling2d_32[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_139[0][0]            
__________________________________________________________________________________________________
activation_327 (Activation)     (None, 70, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 56, 24, 24)   3920        activation_327[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_328 (Activation)     (None, 56, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_328[0][0]             
__________________________________________________________________________________________________
concatenate_140 (Concatenate)   (None, 84, 24, 24)   0           concatenate_139[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 84, 24, 24)   336         concatenate_140[0][0]            
__________________________________________________________________________________________________
activation_329 (Activation)     (None, 84, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 56, 24, 24)   4704        activation_329[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_330 (Activation)     (None, 56, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_330[0][0]             
__________________________________________________________________________________________________
concatenate_141 (Concatenate)   (None, 98, 24, 24)   0           concatenate_140[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 98, 24, 24)   392         concatenate_141[0][0]            
__________________________________________________________________________________________________
activation_331 (Activation)     (None, 98, 24, 24)   0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 56, 24, 24)   5488        activation_331[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_332 (Activation)     (None, 56, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_332[0][0]             
__________________________________________________________________________________________________
concatenate_142 (Concatenate)   (None, 112, 24, 24)  0           concatenate_141[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_142[0][0]            
__________________________________________________________________________________________________
activation_333 (Activation)     (None, 112, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 56, 24, 24)   6272        activation_333[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_334 (Activation)     (None, 56, 24, 24)   0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_334[0][0]             
__________________________________________________________________________________________________
concatenate_143 (Concatenate)   (None, 126, 24, 24)  0           concatenate_142[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 126, 24, 24)  504         concatenate_143[0][0]            
__________________________________________________________________________________________________
activation_335 (Activation)     (None, 126, 24, 24)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_17 (Gl (None, 126)          0           activation_335[0][0]             
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 1)            127         global_average_pooling2d_17[0][0]
==================================================================================================
Total params: 180,641
Trainable params: 176,321
Non-trainable params: 4,320
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 87s - loss: 0.6283 - acc: 0.7204 - val_loss: 0.7292 - val_acc: 0.5005
Epoch 2/30
 - 75s - loss: 0.5380 - acc: 0.7506 - val_loss: 1.5002 - val_acc: 0.5067
Epoch 3/30
 - 75s - loss: 0.5044 - acc: 0.7651 - val_loss: 0.5824 - val_acc: 0.6936
Epoch 4/30
 - 75s - loss: 0.4977 - acc: 0.7674 - val_loss: 1.0358 - val_acc: 0.5035
Epoch 5/30
 - 75s - loss: 0.4908 - acc: 0.7699 - val_loss: 0.8340 - val_acc: 0.5035
Epoch 6/30
 - 75s - loss: 0.4831 - acc: 0.7746 - val_loss: 0.6777 - val_acc: 0.6007

Epoch 00006: ReduceLROnPlateau reducing learning rate to 0.015811388536449943.
Epoch 7/30
 - 75s - loss: 0.4610 - acc: 0.7806 - val_loss: 0.6987 - val_acc: 0.7162
Epoch 8/30
 - 75s - loss: 0.4544 - acc: 0.7847 - val_loss: 1.1952 - val_acc: 0.5036
Epoch 00008: early stopping

  32/7968 [..............................] - ETA: 5s
 128/7968 [..............................] - ETA: 5s
 224/7968 [..............................] - ETA: 5s
 320/7968 [>.............................] - ETA: 5s
 416/7968 [>.............................] - ETA: 5s
 512/7968 [>.............................] - ETA: 5s
 608/7968 [=>............................] - ETA: 5s
 704/7968 [=>............................] - ETA: 5s
 800/7968 [==>...........................] - ETA: 5s
 896/7968 [==>...........................] - ETA: 5s
 992/7968 [==>...........................] - ETA: 5s
1088/7968 [===>..........................] - ETA: 4s
1184/7968 [===>..........................] - ETA: 4s
1280/7968 [===>..........................] - ETA: 4s
1376/7968 [====>.........................] - ETA: 4s
1472/7968 [====>.........................] - ETA: 4s
1568/7968 [====>.........................] - ETA: 4s
1664/7968 [=====>........................] - ETA: 4s
1760/7968 [=====>........................] - ETA: 4s
1856/7968 [=====>........................] - ETA: 4s
1952/7968 [======>.......................] - ETA: 4s
2048/7968 [======>.......................] - ETA: 4s
2144/7968 [=======>......................] - ETA: 4s
2240/7968 [=======>......................] - ETA: 4s
2336/7968 [=======>......................] - ETA: 4s
2432/7968 [========>.....................] - ETA: 3s
2528/7968 [========>.....................] - ETA: 3s
2624/7968 [========>.....................] - ETA: 3s
2720/7968 [=========>....................] - ETA: 3s
2816/7968 [=========>....................] - ETA: 3s
2912/7968 [=========>....................] - ETA: 3s
3008/7968 [==========>...................] - ETA: 3s
3104/7968 [==========>...................] - ETA: 3s
3200/7968 [===========>..................] - ETA: 3s
3296/7968 [===========>..................] - ETA: 3s
3392/7968 [===========>..................] - ETA: 3s
3488/7968 [============>.................] - ETA: 3s
3584/7968 [============>.................] - ETA: 3s
3680/7968 [============>.................] - ETA: 3s
3776/7968 [=============>................] - ETA: 3s
3872/7968 [=============>................] - ETA: 2s
3968/7968 [=============>................] - ETA: 2s
4064/7968 [==============>...............] - ETA: 2s
4160/7968 [==============>...............] - ETA: 2s
4256/7968 [===============>..............] - ETA: 2s
4352/7968 [===============>..............] - ETA: 2s
4448/7968 [===============>..............] - ETA: 2s
4544/7968 [================>.............] - ETA: 2s
4640/7968 [================>.............] - ETA: 2s
4736/7968 [================>.............] - ETA: 2s
4832/7968 [=================>............] - ETA: 2s
4928/7968 [=================>............] - ETA: 2s
5024/7968 [=================>............] - ETA: 2s
5120/7968 [==================>...........] - ETA: 2s
5216/7968 [==================>...........] - ETA: 1s
5312/7968 [===================>..........] - ETA: 1s
5408/7968 [===================>..........] - ETA: 1s
5504/7968 [===================>..........] - ETA: 1s
5600/7968 [====================>.........] - ETA: 1s
5696/7968 [====================>.........] - ETA: 1s
5792/7968 [====================>.........] - ETA: 1s
5888/7968 [=====================>........] - ETA: 1s
5984/7968 [=====================>........] - ETA: 1s
6080/7968 [=====================>........] - ETA: 1s
6176/7968 [======================>.......] - ETA: 1s
6272/7968 [======================>.......] - ETA: 1s
6368/7968 [======================>.......] - ETA: 1s
6464/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6656/7968 [========================>.....] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6848/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7040/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7232/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7616/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7808/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 6s 719us/step
current val accuracy: 0.5036395582329317
current auc_score ------------------>  0.8158050179592667
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_18 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_18[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_336 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_336[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_337 (Activation)     (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_337[0][0]             
__________________________________________________________________________________________________
concatenate_144 (Concatenate)   (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_144[0][0]            
__________________________________________________________________________________________________
activation_338 (Activation)     (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_338[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_339 (Activation)     (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_339[0][0]             
__________________________________________________________________________________________________
concatenate_145 (Concatenate)   (None, 28, 96, 96)   0           concatenate_144[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 28, 96, 96)   112         concatenate_145[0][0]            
__________________________________________________________________________________________________
activation_340 (Activation)     (None, 28, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 14, 96, 96)   392         activation_340[0][0]             
__________________________________________________________________________________________________
average_pooling2d_33 (AveragePo (None, 14, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 14, 48, 48)   56          average_pooling2d_33[0][0]       
__________________________________________________________________________________________________
activation_341 (Activation)     (None, 14, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   336         activation_341[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_342 (Activation)     (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_342[0][0]             
__________________________________________________________________________________________________
concatenate_146 (Concatenate)   (None, 20, 48, 48)   0           average_pooling2d_33[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 20, 48, 48)   80          concatenate_146[0][0]            
__________________________________________________________________________________________________
activation_343 (Activation)     (None, 20, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   480         activation_343[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_344 (Activation)     (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_344[0][0]             
__________________________________________________________________________________________________
concatenate_147 (Concatenate)   (None, 26, 48, 48)   0           concatenate_146[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 26, 48, 48)   104         concatenate_147[0][0]            
__________________________________________________________________________________________________
activation_345 (Activation)     (None, 26, 48, 48)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_18 (Gl (None, 26)           0           activation_345[0][0]             
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 1)            27          global_average_pooling2d_18[0][0]
==================================================================================================
Total params: 8,507
Trainable params: 8,063
Non-trainable params: 444
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 30s - loss: 0.6564 - acc: 0.6585 - val_loss: 0.6138 - val_acc: 0.7233
Epoch 2/30
 - 20s - loss: 0.6007 - acc: 0.7285 - val_loss: 0.5809 - val_acc: 0.7278
Epoch 3/30
 - 20s - loss: 0.5710 - acc: 0.7416 - val_loss: 0.5613 - val_acc: 0.7395
Epoch 4/30
 - 20s - loss: 0.5568 - acc: 0.7458 - val_loss: 0.5500 - val_acc: 0.7465
Epoch 5/30
 - 20s - loss: 0.5459 - acc: 0.7508 - val_loss: 0.5386 - val_acc: 0.7516
Epoch 6/30
 - 20s - loss: 0.5370 - acc: 0.7538 - val_loss: 0.5306 - val_acc: 0.7546
Epoch 7/30
 - 20s - loss: 0.5309 - acc: 0.7542 - val_loss: 0.5235 - val_acc: 0.7578
Epoch 8/30
 - 20s - loss: 0.5241 - acc: 0.7600 - val_loss: 0.5181 - val_acc: 0.7575
Epoch 9/30
 - 20s - loss: 0.5188 - acc: 0.7626 - val_loss: 0.5116 - val_acc: 0.7610
Epoch 10/30
 - 20s - loss: 0.5118 - acc: 0.7647 - val_loss: 0.5069 - val_acc: 0.7623
Epoch 11/30
 - 20s - loss: 0.5067 - acc: 0.7688 - val_loss: 0.4981 - val_acc: 0.7690
Epoch 12/30
 - 20s - loss: 0.5012 - acc: 0.7716 - val_loss: 0.4958 - val_acc: 0.7701
Epoch 13/30
 - 20s - loss: 0.4979 - acc: 0.7701 - val_loss: 0.4936 - val_acc: 0.7716
Epoch 14/30
 - 20s - loss: 0.4936 - acc: 0.7739 - val_loss: 0.4844 - val_acc: 0.7732
Epoch 15/30
 - 20s - loss: 0.4893 - acc: 0.7751 - val_loss: 0.4816 - val_acc: 0.7752
Epoch 16/30
 - 20s - loss: 0.4846 - acc: 0.7796 - val_loss: 0.4762 - val_acc: 0.7780
Epoch 17/30
 - 20s - loss: 0.4824 - acc: 0.7815 - val_loss: 0.4753 - val_acc: 0.7816
Epoch 18/30
 - 20s - loss: 0.4796 - acc: 0.7826 - val_loss: 0.4716 - val_acc: 0.7818
Epoch 19/30
 - 21s - loss: 0.4772 - acc: 0.7824 - val_loss: 0.4691 - val_acc: 0.7833
Epoch 20/30
 - 21s - loss: 0.4736 - acc: 0.7844 - val_loss: 0.4680 - val_acc: 0.7864
Epoch 21/30
 - 21s - loss: 0.4730 - acc: 0.7848 - val_loss: 0.4621 - val_acc: 0.7861
Epoch 22/30
 - 21s - loss: 0.4697 - acc: 0.7877 - val_loss: 0.4605 - val_acc: 0.7888
Epoch 23/30
 - 21s - loss: 0.4659 - acc: 0.7888 - val_loss: 0.4697 - val_acc: 0.7834
Epoch 24/30
 - 21s - loss: 0.4648 - acc: 0.7883 - val_loss: 0.4579 - val_acc: 0.7893
Epoch 25/30
 - 21s - loss: 0.4630 - acc: 0.7910 - val_loss: 0.4538 - val_acc: 0.7934
Epoch 26/30
 - 21s - loss: 0.4598 - acc: 0.7930 - val_loss: 0.4557 - val_acc: 0.7932
Epoch 27/30
 - 21s - loss: 0.4599 - acc: 0.7907 - val_loss: 0.4532 - val_acc: 0.7971
Epoch 28/30
 - 21s - loss: 0.4565 - acc: 0.7941 - val_loss: 0.4479 - val_acc: 0.7962
Epoch 29/30
 - 20s - loss: 0.4536 - acc: 0.7955 - val_loss: 0.4460 - val_acc: 0.7987
Epoch 30/30
 - 20s - loss: 0.4529 - acc: 0.7962 - val_loss: 0.4531 - val_acc: 0.7919

  32/7968 [..............................] - ETA: 2s
 256/7968 [..............................] - ETA: 1s
 480/7968 [>.............................] - ETA: 1s
 704/7968 [=>............................] - ETA: 1s
 928/7968 [==>...........................] - ETA: 1s
1120/7968 [===>..........................] - ETA: 1s
1344/7968 [====>.........................] - ETA: 1s
1568/7968 [====>.........................] - ETA: 1s
1792/7968 [=====>........................] - ETA: 1s
2016/7968 [======>.......................] - ETA: 1s
2240/7968 [=======>......................] - ETA: 1s
2464/7968 [========>.....................] - ETA: 1s
2688/7968 [=========>....................] - ETA: 1s
2912/7968 [=========>....................] - ETA: 1s
3136/7968 [==========>...................] - ETA: 1s
3360/7968 [===========>..................] - ETA: 1s
3584/7968 [============>.................] - ETA: 1s
3808/7968 [=============>................] - ETA: 1s
4032/7968 [==============>...............] - ETA: 0s
4256/7968 [===============>..............] - ETA: 0s
4480/7968 [===============>..............] - ETA: 0s
4704/7968 [================>.............] - ETA: 0s
4928/7968 [=================>............] - ETA: 0s
5152/7968 [==================>...........] - ETA: 0s
5376/7968 [===================>..........] - ETA: 0s
5600/7968 [====================>.........] - ETA: 0s
5824/7968 [====================>.........] - ETA: 0s
6048/7968 [=====================>........] - ETA: 0s
6272/7968 [======================>.......] - ETA: 0s
6464/7968 [=======================>......] - ETA: 0s
6688/7968 [========================>.....] - ETA: 0s
6912/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7360/7968 [==========================>...] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7808/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 251us/step
current val accuracy: 0.7919176706827309
current auc_score ------------------>  0.885639340824846
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_19 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_19[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_346 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 24, 96, 96)   384         activation_346[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_347 (Activation)     (None, 24, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_347[0][0]             
__________________________________________________________________________________________________
concatenate_148 (Concatenate)   (None, 22, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 22, 96, 96)   88          concatenate_148[0][0]            
__________________________________________________________________________________________________
activation_348 (Activation)     (None, 22, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 24, 96, 96)   528         activation_348[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_349 (Activation)     (None, 24, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_349[0][0]             
__________________________________________________________________________________________________
concatenate_149 (Concatenate)   (None, 28, 96, 96)   0           concatenate_148[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 28, 96, 96)   112         concatenate_149[0][0]            
__________________________________________________________________________________________________
activation_350 (Activation)     (None, 28, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 24, 96, 96)   672         activation_350[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 24, 96, 96)   96          dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_351 (Activation)     (None, 24, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 6, 96, 96)    1296        activation_351[0][0]             
__________________________________________________________________________________________________
concatenate_150 (Concatenate)   (None, 34, 96, 96)   0           concatenate_149[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 34, 96, 96)   136         concatenate_150[0][0]            
__________________________________________________________________________________________________
activation_352 (Activation)     (None, 34, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 17, 96, 96)   578         activation_352[0][0]             
__________________________________________________________________________________________________
average_pooling2d_34 (AveragePo (None, 17, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 17, 48, 48)   68          average_pooling2d_34[0][0]       
__________________________________________________________________________________________________
activation_353 (Activation)     (None, 17, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 24, 48, 48)   408         activation_353[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_354 (Activation)     (None, 24, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_354[0][0]             
__________________________________________________________________________________________________
concatenate_151 (Concatenate)   (None, 23, 48, 48)   0           average_pooling2d_34[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 23, 48, 48)   92          concatenate_151[0][0]            
__________________________________________________________________________________________________
activation_355 (Activation)     (None, 23, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 24, 48, 48)   552         activation_355[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_356 (Activation)     (None, 24, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_356[0][0]             
__________________________________________________________________________________________________
concatenate_152 (Concatenate)   (None, 29, 48, 48)   0           concatenate_151[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 29, 48, 48)   116         concatenate_152[0][0]            
__________________________________________________________________________________________________
activation_357 (Activation)     (None, 29, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 24, 48, 48)   696         activation_357[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 24, 48, 48)   96          dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_358 (Activation)     (None, 24, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 6, 48, 48)    1296        activation_358[0][0]             
__________________________________________________________________________________________________
concatenate_153 (Concatenate)   (None, 35, 48, 48)   0           concatenate_152[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 35, 48, 48)   140         concatenate_153[0][0]            
__________________________________________________________________________________________________
activation_359 (Activation)     (None, 35, 48, 48)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_19 (Gl (None, 35)           0           activation_359[0][0]             
__________________________________________________________________________________________________
dense_19 (Dense)                (None, 1)            36          global_average_pooling2d_19[0][0]
==================================================================================================
Total params: 13,310
Trainable params: 12,614
Non-trainable params: 696
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 39s - loss: 0.6428 - acc: 0.6977 - val_loss: 0.6062 - val_acc: 0.7313
Epoch 2/30
 - 27s - loss: 0.5901 - acc: 0.7406 - val_loss: 0.5720 - val_acc: 0.7466
Epoch 3/30
 - 27s - loss: 0.5690 - acc: 0.7487 - val_loss: 0.5572 - val_acc: 0.7563
Epoch 4/30
 - 27s - loss: 0.5518 - acc: 0.7573 - val_loss: 0.5371 - val_acc: 0.7651
Epoch 5/30
 - 27s - loss: 0.5368 - acc: 0.7655 - val_loss: 0.5229 - val_acc: 0.7730
Epoch 6/30
 - 27s - loss: 0.5250 - acc: 0.7715 - val_loss: 0.5144 - val_acc: 0.7723
Epoch 7/30
 - 27s - loss: 0.5150 - acc: 0.7747 - val_loss: 0.5057 - val_acc: 0.7765
Epoch 8/30
 - 28s - loss: 0.5082 - acc: 0.7785 - val_loss: 0.4911 - val_acc: 0.7815
Epoch 9/30
 - 28s - loss: 0.4988 - acc: 0.7825 - val_loss: 0.4905 - val_acc: 0.7831
Epoch 10/30
 - 27s - loss: 0.4919 - acc: 0.7857 - val_loss: 0.5105 - val_acc: 0.7570
Epoch 11/30
 - 27s - loss: 0.4855 - acc: 0.7868 - val_loss: 0.4945 - val_acc: 0.7833
Epoch 12/30
 - 28s - loss: 0.4808 - acc: 0.7891 - val_loss: 0.4704 - val_acc: 0.7939
Epoch 13/30
 - 27s - loss: 0.4766 - acc: 0.7900 - val_loss: 0.4860 - val_acc: 0.7720
Epoch 14/30
 - 27s - loss: 0.4704 - acc: 0.7935 - val_loss: 0.4631 - val_acc: 0.7909
Epoch 15/30
 - 27s - loss: 0.4654 - acc: 0.7961 - val_loss: 0.4525 - val_acc: 0.7987
Epoch 16/30
 - 27s - loss: 0.4641 - acc: 0.7961 - val_loss: 0.4508 - val_acc: 0.7984
Epoch 17/30
 - 28s - loss: 0.4578 - acc: 0.7993 - val_loss: 0.4968 - val_acc: 0.7656
Epoch 18/30
 - 27s - loss: 0.4543 - acc: 0.8002 - val_loss: 0.4670 - val_acc: 0.7838
Epoch 19/30
 - 27s - loss: 0.4515 - acc: 0.8013 - val_loss: 0.4415 - val_acc: 0.8084
Epoch 20/30
 - 27s - loss: 0.4475 - acc: 0.8028 - val_loss: 0.4613 - val_acc: 0.7838
Epoch 21/30
 - 27s - loss: 0.4428 - acc: 0.8069 - val_loss: 0.4538 - val_acc: 0.8025
Epoch 22/30
 - 27s - loss: 0.4416 - acc: 0.8068 - val_loss: 0.4307 - val_acc: 0.8109
Epoch 23/30
 - 27s - loss: 0.4385 - acc: 0.8079 - val_loss: 0.4409 - val_acc: 0.8102
Epoch 24/30
 - 27s - loss: 0.4365 - acc: 0.8083 - val_loss: 0.4323 - val_acc: 0.8090
Epoch 25/30
 - 27s - loss: 0.4335 - acc: 0.8086 - val_loss: 0.4230 - val_acc: 0.8155
Epoch 26/30
 - 27s - loss: 0.4308 - acc: 0.8102 - val_loss: 0.4268 - val_acc: 0.8161
Epoch 27/30
 - 27s - loss: 0.4273 - acc: 0.8145 - val_loss: 0.4445 - val_acc: 0.7976
Epoch 28/30
 - 27s - loss: 0.4262 - acc: 0.8144 - val_loss: 0.4150 - val_acc: 0.8194
Epoch 29/30
 - 27s - loss: 0.4251 - acc: 0.8144 - val_loss: 0.4330 - val_acc: 0.8081
Epoch 30/30
 - 27s - loss: 0.4232 - acc: 0.8145 - val_loss: 0.4218 - val_acc: 0.8140

  32/7968 [..............................] - ETA: 2s
 192/7968 [..............................] - ETA: 2s
 352/7968 [>.............................] - ETA: 2s
 512/7968 [>.............................] - ETA: 2s
 672/7968 [=>............................] - ETA: 2s
 832/7968 [==>...........................] - ETA: 2s
 992/7968 [==>...........................] - ETA: 2s
1152/7968 [===>..........................] - ETA: 2s
1312/7968 [===>..........................] - ETA: 2s
1472/7968 [====>.........................] - ETA: 2s
1632/7968 [=====>........................] - ETA: 2s
1792/7968 [=====>........................] - ETA: 1s
1952/7968 [======>.......................] - ETA: 1s
2112/7968 [======>.......................] - ETA: 1s
2272/7968 [=======>......................] - ETA: 1s
2432/7968 [========>.....................] - ETA: 1s
2592/7968 [========>.....................] - ETA: 1s
2752/7968 [=========>....................] - ETA: 1s
2912/7968 [=========>....................] - ETA: 1s
3072/7968 [==========>...................] - ETA: 1s
3232/7968 [===========>..................] - ETA: 1s
3424/7968 [===========>..................] - ETA: 1s
3584/7968 [============>.................] - ETA: 1s
3744/7968 [=============>................] - ETA: 1s
3904/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 1s
4224/7968 [==============>...............] - ETA: 1s
4416/7968 [===============>..............] - ETA: 1s
4608/7968 [================>.............] - ETA: 1s
4768/7968 [================>.............] - ETA: 1s
4928/7968 [=================>............] - ETA: 0s
5088/7968 [==================>...........] - ETA: 0s
5248/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5568/7968 [===================>..........] - ETA: 0s
5728/7968 [====================>.........] - ETA: 0s
5888/7968 [=====================>........] - ETA: 0s
6048/7968 [=====================>........] - ETA: 0s
6208/7968 [======================>.......] - ETA: 0s
6368/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6688/7968 [========================>.....] - ETA: 0s
6848/7968 [========================>.....] - ETA: 0s
7040/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7360/7968 [==========================>...] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7680/7968 [===========================>..] - ETA: 0s
7872/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 3s 317us/step
current val accuracy: 0.8140060240963856
current auc_score ------------------>  0.9053852093870058
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_20 (InputLayer)        (None, 2, 96, 96)         0         
_________________________________________________________________
initial_conv2D (Conv2D)      (None, 16, 96, 96)        288       
_________________________________________________________________
tr_0_bn (BatchNormalization) (None, 16, 96, 96)        64        
_________________________________________________________________
activation_360 (Activation)  (None, 16, 96, 96)        0         
_________________________________________________________________
tr_0_conv2D (Conv2D)         (None, 8, 96, 96)         128       
_________________________________________________________________
average_pooling2d_35 (Averag (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_bn (BatchNormalization) (None, 8, 48, 48)         32        
_________________________________________________________________
activation_361 (Activation)  (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_conv2D (Conv2D)         (None, 4, 48, 48)         32        
_________________________________________________________________
average_pooling2d_36 (Averag (None, 4, 24, 24)         0         
_________________________________________________________________
final_bn (BatchNormalization (None, 4, 24, 24)         16        
_________________________________________________________________
activation_362 (Activation)  (None, 4, 24, 24)         0         
_________________________________________________________________
global_average_pooling2d_20  (None, 4)                 0         
_________________________________________________________________
dense_20 (Dense)             (None, 1)                 5         
=================================================================
Total params: 565
Trainable params: 509
Non-trainable params: 56
_________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 18s - loss: 0.7196 - acc: 0.4992 - val_loss: 0.7089 - val_acc: 0.5039
Epoch 2/30
 - 9s - loss: 0.7055 - acc: 0.4995 - val_loss: 0.6960 - val_acc: 0.5056
Epoch 3/30
 - 10s - loss: 0.6950 - acc: 0.5026 - val_loss: 0.6891 - val_acc: 0.5153
Epoch 4/30
 - 10s - loss: 0.6888 - acc: 0.5132 - val_loss: 0.6837 - val_acc: 0.5289
Epoch 5/30
 - 10s - loss: 0.6833 - acc: 0.5263 - val_loss: 0.6788 - val_acc: 0.5415
Epoch 6/30
 - 10s - loss: 0.6787 - acc: 0.5398 - val_loss: 0.6751 - val_acc: 0.5547
Epoch 7/30
 - 10s - loss: 0.6753 - acc: 0.5553 - val_loss: 0.6711 - val_acc: 0.5708
Epoch 8/30
 - 10s - loss: 0.6720 - acc: 0.5713 - val_loss: 0.6681 - val_acc: 0.5886
Epoch 9/30
 - 10s - loss: 0.6685 - acc: 0.5884 - val_loss: 0.6648 - val_acc: 0.6034
Epoch 10/30
 - 10s - loss: 0.6651 - acc: 0.6036 - val_loss: 0.6612 - val_acc: 0.6205
Epoch 11/30
 - 10s - loss: 0.6617 - acc: 0.6234 - val_loss: 0.6581 - val_acc: 0.6355
Epoch 12/30
 - 10s - loss: 0.6591 - acc: 0.6349 - val_loss: 0.6557 - val_acc: 0.6481
Epoch 13/30
 - 10s - loss: 0.6563 - acc: 0.6455 - val_loss: 0.6533 - val_acc: 0.6562
Epoch 14/30
 - 10s - loss: 0.6544 - acc: 0.6549 - val_loss: 0.6515 - val_acc: 0.6652
Epoch 15/30
 - 10s - loss: 0.6526 - acc: 0.6645 - val_loss: 0.6498 - val_acc: 0.6698
Epoch 16/30
 - 10s - loss: 0.6508 - acc: 0.6694 - val_loss: 0.6478 - val_acc: 0.6746
Epoch 17/30
 - 10s - loss: 0.6493 - acc: 0.6754 - val_loss: 0.6466 - val_acc: 0.6791
Epoch 18/30
 - 10s - loss: 0.6475 - acc: 0.6835 - val_loss: 0.6453 - val_acc: 0.6854
Epoch 19/30
 - 9s - loss: 0.6459 - acc: 0.6867 - val_loss: 0.6437 - val_acc: 0.6910
Epoch 20/30
 - 10s - loss: 0.6449 - acc: 0.6893 - val_loss: 0.6424 - val_acc: 0.6968
Epoch 21/30
 - 10s - loss: 0.6436 - acc: 0.6936 - val_loss: 0.6412 - val_acc: 0.6999
Epoch 22/30
 - 10s - loss: 0.6416 - acc: 0.6973 - val_loss: 0.6395 - val_acc: 0.7009
Epoch 23/30
 - 10s - loss: 0.6406 - acc: 0.6980 - val_loss: 0.6388 - val_acc: 0.7036
Epoch 24/30
 - 10s - loss: 0.6394 - acc: 0.6999 - val_loss: 0.6371 - val_acc: 0.7054
Epoch 25/30
 - 10s - loss: 0.6380 - acc: 0.7017 - val_loss: 0.6356 - val_acc: 0.7083
Epoch 26/30
 - 10s - loss: 0.6363 - acc: 0.7047 - val_loss: 0.6342 - val_acc: 0.7086
Epoch 27/30
 - 9s - loss: 0.6350 - acc: 0.7065 - val_loss: 0.6330 - val_acc: 0.7096
Epoch 28/30
 - 10s - loss: 0.6341 - acc: 0.7047 - val_loss: 0.6318 - val_acc: 0.7097
Epoch 29/30
 - 9s - loss: 0.6332 - acc: 0.7063 - val_loss: 0.6306 - val_acc: 0.7111
Epoch 30/30
 - 9s - loss: 0.6316 - acc: 0.7070 - val_loss: 0.6294 - val_acc: 0.7111

  32/7968 [..............................] - ETA: 1s
 384/7968 [>.............................] - ETA: 1s
 736/7968 [=>............................] - ETA: 1s
1088/7968 [===>..........................] - ETA: 1s
1440/7968 [====>.........................] - ETA: 0s
1792/7968 [=====>........................] - ETA: 0s
2144/7968 [=======>......................] - ETA: 0s
2496/7968 [========>.....................] - ETA: 0s
2848/7968 [=========>....................] - ETA: 0s
3200/7968 [===========>..................] - ETA: 0s
3552/7968 [============>.................] - ETA: 0s
3904/7968 [=============>................] - ETA: 0s
4256/7968 [===============>..............] - ETA: 0s
4608/7968 [================>.............] - ETA: 0s
4960/7968 [=================>............] - ETA: 0s
5312/7968 [===================>..........] - ETA: 0s
5664/7968 [====================>.........] - ETA: 0s
6016/7968 [=====================>........] - ETA: 0s
6368/7968 [======================>.......] - ETA: 0s
6720/7968 [========================>.....] - ETA: 0s
7072/7968 [=========================>....] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 1s 152us/step
current val accuracy: 0.7110943775100401
current auc_score ------------------>  0.7673975671569719
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_21 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_21[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_363 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_363[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_364 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_364[0][0]             
__________________________________________________________________________________________________
concatenate_154 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_154[0][0]            
__________________________________________________________________________________________________
activation_365 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_365[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_366 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_366[0][0]             
__________________________________________________________________________________________________
concatenate_155 (Concatenate)   (None, 76, 96, 96)   0           concatenate_154[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_155[0][0]            
__________________________________________________________________________________________________
activation_367 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_367[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_368 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_368[0][0]             
__________________________________________________________________________________________________
concatenate_156 (Concatenate)   (None, 106, 96, 96)  0           concatenate_155[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_156[0][0]            
__________________________________________________________________________________________________
activation_369 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_369[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_370 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_370[0][0]             
__________________________________________________________________________________________________
concatenate_157 (Concatenate)   (None, 136, 96, 96)  0           concatenate_156[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_157[0][0]            
__________________________________________________________________________________________________
activation_371 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_371[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_372 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_372[0][0]             
__________________________________________________________________________________________________
concatenate_158 (Concatenate)   (None, 166, 96, 96)  0           concatenate_157[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_158[0][0]            
__________________________________________________________________________________________________
activation_373 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_373[0][0]             
__________________________________________________________________________________________________
average_pooling2d_37 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_37[0][0]       
__________________________________________________________________________________________________
activation_374 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_374[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_375 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_375[0][0]             
__________________________________________________________________________________________________
concatenate_159 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_37[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_159[0][0]            
__________________________________________________________________________________________________
activation_376 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_376[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_377 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_377[0][0]             
__________________________________________________________________________________________________
concatenate_160 (Concatenate)   (None, 143, 48, 48)  0           concatenate_159[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_160[0][0]            
__________________________________________________________________________________________________
activation_378 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_378[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_379 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_379[0][0]             
__________________________________________________________________________________________________
concatenate_161 (Concatenate)   (None, 173, 48, 48)  0           concatenate_160[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_161[0][0]            
__________________________________________________________________________________________________
activation_380 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_380[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_381 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_381[0][0]             
__________________________________________________________________________________________________
concatenate_162 (Concatenate)   (None, 203, 48, 48)  0           concatenate_161[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_162[0][0]            
__________________________________________________________________________________________________
activation_382 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_382[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_383 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_383[0][0]             
__________________________________________________________________________________________________
concatenate_163 (Concatenate)   (None, 233, 48, 48)  0           concatenate_162[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_163[0][0]            
__________________________________________________________________________________________________
activation_384 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_384[0][0]             
__________________________________________________________________________________________________
average_pooling2d_38 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_38[0][0]       
__________________________________________________________________________________________________
activation_385 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_385[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_386 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_386[0][0]             
__________________________________________________________________________________________________
concatenate_164 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_38[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_164[0][0]            
__________________________________________________________________________________________________
activation_387 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_387[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_388 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_388[0][0]             
__________________________________________________________________________________________________
concatenate_165 (Concatenate)   (None, 176, 24, 24)  0           concatenate_164[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_165[0][0]            
__________________________________________________________________________________________________
activation_389 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_389[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_390 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_390[0][0]             
__________________________________________________________________________________________________
concatenate_166 (Concatenate)   (None, 206, 24, 24)  0           concatenate_165[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_166[0][0]            
__________________________________________________________________________________________________
activation_391 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_391[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_392 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_392[0][0]             
__________________________________________________________________________________________________
concatenate_167 (Concatenate)   (None, 236, 24, 24)  0           concatenate_166[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_167[0][0]            
__________________________________________________________________________________________________
activation_393 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_393[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_394 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_394[0][0]             
__________________________________________________________________________________________________
concatenate_168 (Concatenate)   (None, 266, 24, 24)  0           concatenate_167[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_168[0][0]            
__________________________________________________________________________________________________
activation_395 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_395[0][0]             
__________________________________________________________________________________________________
average_pooling2d_39 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_39[0][0]       
__________________________________________________________________________________________________
activation_396 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_396[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_397 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_397[0][0]             
__________________________________________________________________________________________________
concatenate_169 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_39[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_169[0][0]            
__________________________________________________________________________________________________
activation_398 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_398[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_399 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_399[0][0]             
__________________________________________________________________________________________________
concatenate_170 (Concatenate)   (None, 193, 12, 12)  0           concatenate_169[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_170[0][0]            
__________________________________________________________________________________________________
activation_400 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_400[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_401 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_401[0][0]             
__________________________________________________________________________________________________
concatenate_171 (Concatenate)   (None, 223, 12, 12)  0           concatenate_170[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_171[0][0]            
__________________________________________________________________________________________________
activation_402 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_402[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_403 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_403[0][0]             
__________________________________________________________________________________________________
concatenate_172 (Concatenate)   (None, 253, 12, 12)  0           concatenate_171[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_172[0][0]            
__________________________________________________________________________________________________
activation_404 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_404[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_405 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_405[0][0]             
__________________________________________________________________________________________________
concatenate_173 (Concatenate)   (None, 283, 12, 12)  0           concatenate_172[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_173[0][0]            
__________________________________________________________________________________________________
activation_406 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_21 (Gl (None, 283)          0           activation_406[0][0]             
__________________________________________________________________________________________________
dense_21 (Dense)                (None, 1)            284         global_average_pooling2d_21[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 156s - loss: 0.8138 - acc: 0.8130 - val_loss: 0.6689 - val_acc: 0.8564
Epoch 2/30
 - 139s - loss: 0.5233 - acc: 0.8986 - val_loss: 0.5025 - val_acc: 0.8888
Epoch 3/30
 - 139s - loss: 0.3841 - acc: 0.9320 - val_loss: 0.3310 - val_acc: 0.9440
Epoch 4/30
 - 139s - loss: 0.2974 - acc: 0.9524 - val_loss: 0.2716 - val_acc: 0.9561
Epoch 5/30
 - 139s - loss: 0.2439 - acc: 0.9633 - val_loss: 0.2278 - val_acc: 0.9641
Epoch 6/30
 - 139s - loss: 0.2066 - acc: 0.9708 - val_loss: 0.3188 - val_acc: 0.9255
Epoch 7/30
 - 139s - loss: 0.1798 - acc: 0.9750 - val_loss: 0.1852 - val_acc: 0.9699
Epoch 8/30
 - 139s - loss: 0.1608 - acc: 0.9781 - val_loss: 0.1533 - val_acc: 0.9789
Epoch 9/30
 - 139s - loss: 0.1496 - acc: 0.9784 - val_loss: 0.1815 - val_acc: 0.9670
Epoch 10/30
 - 139s - loss: 0.1296 - acc: 0.9834 - val_loss: 0.1662 - val_acc: 0.9675
Epoch 11/30
 - 139s - loss: 0.1237 - acc: 0.9843 - val_loss: 0.4061 - val_acc: 0.8882

Epoch 00011: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 12/30
 - 139s - loss: 0.0884 - acc: 0.9958 - val_loss: 0.0997 - val_acc: 0.9897
Epoch 13/30
 - 139s - loss: 0.0799 - acc: 0.9970 - val_loss: 0.0912 - val_acc: 0.9913
Epoch 14/30
 - 139s - loss: 0.0747 - acc: 0.9971 - val_loss: 0.1568 - val_acc: 0.9676
Epoch 15/30
 - 139s - loss: 0.0710 - acc: 0.9972 - val_loss: 0.0828 - val_acc: 0.9927
Epoch 16/30
 - 139s - loss: 0.0658 - acc: 0.9980 - val_loss: 0.0813 - val_acc: 0.9923
Epoch 17/30
 - 139s - loss: 0.0649 - acc: 0.9971 - val_loss: 0.0861 - val_acc: 0.9892
Epoch 18/30
 - 139s - loss: 0.0604 - acc: 0.9979 - val_loss: 0.0901 - val_acc: 0.9868
Epoch 19/30
 - 140s - loss: 0.0589 - acc: 0.9974 - val_loss: 0.0843 - val_acc: 0.9897

Epoch 00019: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 20/30
 - 141s - loss: 0.0536 - acc: 0.9990 - val_loss: 0.0661 - val_acc: 0.9945
Epoch 21/30
 - 139s - loss: 0.0506 - acc: 0.9997 - val_loss: 0.0620 - val_acc: 0.9951
Epoch 22/30
 - 139s - loss: 0.0492 - acc: 0.9995 - val_loss: 0.0629 - val_acc: 0.9942
Epoch 23/30
 - 139s - loss: 0.0474 - acc: 0.9997 - val_loss: 0.0625 - val_acc: 0.9937
Epoch 24/30
 - 139s - loss: 0.0455 - acc: 0.9999 - val_loss: 0.0593 - val_acc: 0.9945
Epoch 25/30
 - 139s - loss: 0.0442 - acc: 0.9997 - val_loss: 0.0571 - val_acc: 0.9957
Epoch 26/30
 - 139s - loss: 0.0431 - acc: 0.9996 - val_loss: 0.0569 - val_acc: 0.9951
Epoch 27/30
 - 139s - loss: 0.0418 - acc: 0.9996 - val_loss: 0.0560 - val_acc: 0.9954
Epoch 28/30
 - 139s - loss: 0.0400 - acc: 0.9999 - val_loss: 0.0538 - val_acc: 0.9954
Epoch 29/30
 - 139s - loss: 0.0388 - acc: 0.9998 - val_loss: 0.0554 - val_acc: 0.9942
Epoch 30/30
 - 139s - loss: 0.0388 - acc: 0.9995 - val_loss: 0.0520 - val_acc: 0.9954

  32/7968 [..............................] - ETA: 10s
  96/7968 [..............................] - ETA: 10s
 160/7968 [..............................] - ETA: 10s
 224/7968 [..............................] - ETA: 10s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 9s 
 672/7968 [=>............................] - ETA: 9s
 736/7968 [=>............................] - ETA: 9s
 800/7968 [==>...........................] - ETA: 9s
 864/7968 [==>...........................] - ETA: 9s
 928/7968 [==>...........................] - ETA: 9s
 992/7968 [==>...........................] - ETA: 9s
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 8s
1440/7968 [====>.........................] - ETA: 8s
1504/7968 [====>.........................] - ETA: 8s
1568/7968 [====>.........................] - ETA: 8s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 7s
2144/7968 [=======>......................] - ETA: 7s
2208/7968 [=======>......................] - ETA: 7s
2272/7968 [=======>......................] - ETA: 7s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 6s
2912/7968 [=========>....................] - ETA: 6s
2976/7968 [==========>...................] - ETA: 6s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 5s
3616/7968 [============>.................] - ETA: 5s
3680/7968 [============>.................] - ETA: 5s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 4s
4384/7968 [===============>..............] - ETA: 4s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 3s
5088/7968 [==================>...........] - ETA: 3s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 2s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9953564257028112
current auc_score ------------------>  0.9999004503173996
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_22 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_22[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_407 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_407[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_408 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_408[0][0]             
__________________________________________________________________________________________________
concatenate_174 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_174[0][0]            
__________________________________________________________________________________________________
activation_409 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_409[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_410 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_410[0][0]             
__________________________________________________________________________________________________
concatenate_175 (Concatenate)   (None, 76, 96, 96)   0           concatenate_174[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_175[0][0]            
__________________________________________________________________________________________________
activation_411 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_411[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_412 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_412[0][0]             
__________________________________________________________________________________________________
concatenate_176 (Concatenate)   (None, 106, 96, 96)  0           concatenate_175[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_176[0][0]            
__________________________________________________________________________________________________
activation_413 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_413[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_414 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_414[0][0]             
__________________________________________________________________________________________________
concatenate_177 (Concatenate)   (None, 136, 96, 96)  0           concatenate_176[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_177[0][0]            
__________________________________________________________________________________________________
activation_415 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_415[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_416 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_416[0][0]             
__________________________________________________________________________________________________
concatenate_178 (Concatenate)   (None, 166, 96, 96)  0           concatenate_177[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_178[0][0]            
__________________________________________________________________________________________________
activation_417 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_417[0][0]             
__________________________________________________________________________________________________
average_pooling2d_40 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_40[0][0]       
__________________________________________________________________________________________________
activation_418 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_418[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_419 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_419[0][0]             
__________________________________________________________________________________________________
concatenate_179 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_40[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_179[0][0]            
__________________________________________________________________________________________________
activation_420 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_420[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_421 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_421[0][0]             
__________________________________________________________________________________________________
concatenate_180 (Concatenate)   (None, 143, 48, 48)  0           concatenate_179[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_180[0][0]            
__________________________________________________________________________________________________
activation_422 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_422[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_423 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_423[0][0]             
__________________________________________________________________________________________________
concatenate_181 (Concatenate)   (None, 173, 48, 48)  0           concatenate_180[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_181[0][0]            
__________________________________________________________________________________________________
activation_424 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_424[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_425 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_425[0][0]             
__________________________________________________________________________________________________
concatenate_182 (Concatenate)   (None, 203, 48, 48)  0           concatenate_181[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_182[0][0]            
__________________________________________________________________________________________________
activation_426 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_426[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_427 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_427[0][0]             
__________________________________________________________________________________________________
concatenate_183 (Concatenate)   (None, 233, 48, 48)  0           concatenate_182[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_183[0][0]            
__________________________________________________________________________________________________
activation_428 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_428[0][0]             
__________________________________________________________________________________________________
average_pooling2d_41 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_41[0][0]       
__________________________________________________________________________________________________
activation_429 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_429[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_430 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_430[0][0]             
__________________________________________________________________________________________________
concatenate_184 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_41[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_184[0][0]            
__________________________________________________________________________________________________
activation_431 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_431[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_432 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_432[0][0]             
__________________________________________________________________________________________________
concatenate_185 (Concatenate)   (None, 176, 24, 24)  0           concatenate_184[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_185[0][0]            
__________________________________________________________________________________________________
activation_433 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_433[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_434 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_434[0][0]             
__________________________________________________________________________________________________
concatenate_186 (Concatenate)   (None, 206, 24, 24)  0           concatenate_185[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_186[0][0]            
__________________________________________________________________________________________________
activation_435 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_435[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_436 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_436[0][0]             
__________________________________________________________________________________________________
concatenate_187 (Concatenate)   (None, 236, 24, 24)  0           concatenate_186[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_187[0][0]            
__________________________________________________________________________________________________
activation_437 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_437[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_438 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_438[0][0]             
__________________________________________________________________________________________________
concatenate_188 (Concatenate)   (None, 266, 24, 24)  0           concatenate_187[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_188[0][0]            
__________________________________________________________________________________________________
activation_439 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_439[0][0]             
__________________________________________________________________________________________________
average_pooling2d_42 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_42[0][0]       
__________________________________________________________________________________________________
activation_440 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_440[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_441 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_441[0][0]             
__________________________________________________________________________________________________
concatenate_189 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_42[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_189[0][0]            
__________________________________________________________________________________________________
activation_442 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_442[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_443 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_443[0][0]             
__________________________________________________________________________________________________
concatenate_190 (Concatenate)   (None, 193, 12, 12)  0           concatenate_189[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_190[0][0]            
__________________________________________________________________________________________________
activation_444 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_444[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_445 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_445[0][0]             
__________________________________________________________________________________________________
concatenate_191 (Concatenate)   (None, 223, 12, 12)  0           concatenate_190[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_191[0][0]            
__________________________________________________________________________________________________
activation_446 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_446[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_447 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_447[0][0]             
__________________________________________________________________________________________________
concatenate_192 (Concatenate)   (None, 253, 12, 12)  0           concatenate_191[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_192[0][0]            
__________________________________________________________________________________________________
activation_448 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_448[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_449 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_449[0][0]             
__________________________________________________________________________________________________
concatenate_193 (Concatenate)   (None, 283, 12, 12)  0           concatenate_192[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_193[0][0]            
__________________________________________________________________________________________________
activation_450 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_22 (Gl (None, 283)          0           activation_450[0][0]             
__________________________________________________________________________________________________
dense_22 (Dense)                (None, 1)            284         global_average_pooling2d_22[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 158s - loss: 0.8233 - acc: 0.8074 - val_loss: 0.6696 - val_acc: 0.8386
Epoch 2/30
 - 139s - loss: 0.5349 - acc: 0.8873 - val_loss: 0.4873 - val_acc: 0.8926
Epoch 3/30
 - 139s - loss: 0.3963 - acc: 0.9224 - val_loss: 0.3524 - val_acc: 0.9337
Epoch 4/30
 - 139s - loss: 0.3102 - acc: 0.9426 - val_loss: 0.8257 - val_acc: 0.7952
Epoch 5/30
 - 139s - loss: 0.2566 - acc: 0.9554 - val_loss: 0.2774 - val_acc: 0.9415
Epoch 6/30
 - 139s - loss: 0.2197 - acc: 0.9639 - val_loss: 0.2365 - val_acc: 0.9556
Epoch 7/30
 - 139s - loss: 0.1910 - acc: 0.9696 - val_loss: 0.2033 - val_acc: 0.9634
Epoch 8/30
 - 139s - loss: 0.1703 - acc: 0.9738 - val_loss: 0.1769 - val_acc: 0.9713
Epoch 9/30
 - 139s - loss: 0.1500 - acc: 0.9782 - val_loss: 0.2213 - val_acc: 0.9516
Epoch 10/30
 - 139s - loss: 0.1403 - acc: 0.9798 - val_loss: 0.1797 - val_acc: 0.9655
Epoch 11/30
 - 139s - loss: 0.1375 - acc: 0.9805 - val_loss: 0.1857 - val_acc: 0.9596

Epoch 00011: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 12/30
 - 140s - loss: 0.0921 - acc: 0.9953 - val_loss: 0.1092 - val_acc: 0.9878
Epoch 13/30
 - 140s - loss: 0.0827 - acc: 0.9966 - val_loss: 0.1030 - val_acc: 0.9888
Epoch 14/30
 - 140s - loss: 0.0777 - acc: 0.9966 - val_loss: 0.1108 - val_acc: 0.9838
Epoch 15/30
 - 140s - loss: 0.0758 - acc: 0.9961 - val_loss: 0.0985 - val_acc: 0.9878
Epoch 16/30
 - 140s - loss: 0.0695 - acc: 0.9973 - val_loss: 0.0889 - val_acc: 0.9896
Epoch 17/30
 - 140s - loss: 0.0647 - acc: 0.9981 - val_loss: 0.1034 - val_acc: 0.9836
Epoch 18/30
 - 140s - loss: 0.0662 - acc: 0.9964 - val_loss: 0.0783 - val_acc: 0.9922
Epoch 19/30
 - 140s - loss: 0.0608 - acc: 0.9978 - val_loss: 0.1109 - val_acc: 0.9828
Epoch 20/30
 - 141s - loss: 0.0594 - acc: 0.9977 - val_loss: 0.0858 - val_acc: 0.9886
Epoch 21/30
 - 140s - loss: 0.0594 - acc: 0.9971 - val_loss: 0.0908 - val_acc: 0.9878

Epoch 00021: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 22/30
 - 140s - loss: 0.0525 - acc: 0.9991 - val_loss: 0.0681 - val_acc: 0.9944
Epoch 23/30
 - 140s - loss: 0.0494 - acc: 0.9998 - val_loss: 0.0697 - val_acc: 0.9930
Epoch 24/30
 - 140s - loss: 0.0478 - acc: 0.9999 - val_loss: 0.0656 - val_acc: 0.9935
Epoch 25/30
 - 139s - loss: 0.0465 - acc: 0.9998 - val_loss: 0.0666 - val_acc: 0.9928
Epoch 26/30
 - 140s - loss: 0.0461 - acc: 0.9994 - val_loss: 0.0638 - val_acc: 0.9925
Epoch 27/30
 - 140s - loss: 0.0434 - acc: 0.9999 - val_loss: 0.0607 - val_acc: 0.9941
Epoch 28/30
 - 140s - loss: 0.0421 - acc: 0.9998 - val_loss: 0.0660 - val_acc: 0.9922
Epoch 29/30
 - 140s - loss: 0.0409 - acc: 0.9998 - val_loss: 0.0604 - val_acc: 0.9937
Epoch 30/30
 - 140s - loss: 0.0398 - acc: 0.9998 - val_loss: 0.0558 - val_acc: 0.9946

  32/7968 [..............................] - ETA: 10s
  96/7968 [..............................] - ETA: 10s
 160/7968 [..............................] - ETA: 10s
 224/7968 [..............................] - ETA: 10s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 10s
 800/7968 [==>...........................] - ETA: 9s 
 864/7968 [==>...........................] - ETA: 9s
 928/7968 [==>...........................] - ETA: 9s
 992/7968 [==>...........................] - ETA: 9s
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 8s
1568/7968 [====>.........................] - ETA: 8s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 8s
2272/7968 [=======>......................] - ETA: 7s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 7s
2976/7968 [==========>...................] - ETA: 6s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 6s
3680/7968 [============>.................] - ETA: 5s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 4s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 4s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 3s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9946034136546185
current auc_score ------------------>  0.9997387135862382
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_23 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_23[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_451 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_451[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_452 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_452[0][0]             
__________________________________________________________________________________________________
concatenate_194 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_194[0][0]            
__________________________________________________________________________________________________
activation_453 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_453[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_454 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_454[0][0]             
__________________________________________________________________________________________________
concatenate_195 (Concatenate)   (None, 76, 96, 96)   0           concatenate_194[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_195[0][0]            
__________________________________________________________________________________________________
activation_455 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_455[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_456 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_456[0][0]             
__________________________________________________________________________________________________
concatenate_196 (Concatenate)   (None, 106, 96, 96)  0           concatenate_195[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_196[0][0]            
__________________________________________________________________________________________________
activation_457 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_457[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_458 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_458[0][0]             
__________________________________________________________________________________________________
concatenate_197 (Concatenate)   (None, 136, 96, 96)  0           concatenate_196[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_197[0][0]            
__________________________________________________________________________________________________
activation_459 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_459[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_460 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_460[0][0]             
__________________________________________________________________________________________________
concatenate_198 (Concatenate)   (None, 166, 96, 96)  0           concatenate_197[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_198[0][0]            
__________________________________________________________________________________________________
activation_461 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_461[0][0]             
__________________________________________________________________________________________________
average_pooling2d_43 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_43[0][0]       
__________________________________________________________________________________________________
activation_462 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_462[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_463 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_463[0][0]             
__________________________________________________________________________________________________
concatenate_199 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_43[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_199[0][0]            
__________________________________________________________________________________________________
activation_464 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_464[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_465 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_465[0][0]             
__________________________________________________________________________________________________
concatenate_200 (Concatenate)   (None, 143, 48, 48)  0           concatenate_199[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_200[0][0]            
__________________________________________________________________________________________________
activation_466 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_466[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_467 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_467[0][0]             
__________________________________________________________________________________________________
concatenate_201 (Concatenate)   (None, 173, 48, 48)  0           concatenate_200[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_201[0][0]            
__________________________________________________________________________________________________
activation_468 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_468[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_469 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_469[0][0]             
__________________________________________________________________________________________________
concatenate_202 (Concatenate)   (None, 203, 48, 48)  0           concatenate_201[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_202[0][0]            
__________________________________________________________________________________________________
activation_470 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_470[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_471 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_471[0][0]             
__________________________________________________________________________________________________
concatenate_203 (Concatenate)   (None, 233, 48, 48)  0           concatenate_202[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_203[0][0]            
__________________________________________________________________________________________________
activation_472 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_472[0][0]             
__________________________________________________________________________________________________
average_pooling2d_44 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_44[0][0]       
__________________________________________________________________________________________________
activation_473 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_473[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_474 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_474[0][0]             
__________________________________________________________________________________________________
concatenate_204 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_44[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_204[0][0]            
__________________________________________________________________________________________________
activation_475 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_475[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_476 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_476[0][0]             
__________________________________________________________________________________________________
concatenate_205 (Concatenate)   (None, 176, 24, 24)  0           concatenate_204[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_205[0][0]            
__________________________________________________________________________________________________
activation_477 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_477[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_478 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_478[0][0]             
__________________________________________________________________________________________________
concatenate_206 (Concatenate)   (None, 206, 24, 24)  0           concatenate_205[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_206[0][0]            
__________________________________________________________________________________________________
activation_479 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_479[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_480 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_480[0][0]             
__________________________________________________________________________________________________
concatenate_207 (Concatenate)   (None, 236, 24, 24)  0           concatenate_206[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_207[0][0]            
__________________________________________________________________________________________________
activation_481 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_481[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_482 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_482[0][0]             
__________________________________________________________________________________________________
concatenate_208 (Concatenate)   (None, 266, 24, 24)  0           concatenate_207[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_208[0][0]            
__________________________________________________________________________________________________
activation_483 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_483[0][0]             
__________________________________________________________________________________________________
average_pooling2d_45 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_45[0][0]       
__________________________________________________________________________________________________
activation_484 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_484[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_485 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_485[0][0]             
__________________________________________________________________________________________________
concatenate_209 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_45[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_209[0][0]            
__________________________________________________________________________________________________
activation_486 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_486[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_487 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_487[0][0]             
__________________________________________________________________________________________________
concatenate_210 (Concatenate)   (None, 193, 12, 12)  0           concatenate_209[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_210[0][0]            
__________________________________________________________________________________________________
activation_488 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_488[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_489 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_489[0][0]             
__________________________________________________________________________________________________
concatenate_211 (Concatenate)   (None, 223, 12, 12)  0           concatenate_210[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_211[0][0]            
__________________________________________________________________________________________________
activation_490 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_490[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_491 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_491[0][0]             
__________________________________________________________________________________________________
concatenate_212 (Concatenate)   (None, 253, 12, 12)  0           concatenate_211[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_212[0][0]            
__________________________________________________________________________________________________
activation_492 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_492[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_493 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_493[0][0]             
__________________________________________________________________________________________________
concatenate_213 (Concatenate)   (None, 283, 12, 12)  0           concatenate_212[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_213[0][0]            
__________________________________________________________________________________________________
activation_494 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_23 (Gl (None, 283)          0           activation_494[0][0]             
__________________________________________________________________________________________________
dense_23 (Dense)                (None, 1)            284         global_average_pooling2d_23[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 161s - loss: 0.8367 - acc: 0.8045 - val_loss: 0.6758 - val_acc: 0.8503
Epoch 2/30
 - 140s - loss: 0.5506 - acc: 0.8823 - val_loss: 0.4695 - val_acc: 0.9037
Epoch 3/30
 - 140s - loss: 0.4064 - acc: 0.9196 - val_loss: 0.3934 - val_acc: 0.9138
Epoch 4/30
 - 140s - loss: 0.3164 - acc: 0.9419 - val_loss: 0.2801 - val_acc: 0.9504
Epoch 5/30
 - 140s - loss: 0.2630 - acc: 0.9541 - val_loss: 0.2389 - val_acc: 0.9597
Epoch 6/30
 - 140s - loss: 0.2199 - acc: 0.9646 - val_loss: 0.2155 - val_acc: 0.9637
Epoch 7/30
 - 140s - loss: 0.1941 - acc: 0.9695 - val_loss: 0.1866 - val_acc: 0.9716
Epoch 8/30
 - 140s - loss: 0.1764 - acc: 0.9730 - val_loss: 0.1838 - val_acc: 0.9682
Epoch 9/30
 - 140s - loss: 0.1566 - acc: 0.9773 - val_loss: 0.2157 - val_acc: 0.9529
Epoch 10/30
 - 140s - loss: 0.1437 - acc: 0.9795 - val_loss: 0.1630 - val_acc: 0.9716
Epoch 11/30
 - 140s - loss: 0.1338 - acc: 0.9811 - val_loss: 0.1367 - val_acc: 0.9797
Epoch 12/30
 - 140s - loss: 0.1235 - acc: 0.9837 - val_loss: 0.1408 - val_acc: 0.9765
Epoch 13/30
 - 140s - loss: 0.1132 - acc: 0.9850 - val_loss: 0.1572 - val_acc: 0.9718
Epoch 14/30
 - 140s - loss: 0.1123 - acc: 0.9852 - val_loss: 0.1499 - val_acc: 0.9715

Epoch 00014: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 15/30
 - 140s - loss: 0.0804 - acc: 0.9957 - val_loss: 0.0909 - val_acc: 0.9916
Epoch 16/30
 - 140s - loss: 0.0689 - acc: 0.9984 - val_loss: 0.0841 - val_acc: 0.9922
Epoch 17/30
 - 140s - loss: 0.0684 - acc: 0.9970 - val_loss: 0.0960 - val_acc: 0.9882
Epoch 18/30
 - 140s - loss: 0.0638 - acc: 0.9976 - val_loss: 0.0887 - val_acc: 0.9897
Epoch 19/30
 - 140s - loss: 0.0607 - acc: 0.9977 - val_loss: 0.0819 - val_acc: 0.9906
Epoch 20/30
 - 140s - loss: 0.0604 - acc: 0.9968 - val_loss: 0.0814 - val_acc: 0.9898
Epoch 21/30
 - 140s - loss: 0.0537 - acc: 0.9987 - val_loss: 0.0789 - val_acc: 0.9906
Epoch 22/30
 - 140s - loss: 0.0553 - acc: 0.9973 - val_loss: 0.0824 - val_acc: 0.9902
Epoch 23/30
 - 140s - loss: 0.0530 - acc: 0.9978 - val_loss: 0.0850 - val_acc: 0.9880
Epoch 24/30
 - 140s - loss: 0.0504 - acc: 0.9975 - val_loss: 0.0837 - val_acc: 0.9882

Epoch 00024: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 25/30
 - 140s - loss: 0.0467 - acc: 0.9990 - val_loss: 0.0687 - val_acc: 0.9926
Epoch 26/30
 - 140s - loss: 0.0437 - acc: 0.9998 - val_loss: 0.0670 - val_acc: 0.9935
Epoch 27/30
 - 140s - loss: 0.0426 - acc: 0.9997 - val_loss: 0.0624 - val_acc: 0.9935
Epoch 28/30
 - 140s - loss: 0.0409 - acc: 0.9999 - val_loss: 0.0631 - val_acc: 0.9927
Epoch 29/30
 - 140s - loss: 0.0395 - acc: 0.9998 - val_loss: 0.0620 - val_acc: 0.9930
Epoch 30/30
 - 140s - loss: 0.0382 - acc: 0.9998 - val_loss: 0.0621 - val_acc: 0.9928

  32/7968 [..............................] - ETA: 10s
  96/7968 [..............................] - ETA: 10s
 160/7968 [..............................] - ETA: 10s
 224/7968 [..............................] - ETA: 10s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 9s 
 800/7968 [==>...........................] - ETA: 9s
 864/7968 [==>...........................] - ETA: 9s
 928/7968 [==>...........................] - ETA: 9s
 992/7968 [==>...........................] - ETA: 9s
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 8s
1568/7968 [====>.........................] - ETA: 8s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 7s
2272/7968 [=======>......................] - ETA: 7s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 6s
2976/7968 [==========>...................] - ETA: 6s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 5s
3680/7968 [============>.................] - ETA: 5s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 4s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 3s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 2s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9928463855421686
current auc_score ------------------>  0.9996483312952952
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_24 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_24[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_495 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_495[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_496 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_496[0][0]             
__________________________________________________________________________________________________
concatenate_214 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_214[0][0]            
__________________________________________________________________________________________________
activation_497 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_497[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_498 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_498[0][0]             
__________________________________________________________________________________________________
concatenate_215 (Concatenate)   (None, 76, 96, 96)   0           concatenate_214[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_215[0][0]            
__________________________________________________________________________________________________
activation_499 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_499[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_500 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_500[0][0]             
__________________________________________________________________________________________________
concatenate_216 (Concatenate)   (None, 106, 96, 96)  0           concatenate_215[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_216[0][0]            
__________________________________________________________________________________________________
activation_501 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_501[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_502 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_502[0][0]             
__________________________________________________________________________________________________
concatenate_217 (Concatenate)   (None, 136, 96, 96)  0           concatenate_216[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_217[0][0]            
__________________________________________________________________________________________________
activation_503 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_503[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_504 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_504[0][0]             
__________________________________________________________________________________________________
concatenate_218 (Concatenate)   (None, 166, 96, 96)  0           concatenate_217[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_218[0][0]            
__________________________________________________________________________________________________
activation_505 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_505[0][0]             
__________________________________________________________________________________________________
average_pooling2d_46 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_46[0][0]       
__________________________________________________________________________________________________
activation_506 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_506[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_507 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_507[0][0]             
__________________________________________________________________________________________________
concatenate_219 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_46[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_219[0][0]            
__________________________________________________________________________________________________
activation_508 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_508[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_509 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_509[0][0]             
__________________________________________________________________________________________________
concatenate_220 (Concatenate)   (None, 143, 48, 48)  0           concatenate_219[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_220[0][0]            
__________________________________________________________________________________________________
activation_510 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_510[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_511 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_511[0][0]             
__________________________________________________________________________________________________
concatenate_221 (Concatenate)   (None, 173, 48, 48)  0           concatenate_220[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_221[0][0]            
__________________________________________________________________________________________________
activation_512 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_512[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_513 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_513[0][0]             
__________________________________________________________________________________________________
concatenate_222 (Concatenate)   (None, 203, 48, 48)  0           concatenate_221[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_222[0][0]            
__________________________________________________________________________________________________
activation_514 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_514[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_515 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_515[0][0]             
__________________________________________________________________________________________________
concatenate_223 (Concatenate)   (None, 233, 48, 48)  0           concatenate_222[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_223[0][0]            
__________________________________________________________________________________________________
activation_516 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_516[0][0]             
__________________________________________________________________________________________________
average_pooling2d_47 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_47[0][0]       
__________________________________________________________________________________________________
activation_517 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_517[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_518 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_518[0][0]             
__________________________________________________________________________________________________
concatenate_224 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_47[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_224[0][0]            
__________________________________________________________________________________________________
activation_519 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_519[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_520 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_520[0][0]             
__________________________________________________________________________________________________
concatenate_225 (Concatenate)   (None, 176, 24, 24)  0           concatenate_224[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_225[0][0]            
__________________________________________________________________________________________________
activation_521 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_521[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_522 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_522[0][0]             
__________________________________________________________________________________________________
concatenate_226 (Concatenate)   (None, 206, 24, 24)  0           concatenate_225[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_226[0][0]            
__________________________________________________________________________________________________
activation_523 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_523[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_524 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_524[0][0]             
__________________________________________________________________________________________________
concatenate_227 (Concatenate)   (None, 236, 24, 24)  0           concatenate_226[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_227[0][0]            
__________________________________________________________________________________________________
activation_525 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_525[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_526 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_526[0][0]             
__________________________________________________________________________________________________
concatenate_228 (Concatenate)   (None, 266, 24, 24)  0           concatenate_227[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_228[0][0]            
__________________________________________________________________________________________________
activation_527 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_527[0][0]             
__________________________________________________________________________________________________
average_pooling2d_48 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_48[0][0]       
__________________________________________________________________________________________________
activation_528 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_528[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_529 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_529[0][0]             
__________________________________________________________________________________________________
concatenate_229 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_48[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_229[0][0]            
__________________________________________________________________________________________________
activation_530 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_530[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_531 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_531[0][0]             
__________________________________________________________________________________________________
concatenate_230 (Concatenate)   (None, 193, 12, 12)  0           concatenate_229[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_230[0][0]            
__________________________________________________________________________________________________
activation_532 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_532[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_533 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_533[0][0]             
__________________________________________________________________________________________________
concatenate_231 (Concatenate)   (None, 223, 12, 12)  0           concatenate_230[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_231[0][0]            
__________________________________________________________________________________________________
activation_534 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_534[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_535 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_535[0][0]             
__________________________________________________________________________________________________
concatenate_232 (Concatenate)   (None, 253, 12, 12)  0           concatenate_231[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_232[0][0]            
__________________________________________________________________________________________________
activation_536 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_536[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_537 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_537[0][0]             
__________________________________________________________________________________________________
concatenate_233 (Concatenate)   (None, 283, 12, 12)  0           concatenate_232[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_233[0][0]            
__________________________________________________________________________________________________
activation_538 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_24 (Gl (None, 283)          0           activation_538[0][0]             
__________________________________________________________________________________________________
dense_24 (Dense)                (None, 1)            284         global_average_pooling2d_24[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 162s - loss: 0.8148 - acc: 0.8189 - val_loss: 1.4071 - val_acc: 0.6156
Epoch 2/30
 - 140s - loss: 0.5377 - acc: 0.8899 - val_loss: 0.4810 - val_acc: 0.8912
Epoch 3/30
 - 140s - loss: 0.3919 - acc: 0.9267 - val_loss: 0.4859 - val_acc: 0.8758
Epoch 4/30
 - 141s - loss: 0.3067 - acc: 0.9472 - val_loss: 0.3529 - val_acc: 0.9246
Epoch 5/30
 - 141s - loss: 0.2541 - acc: 0.9575 - val_loss: 0.4001 - val_acc: 0.8995
Epoch 6/30
 - 140s - loss: 0.2103 - acc: 0.9672 - val_loss: 0.2783 - val_acc: 0.9371
Epoch 7/30
 - 140s - loss: 0.1837 - acc: 0.9722 - val_loss: 0.2417 - val_acc: 0.9463
Epoch 8/30
 - 140s - loss: 0.1652 - acc: 0.9751 - val_loss: 0.1978 - val_acc: 0.9602
Epoch 9/30
 - 140s - loss: 0.1476 - acc: 0.9793 - val_loss: 0.1710 - val_acc: 0.9700
Epoch 10/30
 - 140s - loss: 0.1394 - acc: 0.9799 - val_loss: 0.1676 - val_acc: 0.9695
Epoch 11/30
 - 140s - loss: 0.1242 - acc: 0.9836 - val_loss: 0.1288 - val_acc: 0.9824
Epoch 12/30
 - 140s - loss: 0.1213 - acc: 0.9827 - val_loss: 0.1696 - val_acc: 0.9630
Epoch 13/30
 - 140s - loss: 0.1094 - acc: 0.9858 - val_loss: 0.1260 - val_acc: 0.9809
Epoch 14/30
 - 140s - loss: 0.1038 - acc: 0.9871 - val_loss: 0.1077 - val_acc: 0.9857
Epoch 15/30
 - 140s - loss: 0.1009 - acc: 0.9865 - val_loss: 0.1036 - val_acc: 0.9866
Epoch 16/30
 - 140s - loss: 0.0951 - acc: 0.9880 - val_loss: 0.1021 - val_acc: 0.9856
Epoch 17/30
 - 140s - loss: 0.0909 - acc: 0.9886 - val_loss: 0.1432 - val_acc: 0.9714
Epoch 18/30
 - 140s - loss: 0.0848 - acc: 0.9895 - val_loss: 0.1351 - val_acc: 0.9723
Epoch 19/30
 - 140s - loss: 0.0821 - acc: 0.9908 - val_loss: 0.1309 - val_acc: 0.9738

Epoch 00019: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 20/30
 - 140s - loss: 0.0602 - acc: 0.9976 - val_loss: 0.0691 - val_acc: 0.9936
Epoch 21/30
 - 140s - loss: 0.0533 - acc: 0.9989 - val_loss: 0.0672 - val_acc: 0.9925
Epoch 22/30
 - 140s - loss: 0.0506 - acc: 0.9987 - val_loss: 0.0644 - val_acc: 0.9926
Epoch 23/30
 - 140s - loss: 0.0476 - acc: 0.9985 - val_loss: 0.0627 - val_acc: 0.9925
Epoch 24/30
 - 140s - loss: 0.0453 - acc: 0.9985 - val_loss: 0.0662 - val_acc: 0.9912
Epoch 25/30
 - 140s - loss: 0.0432 - acc: 0.9988 - val_loss: 0.0544 - val_acc: 0.9944
Epoch 26/30
 - 140s - loss: 0.0424 - acc: 0.9981 - val_loss: 0.0621 - val_acc: 0.9921
Epoch 27/30
 - 140s - loss: 0.0388 - acc: 0.9993 - val_loss: 0.0673 - val_acc: 0.9896
Epoch 28/30
 - 140s - loss: 0.0405 - acc: 0.9979 - val_loss: 0.0582 - val_acc: 0.9921

Epoch 00028: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 29/30
 - 140s - loss: 0.0356 - acc: 0.9994 - val_loss: 0.0502 - val_acc: 0.9949
Epoch 30/30
 - 140s - loss: 0.0344 - acc: 0.9997 - val_loss: 0.0473 - val_acc: 0.9952

  32/7968 [..............................] - ETA: 11s
  96/7968 [..............................] - ETA: 10s
 160/7968 [..............................] - ETA: 10s
 224/7968 [..............................] - ETA: 10s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 10s
 800/7968 [==>...........................] - ETA: 10s
 864/7968 [==>...........................] - ETA: 9s 
 928/7968 [==>...........................] - ETA: 9s
 992/7968 [==>...........................] - ETA: 9s
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 9s
1568/7968 [====>.........................] - ETA: 8s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 8s
2272/7968 [=======>......................] - ETA: 7s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 7s
2976/7968 [==========>...................] - ETA: 6s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 6s
3680/7968 [============>.................] - ETA: 5s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 5s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 4s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 3s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9952309236947792
current auc_score ------------------>  0.999849383850471
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_25 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_25[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_539 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_539[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_540 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_540[0][0]             
__________________________________________________________________________________________________
concatenate_234 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_234[0][0]            
__________________________________________________________________________________________________
activation_541 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_541[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_542 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_542[0][0]             
__________________________________________________________________________________________________
concatenate_235 (Concatenate)   (None, 76, 96, 96)   0           concatenate_234[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_235[0][0]            
__________________________________________________________________________________________________
activation_543 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_543[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_544 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_544[0][0]             
__________________________________________________________________________________________________
concatenate_236 (Concatenate)   (None, 106, 96, 96)  0           concatenate_235[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_236[0][0]            
__________________________________________________________________________________________________
activation_545 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_545[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_546 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_546[0][0]             
__________________________________________________________________________________________________
concatenate_237 (Concatenate)   (None, 136, 96, 96)  0           concatenate_236[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_237[0][0]            
__________________________________________________________________________________________________
activation_547 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_547[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_548 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_548[0][0]             
__________________________________________________________________________________________________
concatenate_238 (Concatenate)   (None, 166, 96, 96)  0           concatenate_237[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_238[0][0]            
__________________________________________________________________________________________________
activation_549 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_549[0][0]             
__________________________________________________________________________________________________
average_pooling2d_49 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_49[0][0]       
__________________________________________________________________________________________________
activation_550 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_550[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_551 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_551[0][0]             
__________________________________________________________________________________________________
concatenate_239 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_49[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_239[0][0]            
__________________________________________________________________________________________________
activation_552 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_552[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_553 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_553[0][0]             
__________________________________________________________________________________________________
concatenate_240 (Concatenate)   (None, 143, 48, 48)  0           concatenate_239[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_240[0][0]            
__________________________________________________________________________________________________
activation_554 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_554[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_555 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_555[0][0]             
__________________________________________________________________________________________________
concatenate_241 (Concatenate)   (None, 173, 48, 48)  0           concatenate_240[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_241[0][0]            
__________________________________________________________________________________________________
activation_556 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_556[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_557 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_557[0][0]             
__________________________________________________________________________________________________
concatenate_242 (Concatenate)   (None, 203, 48, 48)  0           concatenate_241[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_242[0][0]            
__________________________________________________________________________________________________
activation_558 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_558[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_559 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_559[0][0]             
__________________________________________________________________________________________________
concatenate_243 (Concatenate)   (None, 233, 48, 48)  0           concatenate_242[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_243[0][0]            
__________________________________________________________________________________________________
activation_560 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_560[0][0]             
__________________________________________________________________________________________________
average_pooling2d_50 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_50[0][0]       
__________________________________________________________________________________________________
activation_561 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_561[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_562 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_562[0][0]             
__________________________________________________________________________________________________
concatenate_244 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_50[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_244[0][0]            
__________________________________________________________________________________________________
activation_563 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_563[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_564 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_564[0][0]             
__________________________________________________________________________________________________
concatenate_245 (Concatenate)   (None, 176, 24, 24)  0           concatenate_244[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_245[0][0]            
__________________________________________________________________________________________________
activation_565 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_565[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_566 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_566[0][0]             
__________________________________________________________________________________________________
concatenate_246 (Concatenate)   (None, 206, 24, 24)  0           concatenate_245[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_246[0][0]            
__________________________________________________________________________________________________
activation_567 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_567[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_568 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_568[0][0]             
__________________________________________________________________________________________________
concatenate_247 (Concatenate)   (None, 236, 24, 24)  0           concatenate_246[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_247[0][0]            
__________________________________________________________________________________________________
activation_569 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_569[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_570 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_570[0][0]             
__________________________________________________________________________________________________
concatenate_248 (Concatenate)   (None, 266, 24, 24)  0           concatenate_247[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_248[0][0]            
__________________________________________________________________________________________________
activation_571 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_571[0][0]             
__________________________________________________________________________________________________
average_pooling2d_51 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_51[0][0]       
__________________________________________________________________________________________________
activation_572 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_572[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_573 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_573[0][0]             
__________________________________________________________________________________________________
concatenate_249 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_51[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_249[0][0]            
__________________________________________________________________________________________________
activation_574 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_574[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_575 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_575[0][0]             
__________________________________________________________________________________________________
concatenate_250 (Concatenate)   (None, 193, 12, 12)  0           concatenate_249[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_250[0][0]            
__________________________________________________________________________________________________
activation_576 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_576[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_577 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_577[0][0]             
__________________________________________________________________________________________________
concatenate_251 (Concatenate)   (None, 223, 12, 12)  0           concatenate_250[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_251[0][0]            
__________________________________________________________________________________________________
activation_578 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_578[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_579 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_579[0][0]             
__________________________________________________________________________________________________
concatenate_252 (Concatenate)   (None, 253, 12, 12)  0           concatenate_251[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_252[0][0]            
__________________________________________________________________________________________________
activation_580 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_580[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_581 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_581[0][0]             
__________________________________________________________________________________________________
concatenate_253 (Concatenate)   (None, 283, 12, 12)  0           concatenate_252[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_253[0][0]            
__________________________________________________________________________________________________
activation_582 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_25 (Gl (None, 283)          0           activation_582[0][0]             
__________________________________________________________________________________________________
dense_25 (Dense)                (None, 1)            284         global_average_pooling2d_25[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 163s - loss: 0.8234 - acc: 0.8200 - val_loss: 0.6440 - val_acc: 0.8788
Epoch 2/30
 - 140s - loss: 0.5547 - acc: 0.8892 - val_loss: 0.5030 - val_acc: 0.8948
Epoch 3/30
 - 140s - loss: 0.4129 - acc: 0.9254 - val_loss: 0.4043 - val_acc: 0.9133
Epoch 4/30
 - 141s - loss: 0.3247 - acc: 0.9438 - val_loss: 0.5075 - val_acc: 0.8869
Epoch 5/30
 - 141s - loss: 0.2626 - acc: 0.9588 - val_loss: 0.2695 - val_acc: 0.9498
Epoch 6/30
 - 140s - loss: 0.2270 - acc: 0.9642 - val_loss: 0.2667 - val_acc: 0.9473
Epoch 7/30
 - 141s - loss: 0.1965 - acc: 0.9716 - val_loss: 0.3991 - val_acc: 0.8929
Epoch 8/30
 - 141s - loss: 0.1796 - acc: 0.9733 - val_loss: 0.1852 - val_acc: 0.9685
Epoch 9/30
 - 141s - loss: 0.1547 - acc: 0.9796 - val_loss: 0.1688 - val_acc: 0.9721
Epoch 10/30
 - 141s - loss: 0.1463 - acc: 0.9802 - val_loss: 0.6445 - val_acc: 0.8194
Epoch 11/30
 - 141s - loss: 0.1345 - acc: 0.9820 - val_loss: 0.3285 - val_acc: 0.9213
Epoch 12/30
 - 141s - loss: 0.1235 - acc: 0.9838 - val_loss: 0.2163 - val_acc: 0.9487

Epoch 00012: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 13/30
 - 141s - loss: 0.0917 - acc: 0.9953 - val_loss: 0.0971 - val_acc: 0.9907
Epoch 14/30
 - 141s - loss: 0.0791 - acc: 0.9980 - val_loss: 0.0967 - val_acc: 0.9896
Epoch 15/30
 - 141s - loss: 0.0752 - acc: 0.9974 - val_loss: 0.0974 - val_acc: 0.9878
Epoch 16/30
 - 141s - loss: 0.0727 - acc: 0.9968 - val_loss: 0.0945 - val_acc: 0.9887
Epoch 17/30
 - 141s - loss: 0.0690 - acc: 0.9969 - val_loss: 0.0892 - val_acc: 0.9895
Epoch 18/30
 - 141s - loss: 0.0655 - acc: 0.9975 - val_loss: 0.0932 - val_acc: 0.9876
Epoch 19/30
 - 141s - loss: 0.0616 - acc: 0.9978 - val_loss: 0.0971 - val_acc: 0.9848
Epoch 20/30
 - 141s - loss: 0.0617 - acc: 0.9974 - val_loss: 0.0755 - val_acc: 0.9928
Epoch 21/30
 - 141s - loss: 0.0569 - acc: 0.9982 - val_loss: 0.0795 - val_acc: 0.9893
Epoch 22/30
 - 141s - loss: 0.0555 - acc: 0.9980 - val_loss: 0.0712 - val_acc: 0.9918
Epoch 23/30
 - 141s - loss: 0.0556 - acc: 0.9975 - val_loss: 0.0889 - val_acc: 0.9867
Epoch 24/30
 - 141s - loss: 0.0510 - acc: 0.9986 - val_loss: 0.0853 - val_acc: 0.9878
Epoch 25/30
 - 141s - loss: 0.0547 - acc: 0.9968 - val_loss: 0.0827 - val_acc: 0.9877

Epoch 00025: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 26/30
 - 141s - loss: 0.0459 - acc: 0.9995 - val_loss: 0.0613 - val_acc: 0.9931
Epoch 27/30
 - 141s - loss: 0.0446 - acc: 0.9998 - val_loss: 0.0601 - val_acc: 0.9942
Epoch 28/30
 - 141s - loss: 0.0431 - acc: 0.9998 - val_loss: 0.0580 - val_acc: 0.9941
Epoch 29/30
 - 141s - loss: 0.0422 - acc: 0.9996 - val_loss: 0.0590 - val_acc: 0.9939
Epoch 30/30
 - 141s - loss: 0.0407 - acc: 0.9998 - val_loss: 0.0535 - val_acc: 0.9947

  32/7968 [..............................] - ETA: 11s
  96/7968 [..............................] - ETA: 11s
 160/7968 [..............................] - ETA: 10s
 224/7968 [..............................] - ETA: 10s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 10s
 800/7968 [==>...........................] - ETA: 10s
 864/7968 [==>...........................] - ETA: 9s 
 928/7968 [==>...........................] - ETA: 9s
 992/7968 [==>...........................] - ETA: 9s
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 9s
1568/7968 [====>.........................] - ETA: 8s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 8s
2272/7968 [=======>......................] - ETA: 7s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 7s
2976/7968 [==========>...................] - ETA: 6s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 6s
3680/7968 [============>.................] - ETA: 5s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 5s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 4s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 3s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9947289156626506
current auc_score ------------------>  0.9998761299519037
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_26 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_26[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_583 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_583[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_584 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_584[0][0]             
__________________________________________________________________________________________________
concatenate_254 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_254[0][0]            
__________________________________________________________________________________________________
activation_585 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_585[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_586 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_586[0][0]             
__________________________________________________________________________________________________
concatenate_255 (Concatenate)   (None, 76, 96, 96)   0           concatenate_254[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_255[0][0]            
__________________________________________________________________________________________________
activation_587 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_587[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_588 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_588[0][0]             
__________________________________________________________________________________________________
concatenate_256 (Concatenate)   (None, 106, 96, 96)  0           concatenate_255[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_256[0][0]            
__________________________________________________________________________________________________
activation_589 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_589[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_590 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_590[0][0]             
__________________________________________________________________________________________________
concatenate_257 (Concatenate)   (None, 136, 96, 96)  0           concatenate_256[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_257[0][0]            
__________________________________________________________________________________________________
activation_591 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_591[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_592 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_592[0][0]             
__________________________________________________________________________________________________
concatenate_258 (Concatenate)   (None, 166, 96, 96)  0           concatenate_257[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_258[0][0]            
__________________________________________________________________________________________________
activation_593 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_593[0][0]             
__________________________________________________________________________________________________
average_pooling2d_52 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_52[0][0]       
__________________________________________________________________________________________________
activation_594 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_594[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_595 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_595[0][0]             
__________________________________________________________________________________________________
concatenate_259 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_52[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_259[0][0]            
__________________________________________________________________________________________________
activation_596 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_596[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_597 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_597[0][0]             
__________________________________________________________________________________________________
concatenate_260 (Concatenate)   (None, 143, 48, 48)  0           concatenate_259[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_260[0][0]            
__________________________________________________________________________________________________
activation_598 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_598[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_599 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_599[0][0]             
__________________________________________________________________________________________________
concatenate_261 (Concatenate)   (None, 173, 48, 48)  0           concatenate_260[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_261[0][0]            
__________________________________________________________________________________________________
activation_600 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_600[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_601 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_601[0][0]             
__________________________________________________________________________________________________
concatenate_262 (Concatenate)   (None, 203, 48, 48)  0           concatenate_261[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_262[0][0]            
__________________________________________________________________________________________________
activation_602 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_602[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_603 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_603[0][0]             
__________________________________________________________________________________________________
concatenate_263 (Concatenate)   (None, 233, 48, 48)  0           concatenate_262[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_263[0][0]            
__________________________________________________________________________________________________
activation_604 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_604[0][0]             
__________________________________________________________________________________________________
average_pooling2d_53 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_53[0][0]       
__________________________________________________________________________________________________
activation_605 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_605[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_606 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_606[0][0]             
__________________________________________________________________________________________________
concatenate_264 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_53[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_264[0][0]            
__________________________________________________________________________________________________
activation_607 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_607[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_608 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_608[0][0]             
__________________________________________________________________________________________________
concatenate_265 (Concatenate)   (None, 176, 24, 24)  0           concatenate_264[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_265[0][0]            
__________________________________________________________________________________________________
activation_609 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_609[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_610 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_610[0][0]             
__________________________________________________________________________________________________
concatenate_266 (Concatenate)   (None, 206, 24, 24)  0           concatenate_265[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_266[0][0]            
__________________________________________________________________________________________________
activation_611 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_611[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_612 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_612[0][0]             
__________________________________________________________________________________________________
concatenate_267 (Concatenate)   (None, 236, 24, 24)  0           concatenate_266[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_267[0][0]            
__________________________________________________________________________________________________
activation_613 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_613[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_614 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_614[0][0]             
__________________________________________________________________________________________________
concatenate_268 (Concatenate)   (None, 266, 24, 24)  0           concatenate_267[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_268[0][0]            
__________________________________________________________________________________________________
activation_615 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_615[0][0]             
__________________________________________________________________________________________________
average_pooling2d_54 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_54[0][0]       
__________________________________________________________________________________________________
activation_616 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_616[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_617 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_617[0][0]             
__________________________________________________________________________________________________
concatenate_269 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_54[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_269[0][0]            
__________________________________________________________________________________________________
activation_618 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_618[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_619 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_619[0][0]             
__________________________________________________________________________________________________
concatenate_270 (Concatenate)   (None, 193, 12, 12)  0           concatenate_269[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_270[0][0]            
__________________________________________________________________________________________________
activation_620 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_620[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_621 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_621[0][0]             
__________________________________________________________________________________________________
concatenate_271 (Concatenate)   (None, 223, 12, 12)  0           concatenate_270[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_271[0][0]            
__________________________________________________________________________________________________
activation_622 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_622[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_623 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_623[0][0]             
__________________________________________________________________________________________________
concatenate_272 (Concatenate)   (None, 253, 12, 12)  0           concatenate_271[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_272[0][0]            
__________________________________________________________________________________________________
activation_624 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_624[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_625 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_625[0][0]             
__________________________________________________________________________________________________
concatenate_273 (Concatenate)   (None, 283, 12, 12)  0           concatenate_272[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_273[0][0]            
__________________________________________________________________________________________________
activation_626 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_26 (Gl (None, 283)          0           activation_626[0][0]             
__________________________________________________________________________________________________
dense_26 (Dense)                (None, 1)            284         global_average_pooling2d_26[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 170s - loss: 0.7310 - acc: 0.8032 - val_loss: 0.7485 - val_acc: 0.7607
Epoch 2/30
 - 141s - loss: 0.4078 - acc: 0.8851 - val_loss: 0.4019 - val_acc: 0.8789
Epoch 3/30
 - 141s - loss: 0.2958 - acc: 0.9181 - val_loss: 0.2742 - val_acc: 0.9283
Epoch 4/30
 - 141s - loss: 0.2349 - acc: 0.9399 - val_loss: 0.2512 - val_acc: 0.9311
Epoch 5/30
 - 141s - loss: 0.1972 - acc: 0.9511 - val_loss: 0.2229 - val_acc: 0.9376
Epoch 6/30
 - 141s - loss: 0.1715 - acc: 0.9606 - val_loss: 0.1617 - val_acc: 0.9637
Epoch 7/30
 - 141s - loss: 0.1568 - acc: 0.9646 - val_loss: 0.1568 - val_acc: 0.9636
Epoch 8/30
 - 141s - loss: 0.1365 - acc: 0.9713 - val_loss: 0.1456 - val_acc: 0.9666
Epoch 9/30
 - 141s - loss: 0.1260 - acc: 0.9742 - val_loss: 0.1484 - val_acc: 0.9649
Epoch 10/30
 - 141s - loss: 0.1237 - acc: 0.9755 - val_loss: 0.1710 - val_acc: 0.9588
Epoch 11/30
 - 141s - loss: 0.1145 - acc: 0.9782 - val_loss: 0.1239 - val_acc: 0.9743
Epoch 12/30
 - 141s - loss: 0.1073 - acc: 0.9818 - val_loss: 0.1437 - val_acc: 0.9679
Epoch 13/30
 - 141s - loss: 0.0975 - acc: 0.9833 - val_loss: 0.1044 - val_acc: 0.9831
Epoch 14/30
 - 141s - loss: 0.0972 - acc: 0.9848 - val_loss: 0.1253 - val_acc: 0.9753
Epoch 15/30
 - 141s - loss: 0.0937 - acc: 0.9843 - val_loss: 0.1345 - val_acc: 0.9676
Epoch 16/30
 - 141s - loss: 0.0910 - acc: 0.9846 - val_loss: 0.1019 - val_acc: 0.9793
Epoch 17/30
 - 141s - loss: 0.0873 - acc: 0.9858 - val_loss: 0.1206 - val_acc: 0.9754
Epoch 18/30
 - 141s - loss: 0.0826 - acc: 0.9872 - val_loss: 0.0998 - val_acc: 0.9824
Epoch 19/30
 - 141s - loss: 0.0823 - acc: 0.9878 - val_loss: 0.1053 - val_acc: 0.9814
Epoch 20/30
 - 141s - loss: 0.0770 - acc: 0.9882 - val_loss: 0.1102 - val_acc: 0.9783
Epoch 21/30
 - 141s - loss: 0.0768 - acc: 0.9890 - val_loss: 0.1115 - val_acc: 0.9777

Epoch 00021: ReduceLROnPlateau reducing learning rate to 0.00031622778103685084.
Epoch 22/30
 - 142s - loss: 0.0518 - acc: 0.9972 - val_loss: 0.0590 - val_acc: 0.9931
Epoch 23/30
 - 142s - loss: 0.0433 - acc: 0.9986 - val_loss: 0.0573 - val_acc: 0.9930
Epoch 24/30
 - 141s - loss: 0.0392 - acc: 0.9984 - val_loss: 0.0548 - val_acc: 0.9921
Epoch 25/30
 - 141s - loss: 0.0383 - acc: 0.9982 - val_loss: 0.0550 - val_acc: 0.9917
Epoch 26/30
 - 141s - loss: 0.0367 - acc: 0.9975 - val_loss: 0.0646 - val_acc: 0.9885
Epoch 27/30
 - 141s - loss: 0.0356 - acc: 0.9978 - val_loss: 0.0755 - val_acc: 0.9831

Epoch 00027: ReduceLROnPlateau reducing learning rate to 0.00010000000639606199.
Epoch 28/30
 - 142s - loss: 0.0317 - acc: 0.9988 - val_loss: 0.0475 - val_acc: 0.9935
Epoch 29/30
 - 142s - loss: 0.0286 - acc: 0.9995 - val_loss: 0.0444 - val_acc: 0.9942
Epoch 30/30
 - 142s - loss: 0.0272 - acc: 0.9996 - val_loss: 0.0437 - val_acc: 0.9937

  32/7968 [..............................] - ETA: 11s
  96/7968 [..............................] - ETA: 11s
 160/7968 [..............................] - ETA: 11s
 224/7968 [..............................] - ETA: 10s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 10s
 800/7968 [==>...........................] - ETA: 10s
 864/7968 [==>...........................] - ETA: 10s
 928/7968 [==>...........................] - ETA: 9s 
 992/7968 [==>...........................] - ETA: 9s
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 9s
1568/7968 [====>.........................] - ETA: 9s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 8s
2272/7968 [=======>......................] - ETA: 8s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 7s
2976/7968 [==========>...................] - ETA: 7s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 6s
3680/7968 [============>.................] - ETA: 6s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 5s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 4s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 3s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9937248995983936
current auc_score ------------------>  0.9997951670771305
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_27 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_27[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_627 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_627[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_628 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_628[0][0]             
__________________________________________________________________________________________________
concatenate_274 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_274[0][0]            
__________________________________________________________________________________________________
activation_629 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_629[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_630 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_630[0][0]             
__________________________________________________________________________________________________
concatenate_275 (Concatenate)   (None, 76, 96, 96)   0           concatenate_274[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_275[0][0]            
__________________________________________________________________________________________________
activation_631 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_631[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_632 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_632[0][0]             
__________________________________________________________________________________________________
concatenate_276 (Concatenate)   (None, 106, 96, 96)  0           concatenate_275[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_276[0][0]            
__________________________________________________________________________________________________
activation_633 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_633[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_634 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_634[0][0]             
__________________________________________________________________________________________________
concatenate_277 (Concatenate)   (None, 136, 96, 96)  0           concatenate_276[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_277[0][0]            
__________________________________________________________________________________________________
activation_635 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_635[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_636 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_636[0][0]             
__________________________________________________________________________________________________
concatenate_278 (Concatenate)   (None, 166, 96, 96)  0           concatenate_277[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_278[0][0]            
__________________________________________________________________________________________________
activation_637 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_637[0][0]             
__________________________________________________________________________________________________
average_pooling2d_55 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_55[0][0]       
__________________________________________________________________________________________________
activation_638 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_638[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_639 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_639[0][0]             
__________________________________________________________________________________________________
concatenate_279 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_55[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_279[0][0]            
__________________________________________________________________________________________________
activation_640 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_640[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_641 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_641[0][0]             
__________________________________________________________________________________________________
concatenate_280 (Concatenate)   (None, 143, 48, 48)  0           concatenate_279[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_280[0][0]            
__________________________________________________________________________________________________
activation_642 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_642[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_643 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_643[0][0]             
__________________________________________________________________________________________________
concatenate_281 (Concatenate)   (None, 173, 48, 48)  0           concatenate_280[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_281[0][0]            
__________________________________________________________________________________________________
activation_644 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_644[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_645 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_645[0][0]             
__________________________________________________________________________________________________
concatenate_282 (Concatenate)   (None, 203, 48, 48)  0           concatenate_281[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_282[0][0]            
__________________________________________________________________________________________________
activation_646 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_646[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_647 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_647[0][0]             
__________________________________________________________________________________________________
concatenate_283 (Concatenate)   (None, 233, 48, 48)  0           concatenate_282[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_283[0][0]            
__________________________________________________________________________________________________
activation_648 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_648[0][0]             
__________________________________________________________________________________________________
average_pooling2d_56 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_56[0][0]       
__________________________________________________________________________________________________
activation_649 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_649[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_650 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_650[0][0]             
__________________________________________________________________________________________________
concatenate_284 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_56[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_284[0][0]            
__________________________________________________________________________________________________
activation_651 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_651[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_652 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_652[0][0]             
__________________________________________________________________________________________________
concatenate_285 (Concatenate)   (None, 176, 24, 24)  0           concatenate_284[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_285[0][0]            
__________________________________________________________________________________________________
activation_653 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_653[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_654 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_654[0][0]             
__________________________________________________________________________________________________
concatenate_286 (Concatenate)   (None, 206, 24, 24)  0           concatenate_285[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_286[0][0]            
__________________________________________________________________________________________________
activation_655 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_655[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_656 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_656[0][0]             
__________________________________________________________________________________________________
concatenate_287 (Concatenate)   (None, 236, 24, 24)  0           concatenate_286[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_287[0][0]            
__________________________________________________________________________________________________
activation_657 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_657[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_658 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_658[0][0]             
__________________________________________________________________________________________________
concatenate_288 (Concatenate)   (None, 266, 24, 24)  0           concatenate_287[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_288[0][0]            
__________________________________________________________________________________________________
activation_659 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_659[0][0]             
__________________________________________________________________________________________________
average_pooling2d_57 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_57[0][0]       
__________________________________________________________________________________________________
activation_660 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_660[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_661 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_661[0][0]             
__________________________________________________________________________________________________
concatenate_289 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_57[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_289[0][0]            
__________________________________________________________________________________________________
activation_662 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_662[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_663 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_663[0][0]             
__________________________________________________________________________________________________
concatenate_290 (Concatenate)   (None, 193, 12, 12)  0           concatenate_289[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_290[0][0]            
__________________________________________________________________________________________________
activation_664 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_664[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_665 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_665[0][0]             
__________________________________________________________________________________________________
concatenate_291 (Concatenate)   (None, 223, 12, 12)  0           concatenate_290[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_291[0][0]            
__________________________________________________________________________________________________
activation_666 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_666[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_667 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_667[0][0]             
__________________________________________________________________________________________________
concatenate_292 (Concatenate)   (None, 253, 12, 12)  0           concatenate_291[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_292[0][0]            
__________________________________________________________________________________________________
activation_668 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_668[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_669 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_669[0][0]             
__________________________________________________________________________________________________
concatenate_293 (Concatenate)   (None, 283, 12, 12)  0           concatenate_292[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_293[0][0]            
__________________________________________________________________________________________________
activation_670 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_27 (Gl (None, 283)          0           activation_670[0][0]             
__________________________________________________________________________________________________
dense_27 (Dense)                (None, 1)            284         global_average_pooling2d_27[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 168s - loss: 0.6049 - acc: 0.7480 - val_loss: 1.6042 - val_acc: 0.5257
Epoch 2/30
 - 142s - loss: 0.4867 - acc: 0.7746 - val_loss: 0.6803 - val_acc: 0.7041
Epoch 3/30
 - 142s - loss: 0.4484 - acc: 0.7953 - val_loss: 2.6088 - val_acc: 0.5168
Epoch 4/30
 - 142s - loss: 0.4238 - acc: 0.8094 - val_loss: 0.4625 - val_acc: 0.7782
Epoch 5/30
 - 142s - loss: 0.3873 - acc: 0.8317 - val_loss: 0.5398 - val_acc: 0.7368
Epoch 6/30
 - 142s - loss: 0.3593 - acc: 0.8481 - val_loss: 0.5324 - val_acc: 0.7873
Epoch 7/30
 - 142s - loss: 0.3296 - acc: 0.8673 - val_loss: 0.7495 - val_acc: 0.6492

Epoch 00007: ReduceLROnPlateau reducing learning rate to 0.0031622775894859655.
Epoch 8/30
 - 142s - loss: 0.2651 - acc: 0.8974 - val_loss: 0.3460 - val_acc: 0.8564
Epoch 9/30
 - 142s - loss: 0.2406 - acc: 0.9086 - val_loss: 0.3440 - val_acc: 0.8524
Epoch 10/30
 - 142s - loss: 0.2219 - acc: 0.9180 - val_loss: 0.3039 - val_acc: 0.8824
Epoch 11/30
 - 142s - loss: 0.2069 - acc: 0.9247 - val_loss: 0.3532 - val_acc: 0.8450
Epoch 12/30
 - 142s - loss: 0.1985 - acc: 0.9286 - val_loss: 0.3032 - val_acc: 0.8783
Epoch 13/30
 - 142s - loss: 0.1882 - acc: 0.9326 - val_loss: 0.1998 - val_acc: 0.9300
Epoch 14/30
 - 142s - loss: 0.1809 - acc: 0.9350 - val_loss: 0.2142 - val_acc: 0.9223
Epoch 15/30
 - 142s - loss: 0.1692 - acc: 0.9425 - val_loss: 0.2475 - val_acc: 0.9127
Epoch 16/30
 - 142s - loss: 0.1615 - acc: 0.9450 - val_loss: 0.1919 - val_acc: 0.9310
Epoch 17/30
 - 142s - loss: 0.1553 - acc: 0.9476 - val_loss: 0.2420 - val_acc: 0.9158
Epoch 18/30
 - 142s - loss: 0.1505 - acc: 0.9506 - val_loss: 0.3868 - val_acc: 0.8529
Epoch 19/30
 - 142s - loss: 0.1425 - acc: 0.9533 - val_loss: 0.2614 - val_acc: 0.9096

Epoch 00019: ReduceLROnPlateau reducing learning rate to 0.0009999999903331056.
Epoch 20/30
 - 142s - loss: 0.1140 - acc: 0.9656 - val_loss: 0.1392 - val_acc: 0.9541
Epoch 21/30
 - 142s - loss: 0.1089 - acc: 0.9667 - val_loss: 0.1300 - val_acc: 0.9567
Epoch 22/30
 - 142s - loss: 0.1038 - acc: 0.9684 - val_loss: 0.1317 - val_acc: 0.9593
Epoch 23/30
 - 142s - loss: 0.0994 - acc: 0.9704 - val_loss: 0.1194 - val_acc: 0.9640
Epoch 24/30
 - 142s - loss: 0.0990 - acc: 0.9697 - val_loss: 0.1263 - val_acc: 0.9626
Epoch 25/30
 - 142s - loss: 0.0916 - acc: 0.9738 - val_loss: 0.1236 - val_acc: 0.9613
Epoch 26/30
 - 142s - loss: 0.0937 - acc: 0.9712 - val_loss: 0.1590 - val_acc: 0.9504

Epoch 00026: ReduceLROnPlateau reducing learning rate to 0.00031622778103685084.
Epoch 27/30
 - 142s - loss: 0.0832 - acc: 0.9766 - val_loss: 0.1120 - val_acc: 0.9661
Epoch 28/30
 - 142s - loss: 0.0774 - acc: 0.9789 - val_loss: 0.1089 - val_acc: 0.9672
Epoch 29/30
 - 141s - loss: 0.0778 - acc: 0.9786 - val_loss: 0.1073 - val_acc: 0.9685
Epoch 30/30
 - 141s - loss: 0.0762 - acc: 0.9788 - val_loss: 0.1073 - val_acc: 0.9681

  32/7968 [..............................] - ETA: 11s
  96/7968 [..............................] - ETA: 11s
 160/7968 [..............................] - ETA: 11s
 224/7968 [..............................] - ETA: 10s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 10s
 800/7968 [==>...........................] - ETA: 10s
 864/7968 [==>...........................] - ETA: 10s
 928/7968 [==>...........................] - ETA: 9s 
 992/7968 [==>...........................] - ETA: 9s
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 9s
1568/7968 [====>.........................] - ETA: 9s
1632/7968 [=====>........................] - ETA: 8s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 8s
2272/7968 [=======>......................] - ETA: 8s
2336/7968 [=======>......................] - ETA: 7s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 7s
2976/7968 [==========>...................] - ETA: 7s
3040/7968 [==========>...................] - ETA: 6s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 6s
3680/7968 [============>.................] - ETA: 6s
3744/7968 [=============>................] - ETA: 5s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 5s
4448/7968 [===============>..............] - ETA: 4s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 4s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 3s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9681224899598394
current auc_score ------------------>  0.9949460264303148
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_28 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_28[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_671 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_671[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_672 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_672[0][0]             
__________________________________________________________________________________________________
concatenate_294 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_294[0][0]            
__________________________________________________________________________________________________
activation_673 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_673[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_674 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_674[0][0]             
__________________________________________________________________________________________________
concatenate_295 (Concatenate)   (None, 76, 96, 96)   0           concatenate_294[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_295[0][0]            
__________________________________________________________________________________________________
activation_675 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_675[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_676 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_676[0][0]             
__________________________________________________________________________________________________
concatenate_296 (Concatenate)   (None, 106, 96, 96)  0           concatenate_295[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_296[0][0]            
__________________________________________________________________________________________________
activation_677 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_677[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_678 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_678[0][0]             
__________________________________________________________________________________________________
concatenate_297 (Concatenate)   (None, 136, 96, 96)  0           concatenate_296[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_297[0][0]            
__________________________________________________________________________________________________
activation_679 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_679[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_680 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_680[0][0]             
__________________________________________________________________________________________________
concatenate_298 (Concatenate)   (None, 166, 96, 96)  0           concatenate_297[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_298[0][0]            
__________________________________________________________________________________________________
activation_681 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_681[0][0]             
__________________________________________________________________________________________________
average_pooling2d_58 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_58[0][0]       
__________________________________________________________________________________________________
activation_682 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_682[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_683 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_683[0][0]             
__________________________________________________________________________________________________
concatenate_299 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_58[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_299[0][0]            
__________________________________________________________________________________________________
activation_684 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_684[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_685 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_685[0][0]             
__________________________________________________________________________________________________
concatenate_300 (Concatenate)   (None, 143, 48, 48)  0           concatenate_299[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_300[0][0]            
__________________________________________________________________________________________________
activation_686 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_686[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_687 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_687[0][0]             
__________________________________________________________________________________________________
concatenate_301 (Concatenate)   (None, 173, 48, 48)  0           concatenate_300[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_301[0][0]            
__________________________________________________________________________________________________
activation_688 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_688[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_689 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_689[0][0]             
__________________________________________________________________________________________________
concatenate_302 (Concatenate)   (None, 203, 48, 48)  0           concatenate_301[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_302[0][0]            
__________________________________________________________________________________________________
activation_690 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_690[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_691 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_691[0][0]             
__________________________________________________________________________________________________
concatenate_303 (Concatenate)   (None, 233, 48, 48)  0           concatenate_302[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_303[0][0]            
__________________________________________________________________________________________________
activation_692 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_692[0][0]             
__________________________________________________________________________________________________
average_pooling2d_59 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_59[0][0]       
__________________________________________________________________________________________________
activation_693 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_693[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_694 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_694[0][0]             
__________________________________________________________________________________________________
concatenate_304 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_59[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_304[0][0]            
__________________________________________________________________________________________________
activation_695 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_695[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_696 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_696[0][0]             
__________________________________________________________________________________________________
concatenate_305 (Concatenate)   (None, 176, 24, 24)  0           concatenate_304[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_305[0][0]            
__________________________________________________________________________________________________
activation_697 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_697[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_698 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_698[0][0]             
__________________________________________________________________________________________________
concatenate_306 (Concatenate)   (None, 206, 24, 24)  0           concatenate_305[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_306[0][0]            
__________________________________________________________________________________________________
activation_699 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_699[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_700 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_700[0][0]             
__________________________________________________________________________________________________
concatenate_307 (Concatenate)   (None, 236, 24, 24)  0           concatenate_306[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_307[0][0]            
__________________________________________________________________________________________________
activation_701 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_701[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_702 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_702[0][0]             
__________________________________________________________________________________________________
concatenate_308 (Concatenate)   (None, 266, 24, 24)  0           concatenate_307[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_308[0][0]            
__________________________________________________________________________________________________
activation_703 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_703[0][0]             
__________________________________________________________________________________________________
average_pooling2d_60 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_60[0][0]       
__________________________________________________________________________________________________
activation_704 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_704[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_705 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_705[0][0]             
__________________________________________________________________________________________________
concatenate_309 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_60[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_309[0][0]            
__________________________________________________________________________________________________
activation_706 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_706[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_707 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_707[0][0]             
__________________________________________________________________________________________________
concatenate_310 (Concatenate)   (None, 193, 12, 12)  0           concatenate_309[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_310[0][0]            
__________________________________________________________________________________________________
activation_708 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_708[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_709 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_709[0][0]             
__________________________________________________________________________________________________
concatenate_311 (Concatenate)   (None, 223, 12, 12)  0           concatenate_310[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_311[0][0]            
__________________________________________________________________________________________________
activation_710 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_710[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_711 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_711[0][0]             
__________________________________________________________________________________________________
concatenate_312 (Concatenate)   (None, 253, 12, 12)  0           concatenate_311[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_312[0][0]            
__________________________________________________________________________________________________
activation_712 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_712[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_713 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_713[0][0]             
__________________________________________________________________________________________________
concatenate_313 (Concatenate)   (None, 283, 12, 12)  0           concatenate_312[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_313[0][0]            
__________________________________________________________________________________________________
activation_714 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_28 (Gl (None, 283)          0           activation_714[0][0]             
__________________________________________________________________________________________________
dense_28 (Dense)                (None, 1)            284         global_average_pooling2d_28[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 172s - loss: 0.9301 - acc: 0.8089 - val_loss: 0.7935 - val_acc: 0.8827
Epoch 2/30
 - 142s - loss: 0.7673 - acc: 0.8899 - val_loss: 0.7078 - val_acc: 0.9075
Epoch 3/30
 - 141s - loss: 0.6858 - acc: 0.9171 - val_loss: 0.6784 - val_acc: 0.9170
Epoch 4/30
 - 142s - loss: 0.6235 - acc: 0.9381 - val_loss: 0.6047 - val_acc: 0.9442
Epoch 5/30
 - 142s - loss: 0.5796 - acc: 0.9517 - val_loss: 0.5905 - val_acc: 0.9460
Epoch 6/30
 - 142s - loss: 0.5423 - acc: 0.9635 - val_loss: 0.6456 - val_acc: 0.9183
Epoch 7/30
 - 142s - loss: 0.5186 - acc: 0.9680 - val_loss: 0.5247 - val_acc: 0.9630
Epoch 8/30
 - 142s - loss: 0.4949 - acc: 0.9734 - val_loss: 0.5362 - val_acc: 0.9534
Epoch 9/30
 - 142s - loss: 0.4733 - acc: 0.9782 - val_loss: 0.4972 - val_acc: 0.9667
Epoch 10/30
 - 142s - loss: 0.4580 - acc: 0.9813 - val_loss: 0.4800 - val_acc: 0.9708
Epoch 11/30
 - 142s - loss: 0.4396 - acc: 0.9843 - val_loss: 0.4788 - val_acc: 0.9689
Epoch 12/30
 - 141s - loss: 0.4292 - acc: 0.9845 - val_loss: 0.4795 - val_acc: 0.9649
Epoch 13/30
 - 141s - loss: 0.4150 - acc: 0.9866 - val_loss: 0.4596 - val_acc: 0.9720
Epoch 14/30
 - 142s - loss: 0.4068 - acc: 0.9862 - val_loss: 0.5414 - val_acc: 0.9419
Epoch 15/30
 - 142s - loss: 0.3937 - acc: 0.9888 - val_loss: 0.4918 - val_acc: 0.9567
Epoch 16/30
 - 142s - loss: 0.3860 - acc: 0.9878 - val_loss: 0.4207 - val_acc: 0.9744
Epoch 17/30
 - 142s - loss: 0.3714 - acc: 0.9912 - val_loss: 0.4226 - val_acc: 0.9726
Epoch 18/30
 - 142s - loss: 0.3648 - acc: 0.9911 - val_loss: 0.5181 - val_acc: 0.9489
Epoch 19/30
 - 142s - loss: 0.3585 - acc: 0.9904 - val_loss: 0.4522 - val_acc: 0.9661

Epoch 00019: ReduceLROnPlateau reducing learning rate to 3.1622775802825264e-05.
Epoch 20/30
 - 142s - loss: 0.3354 - acc: 0.9973 - val_loss: 0.3643 - val_acc: 0.9864
Epoch 21/30
 - 142s - loss: 0.3279 - acc: 0.9990 - val_loss: 0.3665 - val_acc: 0.9851
Epoch 22/30
 - 142s - loss: 0.3239 - acc: 0.9989 - val_loss: 0.3617 - val_acc: 0.9839
Epoch 23/30
 - 142s - loss: 0.3192 - acc: 0.9987 - val_loss: 0.3579 - val_acc: 0.9864
Epoch 24/30
 - 142s - loss: 0.3139 - acc: 0.9989 - val_loss: 0.3488 - val_acc: 0.9861
Epoch 25/30
 - 142s - loss: 0.3094 - acc: 0.9987 - val_loss: 0.3538 - val_acc: 0.9837
Epoch 26/30
 - 142s - loss: 0.3054 - acc: 0.9987 - val_loss: 0.3404 - val_acc: 0.9883
Epoch 27/30
 - 142s - loss: 0.3001 - acc: 0.9990 - val_loss: 0.3491 - val_acc: 0.9843
Epoch 28/30
 - 142s - loss: 0.2952 - acc: 0.9992 - val_loss: 0.3282 - val_acc: 0.9869
Epoch 29/30
 - 142s - loss: 0.2933 - acc: 0.9986 - val_loss: 0.3315 - val_acc: 0.9853
Epoch 30/30
 - 142s - loss: 0.2858 - acc: 0.9997 - val_loss: 0.3294 - val_acc: 0.9859

  32/7968 [..............................] - ETA: 11s
  96/7968 [..............................] - ETA: 11s
 160/7968 [..............................] - ETA: 11s
 224/7968 [..............................] - ETA: 11s
 288/7968 [>.............................] - ETA: 10s
 352/7968 [>.............................] - ETA: 10s
 416/7968 [>.............................] - ETA: 10s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 10s
 800/7968 [==>...........................] - ETA: 10s
 864/7968 [==>...........................] - ETA: 10s
 928/7968 [==>...........................] - ETA: 10s
 992/7968 [==>...........................] - ETA: 9s 
1056/7968 [==>...........................] - ETA: 9s
1120/7968 [===>..........................] - ETA: 9s
1184/7968 [===>..........................] - ETA: 9s
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 9s
1568/7968 [====>.........................] - ETA: 9s
1632/7968 [=====>........................] - ETA: 9s
1696/7968 [=====>........................] - ETA: 8s
1760/7968 [=====>........................] - ETA: 8s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 8s
2272/7968 [=======>......................] - ETA: 8s
2336/7968 [=======>......................] - ETA: 8s
2400/7968 [========>.....................] - ETA: 7s
2464/7968 [========>.....................] - ETA: 7s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 7s
2976/7968 [==========>...................] - ETA: 7s
3040/7968 [==========>...................] - ETA: 7s
3104/7968 [==========>...................] - ETA: 6s
3168/7968 [==========>...................] - ETA: 6s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 6s
3680/7968 [============>.................] - ETA: 6s
3744/7968 [=============>................] - ETA: 6s
3808/7968 [=============>................] - ETA: 5s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 5s
4448/7968 [===============>..............] - ETA: 5s
4512/7968 [===============>..............] - ETA: 4s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 4s
5152/7968 [==================>...........] - ETA: 4s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 3s
5856/7968 [=====================>........] - ETA: 3s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 2s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 1s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 11s 1ms/step
current val accuracy: 0.9859437751004017
current auc_score ------------------>  0.9986496526598163
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_29 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_29[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_715 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 88, 96, 96)   1408        activation_715[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_716 (Activation)     (None, 88, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_716[0][0]             
__________________________________________________________________________________________________
concatenate_314 (Concatenate)   (None, 38, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 38, 96, 96)   152         concatenate_314[0][0]            
__________________________________________________________________________________________________
activation_717 (Activation)     (None, 38, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 88, 96, 96)   3344        activation_717[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_718 (Activation)     (None, 88, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_718[0][0]             
__________________________________________________________________________________________________
concatenate_315 (Concatenate)   (None, 60, 96, 96)   0           concatenate_314[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 60, 96, 96)   240         concatenate_315[0][0]            
__________________________________________________________________________________________________
activation_719 (Activation)     (None, 60, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 88, 96, 96)   5280        activation_719[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_720 (Activation)     (None, 88, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_720[0][0]             
__________________________________________________________________________________________________
concatenate_316 (Concatenate)   (None, 82, 96, 96)   0           concatenate_315[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 82, 96, 96)   328         concatenate_316[0][0]            
__________________________________________________________________________________________________
activation_721 (Activation)     (None, 82, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 88, 96, 96)   7216        activation_721[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_722 (Activation)     (None, 88, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_722[0][0]             
__________________________________________________________________________________________________
concatenate_317 (Concatenate)   (None, 104, 96, 96)  0           concatenate_316[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 104, 96, 96)  416         concatenate_317[0][0]            
__________________________________________________________________________________________________
activation_723 (Activation)     (None, 104, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 88, 96, 96)   9152        activation_723[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 88, 96, 96)   352         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_724 (Activation)     (None, 88, 96, 96)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 22, 96, 96)   17424       activation_724[0][0]             
__________________________________________________________________________________________________
concatenate_318 (Concatenate)   (None, 126, 96, 96)  0           concatenate_317[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 126, 96, 96)  504         concatenate_318[0][0]            
__________________________________________________________________________________________________
activation_725 (Activation)     (None, 126, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 63, 96, 96)   7938        activation_725[0][0]             
__________________________________________________________________________________________________
average_pooling2d_61 (AveragePo (None, 63, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 63, 48, 48)   252         average_pooling2d_61[0][0]       
__________________________________________________________________________________________________
activation_726 (Activation)     (None, 63, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 88, 48, 48)   5544        activation_726[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_727 (Activation)     (None, 88, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_727[0][0]             
__________________________________________________________________________________________________
concatenate_319 (Concatenate)   (None, 85, 48, 48)   0           average_pooling2d_61[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 85, 48, 48)   340         concatenate_319[0][0]            
__________________________________________________________________________________________________
activation_728 (Activation)     (None, 85, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 88, 48, 48)   7480        activation_728[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_729 (Activation)     (None, 88, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_729[0][0]             
__________________________________________________________________________________________________
concatenate_320 (Concatenate)   (None, 107, 48, 48)  0           concatenate_319[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 107, 48, 48)  428         concatenate_320[0][0]            
__________________________________________________________________________________________________
activation_730 (Activation)     (None, 107, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 88, 48, 48)   9416        activation_730[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_731 (Activation)     (None, 88, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_731[0][0]             
__________________________________________________________________________________________________
concatenate_321 (Concatenate)   (None, 129, 48, 48)  0           concatenate_320[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 129, 48, 48)  516         concatenate_321[0][0]            
__________________________________________________________________________________________________
activation_732 (Activation)     (None, 129, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 88, 48, 48)   11352       activation_732[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_733 (Activation)     (None, 88, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_733[0][0]             
__________________________________________________________________________________________________
concatenate_322 (Concatenate)   (None, 151, 48, 48)  0           concatenate_321[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 151, 48, 48)  604         concatenate_322[0][0]            
__________________________________________________________________________________________________
activation_734 (Activation)     (None, 151, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 88, 48, 48)   13288       activation_734[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 88, 48, 48)   352         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_735 (Activation)     (None, 88, 48, 48)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 22, 48, 48)   17424       activation_735[0][0]             
__________________________________________________________________________________________________
concatenate_323 (Concatenate)   (None, 173, 48, 48)  0           concatenate_322[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 173, 48, 48)  692         concatenate_323[0][0]            
__________________________________________________________________________________________________
activation_736 (Activation)     (None, 173, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 86, 48, 48)   14878       activation_736[0][0]             
__________________________________________________________________________________________________
average_pooling2d_62 (AveragePo (None, 86, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 86, 24, 24)   344         average_pooling2d_62[0][0]       
__________________________________________________________________________________________________
activation_737 (Activation)     (None, 86, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 88, 24, 24)   7568        activation_737[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_738 (Activation)     (None, 88, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_738[0][0]             
__________________________________________________________________________________________________
concatenate_324 (Concatenate)   (None, 108, 24, 24)  0           average_pooling2d_62[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 108, 24, 24)  432         concatenate_324[0][0]            
__________________________________________________________________________________________________
activation_739 (Activation)     (None, 108, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 88, 24, 24)   9504        activation_739[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_740 (Activation)     (None, 88, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_740[0][0]             
__________________________________________________________________________________________________
concatenate_325 (Concatenate)   (None, 130, 24, 24)  0           concatenate_324[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 130, 24, 24)  520         concatenate_325[0][0]            
__________________________________________________________________________________________________
activation_741 (Activation)     (None, 130, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 88, 24, 24)   11440       activation_741[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_742 (Activation)     (None, 88, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_742[0][0]             
__________________________________________________________________________________________________
concatenate_326 (Concatenate)   (None, 152, 24, 24)  0           concatenate_325[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 152, 24, 24)  608         concatenate_326[0][0]            
__________________________________________________________________________________________________
activation_743 (Activation)     (None, 152, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 88, 24, 24)   13376       activation_743[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_744 (Activation)     (None, 88, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_744[0][0]             
__________________________________________________________________________________________________
concatenate_327 (Concatenate)   (None, 174, 24, 24)  0           concatenate_326[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 174, 24, 24)  696         concatenate_327[0][0]            
__________________________________________________________________________________________________
activation_745 (Activation)     (None, 174, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 88, 24, 24)   15312       activation_745[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 88, 24, 24)   352         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_746 (Activation)     (None, 88, 24, 24)   0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 22, 24, 24)   17424       activation_746[0][0]             
__________________________________________________________________________________________________
concatenate_328 (Concatenate)   (None, 196, 24, 24)  0           concatenate_327[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 196, 24, 24)  784         concatenate_328[0][0]            
__________________________________________________________________________________________________
activation_747 (Activation)     (None, 196, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 98, 24, 24)   19208       activation_747[0][0]             
__________________________________________________________________________________________________
average_pooling2d_63 (AveragePo (None, 98, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 98, 12, 12)   392         average_pooling2d_63[0][0]       
__________________________________________________________________________________________________
activation_748 (Activation)     (None, 98, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 88, 12, 12)   8624        activation_748[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_749 (Activation)     (None, 88, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_749[0][0]             
__________________________________________________________________________________________________
concatenate_329 (Concatenate)   (None, 120, 12, 12)  0           average_pooling2d_63[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 120, 12, 12)  480         concatenate_329[0][0]            
__________________________________________________________________________________________________
activation_750 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 88, 12, 12)   10560       activation_750[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_751 (Activation)     (None, 88, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_751[0][0]             
__________________________________________________________________________________________________
concatenate_330 (Concatenate)   (None, 142, 12, 12)  0           concatenate_329[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 142, 12, 12)  568         concatenate_330[0][0]            
__________________________________________________________________________________________________
activation_752 (Activation)     (None, 142, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 88, 12, 12)   12496       activation_752[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_753 (Activation)     (None, 88, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_753[0][0]             
__________________________________________________________________________________________________
concatenate_331 (Concatenate)   (None, 164, 12, 12)  0           concatenate_330[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 164, 12, 12)  656         concatenate_331[0][0]            
__________________________________________________________________________________________________
activation_754 (Activation)     (None, 164, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 88, 12, 12)   14432       activation_754[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_755 (Activation)     (None, 88, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_755[0][0]             
__________________________________________________________________________________________________
concatenate_332 (Concatenate)   (None, 186, 12, 12)  0           concatenate_331[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 186, 12, 12)  744         concatenate_332[0][0]            
__________________________________________________________________________________________________
activation_756 (Activation)     (None, 186, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 88, 12, 12)   16368       activation_756[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 88, 12, 12)   352         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_757 (Activation)     (None, 88, 12, 12)   0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 22, 12, 12)   17424       activation_757[0][0]             
__________________________________________________________________________________________________
concatenate_333 (Concatenate)   (None, 208, 12, 12)  0           concatenate_332[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 208, 12, 12)  832         concatenate_333[0][0]            
__________________________________________________________________________________________________
activation_758 (Activation)     (None, 208, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_29 (Gl (None, 208)          0           activation_758[0][0]             
__________________________________________________________________________________________________
dense_29 (Dense)                (None, 1)            209         global_average_pooling2d_29[0][0]
==================================================================================================
Total params: 602,793
Trainable params: 593,477
Non-trainable params: 9,316
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 147s - loss: 0.7417 - acc: 0.8062 - val_loss: 0.6044 - val_acc: 0.8599
Epoch 2/30
 - 116s - loss: 0.5063 - acc: 0.8923 - val_loss: 0.5687 - val_acc: 0.8518
Epoch 3/30
 - 116s - loss: 0.3952 - acc: 0.9226 - val_loss: 0.4986 - val_acc: 0.8758
Epoch 4/30
 - 116s - loss: 0.3217 - acc: 0.9419 - val_loss: 0.3993 - val_acc: 0.9011
Epoch 5/30
 - 116s - loss: 0.2721 - acc: 0.9549 - val_loss: 0.2717 - val_acc: 0.9483
Epoch 6/30
 - 116s - loss: 0.2361 - acc: 0.9627 - val_loss: 0.4447 - val_acc: 0.8945
Epoch 7/30
 - 116s - loss: 0.2097 - acc: 0.9676 - val_loss: 0.2011 - val_acc: 0.9693
Epoch 8/30
 - 116s - loss: 0.1876 - acc: 0.9725 - val_loss: 0.2153 - val_acc: 0.9598
Epoch 9/30
 - 116s - loss: 0.1706 - acc: 0.9758 - val_loss: 0.2023 - val_acc: 0.9607
Epoch 10/30
 - 116s - loss: 0.1620 - acc: 0.9772 - val_loss: 0.2074 - val_acc: 0.9582

Epoch 00010: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 11/30
 - 115s - loss: 0.1172 - acc: 0.9928 - val_loss: 0.1363 - val_acc: 0.9848
Epoch 12/30
 - 116s - loss: 0.1049 - acc: 0.9954 - val_loss: 0.1459 - val_acc: 0.9798
Epoch 13/30
 - 116s - loss: 0.1006 - acc: 0.9955 - val_loss: 0.1529 - val_acc: 0.9760
Epoch 14/30
 - 116s - loss: 0.0950 - acc: 0.9960 - val_loss: 0.1330 - val_acc: 0.9804
Epoch 15/30
 - 116s - loss: 0.0912 - acc: 0.9958 - val_loss: 0.1206 - val_acc: 0.9841
Epoch 16/30
 - 116s - loss: 0.0860 - acc: 0.9970 - val_loss: 0.1234 - val_acc: 0.9837
Epoch 17/30
 - 116s - loss: 0.0834 - acc: 0.9964 - val_loss: 0.1184 - val_acc: 0.9858
Epoch 18/30
 - 116s - loss: 0.0819 - acc: 0.9963 - val_loss: 0.1239 - val_acc: 0.9823
Epoch 19/30
 - 116s - loss: 0.0799 - acc: 0.9963 - val_loss: 0.1108 - val_acc: 0.9847
Epoch 20/30
 - 116s - loss: 0.0732 - acc: 0.9981 - val_loss: 0.1484 - val_acc: 0.9746
Epoch 21/30
 - 116s - loss: 0.0734 - acc: 0.9973 - val_loss: 0.1089 - val_acc: 0.9853
Epoch 22/30
 - 116s - loss: 0.0741 - acc: 0.9962 - val_loss: 0.0984 - val_acc: 0.9878
Epoch 23/30
 - 116s - loss: 0.0692 - acc: 0.9976 - val_loss: 0.1740 - val_acc: 0.9675
Epoch 24/30
 - 116s - loss: 0.0678 - acc: 0.9976 - val_loss: 0.1225 - val_acc: 0.9793
Epoch 25/30
 - 116s - loss: 0.0678 - acc: 0.9965 - val_loss: 0.1088 - val_acc: 0.9836

Epoch 00025: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 26/30
 - 116s - loss: 0.0617 - acc: 0.9989 - val_loss: 0.0864 - val_acc: 0.9901
Epoch 27/30
 - 116s - loss: 0.0586 - acc: 0.9996 - val_loss: 0.0892 - val_acc: 0.9900
Epoch 28/30
 - 116s - loss: 0.0579 - acc: 0.9996 - val_loss: 0.0829 - val_acc: 0.9912
Epoch 29/30
 - 116s - loss: 0.0570 - acc: 0.9994 - val_loss: 0.0836 - val_acc: 0.9911
Epoch 30/30
 - 116s - loss: 0.0553 - acc: 0.9998 - val_loss: 0.0842 - val_acc: 0.9912

  32/7968 [..............................] - ETA: 9s
  96/7968 [..............................] - ETA: 8s
 160/7968 [..............................] - ETA: 8s
 224/7968 [..............................] - ETA: 8s
 288/7968 [>.............................] - ETA: 8s
 352/7968 [>.............................] - ETA: 8s
 416/7968 [>.............................] - ETA: 8s
 480/7968 [>.............................] - ETA: 8s
 544/7968 [=>............................] - ETA: 8s
 608/7968 [=>............................] - ETA: 8s
 672/7968 [=>............................] - ETA: 8s
 736/7968 [=>............................] - ETA: 8s
 800/7968 [==>...........................] - ETA: 8s
 864/7968 [==>...........................] - ETA: 8s
 928/7968 [==>...........................] - ETA: 8s
 992/7968 [==>...........................] - ETA: 7s
1056/7968 [==>...........................] - ETA: 7s
1120/7968 [===>..........................] - ETA: 7s
1184/7968 [===>..........................] - ETA: 7s
1248/7968 [===>..........................] - ETA: 7s
1312/7968 [===>..........................] - ETA: 7s
1376/7968 [====>.........................] - ETA: 7s
1440/7968 [====>.........................] - ETA: 7s
1504/7968 [====>.........................] - ETA: 7s
1568/7968 [====>.........................] - ETA: 7s
1632/7968 [=====>........................] - ETA: 7s
1696/7968 [=====>........................] - ETA: 7s
1760/7968 [=====>........................] - ETA: 7s
1824/7968 [=====>........................] - ETA: 6s
1888/7968 [======>.......................] - ETA: 6s
1952/7968 [======>.......................] - ETA: 6s
2016/7968 [======>.......................] - ETA: 6s
2080/7968 [======>.......................] - ETA: 6s
2144/7968 [=======>......................] - ETA: 6s
2208/7968 [=======>......................] - ETA: 6s
2272/7968 [=======>......................] - ETA: 6s
2336/7968 [=======>......................] - ETA: 6s
2400/7968 [========>.....................] - ETA: 6s
2464/7968 [========>.....................] - ETA: 6s
2528/7968 [========>.....................] - ETA: 6s
2592/7968 [========>.....................] - ETA: 6s
2656/7968 [=========>....................] - ETA: 6s
2720/7968 [=========>....................] - ETA: 5s
2784/7968 [=========>....................] - ETA: 5s
2848/7968 [=========>....................] - ETA: 5s
2912/7968 [=========>....................] - ETA: 5s
2976/7968 [==========>...................] - ETA: 5s
3040/7968 [==========>...................] - ETA: 5s
3104/7968 [==========>...................] - ETA: 5s
3168/7968 [==========>...................] - ETA: 5s
3232/7968 [===========>..................] - ETA: 5s
3296/7968 [===========>..................] - ETA: 5s
3360/7968 [===========>..................] - ETA: 5s
3424/7968 [===========>..................] - ETA: 5s
3488/7968 [============>.................] - ETA: 5s
3552/7968 [============>.................] - ETA: 5s
3616/7968 [============>.................] - ETA: 4s
3680/7968 [============>.................] - ETA: 4s
3744/7968 [=============>................] - ETA: 4s
3808/7968 [=============>................] - ETA: 4s
3872/7968 [=============>................] - ETA: 4s
3936/7968 [=============>................] - ETA: 4s
4000/7968 [==============>...............] - ETA: 4s
4064/7968 [==============>...............] - ETA: 4s
4128/7968 [==============>...............] - ETA: 4s
4192/7968 [==============>...............] - ETA: 4s
4256/7968 [===============>..............] - ETA: 4s
4320/7968 [===============>..............] - ETA: 4s
4384/7968 [===============>..............] - ETA: 4s
4448/7968 [===============>..............] - ETA: 3s
4512/7968 [===============>..............] - ETA: 3s
4576/7968 [================>.............] - ETA: 3s
4640/7968 [================>.............] - ETA: 3s
4704/7968 [================>.............] - ETA: 3s
4768/7968 [================>.............] - ETA: 3s
4832/7968 [=================>............] - ETA: 3s
4896/7968 [=================>............] - ETA: 3s
4960/7968 [=================>............] - ETA: 3s
5024/7968 [=================>............] - ETA: 3s
5088/7968 [==================>...........] - ETA: 3s
5152/7968 [==================>...........] - ETA: 3s
5216/7968 [==================>...........] - ETA: 3s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 2s
5408/7968 [===================>..........] - ETA: 2s
5472/7968 [===================>..........] - ETA: 2s
5536/7968 [===================>..........] - ETA: 2s
5600/7968 [====================>.........] - ETA: 2s
5664/7968 [====================>.........] - ETA: 2s
5728/7968 [====================>.........] - ETA: 2s
5792/7968 [====================>.........] - ETA: 2s
5856/7968 [=====================>........] - ETA: 2s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 1s
6304/7968 [======================>.......] - ETA: 1s
6368/7968 [======================>.......] - ETA: 1s
6432/7968 [=======================>......] - ETA: 1s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 9s 1ms/step
current val accuracy: 0.991214859437751
current auc_score ------------------>  0.9993745696681442
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_30 (InputLayer)        (None, 2, 96, 96)         0         
_________________________________________________________________
initial_conv2D (Conv2D)      (None, 16, 96, 96)        288       
_________________________________________________________________
tr_0_bn (BatchNormalization) (None, 16, 96, 96)        64        
_________________________________________________________________
activation_759 (Activation)  (None, 16, 96, 96)        0         
_________________________________________________________________
tr_0_conv2D (Conv2D)         (None, 8, 96, 96)         128       
_________________________________________________________________
average_pooling2d_64 (Averag (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_bn (BatchNormalization) (None, 8, 48, 48)         32        
_________________________________________________________________
activation_760 (Activation)  (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_conv2D (Conv2D)         (None, 4, 48, 48)         32        
_________________________________________________________________
average_pooling2d_65 (Averag (None, 4, 24, 24)         0         
_________________________________________________________________
tr_2_bn (BatchNormalization) (None, 4, 24, 24)         16        
_________________________________________________________________
activation_761 (Activation)  (None, 4, 24, 24)         0         
_________________________________________________________________
tr_2_conv2D (Conv2D)         (None, 2, 24, 24)         8         
_________________________________________________________________
average_pooling2d_66 (Averag (None, 2, 12, 12)         0         
_________________________________________________________________
final_bn (BatchNormalization (None, 2, 12, 12)         8         
_________________________________________________________________
activation_762 (Activation)  (None, 2, 12, 12)         0         
_________________________________________________________________
global_average_pooling2d_30  (None, 2)                 0         
_________________________________________________________________
dense_30 (Dense)             (None, 1)                 3         
=================================================================
Total params: 579
Trainable params: 519
Non-trainable params: 60
_________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 37s - loss: 0.6558 - acc: 0.6737 - val_loss: 0.6398 - val_acc: 0.7241
Epoch 2/30
 - 13s - loss: 0.6154 - acc: 0.7341 - val_loss: 0.5976 - val_acc: 0.7348
Epoch 3/30
 - 13s - loss: 0.5864 - acc: 0.7454 - val_loss: 0.5780 - val_acc: 0.7323
Epoch 4/30
 - 13s - loss: 0.5658 - acc: 0.7477 - val_loss: 0.5695 - val_acc: 0.7235
Epoch 5/30
 - 13s - loss: 0.5502 - acc: 0.7513 - val_loss: 0.5433 - val_acc: 0.7505
Epoch 6/30
 - 13s - loss: 0.5396 - acc: 0.7503 - val_loss: 0.5360 - val_acc: 0.7460
Epoch 7/30
 - 13s - loss: 0.5294 - acc: 0.7540 - val_loss: 0.5215 - val_acc: 0.7514
Epoch 8/30
 - 13s - loss: 0.5224 - acc: 0.7558 - val_loss: 0.5156 - val_acc: 0.7530
Epoch 9/30
 - 13s - loss: 0.5161 - acc: 0.7551 - val_loss: 0.5174 - val_acc: 0.7482
Epoch 10/30
 - 13s - loss: 0.5110 - acc: 0.7589 - val_loss: 0.5230 - val_acc: 0.7302
Epoch 11/30
 - 13s - loss: 0.5011 - acc: 0.7589 - val_loss: 0.5513 - val_acc: 0.7073

Epoch 00011: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 12/30
 - 14s - loss: 0.4929 - acc: 0.7629 - val_loss: 0.4911 - val_acc: 0.7632
Epoch 13/30
 - 14s - loss: 0.4916 - acc: 0.7641 - val_loss: 0.4846 - val_acc: 0.7628
Epoch 14/30
 - 14s - loss: 0.4910 - acc: 0.7637 - val_loss: 0.4852 - val_acc: 0.7643
Epoch 15/30
 - 13s - loss: 0.4895 - acc: 0.7635 - val_loss: 0.4850 - val_acc: 0.7582
Epoch 16/30
 - 14s - loss: 0.4862 - acc: 0.7678 - val_loss: 0.4796 - val_acc: 0.7648
Epoch 17/30
 - 13s - loss: 0.4880 - acc: 0.7635 - val_loss: 0.4928 - val_acc: 0.7482
Epoch 18/30
 - 14s - loss: 0.4872 - acc: 0.7647 - val_loss: 0.5057 - val_acc: 0.7439
Epoch 19/30
 - 13s - loss: 0.4866 - acc: 0.7652 - val_loss: 0.4973 - val_acc: 0.7520

Epoch 00019: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 20/30
 - 14s - loss: 0.4835 - acc: 0.7651 - val_loss: 0.4817 - val_acc: 0.7574
Epoch 21/30
 - 14s - loss: 0.4841 - acc: 0.7668 - val_loss: 0.4749 - val_acc: 0.7679
Epoch 22/30
 - 13s - loss: 0.4830 - acc: 0.7672 - val_loss: 0.4779 - val_acc: 0.7615
Epoch 23/30
 - 14s - loss: 0.4841 - acc: 0.7662 - val_loss: 0.4773 - val_acc: 0.7654
Epoch 24/30
 - 13s - loss: 0.4816 - acc: 0.7686 - val_loss: 0.4778 - val_acc: 0.7679

Epoch 00024: ReduceLROnPlateau reducing learning rate to 1.5811389051842542e-05.
Epoch 25/30
 - 14s - loss: 0.4834 - acc: 0.7674 - val_loss: 0.4750 - val_acc: 0.7695
Epoch 26/30
 - 14s - loss: 0.4821 - acc: 0.7684 - val_loss: 0.4759 - val_acc: 0.7658
Epoch 00026: early stopping

  32/7968 [..............................] - ETA: 1s
 256/7968 [..............................] - ETA: 1s
 480/7968 [>.............................] - ETA: 1s
 704/7968 [=>............................] - ETA: 1s
 928/7968 [==>...........................] - ETA: 1s
1152/7968 [===>..........................] - ETA: 1s
1376/7968 [====>.........................] - ETA: 1s
1600/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2048/7968 [======>.......................] - ETA: 1s
2272/7968 [=======>......................] - ETA: 1s
2496/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2944/7968 [==========>...................] - ETA: 1s
3168/7968 [==========>...................] - ETA: 1s
3392/7968 [===========>..................] - ETA: 1s
3616/7968 [============>.................] - ETA: 1s
3840/7968 [=============>................] - ETA: 0s
4064/7968 [==============>...............] - ETA: 0s
4288/7968 [===============>..............] - ETA: 0s
4512/7968 [===============>..............] - ETA: 0s
4736/7968 [================>.............] - ETA: 0s
4960/7968 [=================>............] - ETA: 0s
5184/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5632/7968 [====================>.........] - ETA: 0s
5856/7968 [=====================>........] - ETA: 0s
6080/7968 [=====================>........] - ETA: 0s
6304/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6976/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7872/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 230us/step
current val accuracy: 0.7658132530120482
current auc_score ------------------>  0.856766152503057
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_31 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_31[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_763 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 56, 96, 96)   896         activation_763[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_764 (Activation)     (None, 56, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_764[0][0]             
__________________________________________________________________________________________________
concatenate_334 (Concatenate)   (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 30, 96, 96)   120         concatenate_334[0][0]            
__________________________________________________________________________________________________
activation_765 (Activation)     (None, 30, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 56, 96, 96)   1680        activation_765[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_766 (Activation)     (None, 56, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_766[0][0]             
__________________________________________________________________________________________________
concatenate_335 (Concatenate)   (None, 44, 96, 96)   0           concatenate_334[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 44, 96, 96)   176         concatenate_335[0][0]            
__________________________________________________________________________________________________
activation_767 (Activation)     (None, 44, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 56, 96, 96)   2464        activation_767[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_768 (Activation)     (None, 56, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_768[0][0]             
__________________________________________________________________________________________________
concatenate_336 (Concatenate)   (None, 58, 96, 96)   0           concatenate_335[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 58, 96, 96)   232         concatenate_336[0][0]            
__________________________________________________________________________________________________
activation_769 (Activation)     (None, 58, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 56, 96, 96)   3248        activation_769[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_770 (Activation)     (None, 56, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_770[0][0]             
__________________________________________________________________________________________________
concatenate_337 (Concatenate)   (None, 72, 96, 96)   0           concatenate_336[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 72, 96, 96)   288         concatenate_337[0][0]            
__________________________________________________________________________________________________
activation_771 (Activation)     (None, 72, 96, 96)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 56, 96, 96)   4032        activation_771[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_772 (Activation)     (None, 56, 96, 96)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_772[0][0]             
__________________________________________________________________________________________________
concatenate_338 (Concatenate)   (None, 86, 96, 96)   0           concatenate_337[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 86, 96, 96)   344         concatenate_338[0][0]            
__________________________________________________________________________________________________
activation_773 (Activation)     (None, 86, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 43, 96, 96)   3698        activation_773[0][0]             
__________________________________________________________________________________________________
average_pooling2d_67 (AveragePo (None, 43, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 43, 48, 48)   172         average_pooling2d_67[0][0]       
__________________________________________________________________________________________________
activation_774 (Activation)     (None, 43, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 56, 48, 48)   2408        activation_774[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_775 (Activation)     (None, 56, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_775[0][0]             
__________________________________________________________________________________________________
concatenate_339 (Concatenate)   (None, 57, 48, 48)   0           average_pooling2d_67[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 57, 48, 48)   228         concatenate_339[0][0]            
__________________________________________________________________________________________________
activation_776 (Activation)     (None, 57, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 56, 48, 48)   3192        activation_776[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_777 (Activation)     (None, 56, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_777[0][0]             
__________________________________________________________________________________________________
concatenate_340 (Concatenate)   (None, 71, 48, 48)   0           concatenate_339[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 71, 48, 48)   284         concatenate_340[0][0]            
__________________________________________________________________________________________________
activation_778 (Activation)     (None, 71, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 56, 48, 48)   3976        activation_778[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_779 (Activation)     (None, 56, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_779[0][0]             
__________________________________________________________________________________________________
concatenate_341 (Concatenate)   (None, 85, 48, 48)   0           concatenate_340[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 85, 48, 48)   340         concatenate_341[0][0]            
__________________________________________________________________________________________________
activation_780 (Activation)     (None, 85, 48, 48)   0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 56, 48, 48)   4760        activation_780[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_781 (Activation)     (None, 56, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_781[0][0]             
__________________________________________________________________________________________________
concatenate_342 (Concatenate)   (None, 99, 48, 48)   0           concatenate_341[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 99, 48, 48)   396         concatenate_342[0][0]            
__________________________________________________________________________________________________
activation_782 (Activation)     (None, 99, 48, 48)   0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 56, 48, 48)   5544        activation_782[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_783 (Activation)     (None, 56, 48, 48)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_783[0][0]             
__________________________________________________________________________________________________
concatenate_343 (Concatenate)   (None, 113, 48, 48)  0           concatenate_342[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 113, 48, 48)  452         concatenate_343[0][0]            
__________________________________________________________________________________________________
activation_784 (Activation)     (None, 113, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 56, 48, 48)   6328        activation_784[0][0]             
__________________________________________________________________________________________________
average_pooling2d_68 (AveragePo (None, 56, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 56, 24, 24)   224         average_pooling2d_68[0][0]       
__________________________________________________________________________________________________
activation_785 (Activation)     (None, 56, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 56, 24, 24)   3136        activation_785[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_786 (Activation)     (None, 56, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_786[0][0]             
__________________________________________________________________________________________________
concatenate_344 (Concatenate)   (None, 70, 24, 24)   0           average_pooling2d_68[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_344[0][0]            
__________________________________________________________________________________________________
activation_787 (Activation)     (None, 70, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 56, 24, 24)   3920        activation_787[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_788 (Activation)     (None, 56, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_788[0][0]             
__________________________________________________________________________________________________
concatenate_345 (Concatenate)   (None, 84, 24, 24)   0           concatenate_344[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 84, 24, 24)   336         concatenate_345[0][0]            
__________________________________________________________________________________________________
activation_789 (Activation)     (None, 84, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 56, 24, 24)   4704        activation_789[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_790 (Activation)     (None, 56, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_790[0][0]             
__________________________________________________________________________________________________
concatenate_346 (Concatenate)   (None, 98, 24, 24)   0           concatenate_345[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 98, 24, 24)   392         concatenate_346[0][0]            
__________________________________________________________________________________________________
activation_791 (Activation)     (None, 98, 24, 24)   0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 56, 24, 24)   5488        activation_791[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_792 (Activation)     (None, 56, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_792[0][0]             
__________________________________________________________________________________________________
concatenate_347 (Concatenate)   (None, 112, 24, 24)  0           concatenate_346[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_347[0][0]            
__________________________________________________________________________________________________
activation_793 (Activation)     (None, 112, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 56, 24, 24)   6272        activation_793[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_794 (Activation)     (None, 56, 24, 24)   0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_794[0][0]             
__________________________________________________________________________________________________
concatenate_348 (Concatenate)   (None, 126, 24, 24)  0           concatenate_347[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 126, 24, 24)  504         concatenate_348[0][0]            
__________________________________________________________________________________________________
activation_795 (Activation)     (None, 126, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 63, 24, 24)   7938        activation_795[0][0]             
__________________________________________________________________________________________________
average_pooling2d_69 (AveragePo (None, 63, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 63, 12, 12)   252         average_pooling2d_69[0][0]       
__________________________________________________________________________________________________
activation_796 (Activation)     (None, 63, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 56, 12, 12)   3528        activation_796[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_797 (Activation)     (None, 56, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_797[0][0]             
__________________________________________________________________________________________________
concatenate_349 (Concatenate)   (None, 77, 12, 12)   0           average_pooling2d_69[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 77, 12, 12)   308         concatenate_349[0][0]            
__________________________________________________________________________________________________
activation_798 (Activation)     (None, 77, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 56, 12, 12)   4312        activation_798[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_799 (Activation)     (None, 56, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_799[0][0]             
__________________________________________________________________________________________________
concatenate_350 (Concatenate)   (None, 91, 12, 12)   0           concatenate_349[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 91, 12, 12)   364         concatenate_350[0][0]            
__________________________________________________________________________________________________
activation_800 (Activation)     (None, 91, 12, 12)   0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 56, 12, 12)   5096        activation_800[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_801 (Activation)     (None, 56, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_801[0][0]             
__________________________________________________________________________________________________
concatenate_351 (Concatenate)   (None, 105, 12, 12)  0           concatenate_350[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 105, 12, 12)  420         concatenate_351[0][0]            
__________________________________________________________________________________________________
activation_802 (Activation)     (None, 105, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 56, 12, 12)   5880        activation_802[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_803 (Activation)     (None, 56, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_803[0][0]             
__________________________________________________________________________________________________
concatenate_352 (Concatenate)   (None, 119, 12, 12)  0           concatenate_351[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 119, 12, 12)  476         concatenate_352[0][0]            
__________________________________________________________________________________________________
activation_804 (Activation)     (None, 119, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 56, 12, 12)   6664        activation_804[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_805 (Activation)     (None, 56, 12, 12)   0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_805[0][0]             
__________________________________________________________________________________________________
concatenate_353 (Concatenate)   (None, 133, 12, 12)  0           concatenate_352[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 133, 12, 12)  532         concatenate_353[0][0]            
__________________________________________________________________________________________________
activation_806 (Activation)     (None, 133, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_31 (Gl (None, 133)          0           activation_806[0][0]             
__________________________________________________________________________________________________
dense_31 (Dense)                (None, 1)            134         global_average_pooling2d_31[0][0]
==================================================================================================
Total params: 252,818
Trainable params: 246,762
Non-trainable params: 6,056
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 119s - loss: 0.8454 - acc: 0.7102 - val_loss: 0.7801 - val_acc: 0.7524
Epoch 2/30
 - 86s - loss: 0.7492 - acc: 0.7658 - val_loss: 0.7201 - val_acc: 0.7752
Epoch 3/30
 - 86s - loss: 0.7037 - acc: 0.7857 - val_loss: 0.6752 - val_acc: 0.7969
Epoch 4/30
 - 86s - loss: 0.6732 - acc: 0.8009 - val_loss: 0.6526 - val_acc: 0.8065
Epoch 5/30
 - 86s - loss: 0.6497 - acc: 0.8140 - val_loss: 0.6252 - val_acc: 0.8273
Epoch 6/30
 - 86s - loss: 0.6297 - acc: 0.8272 - val_loss: 0.6114 - val_acc: 0.8352
Epoch 7/30
 - 86s - loss: 0.6159 - acc: 0.8335 - val_loss: 0.6002 - val_acc: 0.8410
Epoch 8/30
 - 86s - loss: 0.6001 - acc: 0.8420 - val_loss: 0.5868 - val_acc: 0.8478
Epoch 9/30
 - 86s - loss: 0.5877 - acc: 0.8476 - val_loss: 0.5870 - val_acc: 0.8473
Epoch 10/30
 - 86s - loss: 0.5751 - acc: 0.8567 - val_loss: 0.5704 - val_acc: 0.8568
Epoch 11/30
 - 86s - loss: 0.5666 - acc: 0.8602 - val_loss: 0.5700 - val_acc: 0.8540
Epoch 12/30
 - 86s - loss: 0.5574 - acc: 0.8654 - val_loss: 0.5508 - val_acc: 0.8734
Epoch 13/30
 - 86s - loss: 0.5464 - acc: 0.8715 - val_loss: 0.5431 - val_acc: 0.8766
Epoch 14/30
 - 86s - loss: 0.5387 - acc: 0.8765 - val_loss: 0.5308 - val_acc: 0.8771
Epoch 15/30
 - 86s - loss: 0.5315 - acc: 0.8806 - val_loss: 0.5322 - val_acc: 0.8751
Epoch 16/30
 - 86s - loss: 0.5209 - acc: 0.8863 - val_loss: 0.5254 - val_acc: 0.8801
Epoch 17/30
 - 86s - loss: 0.5132 - acc: 0.8890 - val_loss: 0.5206 - val_acc: 0.8800
Epoch 18/30
 - 86s - loss: 0.5044 - acc: 0.8935 - val_loss: 0.5071 - val_acc: 0.8961
Epoch 19/30
 - 86s - loss: 0.5022 - acc: 0.8940 - val_loss: 0.5037 - val_acc: 0.8916
Epoch 20/30
 - 86s - loss: 0.4920 - acc: 0.8986 - val_loss: 0.5160 - val_acc: 0.8819
Epoch 21/30
 - 86s - loss: 0.4833 - acc: 0.9028 - val_loss: 0.4924 - val_acc: 0.9019
Epoch 22/30
 - 86s - loss: 0.4800 - acc: 0.9057 - val_loss: 0.4909 - val_acc: 0.8995
Epoch 23/30
 - 86s - loss: 0.4736 - acc: 0.9061 - val_loss: 0.4841 - val_acc: 0.9024
Epoch 24/30
 - 86s - loss: 0.4691 - acc: 0.9093 - val_loss: 0.4783 - val_acc: 0.9049
Epoch 25/30
 - 86s - loss: 0.4637 - acc: 0.9131 - val_loss: 0.4731 - val_acc: 0.9083
Epoch 26/30
 - 86s - loss: 0.4595 - acc: 0.9150 - val_loss: 0.4729 - val_acc: 0.9032
Epoch 27/30
 - 86s - loss: 0.4502 - acc: 0.9167 - val_loss: 0.4687 - val_acc: 0.9080
Epoch 28/30
 - 86s - loss: 0.4455 - acc: 0.9202 - val_loss: 0.4670 - val_acc: 0.9098
Epoch 29/30
 - 86s - loss: 0.4389 - acc: 0.9244 - val_loss: 0.4628 - val_acc: 0.9113
Epoch 30/30
 - 86s - loss: 0.4335 - acc: 0.9254 - val_loss: 0.4616 - val_acc: 0.9109

  32/7968 [..............................] - ETA: 6s
  96/7968 [..............................] - ETA: 6s
 160/7968 [..............................] - ETA: 6s
 224/7968 [..............................] - ETA: 6s
 288/7968 [>.............................] - ETA: 6s
 352/7968 [>.............................] - ETA: 6s
 416/7968 [>.............................] - ETA: 6s
 480/7968 [>.............................] - ETA: 6s
 544/7968 [=>............................] - ETA: 6s
 608/7968 [=>............................] - ETA: 6s
 672/7968 [=>............................] - ETA: 6s
 736/7968 [=>............................] - ETA: 6s
 800/7968 [==>...........................] - ETA: 5s
 864/7968 [==>...........................] - ETA: 5s
 928/7968 [==>...........................] - ETA: 5s
 992/7968 [==>...........................] - ETA: 5s
1056/7968 [==>...........................] - ETA: 5s
1120/7968 [===>..........................] - ETA: 5s
1184/7968 [===>..........................] - ETA: 5s
1248/7968 [===>..........................] - ETA: 5s
1312/7968 [===>..........................] - ETA: 5s
1376/7968 [====>.........................] - ETA: 5s
1440/7968 [====>.........................] - ETA: 5s
1504/7968 [====>.........................] - ETA: 5s
1568/7968 [====>.........................] - ETA: 5s
1632/7968 [=====>........................] - ETA: 5s
1696/7968 [=====>........................] - ETA: 5s
1760/7968 [=====>........................] - ETA: 5s
1824/7968 [=====>........................] - ETA: 5s
1888/7968 [======>.......................] - ETA: 5s
1952/7968 [======>.......................] - ETA: 5s
2016/7968 [======>.......................] - ETA: 4s
2080/7968 [======>.......................] - ETA: 4s
2144/7968 [=======>......................] - ETA: 4s
2208/7968 [=======>......................] - ETA: 4s
2272/7968 [=======>......................] - ETA: 4s
2336/7968 [=======>......................] - ETA: 4s
2400/7968 [========>.....................] - ETA: 4s
2464/7968 [========>.....................] - ETA: 4s
2528/7968 [========>.....................] - ETA: 4s
2592/7968 [========>.....................] - ETA: 4s
2656/7968 [=========>....................] - ETA: 4s
2720/7968 [=========>....................] - ETA: 4s
2784/7968 [=========>....................] - ETA: 4s
2848/7968 [=========>....................] - ETA: 4s
2912/7968 [=========>....................] - ETA: 4s
2976/7968 [==========>...................] - ETA: 4s
3040/7968 [==========>...................] - ETA: 4s
3104/7968 [==========>...................] - ETA: 4s
3168/7968 [==========>...................] - ETA: 3s
3232/7968 [===========>..................] - ETA: 3s
3296/7968 [===========>..................] - ETA: 3s
3360/7968 [===========>..................] - ETA: 3s
3424/7968 [===========>..................] - ETA: 3s
3488/7968 [============>.................] - ETA: 3s
3552/7968 [============>.................] - ETA: 3s
3616/7968 [============>.................] - ETA: 3s
3680/7968 [============>.................] - ETA: 3s
3744/7968 [=============>................] - ETA: 3s
3808/7968 [=============>................] - ETA: 3s
3872/7968 [=============>................] - ETA: 3s
3936/7968 [=============>................] - ETA: 3s
4000/7968 [==============>...............] - ETA: 3s
4064/7968 [==============>...............] - ETA: 3s
4128/7968 [==============>...............] - ETA: 3s
4192/7968 [==============>...............] - ETA: 3s
4256/7968 [===============>..............] - ETA: 3s
4320/7968 [===============>..............] - ETA: 3s
4384/7968 [===============>..............] - ETA: 2s
4448/7968 [===============>..............] - ETA: 2s
4512/7968 [===============>..............] - ETA: 2s
4576/7968 [================>.............] - ETA: 2s
4640/7968 [================>.............] - ETA: 2s
4704/7968 [================>.............] - ETA: 2s
4768/7968 [================>.............] - ETA: 2s
4832/7968 [=================>............] - ETA: 2s
4896/7968 [=================>............] - ETA: 2s
4960/7968 [=================>............] - ETA: 2s
5024/7968 [=================>............] - ETA: 2s
5088/7968 [==================>...........] - ETA: 2s
5152/7968 [==================>...........] - ETA: 2s
5216/7968 [==================>...........] - ETA: 2s
5280/7968 [==================>...........] - ETA: 2s
5344/7968 [===================>..........] - ETA: 2s
5408/7968 [===================>..........] - ETA: 2s
5472/7968 [===================>..........] - ETA: 2s
5536/7968 [===================>..........] - ETA: 2s
5600/7968 [====================>.........] - ETA: 1s
5664/7968 [====================>.........] - ETA: 1s
5728/7968 [====================>.........] - ETA: 1s
5792/7968 [====================>.........] - ETA: 1s
5856/7968 [=====================>........] - ETA: 1s
5920/7968 [=====================>........] - ETA: 1s
5984/7968 [=====================>........] - ETA: 1s
6048/7968 [=====================>........] - ETA: 1s
6112/7968 [======================>.......] - ETA: 1s
6176/7968 [======================>.......] - ETA: 1s
6240/7968 [======================>.......] - ETA: 1s
6304/7968 [======================>.......] - ETA: 1s
6368/7968 [======================>.......] - ETA: 1s
6432/7968 [=======================>......] - ETA: 1s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 0s
6880/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7008/7968 [=========================>....] - ETA: 0s
7072/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 7s 832us/step
current val accuracy: 0.9108935742971888
current auc_score ------------------>  0.9718148385984613
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_32 (InputLayer)        (None, 2, 96, 96)         0         
_________________________________________________________________
initial_conv2D (Conv2D)      (None, 16, 96, 96)        288       
_________________________________________________________________
tr_0_bn (BatchNormalization) (None, 16, 96, 96)        64        
_________________________________________________________________
activation_807 (Activation)  (None, 16, 96, 96)        0         
_________________________________________________________________
tr_0_conv2D (Conv2D)         (None, 8, 96, 96)         128       
_________________________________________________________________
average_pooling2d_70 (Averag (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_bn (BatchNormalization) (None, 8, 48, 48)         32        
_________________________________________________________________
activation_808 (Activation)  (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_conv2D (Conv2D)         (None, 4, 48, 48)         32        
_________________________________________________________________
average_pooling2d_71 (Averag (None, 4, 24, 24)         0         
_________________________________________________________________
tr_2_bn (BatchNormalization) (None, 4, 24, 24)         16        
_________________________________________________________________
activation_809 (Activation)  (None, 4, 24, 24)         0         
_________________________________________________________________
tr_2_conv2D (Conv2D)         (None, 2, 24, 24)         8         
_________________________________________________________________
average_pooling2d_72 (Averag (None, 2, 12, 12)         0         
_________________________________________________________________
final_bn (BatchNormalization (None, 2, 12, 12)         8         
_________________________________________________________________
activation_810 (Activation)  (None, 2, 12, 12)         0         
_________________________________________________________________
global_average_pooling2d_32  (None, 2)                 0         
_________________________________________________________________
dense_32 (Dense)             (None, 1)                 3         
=================================================================
Total params: 579
Trainable params: 519
Non-trainable params: 60
_________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 39s - loss: 0.6650 - acc: 0.6348 - val_loss: 0.6361 - val_acc: 0.7061
Epoch 2/30
 - 14s - loss: 0.6204 - acc: 0.7259 - val_loss: 0.6134 - val_acc: 0.7235
Epoch 3/30
 - 14s - loss: 0.5910 - acc: 0.7332 - val_loss: 0.5813 - val_acc: 0.7344
Epoch 4/30
 - 14s - loss: 0.5695 - acc: 0.7389 - val_loss: 0.5835 - val_acc: 0.6985
Epoch 5/30
 - 14s - loss: 0.5529 - acc: 0.7471 - val_loss: 0.5457 - val_acc: 0.7440
Epoch 6/30
 - 14s - loss: 0.5426 - acc: 0.7467 - val_loss: 0.5375 - val_acc: 0.7503
Epoch 7/30
 - 14s - loss: 0.5344 - acc: 0.7504 - val_loss: 0.5290 - val_acc: 0.7460
Epoch 8/30
 - 14s - loss: 0.5254 - acc: 0.7520 - val_loss: 0.5330 - val_acc: 0.7234
Epoch 9/30
 - 14s - loss: 0.5212 - acc: 0.7527 - val_loss: 0.5189 - val_acc: 0.7533
Epoch 10/30
 - 14s - loss: 0.5167 - acc: 0.7520 - val_loss: 0.5486 - val_acc: 0.7476
Epoch 11/30
 - 14s - loss: 0.5145 - acc: 0.7523 - val_loss: 0.5257 - val_acc: 0.7258
Epoch 12/30
 - 14s - loss: 0.5116 - acc: 0.7524 - val_loss: 0.5732 - val_acc: 0.7361

Epoch 00012: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 13/30
 - 14s - loss: 0.5062 - acc: 0.7577 - val_loss: 0.5315 - val_acc: 0.7201
Epoch 14/30
 - 14s - loss: 0.5063 - acc: 0.7569 - val_loss: 0.5115 - val_acc: 0.7347
Epoch 15/30
 - 14s - loss: 0.5031 - acc: 0.7588 - val_loss: 0.5285 - val_acc: 0.7239
Epoch 16/30
 - 14s - loss: 0.5033 - acc: 0.7581 - val_loss: 0.5261 - val_acc: 0.7259
Epoch 17/30
 - 14s - loss: 0.5012 - acc: 0.7570 - val_loss: 0.5265 - val_acc: 0.7494

Epoch 00017: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.
Epoch 18/30
 - 14s - loss: 0.5003 - acc: 0.7603 - val_loss: 0.5013 - val_acc: 0.7509
Epoch 19/30
 - 14s - loss: 0.5006 - acc: 0.7609 - val_loss: 0.4977 - val_acc: 0.7574
Epoch 20/30
 - 13s - loss: 0.4998 - acc: 0.7616 - val_loss: 0.4962 - val_acc: 0.7577
Epoch 21/30
 - 14s - loss: 0.4991 - acc: 0.7616 - val_loss: 0.4958 - val_acc: 0.7617
Epoch 22/30
 - 14s - loss: 0.4997 - acc: 0.7621 - val_loss: 0.4989 - val_acc: 0.7617
Epoch 23/30
 - 14s - loss: 0.4986 - acc: 0.7615 - val_loss: 0.4981 - val_acc: 0.7619
Epoch 24/30
 - 14s - loss: 0.4980 - acc: 0.7606 - val_loss: 0.4957 - val_acc: 0.7578

Epoch 00024: ReduceLROnPlateau reducing learning rate to 1.5811389051842542e-05.
Epoch 25/30
 - 14s - loss: 0.4967 - acc: 0.7630 - val_loss: 0.4940 - val_acc: 0.7577
Epoch 26/30
 - 13s - loss: 0.4975 - acc: 0.7619 - val_loss: 0.4936 - val_acc: 0.7584
Epoch 27/30
 - 14s - loss: 0.4982 - acc: 0.7599 - val_loss: 0.4933 - val_acc: 0.7587
Epoch 28/30
 - 13s - loss: 0.4980 - acc: 0.7624 - val_loss: 0.4933 - val_acc: 0.7592
Epoch 29/30
 - 13s - loss: 0.4962 - acc: 0.7631 - val_loss: 0.4928 - val_acc: 0.7572
Epoch 30/30
 - 14s - loss: 0.4962 - acc: 0.7643 - val_loss: 0.4944 - val_acc: 0.7574

  32/7968 [..............................] - ETA: 1s
 256/7968 [..............................] - ETA: 1s
 480/7968 [>.............................] - ETA: 1s
 704/7968 [=>............................] - ETA: 1s
 928/7968 [==>...........................] - ETA: 1s
1152/7968 [===>..........................] - ETA: 1s
1376/7968 [====>.........................] - ETA: 1s
1600/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2048/7968 [======>.......................] - ETA: 1s
2272/7968 [=======>......................] - ETA: 1s
2496/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2944/7968 [==========>...................] - ETA: 1s
3168/7968 [==========>...................] - ETA: 1s
3392/7968 [===========>..................] - ETA: 1s
3616/7968 [============>.................] - ETA: 0s
3840/7968 [=============>................] - ETA: 0s
4064/7968 [==============>...............] - ETA: 0s
4288/7968 [===============>..............] - ETA: 0s
4512/7968 [===============>..............] - ETA: 0s
4736/7968 [================>.............] - ETA: 0s
4960/7968 [=================>............] - ETA: 0s
5184/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5632/7968 [====================>.........] - ETA: 0s
5856/7968 [=====================>........] - ETA: 0s
6080/7968 [=====================>........] - ETA: 0s
6304/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6976/7968 [=========================>....] - ETA: 0s
7168/7968 [=========================>....] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7616/7968 [===========================>..] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 233us/step
current val accuracy: 0.7574046184738956
current auc_score ------------------>  0.8480253123339788
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_33 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_33[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_811 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 56, 96, 96)   896         activation_811[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_812 (Activation)     (None, 56, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_812[0][0]             
__________________________________________________________________________________________________
concatenate_354 (Concatenate)   (None, 30, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 30, 96, 96)   120         concatenate_354[0][0]            
__________________________________________________________________________________________________
activation_813 (Activation)     (None, 30, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 56, 96, 96)   1680        activation_813[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_814 (Activation)     (None, 56, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_814[0][0]             
__________________________________________________________________________________________________
concatenate_355 (Concatenate)   (None, 44, 96, 96)   0           concatenate_354[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 44, 96, 96)   176         concatenate_355[0][0]            
__________________________________________________________________________________________________
activation_815 (Activation)     (None, 44, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 56, 96, 96)   2464        activation_815[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_816 (Activation)     (None, 56, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_816[0][0]             
__________________________________________________________________________________________________
concatenate_356 (Concatenate)   (None, 58, 96, 96)   0           concatenate_355[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 58, 96, 96)   232         concatenate_356[0][0]            
__________________________________________________________________________________________________
activation_817 (Activation)     (None, 58, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 56, 96, 96)   3248        activation_817[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_818 (Activation)     (None, 56, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_818[0][0]             
__________________________________________________________________________________________________
concatenate_357 (Concatenate)   (None, 72, 96, 96)   0           concatenate_356[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 72, 96, 96)   288         concatenate_357[0][0]            
__________________________________________________________________________________________________
activation_819 (Activation)     (None, 72, 96, 96)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 56, 96, 96)   4032        activation_819[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 56, 96, 96)   224         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_820 (Activation)     (None, 56, 96, 96)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 14, 96, 96)   7056        activation_820[0][0]             
__________________________________________________________________________________________________
concatenate_358 (Concatenate)   (None, 86, 96, 96)   0           concatenate_357[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 86, 96, 96)   344         concatenate_358[0][0]            
__________________________________________________________________________________________________
activation_821 (Activation)     (None, 86, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 43, 96, 96)   3698        activation_821[0][0]             
__________________________________________________________________________________________________
average_pooling2d_73 (AveragePo (None, 43, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 43, 48, 48)   172         average_pooling2d_73[0][0]       
__________________________________________________________________________________________________
activation_822 (Activation)     (None, 43, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 56, 48, 48)   2408        activation_822[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_823 (Activation)     (None, 56, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_823[0][0]             
__________________________________________________________________________________________________
concatenate_359 (Concatenate)   (None, 57, 48, 48)   0           average_pooling2d_73[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 57, 48, 48)   228         concatenate_359[0][0]            
__________________________________________________________________________________________________
activation_824 (Activation)     (None, 57, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 56, 48, 48)   3192        activation_824[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_825 (Activation)     (None, 56, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_825[0][0]             
__________________________________________________________________________________________________
concatenate_360 (Concatenate)   (None, 71, 48, 48)   0           concatenate_359[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 71, 48, 48)   284         concatenate_360[0][0]            
__________________________________________________________________________________________________
activation_826 (Activation)     (None, 71, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 56, 48, 48)   3976        activation_826[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_827 (Activation)     (None, 56, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_827[0][0]             
__________________________________________________________________________________________________
concatenate_361 (Concatenate)   (None, 85, 48, 48)   0           concatenate_360[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 85, 48, 48)   340         concatenate_361[0][0]            
__________________________________________________________________________________________________
activation_828 (Activation)     (None, 85, 48, 48)   0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 56, 48, 48)   4760        activation_828[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_829 (Activation)     (None, 56, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_829[0][0]             
__________________________________________________________________________________________________
concatenate_362 (Concatenate)   (None, 99, 48, 48)   0           concatenate_361[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 99, 48, 48)   396         concatenate_362[0][0]            
__________________________________________________________________________________________________
activation_830 (Activation)     (None, 99, 48, 48)   0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 56, 48, 48)   5544        activation_830[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 56, 48, 48)   224         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_831 (Activation)     (None, 56, 48, 48)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 14, 48, 48)   7056        activation_831[0][0]             
__________________________________________________________________________________________________
concatenate_363 (Concatenate)   (None, 113, 48, 48)  0           concatenate_362[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 113, 48, 48)  452         concatenate_363[0][0]            
__________________________________________________________________________________________________
activation_832 (Activation)     (None, 113, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 56, 48, 48)   6328        activation_832[0][0]             
__________________________________________________________________________________________________
average_pooling2d_74 (AveragePo (None, 56, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 56, 24, 24)   224         average_pooling2d_74[0][0]       
__________________________________________________________________________________________________
activation_833 (Activation)     (None, 56, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 56, 24, 24)   3136        activation_833[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_834 (Activation)     (None, 56, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_834[0][0]             
__________________________________________________________________________________________________
concatenate_364 (Concatenate)   (None, 70, 24, 24)   0           average_pooling2d_74[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 70, 24, 24)   280         concatenate_364[0][0]            
__________________________________________________________________________________________________
activation_835 (Activation)     (None, 70, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 56, 24, 24)   3920        activation_835[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_836 (Activation)     (None, 56, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_836[0][0]             
__________________________________________________________________________________________________
concatenate_365 (Concatenate)   (None, 84, 24, 24)   0           concatenate_364[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 84, 24, 24)   336         concatenate_365[0][0]            
__________________________________________________________________________________________________
activation_837 (Activation)     (None, 84, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 56, 24, 24)   4704        activation_837[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_838 (Activation)     (None, 56, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_838[0][0]             
__________________________________________________________________________________________________
concatenate_366 (Concatenate)   (None, 98, 24, 24)   0           concatenate_365[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 98, 24, 24)   392         concatenate_366[0][0]            
__________________________________________________________________________________________________
activation_839 (Activation)     (None, 98, 24, 24)   0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 56, 24, 24)   5488        activation_839[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_840 (Activation)     (None, 56, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_840[0][0]             
__________________________________________________________________________________________________
concatenate_367 (Concatenate)   (None, 112, 24, 24)  0           concatenate_366[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_367[0][0]            
__________________________________________________________________________________________________
activation_841 (Activation)     (None, 112, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 56, 24, 24)   6272        activation_841[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 56, 24, 24)   224         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_842 (Activation)     (None, 56, 24, 24)   0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 14, 24, 24)   7056        activation_842[0][0]             
__________________________________________________________________________________________________
concatenate_368 (Concatenate)   (None, 126, 24, 24)  0           concatenate_367[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 126, 24, 24)  504         concatenate_368[0][0]            
__________________________________________________________________________________________________
activation_843 (Activation)     (None, 126, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 63, 24, 24)   7938        activation_843[0][0]             
__________________________________________________________________________________________________
average_pooling2d_75 (AveragePo (None, 63, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 63, 12, 12)   252         average_pooling2d_75[0][0]       
__________________________________________________________________________________________________
activation_844 (Activation)     (None, 63, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 56, 12, 12)   3528        activation_844[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_845 (Activation)     (None, 56, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_845[0][0]             
__________________________________________________________________________________________________
concatenate_369 (Concatenate)   (None, 77, 12, 12)   0           average_pooling2d_75[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 77, 12, 12)   308         concatenate_369[0][0]            
__________________________________________________________________________________________________
activation_846 (Activation)     (None, 77, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 56, 12, 12)   4312        activation_846[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_847 (Activation)     (None, 56, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_847[0][0]             
__________________________________________________________________________________________________
concatenate_370 (Concatenate)   (None, 91, 12, 12)   0           concatenate_369[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 91, 12, 12)   364         concatenate_370[0][0]            
__________________________________________________________________________________________________
activation_848 (Activation)     (None, 91, 12, 12)   0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 56, 12, 12)   5096        activation_848[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_849 (Activation)     (None, 56, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_849[0][0]             
__________________________________________________________________________________________________
concatenate_371 (Concatenate)   (None, 105, 12, 12)  0           concatenate_370[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 105, 12, 12)  420         concatenate_371[0][0]            
__________________________________________________________________________________________________
activation_850 (Activation)     (None, 105, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 56, 12, 12)   5880        activation_850[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_851 (Activation)     (None, 56, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_851[0][0]             
__________________________________________________________________________________________________
concatenate_372 (Concatenate)   (None, 119, 12, 12)  0           concatenate_371[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 119, 12, 12)  476         concatenate_372[0][0]            
__________________________________________________________________________________________________
activation_852 (Activation)     (None, 119, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 56, 12, 12)   6664        activation_852[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 56, 12, 12)   224         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_853 (Activation)     (None, 56, 12, 12)   0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 14, 12, 12)   7056        activation_853[0][0]             
__________________________________________________________________________________________________
concatenate_373 (Concatenate)   (None, 133, 12, 12)  0           concatenate_372[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 133, 12, 12)  532         concatenate_373[0][0]            
__________________________________________________________________________________________________
activation_854 (Activation)     (None, 133, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_33 (Gl (None, 133)          0           activation_854[0][0]             
__________________________________________________________________________________________________
dense_33 (Dense)                (None, 1)            134         global_average_pooling2d_33[0][0]
==================================================================================================
Total params: 252,818
Trainable params: 246,762
Non-trainable params: 6,056
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 123s - loss: 0.6249 - acc: 0.8110 - val_loss: 0.5073 - val_acc: 0.8661
Epoch 2/30
 - 87s - loss: 0.4567 - acc: 0.8850 - val_loss: 0.4204 - val_acc: 0.9006
Epoch 3/30
 - 86s - loss: 0.3687 - acc: 0.9170 - val_loss: 0.3714 - val_acc: 0.9193
Epoch 4/30
 - 86s - loss: 0.3104 - acc: 0.9369 - val_loss: 0.3008 - val_acc: 0.9388
Epoch 5/30
 - 86s - loss: 0.2708 - acc: 0.9506 - val_loss: 0.3161 - val_acc: 0.9276
Epoch 6/30
 - 86s - loss: 0.2379 - acc: 0.9605 - val_loss: 0.2992 - val_acc: 0.9350
Epoch 7/30
 - 86s - loss: 0.2188 - acc: 0.9643 - val_loss: 0.2478 - val_acc: 0.9514
Epoch 8/30
 - 86s - loss: 0.1983 - acc: 0.9702 - val_loss: 0.2103 - val_acc: 0.9644
Epoch 9/30
 - 86s - loss: 0.1842 - acc: 0.9739 - val_loss: 0.2591 - val_acc: 0.9445
Epoch 10/30
 - 86s - loss: 0.1676 - acc: 0.9784 - val_loss: 0.2728 - val_acc: 0.9398
Epoch 11/30
 - 87s - loss: 0.1603 - acc: 0.9780 - val_loss: 0.1964 - val_acc: 0.9637
Epoch 12/30
 - 87s - loss: 0.1495 - acc: 0.9807 - val_loss: 0.1922 - val_acc: 0.9645
Epoch 13/30
 - 87s - loss: 0.1433 - acc: 0.9810 - val_loss: 0.2145 - val_acc: 0.9549
Epoch 14/30
 - 87s - loss: 0.1356 - acc: 0.9830 - val_loss: 0.1889 - val_acc: 0.9650
Epoch 15/30
 - 87s - loss: 0.1265 - acc: 0.9851 - val_loss: 0.2159 - val_acc: 0.9595
Epoch 16/30
 - 87s - loss: 0.1256 - acc: 0.9844 - val_loss: 0.1582 - val_acc: 0.9721
Epoch 17/30
 - 87s - loss: 0.1163 - acc: 0.9871 - val_loss: 0.1790 - val_acc: 0.9627
Epoch 18/30
 - 87s - loss: 0.1104 - acc: 0.9879 - val_loss: 0.1482 - val_acc: 0.9758
Epoch 19/30
 - 87s - loss: 0.1087 - acc: 0.9877 - val_loss: 0.1419 - val_acc: 0.9749
Epoch 20/30
 - 86s - loss: 0.1051 - acc: 0.9879 - val_loss: 0.1550 - val_acc: 0.9710
Epoch 21/30
 - 87s - loss: 0.1019 - acc: 0.9891 - val_loss: 0.1536 - val_acc: 0.9731
Epoch 22/30
 - 86s - loss: 0.0980 - acc: 0.9897 - val_loss: 0.2429 - val_acc: 0.9473

Epoch 00022: ReduceLROnPlateau reducing learning rate to 0.00015811389051842542.
Epoch 23/30
 - 86s - loss: 0.0764 - acc: 0.9967 - val_loss: 0.1032 - val_acc: 0.9877
Epoch 24/30
 - 86s - loss: 0.0701 - acc: 0.9986 - val_loss: 0.1033 - val_acc: 0.9863
Epoch 25/30
 - 86s - loss: 0.0681 - acc: 0.9987 - val_loss: 0.1031 - val_acc: 0.9869
Epoch 26/30
 - 86s - loss: 0.0652 - acc: 0.9986 - val_loss: 0.1533 - val_acc: 0.9739
Epoch 27/30
 - 86s - loss: 0.0637 - acc: 0.9985 - val_loss: 0.0950 - val_acc: 0.9881
Epoch 28/30
 - 86s - loss: 0.0633 - acc: 0.9978 - val_loss: 0.1015 - val_acc: 0.9853
Epoch 29/30
 - 86s - loss: 0.0592 - acc: 0.9988 - val_loss: 0.0951 - val_acc: 0.9878
Epoch 30/30
 - 86s - loss: 0.0591 - acc: 0.9983 - val_loss: 0.1035 - val_acc: 0.9848

Epoch 00030: ReduceLROnPlateau reducing learning rate to 5.0000003198030994e-05.

  32/7968 [..............................] - ETA: 6s
  96/7968 [..............................] - ETA: 6s
 160/7968 [..............................] - ETA: 6s
 224/7968 [..............................] - ETA: 6s
 288/7968 [>.............................] - ETA: 6s
 352/7968 [>.............................] - ETA: 6s
 416/7968 [>.............................] - ETA: 6s
 480/7968 [>.............................] - ETA: 6s
 544/7968 [=>............................] - ETA: 6s
 608/7968 [=>............................] - ETA: 6s
 672/7968 [=>............................] - ETA: 6s
 736/7968 [=>............................] - ETA: 6s
 800/7968 [==>...........................] - ETA: 6s
 864/7968 [==>...........................] - ETA: 6s
 928/7968 [==>...........................] - ETA: 5s
 992/7968 [==>...........................] - ETA: 5s
1056/7968 [==>...........................] - ETA: 5s
1120/7968 [===>..........................] - ETA: 5s
1184/7968 [===>..........................] - ETA: 5s
1248/7968 [===>..........................] - ETA: 5s
1312/7968 [===>..........................] - ETA: 5s
1376/7968 [====>.........................] - ETA: 5s
1440/7968 [====>.........................] - ETA: 5s
1504/7968 [====>.........................] - ETA: 5s
1568/7968 [====>.........................] - ETA: 5s
1632/7968 [=====>........................] - ETA: 5s
1696/7968 [=====>........................] - ETA: 5s
1760/7968 [=====>........................] - ETA: 5s
1824/7968 [=====>........................] - ETA: 5s
1888/7968 [======>.......................] - ETA: 5s
1952/7968 [======>.......................] - ETA: 5s
2016/7968 [======>.......................] - ETA: 5s
2080/7968 [======>.......................] - ETA: 4s
2144/7968 [=======>......................] - ETA: 4s
2208/7968 [=======>......................] - ETA: 4s
2272/7968 [=======>......................] - ETA: 4s
2336/7968 [=======>......................] - ETA: 4s
2400/7968 [========>.....................] - ETA: 4s
2464/7968 [========>.....................] - ETA: 4s
2528/7968 [========>.....................] - ETA: 4s
2592/7968 [========>.....................] - ETA: 4s
2656/7968 [=========>....................] - ETA: 4s
2720/7968 [=========>....................] - ETA: 4s
2784/7968 [=========>....................] - ETA: 4s
2848/7968 [=========>....................] - ETA: 4s
2912/7968 [=========>....................] - ETA: 4s
2976/7968 [==========>...................] - ETA: 4s
3040/7968 [==========>...................] - ETA: 4s
3104/7968 [==========>...................] - ETA: 4s
3168/7968 [==========>...................] - ETA: 4s
3232/7968 [===========>..................] - ETA: 4s
3296/7968 [===========>..................] - ETA: 3s
3360/7968 [===========>..................] - ETA: 3s
3424/7968 [===========>..................] - ETA: 3s
3488/7968 [============>.................] - ETA: 3s
3552/7968 [============>.................] - ETA: 3s
3616/7968 [============>.................] - ETA: 3s
3680/7968 [============>.................] - ETA: 3s
3744/7968 [=============>................] - ETA: 3s
3808/7968 [=============>................] - ETA: 3s
3872/7968 [=============>................] - ETA: 3s
3936/7968 [=============>................] - ETA: 3s
4000/7968 [==============>...............] - ETA: 3s
4064/7968 [==============>...............] - ETA: 3s
4128/7968 [==============>...............] - ETA: 3s
4192/7968 [==============>...............] - ETA: 3s
4256/7968 [===============>..............] - ETA: 3s
4320/7968 [===============>..............] - ETA: 3s
4384/7968 [===============>..............] - ETA: 3s
4448/7968 [===============>..............] - ETA: 2s
4512/7968 [===============>..............] - ETA: 2s
4576/7968 [================>.............] - ETA: 2s
4640/7968 [================>.............] - ETA: 2s
4704/7968 [================>.............] - ETA: 2s
4768/7968 [================>.............] - ETA: 2s
4832/7968 [=================>............] - ETA: 2s
4896/7968 [=================>............] - ETA: 2s
4960/7968 [=================>............] - ETA: 2s
5024/7968 [=================>............] - ETA: 2s
5088/7968 [==================>...........] - ETA: 2s
5152/7968 [==================>...........] - ETA: 2s
5216/7968 [==================>...........] - ETA: 2s
5280/7968 [==================>...........] - ETA: 2s
5344/7968 [===================>..........] - ETA: 2s
5408/7968 [===================>..........] - ETA: 2s
5472/7968 [===================>..........] - ETA: 2s
5536/7968 [===================>..........] - ETA: 2s
5600/7968 [====================>.........] - ETA: 1s
5664/7968 [====================>.........] - ETA: 1s
5728/7968 [====================>.........] - ETA: 1s
5792/7968 [====================>.........] - ETA: 1s
5856/7968 [=====================>........] - ETA: 1s
5920/7968 [=====================>........] - ETA: 1s
5984/7968 [=====================>........] - ETA: 1s
6048/7968 [=====================>........] - ETA: 1s
6112/7968 [======================>.......] - ETA: 1s
6176/7968 [======================>.......] - ETA: 1s
6240/7968 [======================>.......] - ETA: 1s
6304/7968 [======================>.......] - ETA: 1s
6368/7968 [======================>.......] - ETA: 1s
6432/7968 [=======================>......] - ETA: 1s
6496/7968 [=======================>......] - ETA: 1s
6560/7968 [=======================>......] - ETA: 1s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 0s
6880/7968 [========================>.....] - ETA: 0s
6944/7968 [=========================>....] - ETA: 0s
7008/7968 [=========================>....] - ETA: 0s
7072/7968 [=========================>....] - ETA: 0s
7136/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7264/7968 [==========================>...] - ETA: 0s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 7s 845us/step
current val accuracy: 0.9848142570281124
current auc_score ------------------>  0.9985380058005963
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_34 (InputLayer)        (None, 2, 96, 96)         0         
_________________________________________________________________
initial_conv2D (Conv2D)      (None, 16, 96, 96)        288       
_________________________________________________________________
tr_0_bn (BatchNormalization) (None, 16, 96, 96)        64        
_________________________________________________________________
activation_855 (Activation)  (None, 16, 96, 96)        0         
_________________________________________________________________
tr_0_conv2D (Conv2D)         (None, 8, 96, 96)         128       
_________________________________________________________________
average_pooling2d_76 (Averag (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_bn (BatchNormalization) (None, 8, 48, 48)         32        
_________________________________________________________________
activation_856 (Activation)  (None, 8, 48, 48)         0         
_________________________________________________________________
tr_1_conv2D (Conv2D)         (None, 4, 48, 48)         32        
_________________________________________________________________
average_pooling2d_77 (Averag (None, 4, 24, 24)         0         
_________________________________________________________________
tr_2_bn (BatchNormalization) (None, 4, 24, 24)         16        
_________________________________________________________________
activation_857 (Activation)  (None, 4, 24, 24)         0         
_________________________________________________________________
tr_2_conv2D (Conv2D)         (None, 2, 24, 24)         8         
_________________________________________________________________
average_pooling2d_78 (Averag (None, 2, 12, 12)         0         
_________________________________________________________________
final_bn (BatchNormalization (None, 2, 12, 12)         8         
_________________________________________________________________
activation_858 (Activation)  (None, 2, 12, 12)         0         
_________________________________________________________________
global_average_pooling2d_34  (None, 2)                 0         
_________________________________________________________________
dense_34 (Dense)             (None, 1)                 3         
=================================================================
Total params: 579
Trainable params: 519
Non-trainable params: 60
_________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 41s - loss: 0.6464 - acc: 0.6746 - val_loss: 0.6160 - val_acc: 0.7078
Epoch 2/30
 - 14s - loss: 0.5728 - acc: 0.7359 - val_loss: 0.5498 - val_acc: 0.7357
Epoch 3/30
 - 15s - loss: 0.5329 - acc: 0.7517 - val_loss: 0.5823 - val_acc: 0.6852
Epoch 4/30
 - 14s - loss: 0.5131 - acc: 0.7574 - val_loss: 0.5360 - val_acc: 0.7484
Epoch 5/30
 - 14s - loss: 0.5018 - acc: 0.7634 - val_loss: 0.5090 - val_acc: 0.7526
Epoch 6/30
 - 14s - loss: 0.4963 - acc: 0.7615 - val_loss: 0.5895 - val_acc: 0.6920
Epoch 7/30
 - 14s - loss: 0.4885 - acc: 0.7663 - val_loss: 0.5133 - val_acc: 0.7366
Epoch 8/30
 - 14s - loss: 0.4829 - acc: 0.7695 - val_loss: 0.5617 - val_acc: 0.7374

Epoch 00008: ReduceLROnPlateau reducing learning rate to 0.00031622778103685084.
Epoch 9/30
 - 14s - loss: 0.4748 - acc: 0.7724 - val_loss: 0.4767 - val_acc: 0.7711
Epoch 10/30
 - 14s - loss: 0.4727 - acc: 0.7753 - val_loss: 0.5581 - val_acc: 0.7500
Epoch 11/30
 - 14s - loss: 0.4719 - acc: 0.7745 - val_loss: 0.4704 - val_acc: 0.7692
Epoch 12/30
 - 14s - loss: 0.4696 - acc: 0.7740 - val_loss: 0.4720 - val_acc: 0.7717
Epoch 13/30
 - 14s - loss: 0.4695 - acc: 0.7758 - val_loss: 0.4746 - val_acc: 0.7737
Epoch 14/30
 - 14s - loss: 0.4692 - acc: 0.7751 - val_loss: 0.5239 - val_acc: 0.7462

Epoch 00014: ReduceLROnPlateau reducing learning rate to 0.00010000000639606199.
Epoch 15/30
 - 14s - loss: 0.4663 - acc: 0.7770 - val_loss: 0.4663 - val_acc: 0.7824
Epoch 16/30
 - 14s - loss: 0.4670 - acc: 0.7775 - val_loss: 0.4617 - val_acc: 0.7848
Epoch 17/30
 - 14s - loss: 0.4631 - acc: 0.7786 - val_loss: 0.4668 - val_acc: 0.7795
Epoch 18/30
 - 14s - loss: 0.4633 - acc: 0.7778 - val_loss: 0.4725 - val_acc: 0.7814
Epoch 19/30
 - 14s - loss: 0.4645 - acc: 0.7780 - val_loss: 0.4729 - val_acc: 0.7776

Epoch 00019: ReduceLROnPlateau reducing learning rate to 3.1622778103685084e-05.
Epoch 20/30
 - 14s - loss: 0.4633 - acc: 0.7801 - val_loss: 0.4557 - val_acc: 0.7851
Epoch 21/30
 - 14s - loss: 0.4623 - acc: 0.7802 - val_loss: 0.4582 - val_acc: 0.7863
Epoch 22/30
 - 14s - loss: 0.4620 - acc: 0.7793 - val_loss: 0.4582 - val_acc: 0.7804
Epoch 23/30
 - 14s - loss: 0.4631 - acc: 0.7796 - val_loss: 0.4563 - val_acc: 0.7815

Epoch 00023: ReduceLROnPlateau reducing learning rate to 1.0000000409520217e-05.
Epoch 24/30
 - 14s - loss: 0.4629 - acc: 0.7781 - val_loss: 0.4552 - val_acc: 0.7871
Epoch 25/30
 - 14s - loss: 0.4628 - acc: 0.7799 - val_loss: 0.4553 - val_acc: 0.7823
Epoch 26/30
 - 14s - loss: 0.4608 - acc: 0.7788 - val_loss: 0.4554 - val_acc: 0.7877
Epoch 27/30
 - 14s - loss: 0.4636 - acc: 0.7803 - val_loss: 0.4554 - val_acc: 0.7835

Epoch 00027: ReduceLROnPlateau reducing learning rate to 3.1622778678900043e-06.
Epoch 28/30
 - 14s - loss: 0.4601 - acc: 0.7805 - val_loss: 0.4548 - val_acc: 0.7864
Epoch 29/30
 - 14s - loss: 0.4615 - acc: 0.7798 - val_loss: 0.4547 - val_acc: 0.7873
Epoch 30/30
 - 14s - loss: 0.4608 - acc: 0.7810 - val_loss: 0.4548 - val_acc: 0.7860

  32/7968 [..............................] - ETA: 1s
 256/7968 [..............................] - ETA: 1s
 480/7968 [>.............................] - ETA: 1s
 704/7968 [=>............................] - ETA: 1s
 928/7968 [==>...........................] - ETA: 1s
1152/7968 [===>..........................] - ETA: 1s
1376/7968 [====>.........................] - ETA: 1s
1600/7968 [=====>........................] - ETA: 1s
1824/7968 [=====>........................] - ETA: 1s
2048/7968 [======>.......................] - ETA: 1s
2272/7968 [=======>......................] - ETA: 1s
2496/7968 [========>.....................] - ETA: 1s
2720/7968 [=========>....................] - ETA: 1s
2944/7968 [==========>...................] - ETA: 1s
3168/7968 [==========>...................] - ETA: 1s
3392/7968 [===========>..................] - ETA: 1s
3616/7968 [============>.................] - ETA: 1s
3840/7968 [=============>................] - ETA: 1s
4064/7968 [==============>...............] - ETA: 0s
4288/7968 [===============>..............] - ETA: 0s
4512/7968 [===============>..............] - ETA: 0s
4736/7968 [================>.............] - ETA: 0s
4960/7968 [=================>............] - ETA: 0s
5184/7968 [==================>...........] - ETA: 0s
5408/7968 [===================>..........] - ETA: 0s
5632/7968 [====================>.........] - ETA: 0s
5856/7968 [=====================>........] - ETA: 0s
6080/7968 [=====================>........] - ETA: 0s
6304/7968 [======================>.......] - ETA: 0s
6528/7968 [=======================>......] - ETA: 0s
6752/7968 [========================>.....] - ETA: 0s
6976/7968 [=========================>....] - ETA: 0s
7200/7968 [==========================>...] - ETA: 0s
7424/7968 [==========================>...] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7872/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 2s 244us/step
current val accuracy: 0.7860190763052208
current auc_score ------------------>  0.8695142454335677
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_35 (InputLayer)           (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_35[0][0]                   
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_859 (Activation)     (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_859[0][0]             
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_860 (Activation)     (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_860[0][0]             
__________________________________________________________________________________________________
concatenate_374 (Concatenate)   (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_374[0][0]            
__________________________________________________________________________________________________
activation_861 (Activation)     (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_861[0][0]             
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_862 (Activation)     (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_862[0][0]             
__________________________________________________________________________________________________
concatenate_375 (Concatenate)   (None, 76, 96, 96)   0           concatenate_374[0][0]            
                                                                 dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_375[0][0]            
__________________________________________________________________________________________________
activation_863 (Activation)     (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_863[0][0]             
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_864 (Activation)     (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_864[0][0]             
__________________________________________________________________________________________________
concatenate_376 (Concatenate)   (None, 106, 96, 96)  0           concatenate_375[0][0]            
                                                                 dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_376[0][0]            
__________________________________________________________________________________________________
activation_865 (Activation)     (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_865[0][0]             
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_866 (Activation)     (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_866[0][0]             
__________________________________________________________________________________________________
concatenate_377 (Concatenate)   (None, 136, 96, 96)  0           concatenate_376[0][0]            
                                                                 dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_377[0][0]            
__________________________________________________________________________________________________
activation_867 (Activation)     (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_867[0][0]             
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_868 (Activation)     (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_868[0][0]             
__________________________________________________________________________________________________
concatenate_378 (Concatenate)   (None, 166, 96, 96)  0           concatenate_377[0][0]            
                                                                 dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_378[0][0]            
__________________________________________________________________________________________________
activation_869 (Activation)     (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_869[0][0]             
__________________________________________________________________________________________________
average_pooling2d_79 (AveragePo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_79[0][0]       
__________________________________________________________________________________________________
activation_870 (Activation)     (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_870[0][0]             
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_871 (Activation)     (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_871[0][0]             
__________________________________________________________________________________________________
concatenate_379 (Concatenate)   (None, 113, 48, 48)  0           average_pooling2d_79[0][0]       
                                                                 dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_379[0][0]            
__________________________________________________________________________________________________
activation_872 (Activation)     (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_872[0][0]             
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_873 (Activation)     (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_873[0][0]             
__________________________________________________________________________________________________
concatenate_380 (Concatenate)   (None, 143, 48, 48)  0           concatenate_379[0][0]            
                                                                 dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_380[0][0]            
__________________________________________________________________________________________________
activation_874 (Activation)     (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_874[0][0]             
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_875 (Activation)     (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_875[0][0]             
__________________________________________________________________________________________________
concatenate_381 (Concatenate)   (None, 173, 48, 48)  0           concatenate_380[0][0]            
                                                                 dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_381[0][0]            
__________________________________________________________________________________________________
activation_876 (Activation)     (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_876[0][0]             
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_877 (Activation)     (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_877[0][0]             
__________________________________________________________________________________________________
concatenate_382 (Concatenate)   (None, 203, 48, 48)  0           concatenate_381[0][0]            
                                                                 dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_382[0][0]            
__________________________________________________________________________________________________
activation_878 (Activation)     (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_878[0][0]             
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_879 (Activation)     (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_879[0][0]             
__________________________________________________________________________________________________
concatenate_383 (Concatenate)   (None, 233, 48, 48)  0           concatenate_382[0][0]            
                                                                 dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_383[0][0]            
__________________________________________________________________________________________________
activation_880 (Activation)     (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_880[0][0]             
__________________________________________________________________________________________________
average_pooling2d_80 (AveragePo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_80[0][0]       
__________________________________________________________________________________________________
activation_881 (Activation)     (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_881[0][0]             
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_882 (Activation)     (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_882[0][0]             
__________________________________________________________________________________________________
concatenate_384 (Concatenate)   (None, 146, 24, 24)  0           average_pooling2d_80[0][0]       
                                                                 dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_384[0][0]            
__________________________________________________________________________________________________
activation_883 (Activation)     (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_883[0][0]             
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_884 (Activation)     (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_884[0][0]             
__________________________________________________________________________________________________
concatenate_385 (Concatenate)   (None, 176, 24, 24)  0           concatenate_384[0][0]            
                                                                 dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_385[0][0]            
__________________________________________________________________________________________________
activation_885 (Activation)     (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_885[0][0]             
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_886 (Activation)     (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_886[0][0]             
__________________________________________________________________________________________________
concatenate_386 (Concatenate)   (None, 206, 24, 24)  0           concatenate_385[0][0]            
                                                                 dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_386[0][0]            
__________________________________________________________________________________________________
activation_887 (Activation)     (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_887[0][0]             
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_888 (Activation)     (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_888[0][0]             
__________________________________________________________________________________________________
concatenate_387 (Concatenate)   (None, 236, 24, 24)  0           concatenate_386[0][0]            
                                                                 dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_387[0][0]            
__________________________________________________________________________________________________
activation_889 (Activation)     (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_889[0][0]             
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_890 (Activation)     (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_890[0][0]             
__________________________________________________________________________________________________
concatenate_388 (Concatenate)   (None, 266, 24, 24)  0           concatenate_387[0][0]            
                                                                 dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_388[0][0]            
__________________________________________________________________________________________________
activation_891 (Activation)     (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_891[0][0]             
__________________________________________________________________________________________________
average_pooling2d_81 (AveragePo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_81[0][0]       
__________________________________________________________________________________________________
activation_892 (Activation)     (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_892[0][0]             
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_893 (Activation)     (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_893[0][0]             
__________________________________________________________________________________________________
concatenate_389 (Concatenate)   (None, 163, 12, 12)  0           average_pooling2d_81[0][0]       
                                                                 dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_389[0][0]            
__________________________________________________________________________________________________
activation_894 (Activation)     (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_894[0][0]             
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_895 (Activation)     (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_895[0][0]             
__________________________________________________________________________________________________
concatenate_390 (Concatenate)   (None, 193, 12, 12)  0           concatenate_389[0][0]            
                                                                 dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_390[0][0]            
__________________________________________________________________________________________________
activation_896 (Activation)     (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_896[0][0]             
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_897 (Activation)     (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_897[0][0]             
__________________________________________________________________________________________________
concatenate_391 (Concatenate)   (None, 223, 12, 12)  0           concatenate_390[0][0]            
                                                                 dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_391[0][0]            
__________________________________________________________________________________________________
activation_898 (Activation)     (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_898[0][0]             
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_899 (Activation)     (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_899[0][0]             
__________________________________________________________________________________________________
concatenate_392 (Concatenate)   (None, 253, 12, 12)  0           concatenate_391[0][0]            
                                                                 dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_392[0][0]            
__________________________________________________________________________________________________
activation_900 (Activation)     (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_900[0][0]             
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_901 (Activation)     (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_901[0][0]             
__________________________________________________________________________________________________
concatenate_393 (Concatenate)   (None, 283, 12, 12)  0           concatenate_392[0][0]            
                                                                 dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_393[0][0]            
__________________________________________________________________________________________________
activation_902 (Activation)     (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_35 (Gl (None, 283)          0           activation_902[0][0]             
__________________________________________________________________________________________________
dense_35 (Dense)                (None, 1)            284         global_average_pooling2d_35[0][0]
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/30
 - 180s - loss: 0.6076 - acc: 0.7574 - val_loss: 0.9063 - val_acc: 0.4975
Epoch 2/30
 - 144s - loss: 0.4472 - acc: 0.8023 - val_loss: 0.5350 - val_acc: 0.7269
Epoch 3/30
 - 144s - loss: 0.3871 - acc: 0.8415 - val_loss: 0.4306 - val_acc: 0.8040
Epoch 4/30
 - 144s - loss: 0.3363 - acc: 0.8700 - val_loss: 0.4574 - val_acc: 0.8446
Epoch 5/30
 - 144s - loss: 0.2904 - acc: 0.8947 - val_loss: 0.3146 - val_acc: 0.8859
Epoch 6/30
 - 144s - loss: 0.2514 - acc: 0.9152 - val_loss: 0.3289 - val_acc: 0.8747
Epoch 7/30
 - 144s - loss: 0.2217 - acc: 0.9269 - val_loss: 0.2304 - val_acc: 0.9288
Epoch 8/30
 - 144s - loss: 0.1963 - acc: 0.9395 - val_loss: 0.2113 - val_acc: 0.9331
Epoch 9/30
 - 144s - loss: 0.1795 - acc: 0.9456 - val_loss: 0.2241 - val_acc: 0.9306
Epoch 10/30
 - 144s - loss: 0.1709 - acc: 0.9497 - val_loss: 0.1532 - val_acc: 0.9547
Epoch 11/30
 - 144s - loss: 0.1555 - acc: 0.9554 - val_loss: 0.3235 - val_acc: 0.8953
Epoch 12/30
 - 144s - loss: 0.1494 - acc: 0.9580 - val_loss: 0.2212 - val_acc: 0.9307
Epoch 13/30
 - 144s - loss: 0.1363 - acc: 0.9621 - val_loss: 0.3328 - val_acc: 0.8886

Epoch 00013: ReduceLROnPlateau reducing learning rate to 0.0015811387947429827.
Epoch 14/30
 - 144s - loss: 0.0951 - acc: 0.9781 - val_loss: 0.1091 - val_acc: 0.9718
Epoch 15/30
 - 144s - loss: 0.0835 - acc: 0.9816 - val_loss: 0.1008 - val_acc: 0.9748
Epoch 16/30
 - 144s - loss: 0.0753 - acc: 0.9822 - val_loss: 0.1091 - val_acc: 0.9701
Epoch 17/30
 - 146s - loss: 0.0714 - acc: 0.9835 - val_loss: 0.0943 - val_acc: 0.9767
Epoch 18/30
 - 144s - loss: 0.0679 - acc: 0.9846 - val_loss: 0.1010 - val_acc: 0.9730
Epoch 19/30
 - 144s - loss: 0.0631 - acc: 0.9866 - val_loss: 0.1067 - val_acc: 0.9706
Epoch 20/30
 - 144s - loss: 0.0630 - acc: 0.9858 - val_loss: 0.0881 - val_acc: 0.9767
Epoch 21/30
 - 144s - loss: 0.0616 - acc: 0.9864 - val_loss: 0.1118 - val_acc: 0.9708
Epoch 22/30
 - 144s - loss: 0.0545 - acc: 0.9889 - val_loss: 0.0758 - val_acc: 0.9800
Epoch 23/30
 - 144s - loss: 0.0543 - acc: 0.9886 - val_loss: 0.0840 - val_acc: 0.9770
Epoch 24/30
 - 144s - loss: 0.0557 - acc: 0.9884 - val_loss: 0.0897 - val_acc: 0.9772
Epoch 25/30
 - 144s - loss: 0.0492 - acc: 0.9903 - val_loss: 0.0945 - val_acc: 0.9760

Epoch 00025: ReduceLROnPlateau reducing learning rate to 0.0004999999951665528.
Epoch 26/30
 - 144s - loss: 0.0399 - acc: 0.9941 - val_loss: 0.0675 - val_acc: 0.9838
Epoch 27/30
 - 144s - loss: 0.0357 - acc: 0.9952 - val_loss: 0.0637 - val_acc: 0.9838
Epoch 28/30
 - 144s - loss: 0.0337 - acc: 0.9959 - val_loss: 0.0648 - val_acc: 0.9848
Epoch 29/30
 - 144s - loss: 0.0331 - acc: 0.9951 - val_loss: 0.0608 - val_acc: 0.9846
Epoch 30/30
 - 144s - loss: 0.0295 - acc: 0.9972 - val_loss: 0.0627 - val_acc: 0.9858

  32/7968 [..............................] - ETA: 11s
  96/7968 [..............................] - ETA: 11s
 160/7968 [..............................] - ETA: 11s
 224/7968 [..............................] - ETA: 11s
 288/7968 [>.............................] - ETA: 11s
 352/7968 [>.............................] - ETA: 11s
 416/7968 [>.............................] - ETA: 11s
 480/7968 [>.............................] - ETA: 10s
 544/7968 [=>............................] - ETA: 10s
 608/7968 [=>............................] - ETA: 10s
 672/7968 [=>............................] - ETA: 10s
 736/7968 [=>............................] - ETA: 10s
 800/7968 [==>...........................] - ETA: 10s
 864/7968 [==>...........................] - ETA: 10s
 928/7968 [==>...........................] - ETA: 10s
 992/7968 [==>...........................] - ETA: 10s
1056/7968 [==>...........................] - ETA: 10s
1120/7968 [===>..........................] - ETA: 10s
1184/7968 [===>..........................] - ETA: 9s 
1248/7968 [===>..........................] - ETA: 9s
1312/7968 [===>..........................] - ETA: 9s
1376/7968 [====>.........................] - ETA: 9s
1440/7968 [====>.........................] - ETA: 9s
1504/7968 [====>.........................] - ETA: 9s
1568/7968 [====>.........................] - ETA: 9s
1632/7968 [=====>........................] - ETA: 9s
1696/7968 [=====>........................] - ETA: 9s
1760/7968 [=====>........................] - ETA: 9s
1824/7968 [=====>........................] - ETA: 8s
1888/7968 [======>.......................] - ETA: 8s
1952/7968 [======>.......................] - ETA: 8s
2016/7968 [======>.......................] - ETA: 8s
2080/7968 [======>.......................] - ETA: 8s
2144/7968 [=======>......................] - ETA: 8s
2208/7968 [=======>......................] - ETA: 8s
2272/7968 [=======>......................] - ETA: 8s
2336/7968 [=======>......................] - ETA: 8s
2400/7968 [========>.....................] - ETA: 8s
2464/7968 [========>.....................] - ETA: 8s
2528/7968 [========>.....................] - ETA: 7s
2592/7968 [========>.....................] - ETA: 7s
2656/7968 [=========>....................] - ETA: 7s
2720/7968 [=========>....................] - ETA: 7s
2784/7968 [=========>....................] - ETA: 7s
2848/7968 [=========>....................] - ETA: 7s
2912/7968 [=========>....................] - ETA: 7s
2976/7968 [==========>...................] - ETA: 7s
3040/7968 [==========>...................] - ETA: 7s
3104/7968 [==========>...................] - ETA: 7s
3168/7968 [==========>...................] - ETA: 7s
3232/7968 [===========>..................] - ETA: 6s
3296/7968 [===========>..................] - ETA: 6s
3360/7968 [===========>..................] - ETA: 6s
3424/7968 [===========>..................] - ETA: 6s
3488/7968 [============>.................] - ETA: 6s
3552/7968 [============>.................] - ETA: 6s
3616/7968 [============>.................] - ETA: 6s
3680/7968 [============>.................] - ETA: 6s
3744/7968 [=============>................] - ETA: 6s
3808/7968 [=============>................] - ETA: 6s
3872/7968 [=============>................] - ETA: 5s
3936/7968 [=============>................] - ETA: 5s
4000/7968 [==============>...............] - ETA: 5s
4064/7968 [==============>...............] - ETA: 5s
4128/7968 [==============>...............] - ETA: 5s
4192/7968 [==============>...............] - ETA: 5s
4256/7968 [===============>..............] - ETA: 5s
4320/7968 [===============>..............] - ETA: 5s
4384/7968 [===============>..............] - ETA: 5s
4448/7968 [===============>..............] - ETA: 5s
4512/7968 [===============>..............] - ETA: 5s
4576/7968 [================>.............] - ETA: 4s
4640/7968 [================>.............] - ETA: 4s
4704/7968 [================>.............] - ETA: 4s
4768/7968 [================>.............] - ETA: 4s
4832/7968 [=================>............] - ETA: 4s
4896/7968 [=================>............] - ETA: 4s
4960/7968 [=================>............] - ETA: 4s
5024/7968 [=================>............] - ETA: 4s
5088/7968 [==================>...........] - ETA: 4s
5152/7968 [==================>...........] - ETA: 4s
5216/7968 [==================>...........] - ETA: 4s
5280/7968 [==================>...........] - ETA: 3s
5344/7968 [===================>..........] - ETA: 3s
5408/7968 [===================>..........] - ETA: 3s
5472/7968 [===================>..........] - ETA: 3s
5536/7968 [===================>..........] - ETA: 3s
5600/7968 [====================>.........] - ETA: 3s
5664/7968 [====================>.........] - ETA: 3s
5728/7968 [====================>.........] - ETA: 3s
5792/7968 [====================>.........] - ETA: 3s
5856/7968 [=====================>........] - ETA: 3s
5920/7968 [=====================>........] - ETA: 2s
5984/7968 [=====================>........] - ETA: 2s
6048/7968 [=====================>........] - ETA: 2s
6112/7968 [======================>.......] - ETA: 2s
6176/7968 [======================>.......] - ETA: 2s
6240/7968 [======================>.......] - ETA: 2s
6304/7968 [======================>.......] - ETA: 2s
6368/7968 [======================>.......] - ETA: 2s
6432/7968 [=======================>......] - ETA: 2s
6496/7968 [=======================>......] - ETA: 2s
6560/7968 [=======================>......] - ETA: 2s
6624/7968 [=======================>......] - ETA: 1s
6688/7968 [========================>.....] - ETA: 1s
6752/7968 [========================>.....] - ETA: 1s
6816/7968 [========================>.....] - ETA: 1s
6880/7968 [========================>.....] - ETA: 1s
6944/7968 [=========================>....] - ETA: 1s
7008/7968 [=========================>....] - ETA: 1s
7072/7968 [=========================>....] - ETA: 1s
7136/7968 [=========================>....] - ETA: 1s
7200/7968 [==========================>...] - ETA: 1s
7264/7968 [==========================>...] - ETA: 1s
7328/7968 [==========================>...] - ETA: 0s
7392/7968 [==========================>...] - ETA: 0s
7456/7968 [===========================>..] - ETA: 0s
7520/7968 [===========================>..] - ETA: 0s
7584/7968 [===========================>..] - ETA: 0s
7648/7968 [===========================>..] - ETA: 0s
7712/7968 [============================>.] - ETA: 0s
7776/7968 [============================>.] - ETA: 0s
7840/7968 [============================>.] - ETA: 0s
7904/7968 [============================>.] - ETA: 0s
7968/7968 [==============================] - 12s 1ms/step
python hyperas_dn_lr_optimizer_test1.py -n 20
python hyperas_dn_lr_optimizer_test2.py -n 20
python hyperas_dn_lr_optimizer_test3.py -n 20
python hyperas_dn_lr_optimizer_test4.py -n 20
python hyperas_dn_lr_optimizer_test5.py -n 15
python hyperas_dn_lr_optimizer_test6.py -n 15
