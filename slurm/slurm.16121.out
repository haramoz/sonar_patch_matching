export OMP_NUM_THREADS=64
python hyperas_dn_lr.py -n 100
python hyperas_dn_dropout.py -n 20
python hyperas_dn_batchsize.py -n 20
keras_dn_simple.py
no of  evals 100
>>> Imports:
#coding=utf-8

try:
    import numpy as np
except:
    pass

try:
    import random
except:
    pass

try:
    import h5py
except:
    pass

try:
    import tensorflow as tf
except:
    pass

try:
    import matplotlib.pyplot as plt
except:
    pass

try:
    import keras.backend as K
except:
    pass

try:
    from keras.initializers import RandomNormal
except:
    pass

try:
    from keras.layers.core import Dense, Dropout, Activation
except:
    pass

try:
    from keras.layers.pooling import AveragePooling2D, GlobalAveragePooling2D
except:
    pass

try:
    from keras.layers import Input, concatenate, Concatenate
except:
    pass

try:
    from keras.layers import normalization, BatchNormalization, Lambda
except:
    pass

try:
    from keras.layers import Flatten, Conv2D, MaxPooling2D
except:
    pass

try:
    from keras.regularizers import l2
except:
    pass

try:
    from keras.optimizers import RMSprop, Adam
except:
    pass

try:
    from keras.utils import np_utils
except:
    pass

try:
    from keras.models import Model, Sequential
except:
    pass

try:
    from keras.models import model_from_json
except:
    pass

try:
    from keras.models import load_model
except:
    pass

try:
    import keras.initializers
except:
    pass

try:
    from keras.losses import binary_crossentropy
except:
    pass

try:
    from keras.callbacks import EarlyStopping, ModelCheckpoint, ReduceLROnPlateau
except:
    pass

try:
    from keras.utils import multi_gpu_model
except:
    pass

try:
    from sklearn.metrics import accuracy_score
except:
    pass

try:
    from sklearn.metrics import roc_auc_score
except:
    pass

try:
    from sklearn.model_selection import train_test_split
except:
    pass

try:
    from hyperopt import Trials, STATUS_OK, tpe
except:
    pass

try:
    from hyperas import optim
except:
    pass

try:
    from hyperas.distributions import choice, uniform
except:
    pass

try:
    from keras_contrib.applications import DenseNet
except:
    pass

try:
    import argparse
except:
    pass

>>> Hyperas search space:

def get_space():
    return {
        'epochs': hp.choice('epochs', [3,5,7,10]),
        'dropout': hp.uniform('dropout', 0.1,0.5),
        'depth': hp.choice('depth', [28,31,34,25]),
        'growth_rate': hp.choice('growth_rate', [12,18,24,30]),
        'lr': hp.choice('lr', [2E-4,1E-4,5E-4]),
    }

>>> Functions
  1: def process_data():
  2:     random_seed = 7
  3: 
  4:     f = h5py.File('/home/amalli2s/thesis/keras/matchedImagesSplitClasses-2017-02-24-17-39-44-96-96-split-val0.15-tr0.7-tst0.15.hdf5','r')
  5:     X_train = f['X_train'].value
  6:     y_train = f['y_train'].value
  7:     X_test = f['X_val'].value
  8:     y_test = f['y_val'].value
  9:     X_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size=0.2, random_state=random_seed)
 10:  
 11:     return X_train,y_train,X_val,y_val,X_test,y_test
 12: 
 13: 
>>> Data
 1: 
 2: X_train,y_train,X_val,y_val,X_test,y_test = process_data()
 3: 
 4: 
 5: 
>>> Resulting replaced keras model:

   1: def keras_fmin_fnct(space):
   2: 
   3:     K.clear_session()
   4:     epochs = space['epochs']
   5:     es_patience = 5
   6:     lr_patience = 3
   7:     dropout = space['dropout']
   8:     depth = space['depth']
   9:     nb_dense_block = 4
  10:     nb_filter = 16
  11:     growth_rate = space['growth_rate']
  12:     bn = True
  13:     reduction_ = 0.5
  14:     bs = 8
  15:     lr = space['lr']
  16:     weight_file = 'keras_dn_wt_07Oct2030.h5'
  17:     nb_classes = 1
  18:     img_dim = (2,96,96) 
  19:     n_channels = 2
  20:     print("------------------------ current config for the test -------------------------")
  21:     print("Depth: ",depth," Growth_rate: ",growth_rate," lr: ",lr," nb_filter: ",nb_filter," dropout: ",dropout)
  22:     print("Epochs ",epochs," batch_size: ",bs," es_patience: ",es_patience," lr_patience: ",lr_patience)
  23:     print("dense_block ",nb_dense_block," reduction_: ",reduction_," bottleneck: ",bn,)
  24:     print("------------------------       end of configs        -------------------------")
  25: 
  26:     model  = DenseNet(depth=depth, nb_dense_block=nb_dense_block,
  27:                  growth_rate=growth_rate, nb_filter=nb_filter,
  28:                  dropout_rate=dropout,activation='sigmoid',
  29:                  input_shape=img_dim,include_top=True,
  30:                  bottleneck=bn,reduction=reduction_,
  31:                  classes=nb_classes,pooling='avg',
  32:                  weights=None)
  33:     
  34: 
  35:     model.summary()
  36:     opt = Adam(lr=lr)
  37:     model.compile(loss=binary_crossentropy, optimizer=opt, metrics=['accuracy'])
  38: 
  39:     es = EarlyStopping(monitor='val_loss', patience=es_patience,verbose=1)
  40:     checkpointer = ModelCheckpoint(filepath=weight_file,verbose=1, save_best_only=True)
  41: 
  42:     lr_reducer = ReduceLROnPlateau(monitor='val_loss', factor=np.sqrt(0.1), cooldown=0, patience=lr_patience, min_lr=0.5e-6,verbose=1)
  43: 
  44:     model.fit(X_train,y_train,
  45:           batch_size=bs,
  46:           epochs=epochs,
  47:           callbacks=[lr_reducer,es],
  48:           validation_data=(X_val,y_val),
  49:           verbose=2)
  50:     
  51:     score, acc = model.evaluate(X_test,y_test)
  52:     print('current test accuracy:', acc)
  53:     pred = model.predict(X_test)
  54:     auc_score = roc_auc_score(y_test,pred)
  55:     print("current test auc_score ------------------> ",auc_score)
  56: 
  57:     #model = load_model(weight_file) #This is the best model
  58:     #score, acc = model.evaluate(X_test,y_test)
  59:     #print('Best saved model test accuracy:', acc)
  60:     #pred = model.predict(X_test)
  61:     #auc_score = roc_auc_score(y_test,pred)
  62:     #print("best saved model test auc_score ------------------> ",auc_score)
  63: 
  64:     
  65:     return {'loss': -auc_score, 'status': STATUS_OK, 'model': model}  
  66: 
------------------------ current config for the test -------------------------
Depth:  31  Growth_rate:  18  lr:  0.0005  nb_filter:  16  dropout:  0.37701561372628756
Epochs  3  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 96, 96)   1152        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 72, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 96, 96)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 96, 96)   2448        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 72, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 96, 96)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 52, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 96, 96)   3744        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 72, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 96, 96)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 70, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 96, 96)   5040        activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 72, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 96, 96)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 88, 96, 96)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 88, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 44, 96, 96)   3872        activation_9[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 44, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 44, 48, 48)   176         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 44, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 72, 48, 48)   3168        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 62, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 62, 48, 48)   248         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 62, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 72, 48, 48)   4464        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 80, 48, 48)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 80, 48, 48)   320         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 80, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 72, 48, 48)   5760        activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 98, 48, 48)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 98, 48, 48)   392         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 98, 48, 48)   0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 72, 48, 48)   7056        activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 116, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 116, 48, 48)  464         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 116, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 58, 48, 48)   6728        activation_18[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 58, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 58, 24, 24)   232         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 58, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 72, 24, 24)   4176        activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 72, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 76, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 76, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 72, 24, 24)   5472        activation_21[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 72, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 94, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 94, 24, 24)   376         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 94, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 72, 24, 24)   6768        activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 72, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 112, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 112, 24, 24)  448         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 112, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 72, 24, 24)   8064        activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 72, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 130, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 130, 24, 24)  520         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 130, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 65, 24, 24)   8450        activation_27[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 65, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 65, 12, 12)   260         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 65, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 72, 12, 12)   4680        activation_28[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 72, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 18, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 83, 12, 12)   0           average_pooling2d_3[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 83, 12, 12)   332         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 83, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 72, 12, 12)   5976        activation_30[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 72, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 18, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 101, 12, 12)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 101, 12, 12)  404         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 101, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 72, 12, 12)   7272        activation_32[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 72, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 18, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 119, 12, 12)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 119, 12, 12)  476         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 119, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 72, 12, 12)   8568        activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 72, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 18, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 137, 12, 12)  0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 137, 12, 12)  548         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 137, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 137)          0           activation_36[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            138         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 301,056
Trainable params: 295,482
Non-trainable params: 5,574
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/3
 - 252s - loss: 0.6309 - acc: 0.7723 - val_loss: 0.5914 - val_acc: 0.7613
Epoch 2/3
 - 240s - loss: 0.4795 - acc: 0.8190 - val_loss: 0.4500 - val_acc: 0.8257
Epoch 3/3
 - 240s - loss: 0.4165 - acc: 0.8469 - val_loss: 0.3576 - val_acc: 0.8750

  32/7440 [..............................] - ETA: 38s
  96/7440 [..............................] - ETA: 16s
 192/7440 [..............................] - ETA: 10s
 288/7440 [>.............................] - ETA: 8s 
 384/7440 [>.............................] - ETA: 7s
 480/7440 [>.............................] - ETA: 7s
 576/7440 [=>............................] - ETA: 6s
 672/7440 [=>............................] - ETA: 6s
 768/7440 [==>...........................] - ETA: 6s
 864/7440 [==>...........................] - ETA: 5s
 960/7440 [==>...........................] - ETA: 5s
1056/7440 [===>..........................] - ETA: 5s
1152/7440 [===>..........................] - ETA: 5s
1248/7440 [====>.........................] - ETA: 5s
1344/7440 [====>.........................] - ETA: 5s
1440/7440 [====>.........................] - ETA: 5s
1536/7440 [=====>........................] - ETA: 4s
1632/7440 [=====>........................] - ETA: 4s
1728/7440 [=====>........................] - ETA: 4s
1824/7440 [======>.......................] - ETA: 4s
1920/7440 [======>.......................] - ETA: 4s
2016/7440 [=======>......................] - ETA: 4s
2112/7440 [=======>......................] - ETA: 4s
2208/7440 [=======>......................] - ETA: 4s
2304/7440 [========>.....................] - ETA: 4s
2400/7440 [========>.....................] - ETA: 4s
2496/7440 [=========>....................] - ETA: 3s
2592/7440 [=========>....................] - ETA: 3s
2688/7440 [=========>....................] - ETA: 3s
2784/7440 [==========>...................] - ETA: 3s
2880/7440 [==========>...................] - ETA: 3s
2976/7440 [===========>..................] - ETA: 3s
3072/7440 [===========>..................] - ETA: 3s
3168/7440 [===========>..................] - ETA: 3s
3264/7440 [============>.................] - ETA: 3s
3360/7440 [============>.................] - ETA: 3s
3456/7440 [============>.................] - ETA: 3s
3552/7440 [=============>................] - ETA: 3s
3648/7440 [=============>................] - ETA: 2s
3744/7440 [==============>...............] - ETA: 2s
3840/7440 [==============>...............] - ETA: 2s
3936/7440 [==============>...............] - ETA: 2s
4032/7440 [===============>..............] - ETA: 2s
4128/7440 [===============>..............] - ETA: 2s
4224/7440 [================>.............] - ETA: 2s
4320/7440 [================>.............] - ETA: 2s
4416/7440 [================>.............] - ETA: 2s
4512/7440 [=================>............] - ETA: 2s
4608/7440 [=================>............] - ETA: 2s
4704/7440 [=================>............] - ETA: 2s
4800/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 1s
4992/7440 [===================>..........] - ETA: 1s
5088/7440 [===================>..........] - ETA: 1s
5184/7440 [===================>..........] - ETA: 1s
5280/7440 [====================>.........] - ETA: 1s
5376/7440 [====================>.........] - ETA: 1s
5472/7440 [=====================>........] - ETA: 1s
5568/7440 [=====================>........] - ETA: 1s
5664/7440 [=====================>........] - ETA: 1s
5760/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5952/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6144/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 0s
6336/7440 [========================>.....] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6528/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6720/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6912/7440 [==========================>...] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7104/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7296/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 6s 780us/step
current test accuracy: 0.8026881720430108
current test auc_score ------------------>  0.8848272921725054
------------------------ current config for the test -------------------------
Depth:  31  Growth_rate:  24  lr:  0.0002  nb_filter:  16  dropout:  0.2700914467473825
Epochs  5  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 96, 96)   1536        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 96, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 96, 96)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 40, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 96, 96)   3840        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 96, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 96, 96)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 64, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 96, 96)   6144        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 96, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 96, 96)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 88, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 96, 96)   8448        activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 96, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 96, 96)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 112, 96, 96)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 112, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 56, 96, 96)   6272        activation_9[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 56, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 56, 48, 48)   224         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 56, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 48, 48)   5376        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 80, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 48, 48)   320         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 80, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 48, 48)   7680        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 104, 48, 48)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 104, 48, 48)  416         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 104, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 48, 48)   9984        activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 48, 48)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 128, 48, 48)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 128, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 48, 48)   12288       activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 152, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 152, 48, 48)  608         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 152, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 76, 48, 48)   11552       activation_18[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 76, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 76, 24, 24)   304         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 76, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 24, 24)   7296        activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 100, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 100, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 24, 24)   9600        activation_21[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 96, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 124, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 124, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 24, 24)   11904       activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 148, 24, 24)  592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 148, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 24, 24)   14208       activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 172, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 172, 24, 24)  688         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 172, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 86, 24, 24)   14792       activation_27[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 86, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 86, 12, 12)   344         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 86, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 12, 12)   8256        activation_28[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 96, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 110, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 12, 12)  440         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 110, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 12, 12)   10560       activation_30[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 96, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 134, 12, 12)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 134, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 12, 12)   12864       activation_32[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 96, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 158, 12, 12)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 158, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 12, 12)   15168       activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 96, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 182, 12, 12)  0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 182, 12, 12)  728         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 182, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 182)          0           activation_36[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            183         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 524,679
Trainable params: 517,347
Non-trainable params: 7,332
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
 - 253s - loss: 0.7448 - acc: 0.7800 - val_loss: 0.6212 - val_acc: 0.8244
Epoch 2/5
 - 247s - loss: 0.5767 - acc: 0.8378 - val_loss: 0.4902 - val_acc: 0.8756
Epoch 3/5
 - 248s - loss: 0.4819 - acc: 0.8759 - val_loss: 0.4359 - val_acc: 0.8911
Epoch 4/5
 - 250s - loss: 0.4230 - acc: 0.8948 - val_loss: 1.0617 - val_acc: 0.7324
Epoch 5/5
 - 250s - loss: 0.3766 - acc: 0.9107 - val_loss: 0.2958 - val_acc: 0.9418

  32/7440 [..............................] - ETA: 50s
  96/7440 [..............................] - ETA: 20s
 160/7440 [..............................] - ETA: 14s
 224/7440 [..............................] - ETA: 12s
 288/7440 [>.............................] - ETA: 11s
 352/7440 [>.............................] - ETA: 10s
 416/7440 [>.............................] - ETA: 9s 
 480/7440 [>.............................] - ETA: 8s
 544/7440 [=>............................] - ETA: 8s
 608/7440 [=>............................] - ETA: 8s
 672/7440 [=>............................] - ETA: 8s
 736/7440 [=>............................] - ETA: 7s
 800/7440 [==>...........................] - ETA: 7s
 864/7440 [==>...........................] - ETA: 7s
 928/7440 [==>...........................] - ETA: 7s
 992/7440 [===>..........................] - ETA: 7s
1056/7440 [===>..........................] - ETA: 6s
1120/7440 [===>..........................] - ETA: 6s
1184/7440 [===>..........................] - ETA: 6s
1248/7440 [====>.........................] - ETA: 6s
1312/7440 [====>.........................] - ETA: 6s
1376/7440 [====>.........................] - ETA: 6s
1440/7440 [====>.........................] - ETA: 6s
1504/7440 [=====>........................] - ETA: 6s
1568/7440 [=====>........................] - ETA: 6s
1632/7440 [=====>........................] - ETA: 5s
1696/7440 [=====>........................] - ETA: 5s
1760/7440 [======>.......................] - ETA: 5s
1824/7440 [======>.......................] - ETA: 5s
1888/7440 [======>.......................] - ETA: 5s
1952/7440 [======>.......................] - ETA: 5s
2016/7440 [=======>......................] - ETA: 5s
2080/7440 [=======>......................] - ETA: 5s
2144/7440 [=======>......................] - ETA: 5s
2208/7440 [=======>......................] - ETA: 5s
2272/7440 [========>.....................] - ETA: 5s
2336/7440 [========>.....................] - ETA: 5s
2400/7440 [========>.....................] - ETA: 4s
2464/7440 [========>.....................] - ETA: 4s
2528/7440 [=========>....................] - ETA: 4s
2592/7440 [=========>....................] - ETA: 4s
2656/7440 [=========>....................] - ETA: 4s
2720/7440 [=========>....................] - ETA: 4s
2784/7440 [==========>...................] - ETA: 4s
2848/7440 [==========>...................] - ETA: 4s
2912/7440 [==========>...................] - ETA: 4s
2976/7440 [===========>..................] - ETA: 4s
3040/7440 [===========>..................] - ETA: 4s
3104/7440 [===========>..................] - ETA: 4s
3168/7440 [===========>..................] - ETA: 4s
3232/7440 [============>.................] - ETA: 4s
3296/7440 [============>.................] - ETA: 4s
3360/7440 [============>.................] - ETA: 3s
3424/7440 [============>.................] - ETA: 3s
3488/7440 [=============>................] - ETA: 3s
3552/7440 [=============>................] - ETA: 3s
3616/7440 [=============>................] - ETA: 3s
3680/7440 [=============>................] - ETA: 3s
3744/7440 [==============>...............] - ETA: 3s
3808/7440 [==============>...............] - ETA: 3s
3872/7440 [==============>...............] - ETA: 3s
3936/7440 [==============>...............] - ETA: 3s
4000/7440 [===============>..............] - ETA: 3s
4064/7440 [===============>..............] - ETA: 3s
4128/7440 [===============>..............] - ETA: 3s
4192/7440 [===============>..............] - ETA: 3s
4256/7440 [================>.............] - ETA: 3s
4320/7440 [================>.............] - ETA: 2s
4384/7440 [================>.............] - ETA: 2s
4448/7440 [================>.............] - ETA: 2s
4512/7440 [=================>............] - ETA: 2s
4576/7440 [=================>............] - ETA: 2s
4640/7440 [=================>............] - ETA: 2s
4704/7440 [=================>............] - ETA: 2s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 2s
5088/7440 [===================>..........] - ETA: 2s
5152/7440 [===================>..........] - ETA: 2s
5216/7440 [====================>.........] - ETA: 2s
5280/7440 [====================>.........] - ETA: 2s
5344/7440 [====================>.........] - ETA: 1s
5408/7440 [====================>.........] - ETA: 1s
5472/7440 [=====================>........] - ETA: 1s
5536/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 1s
6304/7440 [========================>.....] - ETA: 1s
6368/7440 [========================>.....] - ETA: 1s
6432/7440 [========================>.....] - ETA: 0s
6496/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 7s 959us/step
current test accuracy: 0.7354838709677419
current test auc_score ------------------>  0.8842034845068796
------------------------ current config for the test -------------------------
Depth:  31  Growth_rate:  24  lr:  0.0001  nb_filter:  16  dropout:  0.3910232662433938
Epochs  7  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 96, 96, 96)   1536        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 96, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 24, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 40, 96, 96)   160         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 40, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 96, 96, 96)   3840        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 96, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 24, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 64, 96, 96)   256         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 64, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 96, 96, 96)   6144        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 96, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 24, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 88, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 88, 96, 96)   352         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 88, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 96, 96, 96)   8448        activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 96, 96, 96)   384         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 96, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 24, 96, 96)   20736       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 24, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 96, 96)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 112, 96, 96)  448         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 112, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 56, 96, 96)   6272        activation_9[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 56, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 56, 48, 48)   224         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 56, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 96, 48, 48)   5376        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 96, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 24, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 80, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 80, 48, 48)   320         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 80, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 96, 48, 48)   7680        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 96, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 24, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 104, 48, 48)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 104, 48, 48)  416         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 104, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 96, 48, 48)   9984        activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 96, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 24, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128, 48, 48)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 128, 48, 48)  512         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 128, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 96, 48, 48)   12288       activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 96, 48, 48)   384         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 96, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 24, 48, 48)   20736       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 24, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 152, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 152, 48, 48)  608         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 152, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 76, 48, 48)   11552       activation_18[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 76, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 76, 24, 24)   304         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 76, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 96, 24, 24)   7296        activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 96, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 24, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 100, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 100, 24, 24)  400         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 100, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 96, 24, 24)   9600        activation_21[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 96, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 24, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 124, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 124, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 96, 24, 24)   11904       activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 96, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 24, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 148, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 148, 24, 24)  592         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 148, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 96, 24, 24)   14208       activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 96, 24, 24)   384         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 96, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 24, 24, 24)   20736       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 24, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 172, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 172, 24, 24)  688         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 172, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 86, 24, 24)   14792       activation_27[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 86, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 86, 12, 12)   344         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 86, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 96, 12, 12)   8256        activation_28[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 96, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 24, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 110, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 12, 12)  440         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 110, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 96, 12, 12)   10560       activation_30[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 96, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 24, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 134, 12, 12)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 134, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 96, 12, 12)   12864       activation_32[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 96, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 24, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 158, 12, 12)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 158, 12, 12)  632         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 158, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 96, 12, 12)   15168       activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 96, 12, 12)   384         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 96, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 24, 12, 12)   20736       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 24, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 182, 12, 12)  0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 182, 12, 12)  728         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 182, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 182)          0           activation_36[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            183         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 524,679
Trainable params: 517,347
Non-trainable params: 7,332
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 257s - loss: 0.8034 - acc: 0.7646 - val_loss: 0.7445 - val_acc: 0.7905
Epoch 2/7
 - 251s - loss: 0.6862 - acc: 0.8130 - val_loss: 0.7335 - val_acc: 0.7745
Epoch 3/7
 - 250s - loss: 0.6198 - acc: 0.8399 - val_loss: 0.6368 - val_acc: 0.8199
Epoch 4/7
 - 251s - loss: 0.5681 - acc: 0.8591 - val_loss: 0.5109 - val_acc: 0.8844
Epoch 5/7
 - 250s - loss: 0.5258 - acc: 0.8742 - val_loss: 0.5236 - val_acc: 0.8687
Epoch 6/7
 - 250s - loss: 0.4931 - acc: 0.8877 - val_loss: 0.5056 - val_acc: 0.8771
Epoch 7/7
 - 252s - loss: 0.4625 - acc: 0.8969 - val_loss: 0.4663 - val_acc: 0.8981

  32/7440 [..............................] - ETA: 7s
  96/7440 [..............................] - ETA: 7s
 160/7440 [..............................] - ETA: 7s
 224/7440 [..............................] - ETA: 6s
 288/7440 [>.............................] - ETA: 6s
 352/7440 [>.............................] - ETA: 6s
 416/7440 [>.............................] - ETA: 6s
 480/7440 [>.............................] - ETA: 6s
 544/7440 [=>............................] - ETA: 6s
 608/7440 [=>............................] - ETA: 6s
 672/7440 [=>............................] - ETA: 6s
 736/7440 [=>............................] - ETA: 6s
 800/7440 [==>...........................] - ETA: 6s
 864/7440 [==>...........................] - ETA: 6s
 928/7440 [==>...........................] - ETA: 6s
 992/7440 [===>..........................] - ETA: 5s
1056/7440 [===>..........................] - ETA: 5s
1120/7440 [===>..........................] - ETA: 5s
1184/7440 [===>..........................] - ETA: 5s
1248/7440 [====>.........................] - ETA: 5s
1312/7440 [====>.........................] - ETA: 5s
1376/7440 [====>.........................] - ETA: 5s
1440/7440 [====>.........................] - ETA: 5s
1504/7440 [=====>........................] - ETA: 5s
1568/7440 [=====>........................] - ETA: 5s
1632/7440 [=====>........................] - ETA: 5s
1696/7440 [=====>........................] - ETA: 5s
1760/7440 [======>.......................] - ETA: 5s
1824/7440 [======>.......................] - ETA: 5s
1888/7440 [======>.......................] - ETA: 5s
1952/7440 [======>.......................] - ETA: 5s
2016/7440 [=======>......................] - ETA: 4s
2080/7440 [=======>......................] - ETA: 4s
2144/7440 [=======>......................] - ETA: 4s
2208/7440 [=======>......................] - ETA: 4s
2272/7440 [========>.....................] - ETA: 4s
2336/7440 [========>.....................] - ETA: 4s
2400/7440 [========>.....................] - ETA: 4s
2464/7440 [========>.....................] - ETA: 4s
2528/7440 [=========>....................] - ETA: 4s
2592/7440 [=========>....................] - ETA: 4s
2656/7440 [=========>....................] - ETA: 4s
2720/7440 [=========>....................] - ETA: 4s
2784/7440 [==========>...................] - ETA: 4s
2848/7440 [==========>...................] - ETA: 4s
2912/7440 [==========>...................] - ETA: 4s
2976/7440 [===========>..................] - ETA: 4s
3040/7440 [===========>..................] - ETA: 4s
3104/7440 [===========>..................] - ETA: 3s
3168/7440 [===========>..................] - ETA: 3s
3232/7440 [============>.................] - ETA: 3s
3296/7440 [============>.................] - ETA: 3s
3360/7440 [============>.................] - ETA: 3s
3424/7440 [============>.................] - ETA: 3s
3488/7440 [=============>................] - ETA: 3s
3552/7440 [=============>................] - ETA: 3s
3616/7440 [=============>................] - ETA: 3s
3680/7440 [=============>................] - ETA: 3s
3744/7440 [==============>...............] - ETA: 3s
3808/7440 [==============>...............] - ETA: 3s
3872/7440 [==============>...............] - ETA: 3s
3936/7440 [==============>...............] - ETA: 3s
4000/7440 [===============>..............] - ETA: 3s
4064/7440 [===============>..............] - ETA: 3s
4128/7440 [===============>..............] - ETA: 3s
4192/7440 [===============>..............] - ETA: 2s
4256/7440 [================>.............] - ETA: 2s
4320/7440 [================>.............] - ETA: 2s
4384/7440 [================>.............] - ETA: 2s
4448/7440 [================>.............] - ETA: 2s
4512/7440 [=================>............] - ETA: 2s
4576/7440 [=================>............] - ETA: 2s
4640/7440 [=================>............] - ETA: 2s
4704/7440 [=================>............] - ETA: 2s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 2s
5088/7440 [===================>..........] - ETA: 2s
5152/7440 [===================>..........] - ETA: 2s
5216/7440 [====================>.........] - ETA: 2s
5280/7440 [====================>.........] - ETA: 1s
5344/7440 [====================>.........] - ETA: 1s
5408/7440 [====================>.........] - ETA: 1s
5472/7440 [=====================>........] - ETA: 1s
5536/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 1s
6304/7440 [========================>.....] - ETA: 1s
6368/7440 [========================>.....] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6496/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 7s 920us/step
current test accuracy: 0.7012096774193548
current test auc_score ------------------>  0.8788096167186958
------------------------ current config for the test -------------------------
Depth:  25  Growth_rate:  18  lr:  0.0001  nb_filter:  16  dropout:  0.265064829124285
Epochs  5  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 96, 96)   1152        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 72, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 96, 96)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 96, 96)   2448        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 72, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 96, 96)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 52, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 96, 96)   3744        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 72, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 70, 96, 96)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 70, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 35, 96, 96)   2450        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 35, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 35, 48, 48)   140         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 35, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 72, 48, 48)   2520        activation_8[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 72, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 53, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 53, 48, 48)   212         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 53, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 72, 48, 48)   3816        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 72, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 71, 48, 48)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 71, 48, 48)   284         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 71, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 72, 48, 48)   5112        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 89, 48, 48)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 89, 48, 48)   356         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 89, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 44, 48, 48)   3916        activation_14[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 44, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 44, 24, 24)   176         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 44, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 72, 24, 24)   3168        activation_15[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 72, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 62, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 62, 24, 24)   248         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 62, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 72, 24, 24)   4464        activation_17[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 72, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 80, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 80, 24, 24)   320         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 80, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 72, 24, 24)   5760        activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 72, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 98, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 98, 24, 24)   392         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 98, 24, 24)   0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 49, 24, 24)   4802        activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 49, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 49, 12, 12)   196         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 49, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 72, 12, 12)   3528        activation_22[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 72, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 67, 12, 12)   0           average_pooling2d_3[0][0]        
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 67, 12, 12)   268         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 67, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 72, 12, 12)   4824        activation_24[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 72, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 85, 12, 12)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 85, 12, 12)   340         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 85, 12, 12)   0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 72, 12, 12)   6120        activation_26[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 72, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 103, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 103, 12, 12)  412         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 103, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 103)          0           activation_28[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            104         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 205,672
Trainable params: 201,928
Non-trainable params: 3,744
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
 - 215s - loss: 0.6807 - acc: 0.7620 - val_loss: 0.6861 - val_acc: 0.7454
Epoch 2/5
 - 206s - loss: 0.5930 - acc: 0.8056 - val_loss: 0.5638 - val_acc: 0.8081
Epoch 3/5
 - 206s - loss: 0.5440 - acc: 0.8298 - val_loss: 0.5168 - val_acc: 0.8352
Epoch 4/5
 - 206s - loss: 0.5078 - acc: 0.8486 - val_loss: 0.5315 - val_acc: 0.8194
Epoch 5/5
 - 203s - loss: 0.4774 - acc: 0.8623 - val_loss: 0.4429 - val_acc: 0.8789

  32/7440 [..............................] - ETA: 13s
 128/7440 [..............................] - ETA: 6s 
 224/7440 [..............................] - ETA: 5s
 320/7440 [>.............................] - ETA: 5s
 416/7440 [>.............................] - ETA: 4s
 512/7440 [=>............................] - ETA: 4s
 608/7440 [=>............................] - ETA: 4s
 704/7440 [=>............................] - ETA: 4s
 800/7440 [==>...........................] - ETA: 4s
 896/7440 [==>...........................] - ETA: 4s
 992/7440 [===>..........................] - ETA: 4s
1088/7440 [===>..........................] - ETA: 4s
1184/7440 [===>..........................] - ETA: 4s
1280/7440 [====>.........................] - ETA: 3s
1376/7440 [====>.........................] - ETA: 3s
1472/7440 [====>.........................] - ETA: 3s
1568/7440 [=====>........................] - ETA: 3s
1664/7440 [=====>........................] - ETA: 3s
1760/7440 [======>.......................] - ETA: 3s
1856/7440 [======>.......................] - ETA: 3s
1952/7440 [======>.......................] - ETA: 3s
2048/7440 [=======>......................] - ETA: 3s
2144/7440 [=======>......................] - ETA: 3s
2240/7440 [========>.....................] - ETA: 3s
2336/7440 [========>.....................] - ETA: 3s
2432/7440 [========>.....................] - ETA: 3s
2528/7440 [=========>....................] - ETA: 3s
2624/7440 [=========>....................] - ETA: 3s
2720/7440 [=========>....................] - ETA: 2s
2816/7440 [==========>...................] - ETA: 2s
2912/7440 [==========>...................] - ETA: 2s
3008/7440 [===========>..................] - ETA: 2s
3104/7440 [===========>..................] - ETA: 2s
3200/7440 [===========>..................] - ETA: 2s
3296/7440 [============>.................] - ETA: 2s
3392/7440 [============>.................] - ETA: 2s
3488/7440 [=============>................] - ETA: 2s
3584/7440 [=============>................] - ETA: 2s
3680/7440 [=============>................] - ETA: 2s
3776/7440 [==============>...............] - ETA: 2s
3872/7440 [==============>...............] - ETA: 2s
3968/7440 [===============>..............] - ETA: 2s
4064/7440 [===============>..............] - ETA: 2s
4160/7440 [===============>..............] - ETA: 2s
4256/7440 [================>.............] - ETA: 1s
4352/7440 [================>.............] - ETA: 1s
4448/7440 [================>.............] - ETA: 1s
4544/7440 [=================>............] - ETA: 1s
4640/7440 [=================>............] - ETA: 1s
4736/7440 [==================>...........] - ETA: 1s
4832/7440 [==================>...........] - ETA: 1s
4928/7440 [==================>...........] - ETA: 1s
5024/7440 [===================>..........] - ETA: 1s
5120/7440 [===================>..........] - ETA: 1s
5216/7440 [====================>.........] - ETA: 1s
5312/7440 [====================>.........] - ETA: 1s
5408/7440 [====================>.........] - ETA: 1s
5504/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5696/7440 [=====================>........] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5888/7440 [======================>.......] - ETA: 0s
5984/7440 [=======================>......] - ETA: 0s
6080/7440 [=======================>......] - ETA: 0s
6176/7440 [=======================>......] - ETA: 0s
6272/7440 [========================>.....] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6464/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6656/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6848/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7040/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7424/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 5s 622us/step
current test accuracy: 0.759005376344086
current test auc_score ------------------>  0.9052415741704244
------------------------ current config for the test -------------------------
Depth:  34  Growth_rate:  30  lr:  0.0002  nb_filter:  16  dropout:  0.2498540016669627
Epochs  7  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 96, 96)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 96, 96)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_9[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 96, 96)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 96, 96)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_11[0][0]              
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 113, 48, 48)  0           average_pooling2d_1[0][0]        
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 143, 48, 48)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 173, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_18[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 203, 48, 48)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_20[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 48, 48)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 233, 48, 48)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 146, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 176, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_27[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 206, 24, 24)  0           concatenate_12[0][0]             
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_29[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 236, 24, 24)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_31[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 24, 24)   0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 266, 24, 24)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_33[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 163, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_36[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 193, 12, 12)  0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_38[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 223, 12, 12)  0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_40[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_41[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 253, 12, 12)  0           concatenate_18[0][0]             
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_42[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_43[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 12, 12)   0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 283, 12, 12)  0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 283)          0           activation_44[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            284         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 319s - loss: 0.8751 - acc: 0.7776 - val_loss: 0.7509 - val_acc: 0.8128
Epoch 2/7
 - 309s - loss: 0.6163 - acc: 0.8495 - val_loss: 0.5138 - val_acc: 0.8779
Epoch 3/7
 - 308s - loss: 0.4958 - acc: 0.8843 - val_loss: 0.4253 - val_acc: 0.9065
Epoch 4/7
 - 309s - loss: 0.4108 - acc: 0.9104 - val_loss: 0.3499 - val_acc: 0.9223
Epoch 5/7
 - 310s - loss: 0.3496 - acc: 0.9264 - val_loss: 0.2838 - val_acc: 0.9528
Epoch 6/7
 - 306s - loss: 0.3086 - acc: 0.9384 - val_loss: 0.3069 - val_acc: 0.9300
Epoch 7/7
 - 305s - loss: 0.2800 - acc: 0.9443 - val_loss: 0.2981 - val_acc: 0.9334

  32/7440 [..............................] - ETA: 1:28
  96/7440 [..............................] - ETA: 36s 
 160/7440 [..............................] - ETA: 25s
 224/7440 [..............................] - ETA: 21s
 288/7440 [>.............................] - ETA: 18s
 352/7440 [>.............................] - ETA: 16s
 416/7440 [>.............................] - ETA: 15s
 480/7440 [>.............................] - ETA: 14s
 544/7440 [=>............................] - ETA: 14s
 576/7440 [=>............................] - ETA: 13s
 640/7440 [=>............................] - ETA: 13s
 704/7440 [=>............................] - ETA: 12s
 768/7440 [==>...........................] - ETA: 12s
 832/7440 [==>...........................] - ETA: 12s
 896/7440 [==>...........................] - ETA: 11s
 960/7440 [==>...........................] - ETA: 11s
1024/7440 [===>..........................] - ETA: 11s
1088/7440 [===>..........................] - ETA: 11s
1152/7440 [===>..........................] - ETA: 10s
1216/7440 [===>..........................] - ETA: 10s
1280/7440 [====>.........................] - ETA: 10s
1344/7440 [====>.........................] - ETA: 10s
1408/7440 [====>.........................] - ETA: 10s
1472/7440 [====>.........................] - ETA: 9s 
1536/7440 [=====>........................] - ETA: 9s
1600/7440 [=====>........................] - ETA: 9s
1664/7440 [=====>........................] - ETA: 9s
1728/7440 [=====>........................] - ETA: 9s
1792/7440 [======>.......................] - ETA: 9s
1856/7440 [======>.......................] - ETA: 8s
1920/7440 [======>.......................] - ETA: 8s
1984/7440 [=======>......................] - ETA: 8s
2048/7440 [=======>......................] - ETA: 8s
2112/7440 [=======>......................] - ETA: 8s
2176/7440 [=======>......................] - ETA: 8s
2240/7440 [========>.....................] - ETA: 8s
2304/7440 [========>.....................] - ETA: 8s
2368/7440 [========>.....................] - ETA: 7s
2432/7440 [========>.....................] - ETA: 7s
2496/7440 [=========>....................] - ETA: 7s
2560/7440 [=========>....................] - ETA: 7s
2624/7440 [=========>....................] - ETA: 7s
2688/7440 [=========>....................] - ETA: 7s
2752/7440 [==========>...................] - ETA: 7s
2816/7440 [==========>...................] - ETA: 7s
2880/7440 [==========>...................] - ETA: 7s
2944/7440 [==========>...................] - ETA: 6s
3008/7440 [===========>..................] - ETA: 6s
3072/7440 [===========>..................] - ETA: 6s
3136/7440 [===========>..................] - ETA: 6s
3200/7440 [===========>..................] - ETA: 6s
3264/7440 [============>.................] - ETA: 6s
3328/7440 [============>.................] - ETA: 6s
3392/7440 [============>.................] - ETA: 6s
3456/7440 [============>.................] - ETA: 6s
3520/7440 [=============>................] - ETA: 5s
3584/7440 [=============>................] - ETA: 5s
3648/7440 [=============>................] - ETA: 5s
3712/7440 [=============>................] - ETA: 5s
3776/7440 [==============>...............] - ETA: 5s
3840/7440 [==============>...............] - ETA: 5s
3904/7440 [==============>...............] - ETA: 5s
3968/7440 [===============>..............] - ETA: 5s
4032/7440 [===============>..............] - ETA: 5s
4096/7440 [===============>..............] - ETA: 5s
4160/7440 [===============>..............] - ETA: 4s
4224/7440 [================>.............] - ETA: 4s
4288/7440 [================>.............] - ETA: 4s
4352/7440 [================>.............] - ETA: 4s
4416/7440 [================>.............] - ETA: 4s
4480/7440 [=================>............] - ETA: 4s
4544/7440 [=================>............] - ETA: 4s
4608/7440 [=================>............] - ETA: 4s
4672/7440 [=================>............] - ETA: 4s
4736/7440 [==================>...........] - ETA: 4s
4800/7440 [==================>...........] - ETA: 3s
4864/7440 [==================>...........] - ETA: 3s
4928/7440 [==================>...........] - ETA: 3s
4992/7440 [===================>..........] - ETA: 3s
5056/7440 [===================>..........] - ETA: 3s
5120/7440 [===================>..........] - ETA: 3s
5184/7440 [===================>..........] - ETA: 3s
5248/7440 [====================>.........] - ETA: 3s
5312/7440 [====================>.........] - ETA: 3s
5376/7440 [====================>.........] - ETA: 3s
5440/7440 [====================>.........] - ETA: 2s
5504/7440 [=====================>........] - ETA: 2s
5568/7440 [=====================>........] - ETA: 2s
5632/7440 [=====================>........] - ETA: 2s
5696/7440 [=====================>........] - ETA: 2s
5760/7440 [======================>.......] - ETA: 2s
5824/7440 [======================>.......] - ETA: 2s
5888/7440 [======================>.......] - ETA: 2s
5952/7440 [=======================>......] - ETA: 2s
6016/7440 [=======================>......] - ETA: 2s
6080/7440 [=======================>......] - ETA: 2s
6144/7440 [=======================>......] - ETA: 1s
6208/7440 [========================>.....] - ETA: 1s
6272/7440 [========================>.....] - ETA: 1s
6336/7440 [========================>.....] - ETA: 1s
6400/7440 [========================>.....] - ETA: 1s
6464/7440 [=========================>....] - ETA: 1s
6528/7440 [=========================>....] - ETA: 1s
6592/7440 [=========================>....] - ETA: 1s
6656/7440 [=========================>....] - ETA: 1s
6720/7440 [==========================>...] - ETA: 1s
6784/7440 [==========================>...] - ETA: 0s
6848/7440 [==========================>...] - ETA: 0s
6912/7440 [==========================>...] - ETA: 0s
6976/7440 [===========================>..] - ETA: 0s
7040/7440 [===========================>..] - ETA: 0s
7104/7440 [===========================>..] - ETA: 0s
7168/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7296/7440 [============================>.] - ETA: 0s
7360/7440 [============================>.] - ETA: 0s
7424/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 11s 1ms/step
current test accuracy: 0.7654569892473119
current test auc_score ------------------>  0.8559683922996879
------------------------ current config for the test -------------------------
Depth:  25  Growth_rate:  30  lr:  0.0005  nb_filter:  16  dropout:  0.39713376369586395
Epochs  7  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 96, 96)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 96, 96)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 106, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 96, 96)   5618        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 53, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 48, 48)   212         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 53, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  6360        activation_8[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 48, 48)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 83, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 48, 48)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 113, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 48, 48)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 48, 48)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 143, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 48, 48)   10153       activation_14[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 71, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 24, 24)   284         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 71, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  8520        activation_15[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 24, 24)  404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 101, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  12120       activation_17[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 24, 24)  524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 131, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  15720       activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 24, 24)  644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 161, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 24, 24)   12880       activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 80, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 80, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 12, 12)  440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 110, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  13200       activation_24[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 12, 12)  560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 140, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  16800       activation_26[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 12, 12)  680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 170, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 170)          0           activation_28[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            171         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 552,470
Trainable params: 546,390
Non-trainable params: 6,080
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/7
 - 220s - loss: 0.6531 - acc: 0.7705 - val_loss: 0.5583 - val_acc: 0.8081
Epoch 2/7
 - 214s - loss: 0.4786 - acc: 0.8170 - val_loss: 0.4733 - val_acc: 0.8134
Epoch 3/7
 - 213s - loss: 0.4166 - acc: 0.8462 - val_loss: 0.3808 - val_acc: 0.8735
Epoch 4/7
 - 209s - loss: 0.3635 - acc: 0.8697 - val_loss: 0.5040 - val_acc: 0.8495
Epoch 5/7
 - 208s - loss: 0.3290 - acc: 0.8874 - val_loss: 0.3358 - val_acc: 0.8901
Epoch 6/7
 - 211s - loss: 0.3018 - acc: 0.8986 - val_loss: 0.4968 - val_acc: 0.8429
Epoch 7/7
 - 212s - loss: 0.2754 - acc: 0.9100 - val_loss: 0.2890 - val_acc: 0.9031

  32/7440 [..............................] - ETA: 16s
  96/7440 [..............................] - ETA: 9s 
 160/7440 [..............................] - ETA: 8s
 224/7440 [..............................] - ETA: 7s
 288/7440 [>.............................] - ETA: 6s
 352/7440 [>.............................] - ETA: 6s
 416/7440 [>.............................] - ETA: 6s
 480/7440 [>.............................] - ETA: 6s
 544/7440 [=>............................] - ETA: 6s
 608/7440 [=>............................] - ETA: 6s
 672/7440 [=>............................] - ETA: 5s
 736/7440 [=>............................] - ETA: 5s
 800/7440 [==>...........................] - ETA: 5s
 864/7440 [==>...........................] - ETA: 5s
 928/7440 [==>...........................] - ETA: 5s
 992/7440 [===>..........................] - ETA: 5s
1056/7440 [===>..........................] - ETA: 5s
1120/7440 [===>..........................] - ETA: 5s
1184/7440 [===>..........................] - ETA: 5s
1248/7440 [====>.........................] - ETA: 5s
1312/7440 [====>.........................] - ETA: 5s
1376/7440 [====>.........................] - ETA: 5s
1440/7440 [====>.........................] - ETA: 5s
1504/7440 [=====>........................] - ETA: 4s
1568/7440 [=====>........................] - ETA: 4s
1632/7440 [=====>........................] - ETA: 4s
1696/7440 [=====>........................] - ETA: 4s
1760/7440 [======>.......................] - ETA: 4s
1824/7440 [======>.......................] - ETA: 4s
1888/7440 [======>.......................] - ETA: 4s
1952/7440 [======>.......................] - ETA: 4s
2016/7440 [=======>......................] - ETA: 4s
2080/7440 [=======>......................] - ETA: 4s
2144/7440 [=======>......................] - ETA: 4s
2208/7440 [=======>......................] - ETA: 4s
2272/7440 [========>.....................] - ETA: 4s
2336/7440 [========>.....................] - ETA: 4s
2400/7440 [========>.....................] - ETA: 4s
2464/7440 [========>.....................] - ETA: 4s
2528/7440 [=========>....................] - ETA: 4s
2592/7440 [=========>....................] - ETA: 4s
2656/7440 [=========>....................] - ETA: 3s
2720/7440 [=========>....................] - ETA: 3s
2784/7440 [==========>...................] - ETA: 3s
2848/7440 [==========>...................] - ETA: 3s
2912/7440 [==========>...................] - ETA: 3s
2976/7440 [===========>..................] - ETA: 3s
3040/7440 [===========>..................] - ETA: 3s
3104/7440 [===========>..................] - ETA: 3s
3168/7440 [===========>..................] - ETA: 3s
3232/7440 [============>.................] - ETA: 3s
3296/7440 [============>.................] - ETA: 3s
3360/7440 [============>.................] - ETA: 3s
3424/7440 [============>.................] - ETA: 3s
3488/7440 [=============>................] - ETA: 3s
3552/7440 [=============>................] - ETA: 3s
3616/7440 [=============>................] - ETA: 3s
3680/7440 [=============>................] - ETA: 3s
3744/7440 [==============>...............] - ETA: 3s
3808/7440 [==============>...............] - ETA: 2s
3872/7440 [==============>...............] - ETA: 2s
3936/7440 [==============>...............] - ETA: 2s
4000/7440 [===============>..............] - ETA: 2s
4064/7440 [===============>..............] - ETA: 2s
4128/7440 [===============>..............] - ETA: 2s
4192/7440 [===============>..............] - ETA: 2s
4256/7440 [================>.............] - ETA: 2s
4320/7440 [================>.............] - ETA: 2s
4384/7440 [================>.............] - ETA: 2s
4448/7440 [================>.............] - ETA: 2s
4512/7440 [=================>............] - ETA: 2s
4576/7440 [=================>............] - ETA: 2s
4640/7440 [=================>............] - ETA: 2s
4704/7440 [=================>............] - ETA: 2s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 1s
5088/7440 [===================>..........] - ETA: 1s
5152/7440 [===================>..........] - ETA: 1s
5216/7440 [====================>.........] - ETA: 1s
5280/7440 [====================>.........] - ETA: 1s
5344/7440 [====================>.........] - ETA: 1s
5408/7440 [====================>.........] - ETA: 1s
5472/7440 [=====================>........] - ETA: 1s
5536/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 0s
6304/7440 [========================>.....] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6496/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 6s 821us/step
current test accuracy: 0.8166666666666667
current test auc_score ------------------>  0.906817551161984
------------------------ current config for the test -------------------------
Depth:  25  Growth_rate:  30  lr:  0.0002  nb_filter:  16  dropout:  0.4028738216824569
Epochs  3  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 96, 96)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 96, 96)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 106, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 96, 96)   5618        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 53, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 48, 48)   212         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 53, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  6360        activation_8[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 48, 48)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 83, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 48, 48)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 113, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 48, 48)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 48, 48)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 143, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 48, 48)   10153       activation_14[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 71, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 24, 24)   284         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 71, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  8520        activation_15[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 24, 24)  404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 101, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  12120       activation_17[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 24, 24)  524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 131, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  15720       activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 24, 24)  644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 161, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 24, 24)   12880       activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 80, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 80, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 12, 12)  440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 110, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  13200       activation_24[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 12, 12)  560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 140, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  16800       activation_26[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 12, 12)  680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 170, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 170)          0           activation_28[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            171         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 552,470
Trainable params: 546,390
Non-trainable params: 6,080
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/3
 - 215s - loss: 0.7383 - acc: 0.7702 - val_loss: 0.8534 - val_acc: 0.7494
Epoch 2/3
 - 213s - loss: 0.5772 - acc: 0.8212 - val_loss: 0.5181 - val_acc: 0.8399
Epoch 3/3
 - 212s - loss: 0.4901 - acc: 0.8557 - val_loss: 0.4248 - val_acc: 0.8833

  32/7440 [..............................] - ETA: 6s
  96/7440 [..............................] - ETA: 6s
 160/7440 [..............................] - ETA: 6s
 224/7440 [..............................] - ETA: 5s
 288/7440 [>.............................] - ETA: 5s
 352/7440 [>.............................] - ETA: 5s
 416/7440 [>.............................] - ETA: 5s
 480/7440 [>.............................] - ETA: 5s
 544/7440 [=>............................] - ETA: 5s
 608/7440 [=>............................] - ETA: 5s
 672/7440 [=>............................] - ETA: 5s
 736/7440 [=>............................] - ETA: 5s
 800/7440 [==>...........................] - ETA: 5s
 864/7440 [==>...........................] - ETA: 5s
 928/7440 [==>...........................] - ETA: 5s
 992/7440 [===>..........................] - ETA: 5s
1056/7440 [===>..........................] - ETA: 5s
1120/7440 [===>..........................] - ETA: 5s
1184/7440 [===>..........................] - ETA: 5s
1248/7440 [====>.........................] - ETA: 5s
1312/7440 [====>.........................] - ETA: 4s
1376/7440 [====>.........................] - ETA: 4s
1440/7440 [====>.........................] - ETA: 4s
1504/7440 [=====>........................] - ETA: 4s
1568/7440 [=====>........................] - ETA: 4s
1632/7440 [=====>........................] - ETA: 4s
1696/7440 [=====>........................] - ETA: 4s
1760/7440 [======>.......................] - ETA: 4s
1824/7440 [======>.......................] - ETA: 4s
1888/7440 [======>.......................] - ETA: 4s
1952/7440 [======>.......................] - ETA: 4s
2016/7440 [=======>......................] - ETA: 4s
2080/7440 [=======>......................] - ETA: 4s
2144/7440 [=======>......................] - ETA: 4s
2208/7440 [=======>......................] - ETA: 4s
2272/7440 [========>.....................] - ETA: 4s
2336/7440 [========>.....................] - ETA: 4s
2400/7440 [========>.....................] - ETA: 4s
2464/7440 [========>.....................] - ETA: 4s
2528/7440 [=========>....................] - ETA: 4s
2592/7440 [=========>....................] - ETA: 3s
2656/7440 [=========>....................] - ETA: 3s
2720/7440 [=========>....................] - ETA: 3s
2784/7440 [==========>...................] - ETA: 3s
2848/7440 [==========>...................] - ETA: 3s
2912/7440 [==========>...................] - ETA: 3s
2976/7440 [===========>..................] - ETA: 3s
3040/7440 [===========>..................] - ETA: 3s
3104/7440 [===========>..................] - ETA: 3s
3168/7440 [===========>..................] - ETA: 3s
3232/7440 [============>.................] - ETA: 3s
3296/7440 [============>.................] - ETA: 3s
3360/7440 [============>.................] - ETA: 3s
3424/7440 [============>.................] - ETA: 3s
3488/7440 [=============>................] - ETA: 3s
3552/7440 [=============>................] - ETA: 3s
3616/7440 [=============>................] - ETA: 3s
3680/7440 [=============>................] - ETA: 3s
3744/7440 [==============>...............] - ETA: 3s
3808/7440 [==============>...............] - ETA: 2s
3872/7440 [==============>...............] - ETA: 2s
3936/7440 [==============>...............] - ETA: 2s
4000/7440 [===============>..............] - ETA: 2s
4064/7440 [===============>..............] - ETA: 2s
4128/7440 [===============>..............] - ETA: 2s
4192/7440 [===============>..............] - ETA: 2s
4256/7440 [================>.............] - ETA: 2s
4320/7440 [================>.............] - ETA: 2s
4384/7440 [================>.............] - ETA: 2s
4448/7440 [================>.............] - ETA: 2s
4512/7440 [=================>............] - ETA: 2s
4576/7440 [=================>............] - ETA: 2s
4640/7440 [=================>............] - ETA: 2s
4704/7440 [=================>............] - ETA: 2s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 1s
5088/7440 [===================>..........] - ETA: 1s
5152/7440 [===================>..........] - ETA: 1s
5216/7440 [====================>.........] - ETA: 1s
5280/7440 [====================>.........] - ETA: 1s
5344/7440 [====================>.........] - ETA: 1s
5408/7440 [====================>.........] - ETA: 1s
5472/7440 [=====================>........] - ETA: 1s
5536/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 0s
6304/7440 [========================>.....] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6496/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 6s 815us/step
current test accuracy: 0.8013440860215054
current test auc_score ------------------>  0.9295467684125333
------------------------ current config for the test -------------------------
Depth:  34  Growth_rate:  18  lr:  0.0005  nb_filter:  16  dropout:  0.13231322544510934
Epochs  10  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 96, 96)   1152        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 72, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 96, 96)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 96, 96)   2448        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 72, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 96, 96)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 52, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 96, 96)   3744        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 72, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 96, 96)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 70, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 96, 96)   5040        activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 72, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 96, 96)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 96, 96)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 88, 96, 96)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 96, 96)   6336        activation_9[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 72, 96, 96)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 96, 96)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 96, 96)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 96, 96)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 106, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 96, 96)   5618        activation_11[0][0]              
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 53, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 48, 48)   212         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 53, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 72, 48, 48)   3816        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 71, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 71, 48, 48)   284         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 71, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 72, 48, 48)   5112        activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 89, 48, 48)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 89, 48, 48)   356         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 89, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 72, 48, 48)   6408        activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 107, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 107, 48, 48)  428         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 107, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 72, 48, 48)   7704        activation_18[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 125, 48, 48)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 125, 48, 48)  500         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 125, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 72, 48, 48)   9000        activation_20[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 48, 48)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 48, 48)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 143, 48, 48)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 48, 48)  572         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 143, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 48, 48)   10153       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 71, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 24, 24)   284         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 71, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 72, 24, 24)   5112        activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 72, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 89, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 89, 24, 24)   356         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 89, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 72, 24, 24)   6408        activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 72, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 107, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 107, 24, 24)  428         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 107, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 72, 24, 24)   7704        activation_27[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 72, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 18, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 125, 24, 24)  0           concatenate_12[0][0]             
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 125, 24, 24)  500         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 125, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 72, 24, 24)   9000        activation_29[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 72, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 18, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 143, 24, 24)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 143, 24, 24)  572         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 143, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 72, 24, 24)   10296       activation_31[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 72, 24, 24)   0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 18, 24, 24)   0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 161, 24, 24)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 24, 24)  644         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 161, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 24, 24)   12880       activation_33[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 80, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 80, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 72, 12, 12)   5760        activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 72, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 18, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 98, 12, 12)   0           average_pooling2d_3[0][0]        
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 98, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 72, 12, 12)   7056        activation_36[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 72, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 18, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 116, 12, 12)  0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 116, 12, 12)  464         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 116, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 72, 12, 12)   8352        activation_38[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 72, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 18, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 134, 12, 12)  0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 134, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 72, 12, 12)   9648        activation_40[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 72, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_41[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 18, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 152, 12, 12)  0           concatenate_18[0][0]             
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 152, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 72, 12, 12)   10944       activation_42[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 72, 12, 12)   0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_43[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 18, 12, 12)   0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 170, 12, 12)  0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 12, 12)  680         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 170, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 170)          0           activation_44[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            171         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 408,790
Trainable params: 401,110
Non-trainable params: 7,680
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 288s - loss: 0.6680 - acc: 0.7795 - val_loss: 0.5414 - val_acc: 0.8179
Epoch 2/10
 - 276s - loss: 0.4694 - acc: 0.8399 - val_loss: 0.4438 - val_acc: 0.8700
Epoch 3/10
 - 273s - loss: 0.3819 - acc: 0.8736 - val_loss: 0.3364 - val_acc: 0.9000
Epoch 4/10
 - 277s - loss: 0.3293 - acc: 0.8959 - val_loss: 0.2555 - val_acc: 0.9314
Epoch 5/10
 - 272s - loss: 0.2902 - acc: 0.9123 - val_loss: 0.2176 - val_acc: 0.9390
Epoch 6/10
 - 270s - loss: 0.2616 - acc: 0.9229 - val_loss: 0.1958 - val_acc: 0.9478
Epoch 7/10
 - 264s - loss: 0.2383 - acc: 0.9338 - val_loss: 0.2671 - val_acc: 0.9172
Epoch 8/10
 - 263s - loss: 0.2164 - acc: 0.9403 - val_loss: 0.2652 - val_acc: 0.9152
Epoch 9/10
 - 263s - loss: 0.2004 - acc: 0.9480 - val_loss: 0.1553 - val_acc: 0.9642
Epoch 10/10
 - 262s - loss: 0.1799 - acc: 0.9576 - val_loss: 0.1754 - val_acc: 0.9572

  32/7440 [..............................] - ETA: 21s
  96/7440 [..............................] - ETA: 11s
 160/7440 [..............................] - ETA: 9s 
 224/7440 [..............................] - ETA: 9s
 288/7440 [>.............................] - ETA: 8s
 352/7440 [>.............................] - ETA: 8s
 416/7440 [>.............................] - ETA: 7s
 480/7440 [>.............................] - ETA: 7s
 544/7440 [=>............................] - ETA: 7s
 608/7440 [=>............................] - ETA: 7s
 672/7440 [=>............................] - ETA: 7s
 736/7440 [=>............................] - ETA: 7s
 800/7440 [==>...........................] - ETA: 6s
 864/7440 [==>...........................] - ETA: 6s
 928/7440 [==>...........................] - ETA: 6s
 992/7440 [===>..........................] - ETA: 6s
1056/7440 [===>..........................] - ETA: 6s
1120/7440 [===>..........................] - ETA: 6s
1184/7440 [===>..........................] - ETA: 6s
1248/7440 [====>.........................] - ETA: 6s
1312/7440 [====>.........................] - ETA: 6s
1376/7440 [====>.........................] - ETA: 6s
1440/7440 [====>.........................] - ETA: 6s
1504/7440 [=====>........................] - ETA: 6s
1568/7440 [=====>........................] - ETA: 5s
1632/7440 [=====>........................] - ETA: 5s
1696/7440 [=====>........................] - ETA: 5s
1760/7440 [======>.......................] - ETA: 5s
1824/7440 [======>.......................] - ETA: 5s
1888/7440 [======>.......................] - ETA: 5s
1952/7440 [======>.......................] - ETA: 5s
2016/7440 [=======>......................] - ETA: 5s
2080/7440 [=======>......................] - ETA: 5s
2144/7440 [=======>......................] - ETA: 5s
2208/7440 [=======>......................] - ETA: 5s
2272/7440 [========>.....................] - ETA: 5s
2336/7440 [========>.....................] - ETA: 5s
2400/7440 [========>.....................] - ETA: 5s
2464/7440 [========>.....................] - ETA: 4s
2528/7440 [=========>....................] - ETA: 4s
2592/7440 [=========>....................] - ETA: 4s
2656/7440 [=========>....................] - ETA: 4s
2720/7440 [=========>....................] - ETA: 4s
2784/7440 [==========>...................] - ETA: 4s
2848/7440 [==========>...................] - ETA: 4s
2912/7440 [==========>...................] - ETA: 4s
2976/7440 [===========>..................] - ETA: 4s
3040/7440 [===========>..................] - ETA: 4s
3104/7440 [===========>..................] - ETA: 4s
3168/7440 [===========>..................] - ETA: 4s
3232/7440 [============>.................] - ETA: 4s
3296/7440 [============>.................] - ETA: 4s
3360/7440 [============>.................] - ETA: 4s
3424/7440 [============>.................] - ETA: 4s
3488/7440 [=============>................] - ETA: 3s
3552/7440 [=============>................] - ETA: 3s
3616/7440 [=============>................] - ETA: 3s
3680/7440 [=============>................] - ETA: 3s
3744/7440 [==============>...............] - ETA: 3s
3808/7440 [==============>...............] - ETA: 3s
3872/7440 [==============>...............] - ETA: 3s
3936/7440 [==============>...............] - ETA: 3s
4000/7440 [===============>..............] - ETA: 3s
4064/7440 [===============>..............] - ETA: 3s
4128/7440 [===============>..............] - ETA: 3s
4192/7440 [===============>..............] - ETA: 3s
4256/7440 [================>.............] - ETA: 3s
4320/7440 [================>.............] - ETA: 3s
4384/7440 [================>.............] - ETA: 3s
4448/7440 [================>.............] - ETA: 2s
4512/7440 [=================>............] - ETA: 2s
4576/7440 [=================>............] - ETA: 2s
4640/7440 [=================>............] - ETA: 2s
4704/7440 [=================>............] - ETA: 2s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 2s
5088/7440 [===================>..........] - ETA: 2s
5152/7440 [===================>..........] - ETA: 2s
5216/7440 [====================>.........] - ETA: 2s
5280/7440 [====================>.........] - ETA: 2s
5344/7440 [====================>.........] - ETA: 2s
5408/7440 [====================>.........] - ETA: 2s
5472/7440 [=====================>........] - ETA: 1s
5536/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 1s
6304/7440 [========================>.....] - ETA: 1s
6368/7440 [========================>.....] - ETA: 1s
6432/7440 [========================>.....] - ETA: 0s
6496/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 7s 992us/step
current test accuracy: 0.6219086021505377
current test auc_score ------------------>  0.8249969649670483
------------------------ current config for the test -------------------------
Depth:  34  Growth_rate:  30  lr:  0.0002  nb_filter:  16  dropout:  0.3943095250241596
Epochs  10  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 96, 96)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 96, 96)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 136, 96, 96)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 136, 96, 96)  0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 120, 96, 96)  16320       activation_9[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 120, 96, 96)  0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 96, 96)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 166, 96, 96)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 166, 96, 96)  664         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 166, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 83, 96, 96)   13778       activation_11[0][0]              
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 83, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 83, 48, 48)   332         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 83, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 113, 48, 48)  0           average_pooling2d_1[0][0]        
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 113, 48, 48)  0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 143, 48, 48)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 143, 48, 48)  572         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 143, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  17160       activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 173, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 173, 48, 48)  692         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 173, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  20760       activation_18[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 203, 48, 48)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 203, 48, 48)  812         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 203, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 120, 48, 48)  24360       activation_20[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 120, 48, 48)  0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 48, 48)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 233, 48, 48)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 233, 48, 48)  932         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 233, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 116, 48, 48)  27028       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 116, 24, 24)  0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 116, 24, 24)  464         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 116, 24, 24)  0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  13920       activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 146, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 146, 24, 24)  584         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 146, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  17520       activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 176, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 176, 24, 24)  704         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 176, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  21120       activation_27[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 206, 24, 24)  0           concatenate_12[0][0]             
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 206, 24, 24)  824         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 206, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  24720       activation_29[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 236, 24, 24)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 236, 24, 24)  944         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 236, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 120, 24, 24)  28320       activation_31[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 120, 24, 24)  0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 24, 24)   0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 266, 24, 24)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 266, 24, 24)  1064        concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 266, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 133, 24, 24)  35378       activation_33[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 133, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 133, 12, 12)  532         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 133, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  15960       activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 163, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 163, 12, 12)  652         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 163, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  19560       activation_36[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 30, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 193, 12, 12)  0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 193, 12, 12)  772         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 193, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  23160       activation_38[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 30, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 223, 12, 12)  0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 223, 12, 12)  892         concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 223, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  26760       activation_40[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_41[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 30, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 253, 12, 12)  0           concatenate_18[0][0]             
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 253, 12, 12)  1012        concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 253, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 120, 12, 12)  30360       activation_42[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 120, 12, 12)  0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_43[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 30, 12, 12)   0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 283, 12, 12)  0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 283, 12, 12)  1132        concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 283, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 283)          0           activation_44[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            284         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 1,102,708
Trainable params: 1,090,132
Non-trainable params: 12,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 311s - loss: 0.8742 - acc: 0.7718 - val_loss: 0.7161 - val_acc: 0.8041
Epoch 2/10
 - 302s - loss: 0.6218 - acc: 0.8312 - val_loss: 0.5075 - val_acc: 0.8705
Epoch 3/10
 - 303s - loss: 0.5077 - acc: 0.8657 - val_loss: 0.4848 - val_acc: 0.8638
Epoch 4/10
 - 301s - loss: 0.4433 - acc: 0.8809 - val_loss: 0.4045 - val_acc: 0.9036
Epoch 5/10
 - 300s - loss: 0.3893 - acc: 0.8990 - val_loss: 0.3231 - val_acc: 0.9262
Epoch 6/10
 - 302s - loss: 0.3489 - acc: 0.9123 - val_loss: 0.2762 - val_acc: 0.9415
Epoch 7/10
 - 302s - loss: 0.3192 - acc: 0.9207 - val_loss: 0.2887 - val_acc: 0.9384
Epoch 8/10
 - 303s - loss: 0.2914 - acc: 0.9316 - val_loss: 0.2845 - val_acc: 0.9295
Epoch 9/10
 - 306s - loss: 0.2694 - acc: 0.9386 - val_loss: 0.3720 - val_acc: 0.8962

Epoch 00009: ReduceLROnPlateau reducing learning rate to 6.324555160565053e-05.
Epoch 10/10
 - 303s - loss: 0.2158 - acc: 0.9590 - val_loss: 0.2573 - val_acc: 0.9351

  32/7440 [..............................] - ETA: 11s
  96/7440 [..............................] - ETA: 10s
 160/7440 [..............................] - ETA: 10s
 224/7440 [..............................] - ETA: 10s
 288/7440 [>.............................] - ETA: 10s
 352/7440 [>.............................] - ETA: 10s
 416/7440 [>.............................] - ETA: 9s 
 480/7440 [>.............................] - ETA: 9s
 544/7440 [=>............................] - ETA: 9s
 608/7440 [=>............................] - ETA: 9s
 672/7440 [=>............................] - ETA: 9s
 736/7440 [=>............................] - ETA: 9s
 800/7440 [==>...........................] - ETA: 9s
 864/7440 [==>...........................] - ETA: 9s
 928/7440 [==>...........................] - ETA: 9s
 992/7440 [===>..........................] - ETA: 9s
1056/7440 [===>..........................] - ETA: 8s
1120/7440 [===>..........................] - ETA: 8s
1184/7440 [===>..........................] - ETA: 8s
1248/7440 [====>.........................] - ETA: 8s
1312/7440 [====>.........................] - ETA: 8s
1376/7440 [====>.........................] - ETA: 8s
1440/7440 [====>.........................] - ETA: 8s
1504/7440 [=====>........................] - ETA: 8s
1568/7440 [=====>........................] - ETA: 8s
1632/7440 [=====>........................] - ETA: 8s
1696/7440 [=====>........................] - ETA: 8s
1760/7440 [======>.......................] - ETA: 7s
1824/7440 [======>.......................] - ETA: 7s
1888/7440 [======>.......................] - ETA: 7s
1952/7440 [======>.......................] - ETA: 7s
2016/7440 [=======>......................] - ETA: 7s
2080/7440 [=======>......................] - ETA: 7s
2144/7440 [=======>......................] - ETA: 7s
2208/7440 [=======>......................] - ETA: 7s
2272/7440 [========>.....................] - ETA: 7s
2336/7440 [========>.....................] - ETA: 7s
2400/7440 [========>.....................] - ETA: 7s
2464/7440 [========>.....................] - ETA: 6s
2528/7440 [=========>....................] - ETA: 6s
2592/7440 [=========>....................] - ETA: 6s
2656/7440 [=========>....................] - ETA: 6s
2720/7440 [=========>....................] - ETA: 6s
2784/7440 [==========>...................] - ETA: 6s
2848/7440 [==========>...................] - ETA: 6s
2912/7440 [==========>...................] - ETA: 6s
2976/7440 [===========>..................] - ETA: 6s
3040/7440 [===========>..................] - ETA: 6s
3104/7440 [===========>..................] - ETA: 6s
3168/7440 [===========>..................] - ETA: 5s
3232/7440 [============>.................] - ETA: 5s
3296/7440 [============>.................] - ETA: 5s
3360/7440 [============>.................] - ETA: 5s
3424/7440 [============>.................] - ETA: 5s
3488/7440 [=============>................] - ETA: 5s
3552/7440 [=============>................] - ETA: 5s
3616/7440 [=============>................] - ETA: 5s
3680/7440 [=============>................] - ETA: 5s
3744/7440 [==============>...............] - ETA: 5s
3808/7440 [==============>...............] - ETA: 5s
3872/7440 [==============>...............] - ETA: 4s
3936/7440 [==============>...............] - ETA: 4s
4000/7440 [===============>..............] - ETA: 4s
4064/7440 [===============>..............] - ETA: 4s
4128/7440 [===============>..............] - ETA: 4s
4192/7440 [===============>..............] - ETA: 4s
4256/7440 [================>.............] - ETA: 4s
4320/7440 [================>.............] - ETA: 4s
4384/7440 [================>.............] - ETA: 4s
4448/7440 [================>.............] - ETA: 4s
4512/7440 [=================>............] - ETA: 4s
4576/7440 [=================>............] - ETA: 3s
4640/7440 [=================>............] - ETA: 3s
4704/7440 [=================>............] - ETA: 3s
4768/7440 [==================>...........] - ETA: 3s
4832/7440 [==================>...........] - ETA: 3s
4896/7440 [==================>...........] - ETA: 3s
4960/7440 [===================>..........] - ETA: 3s
5024/7440 [===================>..........] - ETA: 3s
5088/7440 [===================>..........] - ETA: 3s
5152/7440 [===================>..........] - ETA: 3s
5216/7440 [====================>.........] - ETA: 3s
5280/7440 [====================>.........] - ETA: 3s
5344/7440 [====================>.........] - ETA: 2s
5408/7440 [====================>.........] - ETA: 2s
5472/7440 [=====================>........] - ETA: 2s
5536/7440 [=====================>........] - ETA: 2s
5600/7440 [=====================>........] - ETA: 2s
5664/7440 [=====================>........] - ETA: 2s
5728/7440 [======================>.......] - ETA: 2s
5792/7440 [======================>.......] - ETA: 2s
5856/7440 [======================>.......] - ETA: 2s
5920/7440 [======================>.......] - ETA: 2s
5984/7440 [=======================>......] - ETA: 2s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 1s
6304/7440 [========================>.....] - ETA: 1s
6368/7440 [========================>.....] - ETA: 1s
6432/7440 [========================>.....] - ETA: 1s
6496/7440 [=========================>....] - ETA: 1s
6560/7440 [=========================>....] - ETA: 1s
6624/7440 [=========================>....] - ETA: 1s
6688/7440 [=========================>....] - ETA: 1s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 10s 1ms/step
current test accuracy: 0.746505376344086
current test auc_score ------------------>  0.8352715631864955
------------------------ current config for the test -------------------------
Depth:  28  Growth_rate:  12  lr:  0.0001  nb_filter:  16  dropout:  0.1837870988019101
Epochs  10  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   768         activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 96, 96)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 96, 96)   1344        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 48, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 96, 96)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 40, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 96, 96)   1920        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 48, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 52, 96, 96)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 52, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 48, 96, 96)   2496        activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 48, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 64, 96, 96)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 64, 96, 96)   256         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 64, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 32, 96, 96)   2048        activation_9[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 32, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 32, 48, 48)   128         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 32, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   1536        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 44, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 44, 48, 48)   176         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 44, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 48, 48, 48)   2112        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 56, 48, 48)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 56, 48, 48)   224         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 56, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 48, 48, 48)   2688        activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 48, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 68, 48, 48)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 68, 48, 48)   272         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 68, 48, 48)   0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 48, 48, 48)   3264        activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 48, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 80, 48, 48)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 80, 48, 48)   320         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 80, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 40, 48, 48)   3200        activation_18[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 40, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 40, 24, 24)   160         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 40, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   1920        activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 52, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 52, 24, 24)   208         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 52, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 48, 24, 24)   2496        activation_21[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 48, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 64, 24, 24)   0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 64, 24, 24)   256         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 64, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 48, 24, 24)   3072        activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 48, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 12, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 76, 24, 24)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 76, 24, 24)   304         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 76, 24, 24)   0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 48, 24, 24)   3648        activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 48, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 12, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 88, 24, 24)   0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 88, 24, 24)   352         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 88, 24, 24)   0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 44, 24, 24)   3872        activation_27[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 44, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 44, 12, 12)   176         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 44, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 48, 12, 12)   2112        activation_28[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 48, 12, 12)   192         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 48, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 12, 12, 12)   5184        activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 12, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 56, 12, 12)   0           average_pooling2d_3[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 56, 12, 12)   224         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 56, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 48, 12, 12)   2688        activation_30[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 48, 12, 12)   192         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 48, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 12, 12, 12)   5184        activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 12, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 68, 12, 12)   0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 68, 12, 12)   272         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 68, 12, 12)   0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 48, 12, 12)   3264        activation_32[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 48, 12, 12)   192         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 48, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 12, 12, 12)   5184        activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 12, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 80, 12, 12)   0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 80, 12, 12)   320         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 80, 12, 12)   0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 48, 12, 12)   3840        activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 48, 12, 12)   192         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 48, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 12, 12, 12)   5184        activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 12, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 92, 12, 12)   0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 92, 12, 12)   368         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 92, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 92)           0           activation_36[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            93          global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 139,245
Trainable params: 135,429
Non-trainable params: 3,816
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 232s - loss: 0.6579 - acc: 0.7644 - val_loss: 0.5814 - val_acc: 0.7966
Epoch 2/10
 - 224s - loss: 0.5783 - acc: 0.8058 - val_loss: 0.5113 - val_acc: 0.8367
Epoch 3/10
 - 224s - loss: 0.5278 - acc: 0.8310 - val_loss: 0.4561 - val_acc: 0.8741
Epoch 4/10
 - 222s - loss: 0.4980 - acc: 0.8489 - val_loss: 0.4715 - val_acc: 0.8563
Epoch 5/10
 - 224s - loss: 0.4629 - acc: 0.8657 - val_loss: 0.5098 - val_acc: 0.8371
Epoch 6/10
 - 228s - loss: 0.4421 - acc: 0.8762 - val_loss: 0.3970 - val_acc: 0.8972
Epoch 7/10
 - 225s - loss: 0.4217 - acc: 0.8836 - val_loss: 0.3948 - val_acc: 0.8942
Epoch 8/10
 - 227s - loss: 0.4046 - acc: 0.8912 - val_loss: 0.3496 - val_acc: 0.9203
Epoch 9/10
 - 231s - loss: 0.3869 - acc: 0.8986 - val_loss: 0.3329 - val_acc: 0.9193
Epoch 10/10
 - 231s - loss: 0.3731 - acc: 0.9040 - val_loss: 0.3408 - val_acc: 0.9162

  32/7440 [..............................] - ETA: 24s
 128/7440 [..............................] - ETA: 9s 
 224/7440 [..............................] - ETA: 6s
 320/7440 [>.............................] - ETA: 6s
 416/7440 [>.............................] - ETA: 5s
 512/7440 [=>............................] - ETA: 5s
 608/7440 [=>............................] - ETA: 5s
 704/7440 [=>............................] - ETA: 4s
 800/7440 [==>...........................] - ETA: 4s
 896/7440 [==>...........................] - ETA: 4s
 992/7440 [===>..........................] - ETA: 4s
1088/7440 [===>..........................] - ETA: 4s
1184/7440 [===>..........................] - ETA: 4s
1280/7440 [====>.........................] - ETA: 4s
1376/7440 [====>.........................] - ETA: 4s
1472/7440 [====>.........................] - ETA: 3s
1568/7440 [=====>........................] - ETA: 3s
1664/7440 [=====>........................] - ETA: 3s
1760/7440 [======>.......................] - ETA: 3s
1856/7440 [======>.......................] - ETA: 3s
1952/7440 [======>.......................] - ETA: 3s
2048/7440 [=======>......................] - ETA: 3s
2144/7440 [=======>......................] - ETA: 3s
2240/7440 [========>.....................] - ETA: 3s
2336/7440 [========>.....................] - ETA: 3s
2432/7440 [========>.....................] - ETA: 3s
2528/7440 [=========>....................] - ETA: 3s
2624/7440 [=========>....................] - ETA: 3s
2720/7440 [=========>....................] - ETA: 2s
2816/7440 [==========>...................] - ETA: 2s
2912/7440 [==========>...................] - ETA: 2s
3008/7440 [===========>..................] - ETA: 2s
3104/7440 [===========>..................] - ETA: 2s
3200/7440 [===========>..................] - ETA: 2s
3296/7440 [============>.................] - ETA: 2s
3392/7440 [============>.................] - ETA: 2s
3488/7440 [=============>................] - ETA: 2s
3584/7440 [=============>................] - ETA: 2s
3680/7440 [=============>................] - ETA: 2s
3776/7440 [==============>...............] - ETA: 2s
3872/7440 [==============>...............] - ETA: 2s
3968/7440 [===============>..............] - ETA: 2s
4064/7440 [===============>..............] - ETA: 2s
4160/7440 [===============>..............] - ETA: 2s
4256/7440 [================>.............] - ETA: 1s
4352/7440 [================>.............] - ETA: 1s
4448/7440 [================>.............] - ETA: 1s
4544/7440 [=================>............] - ETA: 1s
4640/7440 [=================>............] - ETA: 1s
4736/7440 [==================>...........] - ETA: 1s
4832/7440 [==================>...........] - ETA: 1s
4928/7440 [==================>...........] - ETA: 1s
5024/7440 [===================>..........] - ETA: 1s
5120/7440 [===================>..........] - ETA: 1s
5216/7440 [====================>.........] - ETA: 1s
5312/7440 [====================>.........] - ETA: 1s
5408/7440 [====================>.........] - ETA: 1s
5504/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5696/7440 [=====================>........] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5888/7440 [======================>.......] - ETA: 0s
5984/7440 [=======================>......] - ETA: 0s
6080/7440 [=======================>......] - ETA: 0s
6176/7440 [=======================>......] - ETA: 0s
6272/7440 [========================>.....] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6464/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6656/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6848/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7040/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7424/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 5s 620us/step
current test accuracy: 0.7994623655913978
current test auc_score ------------------>  0.9293755781015146
------------------------ current config for the test -------------------------
Depth:  28  Growth_rate:  30  lr:  0.0001  nb_filter:  16  dropout:  0.30424828118201364
Epochs  10  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 96, 96)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 96, 96)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 136, 96, 96)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 136, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 68, 96, 96)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 68, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 68, 48, 48)   272         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 68, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  8160        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 98, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 48, 48)   392         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 98, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  11760       activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 128, 48, 48)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 48, 48)  512         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 128, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 158, 48, 48)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 158, 48, 48)  632         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 158, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  18960       activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 188, 48, 48)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 188, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 94, 48, 48)   17672       activation_18[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 94, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 94, 24, 24)   376         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 94, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  11280       activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 124, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  14880       activation_21[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 154, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 154, 24, 24)  616         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 154, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  18480       activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 184, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 184, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  22080       activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 214, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 214, 24, 24)  856         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 214, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 107, 24, 24)  22898       activation_27[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 107, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 107, 12, 12)  428         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 107, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  12840       activation_28[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 137, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 137, 12, 12)  548         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 137, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  16440       activation_30[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 167, 12, 12)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 167, 12, 12)  668         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 167, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  20040       activation_32[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 197, 12, 12)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 197, 12, 12)  788         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 197, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  23640       activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 227, 12, 12)  0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 227, 12, 12)  908         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 227, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 227)          0           activation_36[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            228         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 810,114
Trainable params: 801,024
Non-trainable params: 9,090
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 260s - loss: 0.8668 - acc: 0.7715 - val_loss: 0.8008 - val_acc: 0.7922
Epoch 2/10
 - 253s - loss: 0.7120 - acc: 0.8297 - val_loss: 0.6678 - val_acc: 0.8468
Epoch 3/10
 - 255s - loss: 0.6269 - acc: 0.8600 - val_loss: 0.5558 - val_acc: 0.8975
Epoch 4/10
 - 251s - loss: 0.5641 - acc: 0.8817 - val_loss: 0.5778 - val_acc: 0.8764
Epoch 5/10
 - 246s - loss: 0.5163 - acc: 0.8984 - val_loss: 0.5078 - val_acc: 0.8965
Epoch 6/10
 - 250s - loss: 0.4780 - acc: 0.9102 - val_loss: 0.4950 - val_acc: 0.9075
Epoch 7/10
 - 252s - loss: 0.4487 - acc: 0.9166 - val_loss: 0.4870 - val_acc: 0.8952
Epoch 8/10
 - 251s - loss: 0.4157 - acc: 0.9271 - val_loss: 0.4080 - val_acc: 0.9278
Epoch 9/10
 - 246s - loss: 0.3944 - acc: 0.9324 - val_loss: 0.3524 - val_acc: 0.9504
Epoch 10/10
 - 249s - loss: 0.3704 - acc: 0.9379 - val_loss: 0.3822 - val_acc: 0.9308

  32/7440 [..............................] - ETA: 31s
  96/7440 [..............................] - ETA: 15s
 160/7440 [..............................] - ETA: 12s
 224/7440 [..............................] - ETA: 11s
 288/7440 [>.............................] - ETA: 10s
 352/7440 [>.............................] - ETA: 9s 
 416/7440 [>.............................] - ETA: 9s
 480/7440 [>.............................] - ETA: 8s
 544/7440 [=>............................] - ETA: 8s
 608/7440 [=>............................] - ETA: 8s
 672/7440 [=>............................] - ETA: 8s
 736/7440 [=>............................] - ETA: 8s
 800/7440 [==>...........................] - ETA: 8s
 864/7440 [==>...........................] - ETA: 7s
 928/7440 [==>...........................] - ETA: 7s
 992/7440 [===>..........................] - ETA: 7s
1056/7440 [===>..........................] - ETA: 7s
1120/7440 [===>..........................] - ETA: 7s
1184/7440 [===>..........................] - ETA: 7s
1248/7440 [====>.........................] - ETA: 7s
1312/7440 [====>.........................] - ETA: 7s
1376/7440 [====>.........................] - ETA: 7s
1440/7440 [====>.........................] - ETA: 6s
1504/7440 [=====>........................] - ETA: 6s
1568/7440 [=====>........................] - ETA: 6s
1632/7440 [=====>........................] - ETA: 6s
1696/7440 [=====>........................] - ETA: 6s
1760/7440 [======>.......................] - ETA: 6s
1824/7440 [======>.......................] - ETA: 6s
1888/7440 [======>.......................] - ETA: 6s
1952/7440 [======>.......................] - ETA: 6s
2016/7440 [=======>......................] - ETA: 6s
2080/7440 [=======>......................] - ETA: 6s
2144/7440 [=======>......................] - ETA: 6s
2208/7440 [=======>......................] - ETA: 5s
2272/7440 [========>.....................] - ETA: 5s
2336/7440 [========>.....................] - ETA: 5s
2400/7440 [========>.....................] - ETA: 5s
2464/7440 [========>.....................] - ETA: 5s
2528/7440 [=========>....................] - ETA: 5s
2592/7440 [=========>....................] - ETA: 5s
2656/7440 [=========>....................] - ETA: 5s
2720/7440 [=========>....................] - ETA: 5s
2784/7440 [==========>...................] - ETA: 5s
2848/7440 [==========>...................] - ETA: 5s
2912/7440 [==========>...................] - ETA: 5s
2976/7440 [===========>..................] - ETA: 5s
3040/7440 [===========>..................] - ETA: 4s
3104/7440 [===========>..................] - ETA: 4s
3168/7440 [===========>..................] - ETA: 4s
3232/7440 [============>.................] - ETA: 4s
3296/7440 [============>.................] - ETA: 4s
3360/7440 [============>.................] - ETA: 4s
3424/7440 [============>.................] - ETA: 4s
3488/7440 [=============>................] - ETA: 4s
3552/7440 [=============>................] - ETA: 4s
3616/7440 [=============>................] - ETA: 4s
3680/7440 [=============>................] - ETA: 4s
3744/7440 [==============>...............] - ETA: 4s
3808/7440 [==============>...............] - ETA: 4s
3872/7440 [==============>...............] - ETA: 3s
3936/7440 [==============>...............] - ETA: 3s
4000/7440 [===============>..............] - ETA: 3s
4064/7440 [===============>..............] - ETA: 3s
4128/7440 [===============>..............] - ETA: 3s
4192/7440 [===============>..............] - ETA: 3s
4256/7440 [================>.............] - ETA: 3s
4320/7440 [================>.............] - ETA: 3s
4384/7440 [================>.............] - ETA: 3s
4448/7440 [================>.............] - ETA: 3s
4512/7440 [=================>............] - ETA: 3s
4576/7440 [=================>............] - ETA: 3s
4640/7440 [=================>............] - ETA: 3s
4704/7440 [=================>............] - ETA: 3s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 2s
5088/7440 [===================>..........] - ETA: 2s
5152/7440 [===================>..........] - ETA: 2s
5216/7440 [====================>.........] - ETA: 2s
5280/7440 [====================>.........] - ETA: 2s
5344/7440 [====================>.........] - ETA: 2s
5408/7440 [====================>.........] - ETA: 2s
5472/7440 [=====================>........] - ETA: 2s
5536/7440 [=====================>........] - ETA: 2s
5600/7440 [=====================>........] - ETA: 2s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 1s
6304/7440 [========================>.....] - ETA: 1s
6368/7440 [========================>.....] - ETA: 1s
6432/7440 [========================>.....] - ETA: 1s
6496/7440 [=========================>....] - ETA: 1s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 8s 1ms/step
current test accuracy: 0.8397849462365592
current test auc_score ------------------>  0.9164255260723784
------------------------ current config for the test -------------------------
Depth:  25  Growth_rate:  12  lr:  0.0001  nb_filter:  16  dropout:  0.22202687247320632
Epochs  3  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 48, 96, 96)   768         activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 48, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 12, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 28, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 28, 96, 96)   112         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 48, 96, 96)   1344        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 48, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 12, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 40, 96, 96)   160         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 40, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 48, 96, 96)   1920        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 48, 96, 96)   192         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 48, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 12, 96, 96)   5184        activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 12, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 52, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 52, 96, 96)   208         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 52, 96, 96)   0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 26, 96, 96)   1352        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 26, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 26, 48, 48)   104         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 26, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 48, 48, 48)   1248        activation_8[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 48, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 12, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 38, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 38, 48, 48)   152         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 38, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 48, 48, 48)   1824        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 48, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 12, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 50, 48, 48)   0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 50, 48, 48)   200         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 50, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 48, 48, 48)   2400        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 48, 48, 48)   192         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 48, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 12, 48, 48)   5184        activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 12, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 62, 48, 48)   0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 62, 48, 48)   248         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 62, 48, 48)   0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 31, 48, 48)   1922        activation_14[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 31, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 31, 24, 24)   124         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 31, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 48, 24, 24)   1488        activation_15[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 48, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 12, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 43, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 43, 24, 24)   172         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 43, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 48, 24, 24)   2064        activation_17[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 48, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 12, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 55, 24, 24)   0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 55, 24, 24)   220         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 55, 24, 24)   0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 48, 24, 24)   2640        activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 48, 24, 24)   192         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 48, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 12, 24, 24)   5184        activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 12, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 67, 24, 24)   0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 67, 24, 24)   268         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 67, 24, 24)   0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 33, 24, 24)   2211        activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 33, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 33, 12, 12)   132         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 33, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 48, 12, 12)   1584        activation_22[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 48, 12, 12)   192         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 48, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 12, 12, 12)   5184        activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 12, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 45, 12, 12)   0           average_pooling2d_3[0][0]        
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 45, 12, 12)   180         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 45, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 48, 12, 12)   2160        activation_24[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 48, 12, 12)   192         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 48, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 12, 12, 12)   5184        activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 12, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 57, 12, 12)   0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 57, 12, 12)   228         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 57, 12, 12)   0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 48, 12, 12)   2736        activation_26[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 48, 12, 12)   192         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 48, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 12, 12, 12)   5184        activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 12, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 69, 12, 12)   0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 69, 12, 12)   276         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 69, 12, 12)   0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 69)           0           activation_28[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            70          global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 95,379
Trainable params: 92,803
Non-trainable params: 2,576
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/3
 - 197s - loss: 0.6262 - acc: 0.7553 - val_loss: 0.5635 - val_acc: 0.7958
Epoch 2/3
 - 196s - loss: 0.5550 - acc: 0.7985 - val_loss: 0.5580 - val_acc: 0.8087
Epoch 3/3
 - 195s - loss: 0.5172 - acc: 0.8150 - val_loss: 0.5825 - val_acc: 0.7935

  32/7440 [..............................] - ETA: 9s
 160/7440 [..............................] - ETA: 4s
 288/7440 [>.............................] - ETA: 4s
 416/7440 [>.............................] - ETA: 3s
 544/7440 [=>............................] - ETA: 3s
 672/7440 [=>............................] - ETA: 3s
 800/7440 [==>...........................] - ETA: 3s
 928/7440 [==>...........................] - ETA: 3s
1056/7440 [===>..........................] - ETA: 3s
1184/7440 [===>..........................] - ETA: 3s
1312/7440 [====>.........................] - ETA: 3s
1440/7440 [====>.........................] - ETA: 2s
1568/7440 [=====>........................] - ETA: 2s
1696/7440 [=====>........................] - ETA: 2s
1824/7440 [======>.......................] - ETA: 2s
1952/7440 [======>.......................] - ETA: 2s
2080/7440 [=======>......................] - ETA: 2s
2208/7440 [=======>......................] - ETA: 2s
2336/7440 [========>.....................] - ETA: 2s
2464/7440 [========>.....................] - ETA: 2s
2592/7440 [=========>....................] - ETA: 2s
2720/7440 [=========>....................] - ETA: 2s
2848/7440 [==========>...................] - ETA: 2s
2976/7440 [===========>..................] - ETA: 2s
3104/7440 [===========>..................] - ETA: 2s
3232/7440 [============>.................] - ETA: 2s
3360/7440 [============>.................] - ETA: 1s
3488/7440 [=============>................] - ETA: 1s
3616/7440 [=============>................] - ETA: 1s
3744/7440 [==============>...............] - ETA: 1s
3872/7440 [==============>...............] - ETA: 1s
4000/7440 [===============>..............] - ETA: 1s
4128/7440 [===============>..............] - ETA: 1s
4256/7440 [================>.............] - ETA: 1s
4384/7440 [================>.............] - ETA: 1s
4512/7440 [=================>............] - ETA: 1s
4640/7440 [=================>............] - ETA: 1s
4768/7440 [==================>...........] - ETA: 1s
4896/7440 [==================>...........] - ETA: 1s
5024/7440 [===================>..........] - ETA: 1s
5152/7440 [===================>..........] - ETA: 1s
5280/7440 [====================>.........] - ETA: 1s
5408/7440 [====================>.........] - ETA: 0s
5536/7440 [=====================>........] - ETA: 0s
5664/7440 [=====================>........] - ETA: 0s
5792/7440 [======================>.......] - ETA: 0s
5920/7440 [======================>.......] - ETA: 0s
6048/7440 [=======================>......] - ETA: 0s
6176/7440 [=======================>......] - ETA: 0s
6304/7440 [========================>.....] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 4s 473us/step
current test accuracy: 0.7446236559139785
current test auc_score ------------------>  0.8885592265001735
------------------------ current config for the test -------------------------
Depth:  25  Growth_rate:  30  lr:  0.0001  nb_filter:  16  dropout:  0.2504965050878476
Epochs  10  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 96, 96)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 96, 96)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 106, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 96, 96)   5618        activation_7[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 53, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 48, 48)   212         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 53, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  6360        activation_8[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_9[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 83, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 83, 48, 48)   332         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 83, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  9960        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 113, 48, 48)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 113, 48, 48)  452         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 113, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  13560       activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 143, 48, 48)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 48, 48)  572         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 143, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 48, 48)   10153       activation_14[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 71, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 24, 24)   284         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 71, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  8520        activation_15[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_16[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 101, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 101, 24, 24)  404         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 101, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  12120       activation_17[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_18[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 131, 24, 24)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 131, 24, 24)  524         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 131, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  15720       activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 161, 24, 24)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 24, 24)  644         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 161, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 24, 24)   12880       activation_21[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 80, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 80, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  9600        activation_22[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_23[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 110, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 110, 12, 12)  440         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 110, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  13200       activation_24[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_25[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 140, 12, 12)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 140, 12, 12)  560         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 140, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  16800       activation_26[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_27[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 170, 12, 12)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 12, 12)  680         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 170, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 170)          0           activation_28[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            171         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 552,470
Trainable params: 546,390
Non-trainable params: 6,080
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
 - 215s - loss: 0.7760 - acc: 0.7710 - val_loss: 0.7195 - val_acc: 0.8053
Epoch 2/10
 - 209s - loss: 0.6514 - acc: 0.8268 - val_loss: 0.5851 - val_acc: 0.8539
Epoch 3/10
 - 205s - loss: 0.5770 - acc: 0.8606 - val_loss: 0.5180 - val_acc: 0.8791
Epoch 4/10
 - 204s - loss: 0.5311 - acc: 0.8757 - val_loss: 0.5229 - val_acc: 0.8661
Epoch 5/10
 - 206s - loss: 0.4897 - acc: 0.8914 - val_loss: 0.4462 - val_acc: 0.9041
Epoch 6/10
 - 203s - loss: 0.4592 - acc: 0.9028 - val_loss: 0.4369 - val_acc: 0.9037
Epoch 7/10
 - 203s - loss: 0.4303 - acc: 0.9095 - val_loss: 0.4250 - val_acc: 0.9040
Epoch 8/10
 - 202s - loss: 0.3991 - acc: 0.9208 - val_loss: 0.3626 - val_acc: 0.9326
Epoch 9/10
 - 202s - loss: 0.3853 - acc: 0.9237 - val_loss: 0.4707 - val_acc: 0.8854
Epoch 10/10
 - 202s - loss: 0.3655 - acc: 0.9317 - val_loss: 0.3687 - val_acc: 0.9271

  32/7440 [..............................] - ETA: 7s
  96/7440 [..............................] - ETA: 6s
 160/7440 [..............................] - ETA: 6s
 224/7440 [..............................] - ETA: 6s
 288/7440 [>.............................] - ETA: 5s
 352/7440 [>.............................] - ETA: 5s
 416/7440 [>.............................] - ETA: 5s
 480/7440 [>.............................] - ETA: 5s
 544/7440 [=>............................] - ETA: 5s
 608/7440 [=>............................] - ETA: 5s
 672/7440 [=>............................] - ETA: 5s
 736/7440 [=>............................] - ETA: 5s
 800/7440 [==>...........................] - ETA: 5s
 864/7440 [==>...........................] - ETA: 5s
 928/7440 [==>...........................] - ETA: 5s
 992/7440 [===>..........................] - ETA: 5s
1056/7440 [===>..........................] - ETA: 5s
1120/7440 [===>..........................] - ETA: 5s
1216/7440 [===>..........................] - ETA: 5s
1280/7440 [====>.........................] - ETA: 4s
1344/7440 [====>.........................] - ETA: 4s
1408/7440 [====>.........................] - ETA: 4s
1472/7440 [====>.........................] - ETA: 4s
1536/7440 [=====>........................] - ETA: 4s
1600/7440 [=====>........................] - ETA: 4s
1664/7440 [=====>........................] - ETA: 4s
1728/7440 [=====>........................] - ETA: 4s
1792/7440 [======>.......................] - ETA: 4s
1856/7440 [======>.......................] - ETA: 4s
1920/7440 [======>.......................] - ETA: 4s
1984/7440 [=======>......................] - ETA: 4s
2048/7440 [=======>......................] - ETA: 4s
2112/7440 [=======>......................] - ETA: 4s
2176/7440 [=======>......................] - ETA: 4s
2240/7440 [========>.....................] - ETA: 4s
2304/7440 [========>.....................] - ETA: 4s
2368/7440 [========>.....................] - ETA: 4s
2432/7440 [========>.....................] - ETA: 4s
2496/7440 [=========>....................] - ETA: 3s
2560/7440 [=========>....................] - ETA: 3s
2624/7440 [=========>....................] - ETA: 3s
2688/7440 [=========>....................] - ETA: 3s
2752/7440 [==========>...................] - ETA: 3s
2816/7440 [==========>...................] - ETA: 3s
2880/7440 [==========>...................] - ETA: 3s
2944/7440 [==========>...................] - ETA: 3s
3008/7440 [===========>..................] - ETA: 3s
3072/7440 [===========>..................] - ETA: 3s
3136/7440 [===========>..................] - ETA: 3s
3200/7440 [===========>..................] - ETA: 3s
3264/7440 [============>.................] - ETA: 3s
3328/7440 [============>.................] - ETA: 3s
3392/7440 [============>.................] - ETA: 3s
3456/7440 [============>.................] - ETA: 3s
3520/7440 [=============>................] - ETA: 3s
3584/7440 [=============>................] - ETA: 3s
3648/7440 [=============>................] - ETA: 3s
3712/7440 [=============>................] - ETA: 3s
3776/7440 [==============>...............] - ETA: 2s
3840/7440 [==============>...............] - ETA: 2s
3904/7440 [==============>...............] - ETA: 2s
3968/7440 [===============>..............] - ETA: 2s
4032/7440 [===============>..............] - ETA: 2s
4128/7440 [===============>..............] - ETA: 2s
4224/7440 [================>.............] - ETA: 2s
4320/7440 [================>.............] - ETA: 2s
4416/7440 [================>.............] - ETA: 2s
4480/7440 [=================>............] - ETA: 2s
4544/7440 [=================>............] - ETA: 2s
4608/7440 [=================>............] - ETA: 2s
4672/7440 [=================>............] - ETA: 2s
4736/7440 [==================>...........] - ETA: 2s
4800/7440 [==================>...........] - ETA: 2s
4864/7440 [==================>...........] - ETA: 2s
4928/7440 [==================>...........] - ETA: 2s
4992/7440 [===================>..........] - ETA: 1s
5056/7440 [===================>..........] - ETA: 1s
5120/7440 [===================>..........] - ETA: 1s
5184/7440 [===================>..........] - ETA: 1s
5248/7440 [====================>.........] - ETA: 1s
5312/7440 [====================>.........] - ETA: 1s
5376/7440 [====================>.........] - ETA: 1s
5440/7440 [====================>.........] - ETA: 1s
5504/7440 [=====================>........] - ETA: 1s
5568/7440 [=====================>........] - ETA: 1s
5632/7440 [=====================>........] - ETA: 1s
5696/7440 [=====================>........] - ETA: 1s
5760/7440 [======================>.......] - ETA: 1s
5824/7440 [======================>.......] - ETA: 1s
5888/7440 [======================>.......] - ETA: 1s
5952/7440 [=======================>......] - ETA: 1s
6016/7440 [=======================>......] - ETA: 1s
6080/7440 [=======================>......] - ETA: 1s
6144/7440 [=======================>......] - ETA: 1s
6208/7440 [========================>.....] - ETA: 0s
6272/7440 [========================>.....] - ETA: 0s
6368/7440 [========================>.....] - ETA: 0s
6432/7440 [========================>.....] - ETA: 0s
6496/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7040/7440 [===========================>..] - ETA: 0s
7104/7440 [===========================>..] - ETA: 0s
7168/7440 [===========================>..] - ETA: 0s
7232/7440 [============================>.] - ETA: 0s
7296/7440 [============================>.] - ETA: 0s
7360/7440 [============================>.] - ETA: 0s
7424/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 6s 806us/step
current test accuracy: 0.8001344086021506
current test auc_score ------------------>  0.893152640478668
------------------------ current config for the test -------------------------
Depth:  34  Growth_rate:  18  lr:  0.0002  nb_filter:  16  dropout:  0.30690136167475857
Epochs  3  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 72, 96, 96)   1152        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 72, 96, 96)   0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 18, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 34, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 34, 96, 96)   136         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 34, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 72, 96, 96)   2448        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 72, 96, 96)   0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 18, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 52, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 52, 96, 96)   208         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 52, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 72, 96, 96)   3744        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 72, 96, 96)   0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 18, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 70, 96, 96)   0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 70, 96, 96)   280         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 70, 96, 96)   0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 72, 96, 96)   5040        activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 72, 96, 96)   0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 18, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 88, 96, 96)   0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
dense_0_4_bn (BatchNormalizatio (None, 88, 96, 96)   352         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 88, 96, 96)   0           dense_0_4_bn[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_conv2D (Co (None, 72, 96, 96)   6336        activation_9[0][0]               
__________________________________________________________________________________________________
dense_0_4_bottleneck_bn (BatchN (None, 72, 96, 96)   288         dense_0_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 72, 96, 96)   0           dense_0_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_4_conv2D (Conv2D)       (None, 18, 96, 96)   11664       activation_10[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 18, 96, 96)   0           dense_0_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 106, 96, 96)  0           concatenate_4[0][0]              
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 106, 96, 96)  424         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 106, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 53, 96, 96)   5618        activation_11[0][0]              
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 53, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 53, 48, 48)   212         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 53, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 72, 48, 48)   3816        activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 72, 48, 48)   0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 18, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 71, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 71, 48, 48)   284         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 71, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 72, 48, 48)   5112        activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 72, 48, 48)   0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 18, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 89, 48, 48)   0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 89, 48, 48)   356         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 89, 48, 48)   0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 72, 48, 48)   6408        activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 72, 48, 48)   0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 18, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 107, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 107, 48, 48)  428         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 107, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 72, 48, 48)   7704        activation_18[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 72, 48, 48)   0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_19[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 18, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 125, 48, 48)  0           concatenate_8[0][0]              
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_1_4_bn (BatchNormalizatio (None, 125, 48, 48)  500         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 125, 48, 48)  0           dense_1_4_bn[0][0]               
__________________________________________________________________________________________________
dense_1_4_bottleneck_conv2D (Co (None, 72, 48, 48)   9000        activation_20[0][0]              
__________________________________________________________________________________________________
dense_1_4_bottleneck_bn (BatchN (None, 72, 48, 48)   288         dense_1_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 72, 48, 48)   0           dense_1_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_4_conv2D (Conv2D)       (None, 18, 48, 48)   11664       activation_21[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 18, 48, 48)   0           dense_1_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 143, 48, 48)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 143, 48, 48)  572         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 143, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 71, 48, 48)   10153       activation_22[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 71, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 71, 24, 24)   284         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 71, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 72, 24, 24)   5112        activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 72, 24, 24)   0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 18, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 89, 24, 24)   0           average_pooling2d_2[0][0]        
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 89, 24, 24)   356         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 89, 24, 24)   0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 72, 24, 24)   6408        activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 72, 24, 24)   0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 18, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 107, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 107, 24, 24)  428         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 107, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 72, 24, 24)   7704        activation_27[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 72, 24, 24)   0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_28[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 18, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 125, 24, 24)  0           concatenate_12[0][0]             
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 125, 24, 24)  500         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 125, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 72, 24, 24)   9000        activation_29[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 72, 24, 24)   0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_30[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 18, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 143, 24, 24)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_2_4_bn (BatchNormalizatio (None, 143, 24, 24)  572         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 143, 24, 24)  0           dense_2_4_bn[0][0]               
__________________________________________________________________________________________________
dense_2_4_bottleneck_conv2D (Co (None, 72, 24, 24)   10296       activation_31[0][0]              
__________________________________________________________________________________________________
dense_2_4_bottleneck_bn (BatchN (None, 72, 24, 24)   288         dense_2_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 72, 24, 24)   0           dense_2_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_4_conv2D (Conv2D)       (None, 18, 24, 24)   11664       activation_32[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 18, 24, 24)   0           dense_2_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 161, 24, 24)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 161, 24, 24)  644         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 161, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 80, 24, 24)   12880       activation_33[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 80, 12, 12)   0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 80, 12, 12)   320         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 80, 12, 12)   0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 72, 12, 12)   5760        activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 72, 12, 12)   0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 18, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 98, 12, 12)   0           average_pooling2d_3[0][0]        
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 98, 12, 12)   392         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 98, 12, 12)   0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 72, 12, 12)   7056        activation_36[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 72, 12, 12)   0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_37[0][0]              
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 18, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_17 (Concatenate)    (None, 116, 12, 12)  0           concatenate_16[0][0]             
                                                                 dropout_17[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 116, 12, 12)  464         concatenate_17[0][0]             
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 116, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 72, 12, 12)   8352        activation_38[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 72, 12, 12)   0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_39[0][0]              
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 18, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_18 (Concatenate)    (None, 134, 12, 12)  0           concatenate_17[0][0]             
                                                                 dropout_18[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 134, 12, 12)  536         concatenate_18[0][0]             
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 134, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 72, 12, 12)   9648        activation_40[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 72, 12, 12)   0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_41[0][0]              
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 18, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_19 (Concatenate)    (None, 152, 12, 12)  0           concatenate_18[0][0]             
                                                                 dropout_19[0][0]                 
__________________________________________________________________________________________________
dense_3_4_bn (BatchNormalizatio (None, 152, 12, 12)  608         concatenate_19[0][0]             
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 152, 12, 12)  0           dense_3_4_bn[0][0]               
__________________________________________________________________________________________________
dense_3_4_bottleneck_conv2D (Co (None, 72, 12, 12)   10944       activation_42[0][0]              
__________________________________________________________________________________________________
dense_3_4_bottleneck_bn (BatchN (None, 72, 12, 12)   288         dense_3_4_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 72, 12, 12)   0           dense_3_4_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_4_conv2D (Conv2D)       (None, 18, 12, 12)   11664       activation_43[0][0]              
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 18, 12, 12)   0           dense_3_4_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_20 (Concatenate)    (None, 170, 12, 12)  0           concatenate_19[0][0]             
                                                                 dropout_20[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 170, 12, 12)  680         concatenate_20[0][0]             
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 170, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 170)          0           activation_44[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            171         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 408,790
Trainable params: 401,110
Non-trainable params: 7,680
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/3
 - 278s - loss: 0.7470 - acc: 0.7724 - val_loss: 0.5889 - val_acc: 0.8504
Epoch 2/3
 - 272s - loss: 0.5819 - acc: 0.8374 - val_loss: 0.4945 - val_acc: 0.8849
Epoch 3/3
 - 272s - loss: 0.4949 - acc: 0.8692 - val_loss: 0.4179 - val_acc: 0.9009

  32/7440 [..............................] - ETA: 7s
  96/7440 [..............................] - ETA: 7s
 160/7440 [..............................] - ETA: 7s
 224/7440 [..............................] - ETA: 7s
 288/7440 [>.............................] - ETA: 7s
 352/7440 [>.............................] - ETA: 7s
 416/7440 [>.............................] - ETA: 6s
 480/7440 [>.............................] - ETA: 6s
 544/7440 [=>............................] - ETA: 6s
 608/7440 [=>............................] - ETA: 6s
 672/7440 [=>............................] - ETA: 6s
 736/7440 [=>............................] - ETA: 6s
 800/7440 [==>...........................] - ETA: 6s
 864/7440 [==>...........................] - ETA: 6s
 928/7440 [==>...........................] - ETA: 6s
 992/7440 [===>..........................] - ETA: 6s
1056/7440 [===>..........................] - ETA: 6s
1120/7440 [===>..........................] - ETA: 6s
1184/7440 [===>..........................] - ETA: 6s
1248/7440 [====>.........................] - ETA: 6s
1312/7440 [====>.........................] - ETA: 6s
1376/7440 [====>.........................] - ETA: 5s
1440/7440 [====>.........................] - ETA: 5s
1504/7440 [=====>........................] - ETA: 5s
1568/7440 [=====>........................] - ETA: 5s
1632/7440 [=====>........................] - ETA: 5s
1696/7440 [=====>........................] - ETA: 5s
1760/7440 [======>.......................] - ETA: 5s
1824/7440 [======>.......................] - ETA: 5s
1888/7440 [======>.......................] - ETA: 5s
1952/7440 [======>.......................] - ETA: 5s
2016/7440 [=======>......................] - ETA: 5s
2080/7440 [=======>......................] - ETA: 5s
2144/7440 [=======>......................] - ETA: 5s
2208/7440 [=======>......................] - ETA: 5s
2272/7440 [========>.....................] - ETA: 5s
2336/7440 [========>.....................] - ETA: 5s
2400/7440 [========>.....................] - ETA: 4s
2464/7440 [========>.....................] - ETA: 4s
2528/7440 [=========>....................] - ETA: 4s
2592/7440 [=========>....................] - ETA: 4s
2656/7440 [=========>....................] - ETA: 4s
2720/7440 [=========>....................] - ETA: 4s
2784/7440 [==========>...................] - ETA: 4s
2848/7440 [==========>...................] - ETA: 4s
2912/7440 [==========>...................] - ETA: 4s
2976/7440 [===========>..................] - ETA: 4s
3040/7440 [===========>..................] - ETA: 4s
3104/7440 [===========>..................] - ETA: 4s
3168/7440 [===========>..................] - ETA: 4s
3232/7440 [============>.................] - ETA: 4s
3296/7440 [============>.................] - ETA: 4s
3360/7440 [============>.................] - ETA: 3s
3424/7440 [============>.................] - ETA: 3s
3488/7440 [=============>................] - ETA: 3s
3552/7440 [=============>................] - ETA: 3s
3616/7440 [=============>................] - ETA: 3s
3680/7440 [=============>................] - ETA: 3s
3744/7440 [==============>...............] - ETA: 3s
3808/7440 [==============>...............] - ETA: 3s
3872/7440 [==============>...............] - ETA: 3s
3936/7440 [==============>...............] - ETA: 3s
4000/7440 [===============>..............] - ETA: 3s
4064/7440 [===============>..............] - ETA: 3s
4128/7440 [===============>..............] - ETA: 3s
4192/7440 [===============>..............] - ETA: 3s
4256/7440 [================>.............] - ETA: 3s
4320/7440 [================>.............] - ETA: 3s
4384/7440 [================>.............] - ETA: 2s
4448/7440 [================>.............] - ETA: 2s
4512/7440 [=================>............] - ETA: 2s
4576/7440 [=================>............] - ETA: 2s
4640/7440 [=================>............] - ETA: 2s
4704/7440 [=================>............] - ETA: 2s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 2s
5088/7440 [===================>..........] - ETA: 2s
5152/7440 [===================>..........] - ETA: 2s
5216/7440 [====================>.........] - ETA: 2s
5280/7440 [====================>.........] - ETA: 2s
5344/7440 [====================>.........] - ETA: 2s
5408/7440 [====================>.........] - ETA: 1s
5472/7440 [=====================>........] - ETA: 1s
5536/7440 [=====================>........] - ETA: 1s
5600/7440 [=====================>........] - ETA: 1s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 1s
6304/7440 [========================>.....] - ETA: 1s
6368/7440 [========================>.....] - ETA: 1s
6432/7440 [========================>.....] - ETA: 0s
6496/7440 [=========================>....] - ETA: 0s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 7s 977us/step
current test accuracy: 0.7997311827956989
current test auc_score ------------------>  0.8952294701699619
------------------------ current config for the test -------------------------
Depth:  31  Growth_rate:  30  lr:  0.0001  nb_filter:  16  dropout:  0.30906474258594147
Epochs  3  batch_size:  8  es_patience:  5  lr_patience:  3
dense_block  4  reduction_:  0.5  bottleneck:  True
------------------------       end of configs        -------------------------
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 96, 96)    0                                            
__________________________________________________________________________________________________
initial_conv2D (Conv2D)         (None, 16, 96, 96)   288         input_1[0][0]                    
__________________________________________________________________________________________________
dense_0_0_bn (BatchNormalizatio (None, 16, 96, 96)   64          initial_conv2D[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 16, 96, 96)   0           dense_0_0_bn[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_conv2D (Co (None, 120, 96, 96)  1920        activation_1[0][0]               
__________________________________________________________________________________________________
dense_0_0_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 120, 96, 96)  0           dense_0_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_0_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_2[0][0]               
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 30, 96, 96)   0           dense_0_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 46, 96, 96)   0           initial_conv2D[0][0]             
                                                                 dropout_1[0][0]                  
__________________________________________________________________________________________________
dense_0_1_bn (BatchNormalizatio (None, 46, 96, 96)   184         concatenate_1[0][0]              
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 46, 96, 96)   0           dense_0_1_bn[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_conv2D (Co (None, 120, 96, 96)  5520        activation_3[0][0]               
__________________________________________________________________________________________________
dense_0_1_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 120, 96, 96)  0           dense_0_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_1_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_4[0][0]               
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 30, 96, 96)   0           dense_0_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 76, 96, 96)   0           concatenate_1[0][0]              
                                                                 dropout_2[0][0]                  
__________________________________________________________________________________________________
dense_0_2_bn (BatchNormalizatio (None, 76, 96, 96)   304         concatenate_2[0][0]              
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 76, 96, 96)   0           dense_0_2_bn[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_conv2D (Co (None, 120, 96, 96)  9120        activation_5[0][0]               
__________________________________________________________________________________________________
dense_0_2_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 120, 96, 96)  0           dense_0_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_2_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_6[0][0]               
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 30, 96, 96)   0           dense_0_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 106, 96, 96)  0           concatenate_2[0][0]              
                                                                 dropout_3[0][0]                  
__________________________________________________________________________________________________
dense_0_3_bn (BatchNormalizatio (None, 106, 96, 96)  424         concatenate_3[0][0]              
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 106, 96, 96)  0           dense_0_3_bn[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_conv2D (Co (None, 120, 96, 96)  12720       activation_7[0][0]               
__________________________________________________________________________________________________
dense_0_3_bottleneck_bn (BatchN (None, 120, 96, 96)  480         dense_0_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 120, 96, 96)  0           dense_0_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_0_3_conv2D (Conv2D)       (None, 30, 96, 96)   32400       activation_8[0][0]               
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 30, 96, 96)   0           dense_0_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 136, 96, 96)  0           concatenate_3[0][0]              
                                                                 dropout_4[0][0]                  
__________________________________________________________________________________________________
tr_0_bn (BatchNormalization)    (None, 136, 96, 96)  544         concatenate_4[0][0]              
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 136, 96, 96)  0           tr_0_bn[0][0]                    
__________________________________________________________________________________________________
tr_0_conv2D (Conv2D)            (None, 68, 96, 96)   9248        activation_9[0][0]               
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 68, 48, 48)   0           tr_0_conv2D[0][0]                
__________________________________________________________________________________________________
dense_1_0_bn (BatchNormalizatio (None, 68, 48, 48)   272         average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 68, 48, 48)   0           dense_1_0_bn[0][0]               
__________________________________________________________________________________________________
dense_1_0_bottleneck_conv2D (Co (None, 120, 48, 48)  8160        activation_10[0][0]              
__________________________________________________________________________________________________
dense_1_0_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 120, 48, 48)  0           dense_1_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_0_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_11[0][0]              
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 30, 48, 48)   0           dense_1_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 98, 48, 48)   0           average_pooling2d_1[0][0]        
                                                                 dropout_5[0][0]                  
__________________________________________________________________________________________________
dense_1_1_bn (BatchNormalizatio (None, 98, 48, 48)   392         concatenate_5[0][0]              
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 98, 48, 48)   0           dense_1_1_bn[0][0]               
__________________________________________________________________________________________________
dense_1_1_bottleneck_conv2D (Co (None, 120, 48, 48)  11760       activation_12[0][0]              
__________________________________________________________________________________________________
dense_1_1_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 120, 48, 48)  0           dense_1_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_1_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_13[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 30, 48, 48)   0           dense_1_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 128, 48, 48)  0           concatenate_5[0][0]              
                                                                 dropout_6[0][0]                  
__________________________________________________________________________________________________
dense_1_2_bn (BatchNormalizatio (None, 128, 48, 48)  512         concatenate_6[0][0]              
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 128, 48, 48)  0           dense_1_2_bn[0][0]               
__________________________________________________________________________________________________
dense_1_2_bottleneck_conv2D (Co (None, 120, 48, 48)  15360       activation_14[0][0]              
__________________________________________________________________________________________________
dense_1_2_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 120, 48, 48)  0           dense_1_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_2_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_15[0][0]              
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 30, 48, 48)   0           dense_1_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 158, 48, 48)  0           concatenate_6[0][0]              
                                                                 dropout_7[0][0]                  
__________________________________________________________________________________________________
dense_1_3_bn (BatchNormalizatio (None, 158, 48, 48)  632         concatenate_7[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 158, 48, 48)  0           dense_1_3_bn[0][0]               
__________________________________________________________________________________________________
dense_1_3_bottleneck_conv2D (Co (None, 120, 48, 48)  18960       activation_16[0][0]              
__________________________________________________________________________________________________
dense_1_3_bottleneck_bn (BatchN (None, 120, 48, 48)  480         dense_1_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 120, 48, 48)  0           dense_1_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_1_3_conv2D (Conv2D)       (None, 30, 48, 48)   32400       activation_17[0][0]              
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 30, 48, 48)   0           dense_1_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 188, 48, 48)  0           concatenate_7[0][0]              
                                                                 dropout_8[0][0]                  
__________________________________________________________________________________________________
tr_1_bn (BatchNormalization)    (None, 188, 48, 48)  752         concatenate_8[0][0]              
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 188, 48, 48)  0           tr_1_bn[0][0]                    
__________________________________________________________________________________________________
tr_1_conv2D (Conv2D)            (None, 94, 48, 48)   17672       activation_18[0][0]              
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 94, 24, 24)   0           tr_1_conv2D[0][0]                
__________________________________________________________________________________________________
dense_2_0_bn (BatchNormalizatio (None, 94, 24, 24)   376         average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 94, 24, 24)   0           dense_2_0_bn[0][0]               
__________________________________________________________________________________________________
dense_2_0_bottleneck_conv2D (Co (None, 120, 24, 24)  11280       activation_19[0][0]              
__________________________________________________________________________________________________
dense_2_0_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 120, 24, 24)  0           dense_2_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_0_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_20[0][0]              
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 30, 24, 24)   0           dense_2_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 124, 24, 24)  0           average_pooling2d_2[0][0]        
                                                                 dropout_9[0][0]                  
__________________________________________________________________________________________________
dense_2_1_bn (BatchNormalizatio (None, 124, 24, 24)  496         concatenate_9[0][0]              
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 124, 24, 24)  0           dense_2_1_bn[0][0]               
__________________________________________________________________________________________________
dense_2_1_bottleneck_conv2D (Co (None, 120, 24, 24)  14880       activation_21[0][0]              
__________________________________________________________________________________________________
dense_2_1_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 120, 24, 24)  0           dense_2_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_1_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_22[0][0]              
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 30, 24, 24)   0           dense_2_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 154, 24, 24)  0           concatenate_9[0][0]              
                                                                 dropout_10[0][0]                 
__________________________________________________________________________________________________
dense_2_2_bn (BatchNormalizatio (None, 154, 24, 24)  616         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 154, 24, 24)  0           dense_2_2_bn[0][0]               
__________________________________________________________________________________________________
dense_2_2_bottleneck_conv2D (Co (None, 120, 24, 24)  18480       activation_23[0][0]              
__________________________________________________________________________________________________
dense_2_2_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 120, 24, 24)  0           dense_2_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_2_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_24[0][0]              
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 30, 24, 24)   0           dense_2_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_11 (Concatenate)    (None, 184, 24, 24)  0           concatenate_10[0][0]             
                                                                 dropout_11[0][0]                 
__________________________________________________________________________________________________
dense_2_3_bn (BatchNormalizatio (None, 184, 24, 24)  736         concatenate_11[0][0]             
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 184, 24, 24)  0           dense_2_3_bn[0][0]               
__________________________________________________________________________________________________
dense_2_3_bottleneck_conv2D (Co (None, 120, 24, 24)  22080       activation_25[0][0]              
__________________________________________________________________________________________________
dense_2_3_bottleneck_bn (BatchN (None, 120, 24, 24)  480         dense_2_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 120, 24, 24)  0           dense_2_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_2_3_conv2D (Conv2D)       (None, 30, 24, 24)   32400       activation_26[0][0]              
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 30, 24, 24)   0           dense_2_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_12 (Concatenate)    (None, 214, 24, 24)  0           concatenate_11[0][0]             
                                                                 dropout_12[0][0]                 
__________________________________________________________________________________________________
tr_2_bn (BatchNormalization)    (None, 214, 24, 24)  856         concatenate_12[0][0]             
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 214, 24, 24)  0           tr_2_bn[0][0]                    
__________________________________________________________________________________________________
tr_2_conv2D (Conv2D)            (None, 107, 24, 24)  22898       activation_27[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 107, 12, 12)  0           tr_2_conv2D[0][0]                
__________________________________________________________________________________________________
dense_3_0_bn (BatchNormalizatio (None, 107, 12, 12)  428         average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 107, 12, 12)  0           dense_3_0_bn[0][0]               
__________________________________________________________________________________________________
dense_3_0_bottleneck_conv2D (Co (None, 120, 12, 12)  12840       activation_28[0][0]              
__________________________________________________________________________________________________
dense_3_0_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_0_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 120, 12, 12)  0           dense_3_0_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_0_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_29[0][0]              
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 30, 12, 12)   0           dense_3_0_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_13 (Concatenate)    (None, 137, 12, 12)  0           average_pooling2d_3[0][0]        
                                                                 dropout_13[0][0]                 
__________________________________________________________________________________________________
dense_3_1_bn (BatchNormalizatio (None, 137, 12, 12)  548         concatenate_13[0][0]             
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 137, 12, 12)  0           dense_3_1_bn[0][0]               
__________________________________________________________________________________________________
dense_3_1_bottleneck_conv2D (Co (None, 120, 12, 12)  16440       activation_30[0][0]              
__________________________________________________________________________________________________
dense_3_1_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_1_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 120, 12, 12)  0           dense_3_1_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_1_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_31[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 30, 12, 12)   0           dense_3_1_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_14 (Concatenate)    (None, 167, 12, 12)  0           concatenate_13[0][0]             
                                                                 dropout_14[0][0]                 
__________________________________________________________________________________________________
dense_3_2_bn (BatchNormalizatio (None, 167, 12, 12)  668         concatenate_14[0][0]             
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 167, 12, 12)  0           dense_3_2_bn[0][0]               
__________________________________________________________________________________________________
dense_3_2_bottleneck_conv2D (Co (None, 120, 12, 12)  20040       activation_32[0][0]              
__________________________________________________________________________________________________
dense_3_2_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_2_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 120, 12, 12)  0           dense_3_2_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_2_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_33[0][0]              
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 30, 12, 12)   0           dense_3_2_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_15 (Concatenate)    (None, 197, 12, 12)  0           concatenate_14[0][0]             
                                                                 dropout_15[0][0]                 
__________________________________________________________________________________________________
dense_3_3_bn (BatchNormalizatio (None, 197, 12, 12)  788         concatenate_15[0][0]             
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 197, 12, 12)  0           dense_3_3_bn[0][0]               
__________________________________________________________________________________________________
dense_3_3_bottleneck_conv2D (Co (None, 120, 12, 12)  23640       activation_34[0][0]              
__________________________________________________________________________________________________
dense_3_3_bottleneck_bn (BatchN (None, 120, 12, 12)  480         dense_3_3_bottleneck_conv2D[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 120, 12, 12)  0           dense_3_3_bottleneck_bn[0][0]    
__________________________________________________________________________________________________
dense_3_3_conv2D (Conv2D)       (None, 30, 12, 12)   32400       activation_35[0][0]              
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 30, 12, 12)   0           dense_3_3_conv2D[0][0]           
__________________________________________________________________________________________________
concatenate_16 (Concatenate)    (None, 227, 12, 12)  0           concatenate_15[0][0]             
                                                                 dropout_16[0][0]                 
__________________________________________________________________________________________________
final_bn (BatchNormalization)   (None, 227, 12, 12)  908         concatenate_16[0][0]             
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 227, 12, 12)  0           final_bn[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 227)          0           activation_36[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            228         global_average_pooling2d_1[0][0] 
==================================================================================================
Total params: 810,114
Trainable params: 801,024
Non-trainable params: 9,090
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/3
 - 264s - loss: 0.8733 - acc: 0.7695 - val_loss: 0.7811 - val_acc: 0.8043
Epoch 2/3
 - 254s - loss: 0.7229 - acc: 0.8270 - val_loss: 0.6689 - val_acc: 0.8448
Epoch 3/3
 - 251s - loss: 0.6372 - acc: 0.8541 - val_loss: 0.5646 - val_acc: 0.8886

  32/7440 [..............................] - ETA: 9s
  96/7440 [..............................] - ETA: 8s
 160/7440 [..............................] - ETA: 8s
 224/7440 [..............................] - ETA: 8s
 288/7440 [>.............................] - ETA: 8s
 352/7440 [>.............................] - ETA: 7s
 416/7440 [>.............................] - ETA: 7s
 480/7440 [>.............................] - ETA: 7s
 544/7440 [=>............................] - ETA: 7s
 608/7440 [=>............................] - ETA: 7s
 672/7440 [=>............................] - ETA: 7s
 736/7440 [=>............................] - ETA: 7s
 800/7440 [==>...........................] - ETA: 7s
 864/7440 [==>...........................] - ETA: 7s
 928/7440 [==>...........................] - ETA: 7s
 992/7440 [===>..........................] - ETA: 7s
1056/7440 [===>..........................] - ETA: 7s
1120/7440 [===>..........................] - ETA: 7s
1184/7440 [===>..........................] - ETA: 6s
1248/7440 [====>.........................] - ETA: 6s
1312/7440 [====>.........................] - ETA: 6s
1376/7440 [====>.........................] - ETA: 6s
1440/7440 [====>.........................] - ETA: 6s
1504/7440 [=====>........................] - ETA: 6s
1568/7440 [=====>........................] - ETA: 6s
1632/7440 [=====>........................] - ETA: 6s
1696/7440 [=====>........................] - ETA: 6s
1760/7440 [======>.......................] - ETA: 6s
1824/7440 [======>.......................] - ETA: 6s
1888/7440 [======>.......................] - ETA: 6s
1952/7440 [======>.......................] - ETA: 6s
2016/7440 [=======>......................] - ETA: 6s
2080/7440 [=======>......................] - ETA: 5s
2144/7440 [=======>......................] - ETA: 5s
2208/7440 [=======>......................] - ETA: 5s
2272/7440 [========>.....................] - ETA: 5s
2336/7440 [========>.....................] - ETA: 5s
2400/7440 [========>.....................] - ETA: 5s
2464/7440 [========>.....................] - ETA: 5s
2528/7440 [=========>....................] - ETA: 5s
2592/7440 [=========>....................] - ETA: 5s
2656/7440 [=========>....................] - ETA: 5s
2720/7440 [=========>....................] - ETA: 5s
2784/7440 [==========>...................] - ETA: 5s
2848/7440 [==========>...................] - ETA: 5s
2912/7440 [==========>...................] - ETA: 5s
2976/7440 [===========>..................] - ETA: 4s
3040/7440 [===========>..................] - ETA: 4s
3104/7440 [===========>..................] - ETA: 4s
3168/7440 [===========>..................] - ETA: 4s
3232/7440 [============>.................] - ETA: 4s
3296/7440 [============>.................] - ETA: 4s
3360/7440 [============>.................] - ETA: 4s
3424/7440 [============>.................] - ETA: 4s
3488/7440 [=============>................] - ETA: 4s
3552/7440 [=============>................] - ETA: 4s
3616/7440 [=============>................] - ETA: 4s
3680/7440 [=============>................] - ETA: 4s
3744/7440 [==============>...............] - ETA: 4s
3808/7440 [==============>...............] - ETA: 4s
3872/7440 [==============>...............] - ETA: 3s
3936/7440 [==============>...............] - ETA: 3s
4000/7440 [===============>..............] - ETA: 3s
4064/7440 [===============>..............] - ETA: 3s
4128/7440 [===============>..............] - ETA: 3s
4192/7440 [===============>..............] - ETA: 3s
4256/7440 [================>.............] - ETA: 3s
4320/7440 [================>.............] - ETA: 3s
4384/7440 [================>.............] - ETA: 3s
4448/7440 [================>.............] - ETA: 3s
4512/7440 [=================>............] - ETA: 3s
4576/7440 [=================>............] - ETA: 3s
4640/7440 [=================>............] - ETA: 3s
4704/7440 [=================>............] - ETA: 3s
4768/7440 [==================>...........] - ETA: 2s
4832/7440 [==================>...........] - ETA: 2s
4896/7440 [==================>...........] - ETA: 2s
4960/7440 [===================>..........] - ETA: 2s
5024/7440 [===================>..........] - ETA: 2s
5088/7440 [===================>..........] - ETA: 2s
5152/7440 [===================>..........] - ETA: 2s
5216/7440 [====================>.........] - ETA: 2s
5280/7440 [====================>.........] - ETA: 2s
5344/7440 [====================>.........] - ETA: 2s
5408/7440 [====================>.........] - ETA: 2s
5472/7440 [=====================>........] - ETA: 2s
5536/7440 [=====================>........] - ETA: 2s
5600/7440 [=====================>........] - ETA: 2s
5664/7440 [=====================>........] - ETA: 1s
5728/7440 [======================>.......] - ETA: 1s
5792/7440 [======================>.......] - ETA: 1s
5856/7440 [======================>.......] - ETA: 1s
5920/7440 [======================>.......] - ETA: 1s
5984/7440 [=======================>......] - ETA: 1s
6048/7440 [=======================>......] - ETA: 1s
6112/7440 [=======================>......] - ETA: 1s
6176/7440 [=======================>......] - ETA: 1s
6240/7440 [========================>.....] - ETA: 1s
6304/7440 [========================>.....] - ETA: 1s
6368/7440 [========================>.....] - ETA: 1s
6432/7440 [========================>.....] - ETA: 1s
6496/7440 [=========================>....] - ETA: 1s
6560/7440 [=========================>....] - ETA: 0s
6624/7440 [=========================>....] - ETA: 0s
6688/7440 [=========================>....] - ETA: 0s
6752/7440 [==========================>...] - ETA: 0s
6816/7440 [==========================>...] - ETA: 0s
6880/7440 [==========================>...] - ETA: 0s
6944/7440 [===========================>..] - ETA: 0s
7008/7440 [===========================>..] - ETA: 0s
7072/7440 [===========================>..] - ETA: 0s
7136/7440 [===========================>..] - ETA: 0s
7200/7440 [============================>.] - ETA: 0s
7264/7440 [============================>.] - ETA: 0s
7328/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 8s 1ms/step
