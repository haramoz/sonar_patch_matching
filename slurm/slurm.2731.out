CONTRASTIVE LOSS

>>> Imports:
#coding=utf-8

try:
    import numpy as np
except:
    pass

try:
    import random
except:
    pass

try:
    import h5py
except:
    pass

try:
    import tensorflow as tf
except:
    pass

try:
    import matplotlib.pyplot as plt
except:
    pass

try:
    import keras.backend as K
except:
    pass

try:
    from keras.initializers import RandomNormal
except:
    pass

try:
    from keras.layers.core import Dense, Dropout, Activation
except:
    pass

try:
    from keras.layers.pooling import AveragePooling2D, GlobalAveragePooling2D
except:
    pass

try:
    from keras.layers import Input, concatenate, Concatenate
except:
    pass

try:
    from keras.layers import normalization, BatchNormalization, Lambda
except:
    pass

try:
    from keras.layers import Flatten, Conv2D, MaxPooling2D
except:
    pass

try:
    from keras.regularizers import l2
except:
    pass

try:
    from keras.optimizers import RMSprop, Adam
except:
    pass

try:
    from keras.utils import np_utils
except:
    pass

try:
    from keras.models import Model, Sequential
except:
    pass

try:
    from keras.models import model_from_json
except:
    pass

try:
    import keras.initializers
except:
    pass

try:
    from keras.callbacks import EarlyStopping, ModelCheckpoint
except:
    pass

try:
    from sklearn import metrics
except:
    pass

try:
    from sklearn.metrics import roc_auc_score
except:
    pass

try:
    from sklearn.model_selection import train_test_split
except:
    pass

try:
    from sklearn.model_selection import GridSearchCV
except:
    pass

try:
    from keras.wrappers.scikit_learn import KerasClassifier
except:
    pass

try:
    from hyperopt import Trials, STATUS_OK, tpe
except:
    pass

try:
    from hyperas import optim
except:
    pass

try:
    from hyperas.distributions import choice, uniform
except:
    pass

try:
    import pickle
except:
    pass

>>> Hyperas search space:

def get_space():
    return {
        'dense_filter': hp.choice('dense_filter', [512,1024]),
        'decay': hp.choice('decay', [1e-2,1e-3,1e-4,1e-5,1e-6,1e-7]),
    }

>>> Functions
   1: def process_data():
   2:     filename = 'sonar_data'
   3:     infile = open(filename,'rb')
   4:     sonar_data_dict = pickle.load(infile)
   5: 
   6:     infile.close()
   7:     x_train1 = sonar_data_dict.get("x_train1")
   8:     x_train2 = sonar_data_dict.get("x_train2")
   9:     y_train = sonar_data_dict.get("y_train")
  10: 
  11:     x_val1 = sonar_data_dict.get("x_val1")
  12:     x_val2 = sonar_data_dict.get("x_val2")
  13:     y_val = sonar_data_dict.get("y_val")
  14: 
  15:     x_test1 = sonar_data_dict.get("x_test1")
  16:     x_test2 = sonar_data_dict.get("x_test2")
  17:     y_test = sonar_data_dict.get("y_test")
  18: 
  19:     y_test_inverted = 1 - y_test
  20:     y_train_inverted = 1 - y_train
  21:     y_val_inverted = 1 - y_val
  22: 
  23:     return x_train1, x_train2, y_train_inverted, x_val1, x_val2, y_val_inverted, x_test1, x_test2, y_test_inverted
  24: 
  25: def create_base_network(input_shape,dense_filter):
  26:     random_seed = 7
  27: 
  28:     model = Input(shape=input_shape)
  29:     x = Conv2D(16, (3, 3), padding="same",activation='relu', data_format='channels_first',
  30:                kernel_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed),
  31:               bias_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed))(model)
  32: 
  33:     x = Conv2D(16, (3, 3), padding="same", activation='relu',
  34:                kernel_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed),
  35:               bias_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed))(x)
  36:     x = MaxPooling2D(pool_size=(2, 2),strides=(2, 2))(x)
  37: 
  38:     x = Conv2D(32, (3, 3), padding="same", activation='relu',
  39:                kernel_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed),
  40:               bias_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed))(x)
  41: 
  42:     x = Conv2D(32, (3, 3), padding="same", activation='relu',
  43:                kernel_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed),
  44:               bias_initializer=RandomNormal(mean=0.0, stddev=0.05, seed=random_seed))(x)
  45: 
  46:     x = MaxPooling2D(pool_size=(2, 2),strides=(2, 2))(x)
  47:     x = Flatten()(x)
  48:     x = Dense(dense_filter, kernel_initializer=keras.initializers.he_normal(seed=random_seed),activation='relu')(x)
  49: 
  50:     return Model(model,x)
  51: 
  52: def euclidean_distance(vects):
  53:     x, y = vects
  54:     return K.sqrt(K.maximum(K.sum(K.square(x - y), axis=1, keepdims=True), K.epsilon()))
  55: 
  56: def eucl_dist_output_shape(shapes):
  57:     shape1, shape2 = shapes
  58:     return (shape1[0], 1)
  59: 
  60: def contrastive_loss_altered(y_true, y_pred):
  61:     margin = 1.0
  62:     return K.mean((1-y_true) * K.square(y_pred) +
  63:                   y_true * K.square(K.maximum(margin - y_pred, 0)))
  64: 
  65: 
>>> Data
 1: 
 2: x_train1, x_train2, y_train, x_val1, x_val2, y_val, x_test1, x_test2, y_test = process_data()
 3: 
 4: 
 5: 
>>> Resulting replaced keras model:

   1: def keras_fmin_fnct(space):
   2: 
   3:     epochs = 30
   4:     input_shape = (1,96,96)
   5:     patience_ = 1
   6:     dense_filter = space['dense_filter']
   7:     base_network = create_base_network(input_shape,dense_filter)
   8: 
   9:     input_a = Input(shape=input_shape)
  10:     input_b = Input(shape=input_shape)
  11: 
  12:     processed_a = base_network(input_a)
  13:     processed_b = base_network(input_b)
  14: 
  15:     opt = Adam(lr=1e-5,decay=space['decay'])
  16:     distance = Lambda(euclidean_distance,
  17:                       output_shape=eucl_dist_output_shape)([processed_a, processed_b])
  18:     model = Model([input_a, input_b], distance)
  19:     model.compile(loss=contrastive_loss_altered, optimizer=opt, metrics=["accuracy"])
  20: 
  21: 
  22:     es = EarlyStopping(monitor='val_acc', patience=patience_,verbose=1)
  23:     checkpointer = ModelCheckpoint(filepath='keras_weights.hdf5',
  24:                                    verbose=1,
  25:                                    save_best_only=True)
  26:     model.fit([x_train1, x_train2],y_train,
  27:           batch_size=64,
  28:           epochs=epochs,
  29:           validation_data=([x_val1,x_val2], y_val),
  30:           callbacks=[es],
  31:           verbose=0)
  32: 
  33:     score, acc = model.evaluate([x_test1, x_test2], y_test)
  34:     print('Test accuracy:', acc)
  35:     pred = model.predict([x_test1, x_test2])
  36:     auc_score = roc_auc_score(y_test,pred)
  37:     return {'loss': -auc_score, 'status': STATUS_OK, 'model': model}
  38: 
Epoch 00013: early stopping

  32/7440 [..............................] - ETA: 1:03
  64/7440 [..............................] - ETA: 1:02
  96/7440 [..............................] - ETA: 1:02
 128/7440 [..............................] - ETA: 1:02
 160/7440 [..............................] - ETA: 1:02
 192/7440 [..............................] - ETA: 1:01
 224/7440 [..............................] - ETA: 1:01
 256/7440 [>.............................] - ETA: 1:01
 288/7440 [>.............................] - ETA: 1:01
 320/7440 [>.............................] - ETA: 1:01
 352/7440 [>.............................] - ETA: 1:01
 384/7440 [>.............................] - ETA: 1:00
 416/7440 [>.............................] - ETA: 1:00
 448/7440 [>.............................] - ETA: 1:00
 480/7440 [>.............................] - ETA: 1:00
 512/7440 [=>............................] - ETA: 59s 
 544/7440 [=>............................] - ETA: 59s
 576/7440 [=>............................] - ETA: 59s
 608/7440 [=>............................] - ETA: 59s
 640/7440 [=>............................] - ETA: 58s
 672/7440 [=>............................] - ETA: 58s
 704/7440 [=>............................] - ETA: 58s
 736/7440 [=>............................] - ETA: 58s
 768/7440 [==>...........................] - ETA: 57s
 800/7440 [==>...........................] - ETA: 57s
 832/7440 [==>...........................] - ETA: 57s
 864/7440 [==>...........................] - ETA: 57s
 896/7440 [==>...........................] - ETA: 56s
 928/7440 [==>...........................] - ETA: 56s
 960/7440 [==>...........................] - ETA: 56s
 992/7440 [===>..........................] - ETA: 56s
1024/7440 [===>..........................] - ETA: 55s
1056/7440 [===>..........................] - ETA: 55s
1088/7440 [===>..........................] - ETA: 55s
1120/7440 [===>..........................] - ETA: 54s
1152/7440 [===>..........................] - ETA: 54s
1184/7440 [===>..........................] - ETA: 54s
1216/7440 [===>..........................] - ETA: 54s
1248/7440 [====>.........................] - ETA: 53s
1280/7440 [====>.........................] - ETA: 53s
1312/7440 [====>.........................] - ETA: 53s
1344/7440 [====>.........................] - ETA: 52s
1376/7440 [====>.........................] - ETA: 52s
1408/7440 [====>.........................] - ETA: 52s
1440/7440 [====>.........................] - ETA: 51s
1472/7440 [====>.........................] - ETA: 51s
1504/7440 [=====>........................] - ETA: 51s
1536/7440 [=====>........................] - ETA: 51s
1568/7440 [=====>........................] - ETA: 50s
1600/7440 [=====>........................] - ETA: 50s
1632/7440 [=====>........................] - ETA: 50s
1664/7440 [=====>........................] - ETA: 49s
1696/7440 [=====>........................] - ETA: 49s
1728/7440 [=====>........................] - ETA: 49s
1760/7440 [======>.......................] - ETA: 49s
1792/7440 [======>.......................] - ETA: 48s
1824/7440 [======>.......................] - ETA: 48s
1856/7440 [======>.......................] - ETA: 48s
1888/7440 [======>.......................] - ETA: 47s
1920/7440 [======>.......................] - ETA: 47s
1952/7440 [======>.......................] - ETA: 47s
1984/7440 [=======>......................] - ETA: 47s
2016/7440 [=======>......................] - ETA: 46s
2048/7440 [=======>......................] - ETA: 46s
2080/7440 [=======>......................] - ETA: 46s
2112/7440 [=======>......................] - ETA: 45s
2144/7440 [=======>......................] - ETA: 45s
2176/7440 [=======>......................] - ETA: 45s
2208/7440 [=======>......................] - ETA: 45s
2240/7440 [========>.....................] - ETA: 44s
2272/7440 [========>.....................] - ETA: 44s
2304/7440 [========>.....................] - ETA: 44s
2336/7440 [========>.....................] - ETA: 43s
2368/7440 [========>.....................] - ETA: 43s
2400/7440 [========>.....................] - ETA: 43s
2432/7440 [========>.....................] - ETA: 43s
2464/7440 [========>.....................] - ETA: 42s
2496/7440 [=========>....................] - ETA: 42s
2528/7440 [=========>....................] - ETA: 42s
2560/7440 [=========>....................] - ETA: 41s
2592/7440 [=========>....................] - ETA: 41s
2624/7440 [=========>....................] - ETA: 41s
2656/7440 [=========>....................] - ETA: 41s
2688/7440 [=========>....................] - ETA: 40s
2720/7440 [=========>....................] - ETA: 40s
2752/7440 [==========>...................] - ETA: 40s
2784/7440 [==========>...................] - ETA: 40s
2816/7440 [==========>...................] - ETA: 39s
2848/7440 [==========>...................] - ETA: 39s
2880/7440 [==========>...................] - ETA: 39s
2912/7440 [==========>...................] - ETA: 38s
2944/7440 [==========>...................] - ETA: 38s
2976/7440 [===========>..................] - ETA: 38s
3008/7440 [===========>..................] - ETA: 38s
3040/7440 [===========>..................] - ETA: 37s
3072/7440 [===========>..................] - ETA: 37s
3104/7440 [===========>..................] - ETA: 37s
3136/7440 [===========>..................] - ETA: 37s
3168/7440 [===========>..................] - ETA: 36s
3200/7440 [===========>..................] - ETA: 36s
3232/7440 [============>.................] - ETA: 36s
3264/7440 [============>.................] - ETA: 35s
3296/7440 [============>.................] - ETA: 35s
3328/7440 [============>.................] - ETA: 35s
3360/7440 [============>.................] - ETA: 35s
3392/7440 [============>.................] - ETA: 34s
3424/7440 [============>.................] - ETA: 34s
3456/7440 [============>.................] - ETA: 34s
3488/7440 [=============>................] - ETA: 33s
3520/7440 [=============>................] - ETA: 33s
3552/7440 [=============>................] - ETA: 33s
3584/7440 [=============>................] - ETA: 33s
3616/7440 [=============>................] - ETA: 32s
3648/7440 [=============>................] - ETA: 32s
3680/7440 [=============>................] - ETA: 32s
3712/7440 [=============>................] - ETA: 32s
3744/7440 [==============>...............] - ETA: 31s
3776/7440 [==============>...............] - ETA: 31s
3808/7440 [==============>...............] - ETA: 31s
3840/7440 [==============>...............] - ETA: 30s
3872/7440 [==============>...............] - ETA: 30s
3904/7440 [==============>...............] - ETA: 30s
3936/7440 [==============>...............] - ETA: 30s
3968/7440 [===============>..............] - ETA: 29s
4000/7440 [===============>..............] - ETA: 29s
4032/7440 [===============>..............] - ETA: 29s
4064/7440 [===============>..............] - ETA: 29s
4096/7440 [===============>..............] - ETA: 28s
4128/7440 [===============>..............] - ETA: 28s
4160/7440 [===============>..............] - ETA: 28s
4192/7440 [===============>..............] - ETA: 27s
4224/7440 [================>.............] - ETA: 27s
4256/7440 [================>.............] - ETA: 27s
4288/7440 [================>.............] - ETA: 27s
4320/7440 [================>.............] - ETA: 26s
4352/7440 [================>.............] - ETA: 26s
4384/7440 [================>.............] - ETA: 26s
4416/7440 [================>.............] - ETA: 26s
4448/7440 [================>.............] - ETA: 25s
4480/7440 [=================>............] - ETA: 25s
4512/7440 [=================>............] - ETA: 25s
4544/7440 [=================>............] - ETA: 24s
4576/7440 [=================>............] - ETA: 24s
4608/7440 [=================>............] - ETA: 24s
4640/7440 [=================>............] - ETA: 24s
4672/7440 [=================>............] - ETA: 23s
4704/7440 [=================>............] - ETA: 23s
4736/7440 [==================>...........] - ETA: 23s
4768/7440 [==================>...........] - ETA: 22s
4800/7440 [==================>...........] - ETA: 22s
4832/7440 [==================>...........] - ETA: 22s
4864/7440 [==================>...........] - ETA: 22s
4896/7440 [==================>...........] - ETA: 21s
4928/7440 [==================>...........] - ETA: 21s
4960/7440 [===================>..........] - ETA: 21s
4992/7440 [===================>..........] - ETA: 21s
5024/7440 [===================>..........] - ETA: 20s
5056/7440 [===================>..........] - ETA: 20s
5088/7440 [===================>..........] - ETA: 20s
5120/7440 [===================>..........] - ETA: 19s
5152/7440 [===================>..........] - ETA: 19s
5184/7440 [===================>..........] - ETA: 19s
5216/7440 [====================>.........] - ETA: 19s
5248/7440 [====================>.........] - ETA: 18s
5280/7440 [====================>.........] - ETA: 18s
5312/7440 [====================>.........] - ETA: 18s
5344/7440 [====================>.........] - ETA: 17s
5376/7440 [====================>.........] - ETA: 17s
5408/7440 [====================>.........] - ETA: 17s
5440/7440 [====================>.........] - ETA: 17s
5472/7440 [=====================>........] - ETA: 16s
5504/7440 [=====================>........] - ETA: 16s
5536/7440 [=====================>........] - ETA: 16s
5568/7440 [=====================>........] - ETA: 16s
5600/7440 [=====================>........] - ETA: 15s
5632/7440 [=====================>........] - ETA: 15s
5664/7440 [=====================>........] - ETA: 15s
5696/7440 [=====================>........] - ETA: 14s
5728/7440 [======================>.......] - ETA: 14s
5760/7440 [======================>.......] - ETA: 14s
5792/7440 [======================>.......] - ETA: 14s
5824/7440 [======================>.......] - ETA: 13s
5856/7440 [======================>.......] - ETA: 13s
5888/7440 [======================>.......] - ETA: 13s
5920/7440 [======================>.......] - ETA: 13s
5952/7440 [=======================>......] - ETA: 12s
5984/7440 [=======================>......] - ETA: 12s
6016/7440 [=======================>......] - ETA: 12s
6048/7440 [=======================>......] - ETA: 11s
6080/7440 [=======================>......] - ETA: 11s
6112/7440 [=======================>......] - ETA: 11s
6144/7440 [=======================>......] - ETA: 11s
6176/7440 [=======================>......] - ETA: 10s
6208/7440 [========================>.....] - ETA: 10s
6240/7440 [========================>.....] - ETA: 10s
6272/7440 [========================>.....] - ETA: 10s
6304/7440 [========================>.....] - ETA: 9s 
6336/7440 [========================>.....] - ETA: 9s
6368/7440 [========================>.....] - ETA: 9s
6400/7440 [========================>.....] - ETA: 8s
6432/7440 [========================>.....] - ETA: 8s
6464/7440 [=========================>....] - ETA: 8s
6496/7440 [=========================>....] - ETA: 8s
6528/7440 [=========================>....] - ETA: 7s
6560/7440 [=========================>....] - ETA: 7s
6592/7440 [=========================>....] - ETA: 7s
6624/7440 [=========================>....] - ETA: 7s
6656/7440 [=========================>....] - ETA: 6s
6688/7440 [=========================>....] - ETA: 6s
6720/7440 [==========================>...] - ETA: 6s
6752/7440 [==========================>...] - ETA: 5s
6784/7440 [==========================>...] - ETA: 5s
6816/7440 [==========================>...] - ETA: 5s
6848/7440 [==========================>...] - ETA: 5s
6880/7440 [==========================>...] - ETA: 4s
6912/7440 [==========================>...] - ETA: 4s
6944/7440 [===========================>..] - ETA: 4s
6976/7440 [===========================>..] - ETA: 3s
7008/7440 [===========================>..] - ETA: 3s
7040/7440 [===========================>..] - ETA: 3s
7072/7440 [===========================>..] - ETA: 3s
7104/7440 [===========================>..] - ETA: 2s
7136/7440 [===========================>..] - ETA: 2s
7168/7440 [===========================>..] - ETA: 2s
7200/7440 [============================>.] - ETA: 2s
7232/7440 [============================>.] - ETA: 1s
7264/7440 [============================>.] - ETA: 1s
7296/7440 [============================>.] - ETA: 1s
7328/7440 [============================>.] - ETA: 0s
7360/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7424/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 64s 9ms/step
Test accuracy: 0.8354838709677419
best model <keras.engine.training.Model object at 0x7fd4dcf3a630>
best run {'decay': 1, 'dense_filter': 0}
Evalutation of best performing model:

  32/7440 [..............................] - ETA: 1:04
  64/7440 [..............................] - ETA: 1:04
  96/7440 [..............................] - ETA: 1:04
 128/7440 [..............................] - ETA: 1:04
 160/7440 [..............................] - ETA: 1:04
 192/7440 [..............................] - ETA: 1:03
 224/7440 [..............................] - ETA: 1:03
 256/7440 [>.............................] - ETA: 1:03
 288/7440 [>.............................] - ETA: 1:02
 320/7440 [>.............................] - ETA: 1:02
 352/7440 [>.............................] - ETA: 1:01
 384/7440 [>.............................] - ETA: 1:01
 416/7440 [>.............................] - ETA: 1:00
 448/7440 [>.............................] - ETA: 1:00
 480/7440 [>.............................] - ETA: 1:00
 512/7440 [=>............................] - ETA: 59s 
 544/7440 [=>............................] - ETA: 59s
 576/7440 [=>............................] - ETA: 59s
 608/7440 [=>............................] - ETA: 58s
 640/7440 [=>............................] - ETA: 58s
 672/7440 [=>............................] - ETA: 58s
 704/7440 [=>............................] - ETA: 58s
 736/7440 [=>............................] - ETA: 57s
 768/7440 [==>...........................] - ETA: 57s
 800/7440 [==>...........................] - ETA: 57s
 832/7440 [==>...........................] - ETA: 56s
 864/7440 [==>...........................] - ETA: 56s
 896/7440 [==>...........................] - ETA: 56s
 928/7440 [==>...........................] - ETA: 56s
 960/7440 [==>...........................] - ETA: 55s
 992/7440 [===>..........................] - ETA: 55s
1024/7440 [===>..........................] - ETA: 55s
1056/7440 [===>..........................] - ETA: 55s
1088/7440 [===>..........................] - ETA: 54s
1120/7440 [===>..........................] - ETA: 54s
1152/7440 [===>..........................] - ETA: 54s
1184/7440 [===>..........................] - ETA: 53s
1216/7440 [===>..........................] - ETA: 53s
1248/7440 [====>.........................] - ETA: 53s
1280/7440 [====>.........................] - ETA: 53s
1312/7440 [====>.........................] - ETA: 52s
1344/7440 [====>.........................] - ETA: 52s
1376/7440 [====>.........................] - ETA: 52s
1408/7440 [====>.........................] - ETA: 51s
1440/7440 [====>.........................] - ETA: 51s
1472/7440 [====>.........................] - ETA: 51s
1504/7440 [=====>........................] - ETA: 51s
1536/7440 [=====>........................] - ETA: 50s
1568/7440 [=====>........................] - ETA: 50s
1600/7440 [=====>........................] - ETA: 50s
1632/7440 [=====>........................] - ETA: 49s
1664/7440 [=====>........................] - ETA: 49s
1696/7440 [=====>........................] - ETA: 49s
1728/7440 [=====>........................] - ETA: 49s
1760/7440 [======>.......................] - ETA: 48s
1792/7440 [======>.......................] - ETA: 48s
1824/7440 [======>.......................] - ETA: 48s
1856/7440 [======>.......................] - ETA: 47s
1888/7440 [======>.......................] - ETA: 47s
1920/7440 [======>.......................] - ETA: 47s
1952/7440 [======>.......................] - ETA: 47s
1984/7440 [=======>......................] - ETA: 46s
2016/7440 [=======>......................] - ETA: 46s
2048/7440 [=======>......................] - ETA: 46s
2080/7440 [=======>......................] - ETA: 45s
2112/7440 [=======>......................] - ETA: 45s
2144/7440 [=======>......................] - ETA: 45s
2176/7440 [=======>......................] - ETA: 45s
2208/7440 [=======>......................] - ETA: 44s
2240/7440 [========>.....................] - ETA: 44s
2272/7440 [========>.....................] - ETA: 44s
2304/7440 [========>.....................] - ETA: 44s
2336/7440 [========>.....................] - ETA: 43s
2368/7440 [========>.....................] - ETA: 43s
2400/7440 [========>.....................] - ETA: 43s
2432/7440 [========>.....................] - ETA: 42s
2464/7440 [========>.....................] - ETA: 42s
2496/7440 [=========>....................] - ETA: 42s
2528/7440 [=========>....................] - ETA: 42s
2560/7440 [=========>....................] - ETA: 41s
2592/7440 [=========>....................] - ETA: 41s
2624/7440 [=========>....................] - ETA: 41s
2656/7440 [=========>....................] - ETA: 41s
2688/7440 [=========>....................] - ETA: 40s
2720/7440 [=========>....................] - ETA: 40s
2752/7440 [==========>...................] - ETA: 40s
2784/7440 [==========>...................] - ETA: 39s
2816/7440 [==========>...................] - ETA: 39s
2848/7440 [==========>...................] - ETA: 39s
2880/7440 [==========>...................] - ETA: 39s
2912/7440 [==========>...................] - ETA: 38s
2944/7440 [==========>...................] - ETA: 38s
2976/7440 [===========>..................] - ETA: 38s
3008/7440 [===========>..................] - ETA: 38s
3040/7440 [===========>..................] - ETA: 37s
3072/7440 [===========>..................] - ETA: 37s
3104/7440 [===========>..................] - ETA: 37s
3136/7440 [===========>..................] - ETA: 36s
3168/7440 [===========>..................] - ETA: 36s
3200/7440 [===========>..................] - ETA: 36s
3232/7440 [============>.................] - ETA: 36s
3264/7440 [============>.................] - ETA: 35s
3296/7440 [============>.................] - ETA: 35s
3328/7440 [============>.................] - ETA: 35s
3360/7440 [============>.................] - ETA: 34s
3392/7440 [============>.................] - ETA: 34s
3424/7440 [============>.................] - ETA: 34s
3456/7440 [============>.................] - ETA: 34s
3488/7440 [=============>................] - ETA: 33s
3520/7440 [=============>................] - ETA: 33s
3552/7440 [=============>................] - ETA: 33s
3584/7440 [=============>................] - ETA: 33s
3616/7440 [=============>................] - ETA: 32s
3648/7440 [=============>................] - ETA: 32s
3680/7440 [=============>................] - ETA: 32s
3712/7440 [=============>................] - ETA: 31s
3744/7440 [==============>...............] - ETA: 31s
3776/7440 [==============>...............] - ETA: 31s
3808/7440 [==============>...............] - ETA: 31s
3840/7440 [==============>...............] - ETA: 30s
3872/7440 [==============>...............] - ETA: 30s
3904/7440 [==============>...............] - ETA: 30s
3936/7440 [==============>...............] - ETA: 30s
3968/7440 [===============>..............] - ETA: 29s
4000/7440 [===============>..............] - ETA: 29s
4032/7440 [===============>..............] - ETA: 29s
4064/7440 [===============>..............] - ETA: 28s
4096/7440 [===============>..............] - ETA: 28s
4128/7440 [===============>..............] - ETA: 28s
4160/7440 [===============>..............] - ETA: 28s
4192/7440 [===============>..............] - ETA: 27s
4224/7440 [================>.............] - ETA: 27s
4256/7440 [================>.............] - ETA: 27s
4288/7440 [================>.............] - ETA: 27s
4320/7440 [================>.............] - ETA: 26s
4352/7440 [================>.............] - ETA: 26s
4384/7440 [================>.............] - ETA: 26s
4416/7440 [================>.............] - ETA: 25s
4448/7440 [================>.............] - ETA: 25s
4480/7440 [=================>............] - ETA: 25s
4512/7440 [=================>............] - ETA: 25s
4544/7440 [=================>............] - ETA: 24s
4576/7440 [=================>............] - ETA: 24s
4608/7440 [=================>............] - ETA: 24s
4640/7440 [=================>............] - ETA: 24s
4672/7440 [=================>............] - ETA: 23s
4704/7440 [=================>............] - ETA: 23s
4736/7440 [==================>...........] - ETA: 23s
4768/7440 [==================>...........] - ETA: 22s
4800/7440 [==================>...........] - ETA: 22s
4832/7440 [==================>...........] - ETA: 22s
4864/7440 [==================>...........] - ETA: 22s
4896/7440 [==================>...........] - ETA: 21s
4928/7440 [==================>...........] - ETA: 21s
4960/7440 [===================>..........] - ETA: 21s
4992/7440 [===================>..........] - ETA: 21s
5024/7440 [===================>..........] - ETA: 20s
5056/7440 [===================>..........] - ETA: 20s
5088/7440 [===================>..........] - ETA: 20s
5120/7440 [===================>..........] - ETA: 19s
5152/7440 [===================>..........] - ETA: 19s
5184/7440 [===================>..........] - ETA: 19s
5216/7440 [====================>.........] - ETA: 19s
5248/7440 [====================>.........] - ETA: 18s
5280/7440 [====================>.........] - ETA: 18s
5312/7440 [====================>.........] - ETA: 18s
5344/7440 [====================>.........] - ETA: 17s
5376/7440 [====================>.........] - ETA: 17s
5408/7440 [====================>.........] - ETA: 17s
5440/7440 [====================>.........] - ETA: 17s
5472/7440 [=====================>........] - ETA: 16s
5504/7440 [=====================>........] - ETA: 16s
5536/7440 [=====================>........] - ETA: 16s
5568/7440 [=====================>........] - ETA: 16s
5600/7440 [=====================>........] - ETA: 15s
5632/7440 [=====================>........] - ETA: 15s
5664/7440 [=====================>........] - ETA: 15s
5696/7440 [=====================>........] - ETA: 14s
5728/7440 [======================>.......] - ETA: 14s
5760/7440 [======================>.......] - ETA: 14s
5792/7440 [======================>.......] - ETA: 14s
5824/7440 [======================>.......] - ETA: 13s
5856/7440 [======================>.......] - ETA: 13s
5888/7440 [======================>.......] - ETA: 13s
5920/7440 [======================>.......] - ETA: 13s
5952/7440 [=======================>......] - ETA: 12s
5984/7440 [=======================>......] - ETA: 12s
6016/7440 [=======================>......] - ETA: 12s
6048/7440 [=======================>......] - ETA: 11s
6080/7440 [=======================>......] - ETA: 11s
6112/7440 [=======================>......] - ETA: 11s
6144/7440 [=======================>......] - ETA: 11s
6176/7440 [=======================>......] - ETA: 10s
6208/7440 [========================>.....] - ETA: 10s
6240/7440 [========================>.....] - ETA: 10s
6272/7440 [========================>.....] - ETA: 10s
6304/7440 [========================>.....] - ETA: 9s 
6336/7440 [========================>.....] - ETA: 9s
6368/7440 [========================>.....] - ETA: 9s
6400/7440 [========================>.....] - ETA: 8s
6432/7440 [========================>.....] - ETA: 8s
6464/7440 [=========================>....] - ETA: 8s
6496/7440 [=========================>....] - ETA: 8s
6528/7440 [=========================>....] - ETA: 7s
6560/7440 [=========================>....] - ETA: 7s
6592/7440 [=========================>....] - ETA: 7s
6624/7440 [=========================>....] - ETA: 7s
6656/7440 [=========================>....] - ETA: 6s
6688/7440 [=========================>....] - ETA: 6s
6720/7440 [==========================>...] - ETA: 6s
6752/7440 [==========================>...] - ETA: 5s
6784/7440 [==========================>...] - ETA: 5s
6816/7440 [==========================>...] - ETA: 5s
6848/7440 [==========================>...] - ETA: 5s
6880/7440 [==========================>...] - ETA: 4s
6912/7440 [==========================>...] - ETA: 4s
6944/7440 [===========================>..] - ETA: 4s
6976/7440 [===========================>..] - ETA: 3s
7008/7440 [===========================>..] - ETA: 3s
7040/7440 [===========================>..] - ETA: 3s
7072/7440 [===========================>..] - ETA: 3s
7104/7440 [===========================>..] - ETA: 2s
7136/7440 [===========================>..] - ETA: 2s
7168/7440 [===========================>..] - ETA: 2s
7200/7440 [============================>.] - ETA: 2s
7232/7440 [============================>.] - ETA: 1s
7264/7440 [============================>.] - ETA: 1s
7296/7440 [============================>.] - ETA: 1s
7328/7440 [============================>.] - ETA: 0s
7360/7440 [============================>.] - ETA: 0s
7392/7440 [============================>.] - ETA: 0s
7424/7440 [============================>.] - ETA: 0s
7440/7440 [==============================] - 64s 9ms/step
[0.12459353809395145, 0.8354838709677419]
val roc_auc_score 0.938
