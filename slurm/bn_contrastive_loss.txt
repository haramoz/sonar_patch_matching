(anime) [amalli2s@wr14 contrastive_loss]$ python custom_gridsearch_contrastive_loss_vgg_bn1.py
Using TensorFlow backend.
Column names are conv2d_filters, kernel_sizes, initialization, layers, dense_filter1, dense_filter2, dense_filter3, dropout1, dropout2, dropout3, use_bn, batch_size, optimizer, lr, epochs, loss
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
2018-11-29 02:05:57.873788: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-11-29 02:05:58.110315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-11-29 02:05:58.272555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-11-29 02:05:58.272925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:05:59.011091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:05:59.011161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:05:59.011178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:05:59.011191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:05:59.011778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:05:59.131177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
 - 79s - loss: 0.2218 - acc: 0.6731 - val_loss: 0.2382 - val_acc: 0.5300
Epoch 2/5
 - 73s - loss: 0.1788 - acc: 0.7520 - val_loss: 0.2256 - val_acc: 0.5802
Epoch 3/5
 - 73s - loss: 0.1645 - acc: 0.7775 - val_loss: 0.1999 - val_acc: 0.6580
Epoch 4/5
 - 72s - loss: 0.1541 - acc: 0.8055 - val_loss: 0.2469 - val_acc: 0.5133
Epoch 5/5
 - 72s - loss: 0.1453 - acc: 0.8304 - val_loss: 0.1368 - val_acc: 0.8309
Test accuracy:0.735
current auc_score ------------------> 0.885
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:12:30.694310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:12:30.694511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:12:30.694540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:12:30.694559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:12:30.694573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:12:30.695009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:12:30.695186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 75s - loss: 0.2192 - acc: 0.6783 - val_loss: 0.3067 - val_acc: 0.5035
Epoch 2/5
 - 73s - loss: 0.1758 - acc: 0.7593 - val_loss: 0.2207 - val_acc: 0.5880
Epoch 3/5
 - 72s - loss: 0.1621 - acc: 0.7818 - val_loss: 0.2087 - val_acc: 0.5984
Epoch 4/5
 - 72s - loss: 0.1516 - acc: 0.8076 - val_loss: 0.1495 - val_acc: 0.8367
Epoch 5/5
 - 72s - loss: 0.1443 - acc: 0.8309 - val_loss: 0.1377 - val_acc: 0.8351
Test accuracy:0.742
current auc_score ------------------> 0.892
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:18:54.268858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:18:54.269089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:18:54.269121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:18:54.269141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:18:54.269160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:18:54.269661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:18:54.269871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2205 - acc: 0.6784 - val_loss: 0.2590 - val_acc: 0.5067
Epoch 2/5
 - 73s - loss: 0.1780 - acc: 0.7563 - val_loss: 0.1741 - val_acc: 0.7741
Epoch 3/5
 - 72s - loss: 0.1638 - acc: 0.7853 - val_loss: 0.2090 - val_acc: 0.6197
Epoch 4/5
 - 72s - loss: 0.1531 - acc: 0.8057 - val_loss: 0.1496 - val_acc: 0.7915
Epoch 5/5
 - 73s - loss: 0.1443 - acc: 0.8313 - val_loss: 0.1318 - val_acc: 0.8599
Test accuracy:0.834
current auc_score ------------------> 0.914
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:25:19.536714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:25:19.536944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:25:19.536974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:25:19.536993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:25:19.537009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:25:19.537831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:25:19.538077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 76s - loss: 0.2192 - acc: 0.6794 - val_loss: 0.2513 - val_acc: 0.5083
Epoch 2/5
 - 73s - loss: 0.1792 - acc: 0.7516 - val_loss: 0.1972 - val_acc: 0.6653
Epoch 3/5
 - 72s - loss: 0.1641 - acc: 0.7760 - val_loss: 0.1410 - val_acc: 0.8215
Epoch 4/5
 - 73s - loss: 0.1539 - acc: 0.7992 - val_loss: 0.1896 - val_acc: 0.6792
Epoch 5/5
 - 72s - loss: 0.1467 - acc: 0.8218 - val_loss: 0.1583 - val_acc: 0.7748
Test accuracy:0.810
current auc_score ------------------> 0.897
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:31:43.811162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:31:43.811389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:31:43.811422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:31:43.811462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:31:43.811479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:31:43.811992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:31:43.812245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2202 - acc: 0.6747 - val_loss: 0.2132 - val_acc: 0.6194
Epoch 2/5
 - 73s - loss: 0.1791 - acc: 0.7480 - val_loss: 0.2081 - val_acc: 0.6269
Epoch 3/5
 - 73s - loss: 0.1643 - acc: 0.7747 - val_loss: 0.1839 - val_acc: 0.7102
Epoch 4/5
 - 73s - loss: 0.1547 - acc: 0.8001 - val_loss: 0.1506 - val_acc: 0.8186
Epoch 5/5
 - 73s - loss: 0.1470 - acc: 0.8234 - val_loss: 0.1362 - val_acc: 0.8495
Test accuracy:0.772
current auc_score ------------------> 0.897
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:38:09.544572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:38:09.544821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:38:09.544854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:38:09.544890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:38:09.544908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:38:09.545706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:38:09.545963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2204 - acc: 0.6751 - val_loss: 0.2382 - val_acc: 0.5369
Epoch 2/5
 - 73s - loss: 0.1782 - acc: 0.7520 - val_loss: 0.2175 - val_acc: 0.5892
Epoch 3/5
 - 72s - loss: 0.1647 - acc: 0.7747 - val_loss: 0.1757 - val_acc: 0.7467
Epoch 4/5
 - 72s - loss: 0.1556 - acc: 0.7934 - val_loss: 0.2075 - val_acc: 0.6236
Epoch 5/5
 - 73s - loss: 0.1470 - acc: 0.8212 - val_loss: 0.1689 - val_acc: 0.7578
Test accuracy:0.769
current auc_score ------------------> 0.901
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:44:33.012359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:44:33.012532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:44:33.012556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:44:33.012572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:44:33.012584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:44:33.013013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:44:33.013175: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 75s - loss: 0.2183 - acc: 0.6761 - val_loss: 0.2753 - val_acc: 0.5055
Epoch 2/5
 - 72s - loss: 0.1768 - acc: 0.7596 - val_loss: 0.2229 - val_acc: 0.5474
Epoch 3/5
 - 72s - loss: 0.1632 - acc: 0.7850 - val_loss: 0.1665 - val_acc: 0.7838
Epoch 4/5
 - 72s - loss: 0.1542 - acc: 0.8058 - val_loss: 0.1464 - val_acc: 0.8299
Epoch 5/5
 - 71s - loss: 0.1458 - acc: 0.8270 - val_loss: 0.2059 - val_acc: 0.5989
Test accuracy:0.620
current auc_score ------------------> 0.886
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:50:54.147628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:50:54.147853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:50:54.147883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:50:54.147903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:50:54.147918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:50:54.148378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:50:54.148617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 75s - loss: 0.2195 - acc: 0.6775 - val_loss: 0.2640 - val_acc: 0.5161
Epoch 2/5
 - 70s - loss: 0.1765 - acc: 0.7589 - val_loss: 0.1644 - val_acc: 0.7712
Epoch 3/5
 - 70s - loss: 0.1618 - acc: 0.7855 - val_loss: 0.2085 - val_acc: 0.6340
Epoch 4/5
 - 70s - loss: 0.1522 - acc: 0.8101 - val_loss: 0.1408 - val_acc: 0.8415
Epoch 5/5
 - 70s - loss: 0.1444 - acc: 0.8290 - val_loss: 0.1664 - val_acc: 0.7503
Test accuracy:0.806
current auc_score ------------------> 0.926
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 02:57:07.013221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 02:57:07.013455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 02:57:07.013485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 02:57:07.013505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 02:57:07.013520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 02:57:07.013999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 02:57:07.014213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 75s - loss: 0.2201 - acc: 0.6756 - val_loss: 0.2946 - val_acc: 0.5056
Epoch 2/5
 - 71s - loss: 0.1774 - acc: 0.7545 - val_loss: 0.1737 - val_acc: 0.7600
Epoch 3/5
 - 71s - loss: 0.1637 - acc: 0.7810 - val_loss: 0.1709 - val_acc: 0.7751
Epoch 4/5
 - 72s - loss: 0.1534 - acc: 0.8049 - val_loss: 0.1390 - val_acc: 0.8539
Epoch 5/5
 - 72s - loss: 0.1451 - acc: 0.8251 - val_loss: 0.1370 - val_acc: 0.8539
Test accuracy:0.819
current auc_score ------------------> 0.902
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 03:03:27.596867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 03:03:27.597098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 03:03:27.597128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 03:03:27.597153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 03:03:27.597169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 03:03:27.597651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 03:03:27.597898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 76s - loss: 0.2213 - acc: 0.6752 - val_loss: 0.2548 - val_acc: 0.5088
Epoch 2/5
 - 72s - loss: 0.1783 - acc: 0.7570 - val_loss: 0.1877 - val_acc: 0.7048
Epoch 3/5
 - 72s - loss: 0.1640 - acc: 0.7784 - val_loss: 0.1708 - val_acc: 0.7392
Epoch 4/5
 - 72s - loss: 0.1544 - acc: 0.8020 - val_loss: 0.1544 - val_acc: 0.7967
Epoch 5/5
 - 72s - loss: 0.1468 - acc: 0.8250 - val_loss: 0.1587 - val_acc: 0.7759
Test accuracy:0.789
current auc_score ------------------> 0.900
accuracies:  [0.735, 0.742, 0.834, 0.81, 0.772, 0.769, 0.62, 0.806, 0.819, 0.789]
aucs:  [0.885, 0.892, 0.914, 0.897, 0.897, 0.901, 0.886, 0.926, 0.902, 0.9]
mean and std AUC:  0.9+/-0.012  max:   0.926
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '64', 'adam', '0.00001', '5', 'contrastive'], '0.9+/-0.012', 0.926)


Using TensorFlow backend.
Column names are conv2d_filters, kernel_sizes, initialization, layers, dense_filter1, dense_filter2, dense_filter3, dropout1, dropout2, dropout3, use_bn, batch_size, optimizer, lr, epochs, loss
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
2018-11-29 04:05:18.692647: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-11-29 04:05:18.927284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-11-29 04:05:19.087779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-11-29 04:05:19.088143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:05:19.952213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:05:19.952283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:05:19.952304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:05:19.952318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:05:19.952940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:05:20.082481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
 - 79s - loss: 0.2330 - acc: 0.6551 - val_loss: 0.1755 - val_acc: 0.7784
Epoch 2/5
 - 73s - loss: 0.1908 - acc: 0.7515 - val_loss: 0.1576 - val_acc: 0.8094
Epoch 3/5
 - 73s - loss: 0.1793 - acc: 0.7767 - val_loss: 0.1461 - val_acc: 0.8180
Epoch 4/5
 - 72s - loss: 0.1711 - acc: 0.7978 - val_loss: 0.1317 - val_acc: 0.8510
Epoch 5/5
 - 71s - loss: 0.1642 - acc: 0.8144 - val_loss: 0.1276 - val_acc: 0.8592
Test accuracy:0.801
current auc_score ------------------> 0.880
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:11:49.251060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:11:49.251264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:11:49.251298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:11:49.251319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:11:49.251344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:11:49.251994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:11:49.252198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 73s - loss: 0.2322 - acc: 0.6536 - val_loss: 0.1726 - val_acc: 0.7858
Epoch 2/5
 - 71s - loss: 0.1902 - acc: 0.7487 - val_loss: 0.1518 - val_acc: 0.8119
Epoch 3/5
 - 72s - loss: 0.1789 - acc: 0.7825 - val_loss: 0.1441 - val_acc: 0.8256
Epoch 4/5
 - 72s - loss: 0.1713 - acc: 0.7978 - val_loss: 0.1378 - val_acc: 0.8396
Epoch 5/5
 - 72s - loss: 0.1633 - acc: 0.8169 - val_loss: 0.1271 - val_acc: 0.8617
Test accuracy:0.822
current auc_score ------------------> 0.893
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:18:08.711796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:18:08.712047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:18:08.712076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:18:08.712099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:18:08.712116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:18:08.712609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:18:08.712854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 76s - loss: 0.2340 - acc: 0.6530 - val_loss: 0.1744 - val_acc: 0.7890
Epoch 2/5
 - 73s - loss: 0.1906 - acc: 0.7515 - val_loss: 0.1520 - val_acc: 0.8234
Epoch 3/5
 - 72s - loss: 0.1786 - acc: 0.7844 - val_loss: 0.1454 - val_acc: 0.8263
Epoch 4/5
 - 73s - loss: 0.1713 - acc: 0.7976 - val_loss: 0.1387 - val_acc: 0.8336
Epoch 5/5
 - 72s - loss: 0.1647 - acc: 0.8159 - val_loss: 0.1320 - val_acc: 0.8450
Test accuracy:0.798
current auc_score ------------------> 0.876
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:24:33.269873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:24:33.270100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:24:33.270127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:24:33.270144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:24:33.270160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:24:33.270605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:24:33.270824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 76s - loss: 0.2346 - acc: 0.6494 - val_loss: 0.1744 - val_acc: 0.7924
Epoch 2/5
 - 72s - loss: 0.1921 - acc: 0.7466 - val_loss: 0.1548 - val_acc: 0.8121
Epoch 3/5
 - 72s - loss: 0.1794 - acc: 0.7786 - val_loss: 0.1431 - val_acc: 0.8232
Epoch 4/5
 - 72s - loss: 0.1711 - acc: 0.7970 - val_loss: 0.1373 - val_acc: 0.8297
Epoch 5/5
 - 72s - loss: 0.1657 - acc: 0.8130 - val_loss: 0.1314 - val_acc: 0.8436
Test accuracy:0.801
current auc_score ------------------> 0.884
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:30:55.671923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:30:55.672178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:30:55.672227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:30:55.672249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:30:55.672265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:30:55.672815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:30:55.673064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2328 - acc: 0.6549 - val_loss: 0.1692 - val_acc: 0.7981
Epoch 2/5
 - 72s - loss: 0.1905 - acc: 0.7510 - val_loss: 0.1551 - val_acc: 0.8096
Epoch 3/5
 - 73s - loss: 0.1801 - acc: 0.7746 - val_loss: 0.1448 - val_acc: 0.8264
Epoch 4/5
 - 72s - loss: 0.1731 - acc: 0.7938 - val_loss: 0.1384 - val_acc: 0.8366
Epoch 5/5
 - 72s - loss: 0.1658 - acc: 0.8120 - val_loss: 0.1305 - val_acc: 0.8476
Test accuracy:0.796
current auc_score ------------------> 0.875
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:37:18.809226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:37:18.809464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:37:18.809497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:37:18.809515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:37:18.809530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:37:18.810282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:37:18.810576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2327 - acc: 0.6535 - val_loss: 0.1686 - val_acc: 0.7933
Epoch 2/5
 - 72s - loss: 0.1896 - acc: 0.7538 - val_loss: 0.1554 - val_acc: 0.8077
Epoch 3/5
 - 72s - loss: 0.1779 - acc: 0.7818 - val_loss: 0.1422 - val_acc: 0.8321
Epoch 4/5
 - 72s - loss: 0.1704 - acc: 0.8021 - val_loss: 0.1324 - val_acc: 0.8498
Epoch 5/5
 - 72s - loss: 0.1631 - acc: 0.8237 - val_loss: 0.1286 - val_acc: 0.8564
Test accuracy:0.809
current auc_score ------------------> 0.879
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:43:42.652525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:43:42.652778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:43:42.652810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:43:42.652839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:43:42.652854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:43:42.653329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:43:42.653579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2337 - acc: 0.6500 - val_loss: 0.1719 - val_acc: 0.7939
Epoch 2/5
 - 72s - loss: 0.1896 - acc: 0.7540 - val_loss: 0.1552 - val_acc: 0.8163
Epoch 3/5
 - 73s - loss: 0.1789 - acc: 0.7801 - val_loss: 0.1451 - val_acc: 0.8274
Epoch 4/5
 - 72s - loss: 0.1741 - acc: 0.7904 - val_loss: 0.1408 - val_acc: 0.8287
Epoch 5/5
 - 72s - loss: 0.1663 - acc: 0.8090 - val_loss: 0.1306 - val_acc: 0.8534
Test accuracy:0.781
current auc_score ------------------> 0.859
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:50:07.577540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:50:07.577799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:50:07.577832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:50:07.577867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:50:07.577884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:50:07.578369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:50:07.578609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2335 - acc: 0.6488 - val_loss: 0.1717 - val_acc: 0.7981
Epoch 2/5
 - 72s - loss: 0.1902 - acc: 0.7477 - val_loss: 0.1518 - val_acc: 0.8129
Epoch 3/5
 - 72s - loss: 0.1796 - acc: 0.7798 - val_loss: 0.1406 - val_acc: 0.8317
Epoch 4/5
 - 72s - loss: 0.1728 - acc: 0.7927 - val_loss: 0.1373 - val_acc: 0.8385
Epoch 5/5
 - 73s - loss: 0.1685 - acc: 0.8042 - val_loss: 0.1309 - val_acc: 0.8474
Test accuracy:0.777
current auc_score ------------------> 0.853
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 04:56:32.772433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 04:56:32.772669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 04:56:32.772708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 04:56:32.772738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 04:56:32.772756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 04:56:32.773473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 04:56:32.773749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2315 - acc: 0.6572 - val_loss: 0.1697 - val_acc: 0.7992
Epoch 2/5
 - 72s - loss: 0.1887 - acc: 0.7556 - val_loss: 0.1481 - val_acc: 0.8186
Epoch 3/5
 - 72s - loss: 0.1777 - acc: 0.7851 - val_loss: 0.1431 - val_acc: 0.8257
Epoch 4/5
 - 72s - loss: 0.1697 - acc: 0.8042 - val_loss: 0.1348 - val_acc: 0.8453
Epoch 5/5
 - 72s - loss: 0.1626 - acc: 0.8236 - val_loss: 0.1217 - val_acc: 0.8720
Test accuracy:0.809
current auc_score ------------------> 0.878
batch_size:  64  opt:  adam  lr:  1e-05  epochs:  5  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/5
2018-11-29 05:02:55.829915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-11-29 05:02:55.830147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-29 05:02:55.830176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-11-29 05:02:55.830198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-11-29 05:02:55.830212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-11-29 05:02:55.830701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-29 05:02:55.830956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 77s - loss: 0.2341 - acc: 0.6479 - val_loss: 0.1716 - val_acc: 0.7844
Epoch 2/5
 - 72s - loss: 0.1923 - acc: 0.7444 - val_loss: 0.1551 - val_acc: 0.8141
Epoch 3/5
 - 72s - loss: 0.1807 - acc: 0.7748 - val_loss: 0.1499 - val_acc: 0.8135
Epoch 4/5
 - 72s - loss: 0.1728 - acc: 0.7933 - val_loss: 0.1357 - val_acc: 0.8312
Epoch 5/5
 - 72s - loss: 0.1669 - acc: 0.8080 - val_loss: 0.1305 - val_acc: 0.8468
Test accuracy:0.780
current auc_score ------------------> 0.867
accuracies:  [0.801, 0.822, 0.798, 0.801, 0.796, 0.809, 0.781, 0.777, 0.809, 0.78]
aucs:  [0.88, 0.893, 0.876, 0.884, 0.875, 0.879, 0.859, 0.853, 0.878, 0.867]
mean and std AUC:  0.874+/-0.011  max:   0.893
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '64', 'adam', '0.00001', '5', 'contrastive'], '0.874+/-0.011', 0.893)

(anime) [amalli2s@wr14 contrastive_loss]$ python custom_gridsearch_contrastive_loss_vgg_bn1.py
Using TensorFlow backend.
Column names are conv2d_filters, kernel_sizes, initialization, layers, dense_filter1, dense_filter2, dense_filter3, dropout1, dropout2, dropout3, use_bn, batch_size, optimizer, lr, epochs, loss
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
2018-12-03 03:56:10.733954: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-12-03 03:56:11.017644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-12-03 03:56:11.218252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-12-03 03:56:11.220933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 03:56:12.854987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 03:56:12.855091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 03:56:12.855116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 03:56:12.855134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 03:56:12.855857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 03:56:13.017980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
 - 101s - loss: 0.2096 - acc: 0.6914 - val_loss: 0.1692 - val_acc: 0.7840
Epoch 2/4
 - 96s - loss: 0.1734 - acc: 0.7603 - val_loss: 0.1488 - val_acc: 0.8291
Epoch 3/4
 - 96s - loss: 0.1599 - acc: 0.7859 - val_loss: 0.1690 - val_acc: 0.7812
Epoch 4/4
 - 97s - loss: 0.1500 - acc: 0.8117 - val_loss: 0.1365 - val_acc: 0.8523
Test accuracy:0.821
current auc_score ------------------> 0.902
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:03:07.106182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:03:07.106408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:03:07.106444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:03:07.106464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:03:07.106482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:03:07.106977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:03:07.107234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2101 - acc: 0.6924 - val_loss: 0.1912 - val_acc: 0.7154
Epoch 2/4
 - 97s - loss: 0.1720 - acc: 0.7673 - val_loss: 0.1565 - val_acc: 0.8035
Epoch 3/4
 - 97s - loss: 0.1588 - acc: 0.7919 - val_loss: 0.1670 - val_acc: 0.7703
Epoch 4/4
 - 97s - loss: 0.1495 - acc: 0.8182 - val_loss: 0.1376 - val_acc: 0.8612
Test accuracy:0.799
current auc_score ------------------> 0.893
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:09:58.435711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:09:58.435947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:09:58.436001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:09:58.436023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:09:58.436038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:09:58.436531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:09:58.436792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2087 - acc: 0.6948 - val_loss: 0.1898 - val_acc: 0.7321
Epoch 2/4
 - 97s - loss: 0.1728 - acc: 0.7616 - val_loss: 0.1640 - val_acc: 0.7971
Epoch 3/4
 - 97s - loss: 0.1574 - acc: 0.7917 - val_loss: 0.1560 - val_acc: 0.7888
Epoch 4/4
 - 97s - loss: 0.1479 - acc: 0.8165 - val_loss: 0.1312 - val_acc: 0.8576
Test accuracy:0.815
current auc_score ------------------> 0.902
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:16:44.458335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:16:44.458460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:16:44.458483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:16:44.458498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:16:44.458513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:16:44.458802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:16:44.458933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 100s - loss: 0.2085 - acc: 0.6966 - val_loss: 0.1973 - val_acc: 0.6916
Epoch 2/4
 - 97s - loss: 0.1739 - acc: 0.7590 - val_loss: 0.1541 - val_acc: 0.8048
Epoch 3/4
 - 96s - loss: 0.1616 - acc: 0.7818 - val_loss: 0.1411 - val_acc: 0.8466
Epoch 4/4
 - 97s - loss: 0.1516 - acc: 0.8077 - val_loss: 0.1505 - val_acc: 0.8076
Test accuracy:0.655
current auc_score ------------------> 0.875
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:23:33.026145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:23:33.026384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:23:33.026434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:23:33.026463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:23:33.026480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:23:33.026964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:23:33.027188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 102s - loss: 0.2074 - acc: 0.7011 - val_loss: 0.1848 - val_acc: 0.7280
Epoch 2/4
 - 97s - loss: 0.1717 - acc: 0.7653 - val_loss: 0.1601 - val_acc: 0.7844
Epoch 3/4
 - 97s - loss: 0.1578 - acc: 0.7923 - val_loss: 0.1518 - val_acc: 0.8028
Epoch 4/4
 - 98s - loss: 0.1482 - acc: 0.8181 - val_loss: 0.1484 - val_acc: 0.8099
Test accuracy:0.638
current auc_score ------------------> 0.881
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:30:25.699707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:30:25.699935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:30:25.699980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:30:25.700012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:30:25.700030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:30:25.700538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:30:25.700780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2078 - acc: 0.6979 - val_loss: 0.2190 - val_acc: 0.5866
Epoch 2/4
 - 97s - loss: 0.1713 - acc: 0.7646 - val_loss: 0.1698 - val_acc: 0.7600
Epoch 3/4
 - 97s - loss: 0.1577 - acc: 0.7895 - val_loss: 0.1529 - val_acc: 0.8107
Epoch 4/4
 - 97s - loss: 0.1499 - acc: 0.8109 - val_loss: 0.1306 - val_acc: 0.8642
Test accuracy:0.771
current auc_score ------------------> 0.899
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:37:17.638817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:37:17.639077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:37:17.639112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:37:17.639135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:37:17.639154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:37:17.639632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:37:17.639866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2072 - acc: 0.7002 - val_loss: 0.2114 - val_acc: 0.6205
Epoch 2/4
 - 97s - loss: 0.1734 - acc: 0.7595 - val_loss: 0.1561 - val_acc: 0.8074
Epoch 3/4
 - 96s - loss: 0.1610 - acc: 0.7836 - val_loss: 0.2270 - val_acc: 0.5344
Epoch 4/4
 - 96s - loss: 0.1500 - acc: 0.8107 - val_loss: 0.1266 - val_acc: 0.8813
Test accuracy:0.845
current auc_score ------------------> 0.931
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:44:05.847110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:44:05.847334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:44:05.847488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:44:05.847535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:44:05.847547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:44:05.847986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:44:05.848187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2092 - acc: 0.6936 - val_loss: 0.1675 - val_acc: 0.7939
Epoch 2/4
 - 96s - loss: 0.1742 - acc: 0.7573 - val_loss: 0.1819 - val_acc: 0.7401
Epoch 3/4
 - 95s - loss: 0.1615 - acc: 0.7801 - val_loss: 0.1440 - val_acc: 0.8128
Epoch 4/4
 - 96s - loss: 0.1515 - acc: 0.8003 - val_loss: 0.1674 - val_acc: 0.7523
Test accuracy:0.796
current auc_score ------------------> 0.905
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:50:52.636278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:50:52.636528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:50:52.636572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:50:52.636591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:50:52.636606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:50:52.637029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:50:52.637233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2083 - acc: 0.6941 - val_loss: 0.1990 - val_acc: 0.6930
Epoch 2/4
 - 96s - loss: 0.1734 - acc: 0.7567 - val_loss: 0.2167 - val_acc: 0.5723
Epoch 3/4
 - 96s - loss: 0.1609 - acc: 0.7806 - val_loss: 0.1493 - val_acc: 0.8337
Epoch 4/4
 - 96s - loss: 0.1516 - acc: 0.8049 - val_loss: 0.1411 - val_acc: 0.8385
Test accuracy:0.777
current auc_score ------------------> 0.912
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:57:40.985841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:57:40.986090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:57:40.986135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:57:40.986166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:57:40.986183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:57:40.986634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:57:40.986854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 100s - loss: 0.2090 - acc: 0.6969 - val_loss: 0.1918 - val_acc: 0.6954
Epoch 2/4
 - 96s - loss: 0.1738 - acc: 0.7577 - val_loss: 0.1802 - val_acc: 0.7327
Epoch 3/4
 - 96s - loss: 0.1614 - acc: 0.7832 - val_loss: 0.1503 - val_acc: 0.8282
Epoch 4/4
 - 96s - loss: 0.1512 - acc: 0.8075 - val_loss: 0.1296 - val_acc: 0.8583
Test accuracy:0.834
current auc_score ------------------> 0.913
accuracies:  [0.821, 0.799, 0.815, 0.655, 0.638, 0.771, 0.845, 0.796, 0.777, 0.834]
aucs:  [0.902, 0.893, 0.902, 0.875, 0.881, 0.899, 0.931, 0.905, 0.912, 0.913]
mean and std AUC:  0.901+/-0.015  max:   0.931
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:04:31.400838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:04:31.401079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:04:31.401146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:04:31.401168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:04:31.401182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:04:31.401647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:04:31.401874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 68s - loss: 0.2413 - acc: 0.6416 - val_loss: 0.2816 - val_acc: 0.5036
Epoch 2/6
 - 62s - loss: 0.1882 - acc: 0.7377 - val_loss: 0.2834 - val_acc: 0.5068
Epoch 3/6
 - 62s - loss: 0.1747 - acc: 0.7607 - val_loss: 0.2623 - val_acc: 0.5243
Epoch 4/6
 - 62s - loss: 0.1645 - acc: 0.7758 - val_loss: 0.2836 - val_acc: 0.5050
Epoch 5/6
 - 62s - loss: 0.1576 - acc: 0.7948 - val_loss: 0.1881 - val_acc: 0.6795
Epoch 6/6
 - 62s - loss: 0.1521 - acc: 0.8068 - val_loss: 0.2004 - val_acc: 0.6189
Test accuracy:0.738
current auc_score ------------------> 0.918
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:11:09.761563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:11:09.761815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:11:09.761847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:11:09.761876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:11:09.761892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:11:09.762349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:11:09.762578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2357 - acc: 0.6554 - val_loss: 0.2770 - val_acc: 0.5059
Epoch 2/6
 - 62s - loss: 0.1874 - acc: 0.7405 - val_loss: 0.2495 - val_acc: 0.5344
Epoch 3/6
 - 62s - loss: 0.1731 - acc: 0.7607 - val_loss: 0.2415 - val_acc: 0.5384
Epoch 4/6
 - 63s - loss: 0.1640 - acc: 0.7774 - val_loss: 0.1981 - val_acc: 0.6540
Epoch 5/6
 - 62s - loss: 0.1568 - acc: 0.7942 - val_loss: 0.1482 - val_acc: 0.8061
Epoch 6/6
 - 62s - loss: 0.1508 - acc: 0.8072 - val_loss: 0.2079 - val_acc: 0.5983
Test accuracy:0.652
current auc_score ------------------> 0.934
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:17:46.787497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:17:46.787710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:17:46.787748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:17:46.787769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:17:46.787786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:17:46.788244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:17:46.788444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2382 - acc: 0.6464 - val_loss: 0.2339 - val_acc: 0.5383
Epoch 2/6
 - 62s - loss: 0.1886 - acc: 0.7357 - val_loss: 0.2734 - val_acc: 0.5065
Epoch 3/6
 - 62s - loss: 0.1733 - acc: 0.7624 - val_loss: 0.2036 - val_acc: 0.6598
Epoch 4/6
 - 62s - loss: 0.1646 - acc: 0.7790 - val_loss: 0.1883 - val_acc: 0.6915
Epoch 5/6
 - 62s - loss: 0.1574 - acc: 0.7943 - val_loss: 0.2135 - val_acc: 0.5766
Epoch 6/6
 - 62s - loss: 0.1508 - acc: 0.8118 - val_loss: 0.1668 - val_acc: 0.7538
Test accuracy:0.784
current auc_score ------------------> 0.935
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:24:19.880378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:24:19.880614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:24:19.880658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:24:19.880677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:24:19.880691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:24:19.881084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:24:19.881289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2370 - acc: 0.6474 - val_loss: 0.3126 - val_acc: 0.5036
Epoch 2/6
 - 61s - loss: 0.1876 - acc: 0.7393 - val_loss: 0.2681 - val_acc: 0.5197
Epoch 3/6
 - 61s - loss: 0.1727 - acc: 0.7659 - val_loss: 0.2023 - val_acc: 0.6600
Epoch 4/6
 - 60s - loss: 0.1630 - acc: 0.7803 - val_loss: 0.2968 - val_acc: 0.5035
Epoch 5/6
 - 61s - loss: 0.1557 - acc: 0.7953 - val_loss: 0.1923 - val_acc: 0.6677
Epoch 6/6
 - 62s - loss: 0.1503 - acc: 0.8142 - val_loss: 0.1616 - val_acc: 0.7558
Test accuracy:0.744
current auc_score ------------------> 0.898
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:30:50.438092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:30:50.438330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:30:50.438372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:30:50.438411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:30:50.438431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:30:50.438888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:30:50.439112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2376 - acc: 0.6517 - val_loss: 0.2816 - val_acc: 0.5059
Epoch 2/6
 - 62s - loss: 0.1870 - acc: 0.7386 - val_loss: 0.2396 - val_acc: 0.5264
Epoch 3/6
 - 62s - loss: 0.1730 - acc: 0.7629 - val_loss: 0.2367 - val_acc: 0.5192
Epoch 4/6
 - 63s - loss: 0.1638 - acc: 0.7757 - val_loss: 0.2204 - val_acc: 0.5655
Epoch 5/6
 - 62s - loss: 0.1565 - acc: 0.7903 - val_loss: 0.2800 - val_acc: 0.5050
Epoch 6/6
 - 62s - loss: 0.1501 - acc: 0.8091 - val_loss: 0.1843 - val_acc: 0.6846
Test accuracy:0.750
current auc_score ------------------> 0.885
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:37:26.916968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:37:26.917199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:37:26.917242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:37:26.917265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:37:26.917284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:37:26.917697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:37:26.917891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2384 - acc: 0.6430 - val_loss: 0.2725 - val_acc: 0.5045
Epoch 2/6
 - 62s - loss: 0.1882 - acc: 0.7351 - val_loss: 0.2660 - val_acc: 0.5190
Epoch 3/6
 - 62s - loss: 0.1730 - acc: 0.7621 - val_loss: 0.2659 - val_acc: 0.5323
Epoch 4/6
 - 62s - loss: 0.1636 - acc: 0.7790 - val_loss: 0.1850 - val_acc: 0.7043
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7938 - val_loss: 0.1915 - val_acc: 0.6605
Epoch 6/6
 - 62s - loss: 0.1495 - acc: 0.8133 - val_loss: 0.1595 - val_acc: 0.7614
Test accuracy:0.815
current auc_score ------------------> 0.918
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:44:02.568052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:44:02.568281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:44:02.568324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:44:02.568469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:44:02.568498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:44:02.569018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:44:02.569231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2391 - acc: 0.6454 - val_loss: 0.3003 - val_acc: 0.5036
Epoch 2/6
 - 62s - loss: 0.1886 - acc: 0.7357 - val_loss: 0.2666 - val_acc: 0.5046
Epoch 3/6
 - 63s - loss: 0.1744 - acc: 0.7581 - val_loss: 0.2274 - val_acc: 0.5439
Epoch 4/6
 - 62s - loss: 0.1644 - acc: 0.7759 - val_loss: 0.2611 - val_acc: 0.5251
Epoch 5/6
 - 62s - loss: 0.1571 - acc: 0.7902 - val_loss: 0.1979 - val_acc: 0.6798
Epoch 6/6
 - 63s - loss: 0.1510 - acc: 0.8074 - val_loss: 0.2191 - val_acc: 0.6130
Test accuracy:0.647
current auc_score ------------------> 0.888
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:50:38.032098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:50:38.032270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:50:38.032297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:50:38.032313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:50:38.032334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:50:38.032698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:50:38.032856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2377 - acc: 0.6467 - val_loss: 0.3021 - val_acc: 0.5038
Epoch 2/6
 - 62s - loss: 0.1861 - acc: 0.7426 - val_loss: 0.2546 - val_acc: 0.5136
Epoch 3/6
 - 62s - loss: 0.1729 - acc: 0.7661 - val_loss: 0.2156 - val_acc: 0.5858
Epoch 4/6
 - 62s - loss: 0.1635 - acc: 0.7807 - val_loss: 0.2392 - val_acc: 0.5297
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7965 - val_loss: 0.1931 - val_acc: 0.6747
Epoch 6/6
 - 62s - loss: 0.1497 - acc: 0.8159 - val_loss: 0.1420 - val_acc: 0.8017
Test accuracy:0.806
current auc_score ------------------> 0.892
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:57:10.507211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:57:10.507436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:57:10.507467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:57:10.507489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:57:10.507505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:57:10.507924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:57:10.508139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2355 - acc: 0.6529 - val_loss: 0.2436 - val_acc: 0.5261
Epoch 2/6
 - 62s - loss: 0.1868 - acc: 0.7396 - val_loss: 0.2397 - val_acc: 0.5591
Epoch 3/6
 - 62s - loss: 0.1724 - acc: 0.7679 - val_loss: 0.2211 - val_acc: 0.5625
Epoch 4/6
 - 62s - loss: 0.1637 - acc: 0.7811 - val_loss: 0.1853 - val_acc: 0.7201
Epoch 5/6
 - 62s - loss: 0.1570 - acc: 0.7944 - val_loss: 0.1658 - val_acc: 0.7622
Epoch 6/6
 - 62s - loss: 0.1494 - acc: 0.8144 - val_loss: 0.1362 - val_acc: 0.8469
Test accuracy:0.848
current auc_score ------------------> 0.927
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 06:03:47.151620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:03:47.151845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:03:47.151886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:03:47.151907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:03:47.151924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:03:47.152372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:03:47.152642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2363 - acc: 0.6509 - val_loss: 0.2773 - val_acc: 0.5045
Epoch 2/6
 - 62s - loss: 0.1880 - acc: 0.7367 - val_loss: 0.2683 - val_acc: 0.5065
Epoch 3/6
 - 62s - loss: 0.1738 - acc: 0.7612 - val_loss: 0.1777 - val_acc: 0.7371
Epoch 4/6
 - 62s - loss: 0.1643 - acc: 0.7771 - val_loss: 0.2267 - val_acc: 0.5472
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7948 - val_loss: 0.2084 - val_acc: 0.6254
Epoch 6/6
 - 62s - loss: 0.1502 - acc: 0.8113 - val_loss: 0.2033 - val_acc: 0.6143

Epoch 00006: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Test accuracy:0.626
current auc_score ------------------> 0.894
accuracies:  [0.738, 0.652, 0.784, 0.744, 0.75, 0.815, 0.647, 0.806, 0.848, 0.626]
aucs:  [0.918, 0.934, 0.935, 0.898, 0.885, 0.918, 0.888, 0.892, 0.927, 0.894]
mean and std AUC:  0.909+/-0.019  max:   0.935
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:10:27.093272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:10:27.093507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:10:27.093557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:10:27.093579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:10:27.093596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:10:27.094063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:10:27.094298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2625 - acc: 0.6110 - val_loss: 0.2322 - val_acc: 0.5434
Epoch 2/10
 - 58s - loss: 0.1999 - acc: 0.7129 - val_loss: 0.2831 - val_acc: 0.5051
Epoch 3/10
 - 58s - loss: 0.1862 - acc: 0.7413 - val_loss: 0.2920 - val_acc: 0.5068
Epoch 4/10
 - 58s - loss: 0.1764 - acc: 0.7579 - val_loss: 0.2571 - val_acc: 0.5275

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1701 - acc: 0.7695 - val_loss: 0.2668 - val_acc: 0.5296
Epoch 00005: early stopping
Test accuracy:0.514
current auc_score ------------------> 0.861
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:15:40.483335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:15:40.483472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:15:40.483495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:15:40.483509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:15:40.483520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:15:40.483834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:15:40.483969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2646 - acc: 0.6076 - val_loss: 0.2561 - val_acc: 0.5098
Epoch 2/10
 - 58s - loss: 0.2012 - acc: 0.7134 - val_loss: 0.2708 - val_acc: 0.5074
Epoch 3/10
 - 58s - loss: 0.1876 - acc: 0.7388 - val_loss: 0.2900 - val_acc: 0.5127
Epoch 4/10
 - 58s - loss: 0.1770 - acc: 0.7564 - val_loss: 0.2951 - val_acc: 0.5097

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1710 - acc: 0.7669 - val_loss: 0.2820 - val_acc: 0.5051
Epoch 6/10
 - 58s - loss: 0.1687 - acc: 0.7697 - val_loss: 0.2779 - val_acc: 0.5068
Epoch 7/10
 - 59s - loss: 0.1666 - acc: 0.7735 - val_loss: 0.2687 - val_acc: 0.5093

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.99999983430526e-07.
Epoch 00007: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.853
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:22:50.544572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:22:50.544779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:22:50.544841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:22:50.544860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:22:50.544874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:22:50.545323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:22:50.545519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2660 - acc: 0.6086 - val_loss: 0.2628 - val_acc: 0.5053
Epoch 2/10
 - 58s - loss: 0.2019 - acc: 0.7083 - val_loss: 0.2737 - val_acc: 0.5053
Epoch 3/10
 - 58s - loss: 0.1875 - acc: 0.7381 - val_loss: 0.2864 - val_acc: 0.5061
Epoch 4/10
 - 58s - loss: 0.1775 - acc: 0.7561 - val_loss: 0.2889 - val_acc: 0.5063

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1717 - acc: 0.7676 - val_loss: 0.2941 - val_acc: 0.5044
Epoch 6/10
 - 58s - loss: 0.1687 - acc: 0.7716 - val_loss: 0.2712 - val_acc: 0.5051
Epoch 7/10
 - 58s - loss: 0.1663 - acc: 0.7777 - val_loss: 0.2150 - val_acc: 0.6098
Epoch 8/10
 - 58s - loss: 0.1642 - acc: 0.7820 - val_loss: 0.2791 - val_acc: 0.5038
Epoch 9/10
 - 58s - loss: 0.1623 - acc: 0.7847 - val_loss: 0.1976 - val_acc: 0.6708
Epoch 10/10
 - 58s - loss: 0.1605 - acc: 0.7855 - val_loss: 0.2996 - val_acc: 0.5035
Test accuracy:0.500
current auc_score ------------------> 0.789
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:32:53.169220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:32:53.169451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:32:53.169493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:32:53.169511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:32:53.169526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:32:53.169937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:32:53.170151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2635 - acc: 0.6118 - val_loss: 0.2510 - val_acc: 0.5133
Epoch 2/10
 - 58s - loss: 0.2002 - acc: 0.7143 - val_loss: 0.2802 - val_acc: 0.5068
Epoch 3/10
 - 58s - loss: 0.1867 - acc: 0.7456 - val_loss: 0.2812 - val_acc: 0.5075
Epoch 4/10
 - 58s - loss: 0.1772 - acc: 0.7580 - val_loss: 0.2793 - val_acc: 0.5099

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1705 - acc: 0.7689 - val_loss: 0.2761 - val_acc: 0.5049
Epoch 00005: early stopping
Test accuracy:0.508
current auc_score ------------------> 0.901
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:38:06.432433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:38:06.432639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:38:06.432676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:38:06.432696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:38:06.432712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:38:06.433149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:38:06.433339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2625 - acc: 0.6094 - val_loss: 0.2514 - val_acc: 0.5131
Epoch 2/10
 - 58s - loss: 0.1994 - acc: 0.7138 - val_loss: 0.2774 - val_acc: 0.5049
Epoch 3/10
 - 58s - loss: 0.1857 - acc: 0.7429 - val_loss: 0.2810 - val_acc: 0.5109
Epoch 4/10
 - 58s - loss: 0.1761 - acc: 0.7611 - val_loss: 0.2590 - val_acc: 0.5173

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1704 - acc: 0.7705 - val_loss: 0.2570 - val_acc: 0.5237
Epoch 6/10
 - 58s - loss: 0.1676 - acc: 0.7740 - val_loss: 0.2338 - val_acc: 0.5365
Epoch 7/10
 - 58s - loss: 0.1653 - acc: 0.7764 - val_loss: 0.2397 - val_acc: 0.5207
Epoch 8/10
 - 58s - loss: 0.1631 - acc: 0.7834 - val_loss: 0.2464 - val_acc: 0.5157
Epoch 9/10
 - 58s - loss: 0.1612 - acc: 0.7840 - val_loss: 0.2299 - val_acc: 0.5419
Epoch 10/10
 - 58s - loss: 0.1590 - acc: 0.7911 - val_loss: 0.1782 - val_acc: 0.7057
Test accuracy:0.726
current auc_score ------------------> 0.914
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:48:11.528393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:48:11.528602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:48:11.528641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:48:11.528662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:48:11.528679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:48:11.529133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:48:11.529350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2616 - acc: 0.6063 - val_loss: 0.2600 - val_acc: 0.5113
Epoch 2/10
 - 58s - loss: 0.2001 - acc: 0.7098 - val_loss: 0.2801 - val_acc: 0.5055
Epoch 3/10
 - 58s - loss: 0.1861 - acc: 0.7406 - val_loss: 0.2552 - val_acc: 0.5144
Epoch 4/10
 - 58s - loss: 0.1764 - acc: 0.7611 - val_loss: 0.2376 - val_acc: 0.5439
Epoch 5/10
 - 58s - loss: 0.1693 - acc: 0.7718 - val_loss: 0.2667 - val_acc: 0.5250
Epoch 6/10
 - 58s - loss: 0.1641 - acc: 0.7809 - val_loss: 0.2912 - val_acc: 0.5154
Epoch 7/10
 - 58s - loss: 0.1587 - acc: 0.7924 - val_loss: 0.2944 - val_acc: 0.5035

Epoch 00007: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 8/10
 - 58s - loss: 0.1546 - acc: 0.7989 - val_loss: 0.2387 - val_acc: 0.5359
Epoch 00008: early stopping
Test accuracy:0.508
current auc_score ------------------> 0.897
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:56:20.378759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:56:20.379009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:56:20.379054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:56:20.379072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:56:20.379094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:56:20.379517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:56:20.379744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2674 - acc: 0.6018 - val_loss: 0.2663 - val_acc: 0.5055
Epoch 2/10
 - 58s - loss: 0.2022 - acc: 0.7081 - val_loss: 0.2953 - val_acc: 0.5040
Epoch 3/10
 - 58s - loss: 0.1874 - acc: 0.7400 - val_loss: 0.2896 - val_acc: 0.5126
Epoch 4/10
 - 58s - loss: 0.1770 - acc: 0.7563 - val_loss: 0.2824 - val_acc: 0.5262

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1705 - acc: 0.7679 - val_loss: 0.2837 - val_acc: 0.5088
Epoch 6/10
 - 58s - loss: 0.1677 - acc: 0.7709 - val_loss: 0.2670 - val_acc: 0.5080
Epoch 7/10
 - 58s - loss: 0.1657 - acc: 0.7767 - val_loss: 0.2496 - val_acc: 0.5237
Epoch 8/10
 - 58s - loss: 0.1638 - acc: 0.7800 - val_loss: 0.2618 - val_acc: 0.5080
Epoch 00008: early stopping
Test accuracy:0.507
current auc_score ------------------> 0.877
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:04:26.972924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:04:26.973129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:04:26.973161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:04:26.973181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:04:26.973196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:04:26.973587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:04:26.973758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2638 - acc: 0.6076 - val_loss: 0.2777 - val_acc: 0.5036
Epoch 2/10
 - 58s - loss: 0.2009 - acc: 0.7107 - val_loss: 0.3364 - val_acc: 0.5035
Epoch 3/10
 - 58s - loss: 0.1863 - acc: 0.7433 - val_loss: 0.3218 - val_acc: 0.5036
Epoch 4/10
 - 58s - loss: 0.1759 - acc: 0.7645 - val_loss: 0.2725 - val_acc: 0.5177
Epoch 5/10
 - 58s - loss: 0.1686 - acc: 0.7721 - val_loss: 0.2995 - val_acc: 0.5082
Epoch 6/10
 - 58s - loss: 0.1628 - acc: 0.7848 - val_loss: 0.2988 - val_acc: 0.5035
Epoch 7/10
 - 58s - loss: 0.1576 - acc: 0.7964 - val_loss: 0.2667 - val_acc: 0.5046
Epoch 8/10
 - 58s - loss: 0.1537 - acc: 0.8057 - val_loss: 0.2386 - val_acc: 0.5533
Epoch 9/10
 - 58s - loss: 0.1498 - acc: 0.8181 - val_loss: 0.1768 - val_acc: 0.7102
Epoch 10/10
 - 58s - loss: 0.1458 - acc: 0.8293 - val_loss: 0.2702 - val_acc: 0.5038
Test accuracy:0.500
current auc_score ------------------> 0.887
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:14:29.065409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:14:29.065642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:14:29.065680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:14:29.065699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:14:29.065716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:14:29.066180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:14:29.066389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2680 - acc: 0.6027 - val_loss: 0.2496 - val_acc: 0.5190
Epoch 2/10
 - 57s - loss: 0.2021 - acc: 0.7053 - val_loss: 0.3291 - val_acc: 0.5036
Epoch 3/10
 - 57s - loss: 0.1879 - acc: 0.7377 - val_loss: 0.2672 - val_acc: 0.5128
Epoch 4/10
 - 58s - loss: 0.1775 - acc: 0.7523 - val_loss: 0.3034 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1712 - acc: 0.7653 - val_loss: 0.2879 - val_acc: 0.5113
Epoch 00005: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.845
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:19:37.685595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:19:37.685808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:19:37.685848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:19:37.685867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:19:37.685882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:19:37.686315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:19:37.686566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2650 - acc: 0.6073 - val_loss: 0.2704 - val_acc: 0.5039
Epoch 2/10
 - 58s - loss: 0.2015 - acc: 0.7120 - val_loss: 0.2993 - val_acc: 0.5043
Epoch 3/10
 - 59s - loss: 0.1872 - acc: 0.7421 - val_loss: 0.3285 - val_acc: 0.5038
Epoch 4/10
 - 58s - loss: 0.1774 - acc: 0.7599 - val_loss: 0.2891 - val_acc: 0.5122

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1709 - acc: 0.7706 - val_loss: 0.2944 - val_acc: 0.5089
Epoch 6/10
 - 58s - loss: 0.1683 - acc: 0.7746 - val_loss: 0.2477 - val_acc: 0.5316
Epoch 7/10
 - 58s - loss: 0.1665 - acc: 0.7777 - val_loss: 0.2904 - val_acc: 0.5050
Epoch 8/10
 - 58s - loss: 0.1641 - acc: 0.7826 - val_loss: 0.2916 - val_acc: 0.5039
Epoch 9/10
 - 58s - loss: 0.1616 - acc: 0.7864 - val_loss: 0.2428 - val_acc: 0.5215
Epoch 10/10
 - 58s - loss: 0.1600 - acc: 0.7907 - val_loss: 0.2405 - val_acc: 0.5324
Test accuracy:0.524
current auc_score ------------------> 0.902
accuracies:  [0.514, 0.501, 0.5, 0.508, 0.726, 0.508, 0.507, 0.5, 0.501, 0.524]
aucs:  [0.861, 0.853, 0.789, 0.901, 0.914, 0.897, 0.877, 0.887, 0.845, 0.902]
mean and std AUC:  0.873+/-0.035  max:   0.914
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:29:47.856518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:29:47.856698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:29:47.856733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:29:47.856748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:29:47.856760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:29:47.857099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:29:47.857304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.3078 - acc: 0.5581 - val_loss: 0.2165 - val_acc: 0.6437
Epoch 2/12
 - 56s - loss: 0.2149 - acc: 0.6773 - val_loss: 0.2565 - val_acc: 0.5085
Epoch 3/12
 - 56s - loss: 0.2010 - acc: 0.7191 - val_loss: 0.3053 - val_acc: 0.5038
Epoch 4/12
 - 56s - loss: 0.1927 - acc: 0.7346 - val_loss: 0.2862 - val_acc: 0.5055

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1864 - acc: 0.7473 - val_loss: 0.3084 - val_acc: 0.5035
Epoch 00005: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.801
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:34:55.805381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:34:55.805590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:34:55.805628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:34:55.805659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:34:55.805677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:34:55.806102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:34:55.806286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 59s - loss: 0.3095 - acc: 0.5566 - val_loss: 0.2094 - val_acc: 0.6883
Epoch 2/12
 - 56s - loss: 0.2157 - acc: 0.6724 - val_loss: 0.2616 - val_acc: 0.5061
Epoch 3/12
 - 56s - loss: 0.2024 - acc: 0.7090 - val_loss: 0.2929 - val_acc: 0.5046
Epoch 4/12
 - 56s - loss: 0.1934 - acc: 0.7292 - val_loss: 0.2940 - val_acc: 0.5113

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1873 - acc: 0.7417 - val_loss: 0.2876 - val_acc: 0.5113
Epoch 00005: early stopping
Test accuracy:0.512
current auc_score ------------------> 0.854
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:39:57.933213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:39:57.933446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:39:57.933489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:39:57.933509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:39:57.933525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:39:57.933945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:39:57.934184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3102 - acc: 0.5531 - val_loss: 0.2067 - val_acc: 0.7071
Epoch 2/12
 - 56s - loss: 0.2160 - acc: 0.6717 - val_loss: 0.2581 - val_acc: 0.5072
Epoch 3/12
 - 56s - loss: 0.2024 - acc: 0.7120 - val_loss: 0.2813 - val_acc: 0.5055
Epoch 4/12
 - 56s - loss: 0.1925 - acc: 0.7347 - val_loss: 0.3064 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1865 - acc: 0.7423 - val_loss: 0.3112 - val_acc: 0.5044
Epoch 00005: early stopping
Test accuracy:0.504
current auc_score ------------------> 0.844
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:45:00.423342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:45:00.423555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:45:00.423592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:45:00.423609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:45:00.423623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:45:00.424059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:45:00.424263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3042 - acc: 0.5589 - val_loss: 0.2169 - val_acc: 0.6441
Epoch 2/12
 - 56s - loss: 0.2140 - acc: 0.6752 - val_loss: 0.2706 - val_acc: 0.5064
Epoch 3/12
 - 56s - loss: 0.2005 - acc: 0.7115 - val_loss: 0.3078 - val_acc: 0.5049
Epoch 4/12
 - 56s - loss: 0.1914 - acc: 0.7368 - val_loss: 0.3047 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1864 - acc: 0.7426 - val_loss: 0.3086 - val_acc: 0.5048
Epoch 00005: early stopping
Test accuracy:0.505
current auc_score ------------------> 0.828
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:50:01.729623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:50:01.729844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:50:01.729878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:50:01.729900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:50:01.729915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:50:01.730367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:50:01.730573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 59s - loss: 0.3088 - acc: 0.5556 - val_loss: 0.2109 - val_acc: 0.6699
Epoch 2/12
 - 56s - loss: 0.2158 - acc: 0.6706 - val_loss: 0.2594 - val_acc: 0.5107
Epoch 3/12
 - 56s - loss: 0.2017 - acc: 0.7105 - val_loss: 0.2864 - val_acc: 0.5048
Epoch 4/12
 - 56s - loss: 0.1924 - acc: 0.7304 - val_loss: 0.3006 - val_acc: 0.5044

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1868 - acc: 0.7426 - val_loss: 0.2974 - val_acc: 0.5043
Epoch 00005: early stopping
Test accuracy:0.511
current auc_score ------------------> 0.832
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:55:03.467268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:55:03.467462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:55:03.467482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:55:03.467496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:55:03.467524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:55:03.467925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:55:03.468138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3062 - acc: 0.5610 - val_loss: 0.2206 - val_acc: 0.6305
Epoch 2/12
 - 56s - loss: 0.2156 - acc: 0.6684 - val_loss: 0.2599 - val_acc: 0.5093
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7044 - val_loss: 0.2962 - val_acc: 0.5045
Epoch 4/12
 - 56s - loss: 0.1934 - acc: 0.7282 - val_loss: 0.2957 - val_acc: 0.5056

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1873 - acc: 0.7409 - val_loss: 0.3070 - val_acc: 0.5050
Epoch 00005: early stopping
Test accuracy:0.507
current auc_score ------------------> 0.856
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:00:06.861985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:00:06.862219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:00:06.862263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:00:06.862285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:00:06.862302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:00:06.862712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:00:06.862936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3096 - acc: 0.5557 - val_loss: 0.2098 - val_acc: 0.6773
Epoch 2/12
 - 56s - loss: 0.2140 - acc: 0.6746 - val_loss: 0.2498 - val_acc: 0.5097
Epoch 3/12
 - 56s - loss: 0.2012 - acc: 0.7129 - val_loss: 0.3080 - val_acc: 0.5039
Epoch 4/12
 - 56s - loss: 0.1925 - acc: 0.7343 - val_loss: 0.3006 - val_acc: 0.5039

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1871 - acc: 0.7447 - val_loss: 0.3149 - val_acc: 0.5036
Epoch 00005: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.798
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:05:07.522023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:05:07.522180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:05:07.522203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:05:07.522217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:05:07.522229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:05:07.522555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:05:07.522691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 58s - loss: 0.3081 - acc: 0.5588 - val_loss: 0.2066 - val_acc: 0.6969
Epoch 2/12
 - 56s - loss: 0.2144 - acc: 0.6742 - val_loss: 0.2393 - val_acc: 0.5261
Epoch 3/12
 - 56s - loss: 0.2009 - acc: 0.7148 - val_loss: 0.2955 - val_acc: 0.5043
Epoch 4/12
 - 56s - loss: 0.1923 - acc: 0.7341 - val_loss: 0.2794 - val_acc: 0.5110

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1872 - acc: 0.7426 - val_loss: 0.2800 - val_acc: 0.5120
Epoch 00005: early stopping
Test accuracy:0.530
current auc_score ------------------> 0.856
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:10:06.790699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:10:06.790948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:10:06.791000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:10:06.791023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:10:06.791041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:10:06.791483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:10:06.791689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3117 - acc: 0.5519 - val_loss: 0.2192 - val_acc: 0.6409
Epoch 2/12
 - 56s - loss: 0.2166 - acc: 0.6649 - val_loss: 0.2659 - val_acc: 0.5063
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7090 - val_loss: 0.3195 - val_acc: 0.5035
Epoch 4/12
 - 56s - loss: 0.1933 - acc: 0.7309 - val_loss: 0.3245 - val_acc: 0.5036

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1884 - acc: 0.7421 - val_loss: 0.3363 - val_acc: 0.5035
Epoch 00005: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.734
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:15:10.055956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:15:10.056198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:15:10.056241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:15:10.056262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:15:10.056278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:15:10.056750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:15:10.056953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3100 - acc: 0.5558 - val_loss: 0.2156 - val_acc: 0.6525
Epoch 2/12
 - 56s - loss: 0.2162 - acc: 0.6681 - val_loss: 0.2919 - val_acc: 0.5044
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7109 - val_loss: 0.3045 - val_acc: 0.5041
Epoch 4/12
 - 56s - loss: 0.1931 - acc: 0.7292 - val_loss: 0.3043 - val_acc: 0.5053

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1872 - acc: 0.7422 - val_loss: 0.3076 - val_acc: 0.5048
Epoch 00005: early stopping
Test accuracy:0.503
current auc_score ------------------> 0.816
accuracies:  [0.5, 0.512, 0.504, 0.505, 0.511, 0.507, 0.501, 0.53, 0.5, 0.503]
aucs:  [0.801, 0.854, 0.844, 0.828, 0.832, 0.856, 0.798, 0.856, 0.734, 0.816]
mean and std AUC:  0.822+/-0.036  max:   0.856
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '32', 'adam', '0.00001', '4', 'contrastive'], '0.901+/-0.015', 0.931)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '128', 'adam', '0.00001', '6', 'contrastive'], '0.909+/-0.019', 0.935)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '256', 'adam', '0.00001', '10', 'contrastive'], '0.873+/-0.035', 0.914)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '512', 'adam', '0.00001', '12', 'contrastive'], '0.822+/-0.036', 0.856)(anime) [amalli2s@wr14 contrastive_loss]$ python custom_gridsearch_contrastive_loss_vgg_bn1.py
Using TensorFlow backend.
Column names are conv2d_filters, kernel_sizes, initialization, layers, dense_filter1, dense_filter2, dense_filter3, dropout1, dropout2, dropout3, use_bn, batch_size, optimizer, lr, epochs, loss
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
2018-12-03 03:56:10.733954: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-12-03 03:56:11.017644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-12-03 03:56:11.218252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-12-03 03:56:11.220933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 03:56:12.854987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 03:56:12.855091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 03:56:12.855116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 03:56:12.855134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 03:56:12.855857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 03:56:13.017980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
 - 101s - loss: 0.2096 - acc: 0.6914 - val_loss: 0.1692 - val_acc: 0.7840
Epoch 2/4
 - 96s - loss: 0.1734 - acc: 0.7603 - val_loss: 0.1488 - val_acc: 0.8291
Epoch 3/4
 - 96s - loss: 0.1599 - acc: 0.7859 - val_loss: 0.1690 - val_acc: 0.7812
Epoch 4/4
 - 97s - loss: 0.1500 - acc: 0.8117 - val_loss: 0.1365 - val_acc: 0.8523
Test accuracy:0.821
current auc_score ------------------> 0.902
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:03:07.106182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:03:07.106408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:03:07.106444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:03:07.106464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:03:07.106482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:03:07.106977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:03:07.107234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2101 - acc: 0.6924 - val_loss: 0.1912 - val_acc: 0.7154
Epoch 2/4
 - 97s - loss: 0.1720 - acc: 0.7673 - val_loss: 0.1565 - val_acc: 0.8035
Epoch 3/4
 - 97s - loss: 0.1588 - acc: 0.7919 - val_loss: 0.1670 - val_acc: 0.7703
Epoch 4/4
 - 97s - loss: 0.1495 - acc: 0.8182 - val_loss: 0.1376 - val_acc: 0.8612
Test accuracy:0.799
current auc_score ------------------> 0.893
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:09:58.435711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:09:58.435947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:09:58.436001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:09:58.436023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:09:58.436038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:09:58.436531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:09:58.436792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2087 - acc: 0.6948 - val_loss: 0.1898 - val_acc: 0.7321
Epoch 2/4
 - 97s - loss: 0.1728 - acc: 0.7616 - val_loss: 0.1640 - val_acc: 0.7971
Epoch 3/4
 - 97s - loss: 0.1574 - acc: 0.7917 - val_loss: 0.1560 - val_acc: 0.7888
Epoch 4/4
 - 97s - loss: 0.1479 - acc: 0.8165 - val_loss: 0.1312 - val_acc: 0.8576
Test accuracy:0.815
current auc_score ------------------> 0.902
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:16:44.458335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:16:44.458460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:16:44.458483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:16:44.458498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:16:44.458513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:16:44.458802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:16:44.458933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 100s - loss: 0.2085 - acc: 0.6966 - val_loss: 0.1973 - val_acc: 0.6916
Epoch 2/4
 - 97s - loss: 0.1739 - acc: 0.7590 - val_loss: 0.1541 - val_acc: 0.8048
Epoch 3/4
 - 96s - loss: 0.1616 - acc: 0.7818 - val_loss: 0.1411 - val_acc: 0.8466
Epoch 4/4
 - 97s - loss: 0.1516 - acc: 0.8077 - val_loss: 0.1505 - val_acc: 0.8076
Test accuracy:0.655
current auc_score ------------------> 0.875
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:23:33.026145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:23:33.026384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:23:33.026434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:23:33.026463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:23:33.026480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:23:33.026964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:23:33.027188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 102s - loss: 0.2074 - acc: 0.7011 - val_loss: 0.1848 - val_acc: 0.7280
Epoch 2/4
 - 97s - loss: 0.1717 - acc: 0.7653 - val_loss: 0.1601 - val_acc: 0.7844
Epoch 3/4
 - 97s - loss: 0.1578 - acc: 0.7923 - val_loss: 0.1518 - val_acc: 0.8028
Epoch 4/4
 - 98s - loss: 0.1482 - acc: 0.8181 - val_loss: 0.1484 - val_acc: 0.8099
Test accuracy:0.638
current auc_score ------------------> 0.881
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:30:25.699707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:30:25.699935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:30:25.699980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:30:25.700012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:30:25.700030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:30:25.700538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:30:25.700780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2078 - acc: 0.6979 - val_loss: 0.2190 - val_acc: 0.5866
Epoch 2/4
 - 97s - loss: 0.1713 - acc: 0.7646 - val_loss: 0.1698 - val_acc: 0.7600
Epoch 3/4
 - 97s - loss: 0.1577 - acc: 0.7895 - val_loss: 0.1529 - val_acc: 0.8107
Epoch 4/4
 - 97s - loss: 0.1499 - acc: 0.8109 - val_loss: 0.1306 - val_acc: 0.8642
Test accuracy:0.771
current auc_score ------------------> 0.899
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:37:17.638817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:37:17.639077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:37:17.639112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:37:17.639135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:37:17.639154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:37:17.639632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:37:17.639866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2072 - acc: 0.7002 - val_loss: 0.2114 - val_acc: 0.6205
Epoch 2/4
 - 97s - loss: 0.1734 - acc: 0.7595 - val_loss: 0.1561 - val_acc: 0.8074
Epoch 3/4
 - 96s - loss: 0.1610 - acc: 0.7836 - val_loss: 0.2270 - val_acc: 0.5344
Epoch 4/4
 - 96s - loss: 0.1500 - acc: 0.8107 - val_loss: 0.1266 - val_acc: 0.8813
Test accuracy:0.845
current auc_score ------------------> 0.931
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:44:05.847110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:44:05.847334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:44:05.847488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:44:05.847535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:44:05.847547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:44:05.847986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:44:05.848187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2092 - acc: 0.6936 - val_loss: 0.1675 - val_acc: 0.7939
Epoch 2/4
 - 96s - loss: 0.1742 - acc: 0.7573 - val_loss: 0.1819 - val_acc: 0.7401
Epoch 3/4
 - 95s - loss: 0.1615 - acc: 0.7801 - val_loss: 0.1440 - val_acc: 0.8128
Epoch 4/4
 - 96s - loss: 0.1515 - acc: 0.8003 - val_loss: 0.1674 - val_acc: 0.7523
Test accuracy:0.796
current auc_score ------------------> 0.905
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:50:52.636278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:50:52.636528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:50:52.636572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:50:52.636591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:50:52.636606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:50:52.637029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:50:52.637233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2083 - acc: 0.6941 - val_loss: 0.1990 - val_acc: 0.6930
Epoch 2/4
 - 96s - loss: 0.1734 - acc: 0.7567 - val_loss: 0.2167 - val_acc: 0.5723
Epoch 3/4
 - 96s - loss: 0.1609 - acc: 0.7806 - val_loss: 0.1493 - val_acc: 0.8337
Epoch 4/4
 - 96s - loss: 0.1516 - acc: 0.8049 - val_loss: 0.1411 - val_acc: 0.8385
Test accuracy:0.777
current auc_score ------------------> 0.912
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:57:40.985841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:57:40.986090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:57:40.986135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:57:40.986166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:57:40.986183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:57:40.986634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:57:40.986854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 100s - loss: 0.2090 - acc: 0.6969 - val_loss: 0.1918 - val_acc: 0.6954
Epoch 2/4
 - 96s - loss: 0.1738 - acc: 0.7577 - val_loss: 0.1802 - val_acc: 0.7327
Epoch 3/4
 - 96s - loss: 0.1614 - acc: 0.7832 - val_loss: 0.1503 - val_acc: 0.8282
Epoch 4/4
 - 96s - loss: 0.1512 - acc: 0.8075 - val_loss: 0.1296 - val_acc: 0.8583
Test accuracy:0.834
current auc_score ------------------> 0.913
accuracies:  [0.821, 0.799, 0.815, 0.655, 0.638, 0.771, 0.845, 0.796, 0.777, 0.834]
aucs:  [0.902, 0.893, 0.902, 0.875, 0.881, 0.899, 0.931, 0.905, 0.912, 0.913]
mean and std AUC:  0.901+/-0.015  max:   0.931
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:04:31.400838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:04:31.401079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:04:31.401146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:04:31.401168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:04:31.401182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:04:31.401647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:04:31.401874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 68s - loss: 0.2413 - acc: 0.6416 - val_loss: 0.2816 - val_acc: 0.5036
Epoch 2/6
 - 62s - loss: 0.1882 - acc: 0.7377 - val_loss: 0.2834 - val_acc: 0.5068
Epoch 3/6
 - 62s - loss: 0.1747 - acc: 0.7607 - val_loss: 0.2623 - val_acc: 0.5243
Epoch 4/6
 - 62s - loss: 0.1645 - acc: 0.7758 - val_loss: 0.2836 - val_acc: 0.5050
Epoch 5/6
 - 62s - loss: 0.1576 - acc: 0.7948 - val_loss: 0.1881 - val_acc: 0.6795
Epoch 6/6
 - 62s - loss: 0.1521 - acc: 0.8068 - val_loss: 0.2004 - val_acc: 0.6189
Test accuracy:0.738
current auc_score ------------------> 0.918
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:11:09.761563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:11:09.761815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:11:09.761847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:11:09.761876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:11:09.761892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:11:09.762349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:11:09.762578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2357 - acc: 0.6554 - val_loss: 0.2770 - val_acc: 0.5059
Epoch 2/6
 - 62s - loss: 0.1874 - acc: 0.7405 - val_loss: 0.2495 - val_acc: 0.5344
Epoch 3/6
 - 62s - loss: 0.1731 - acc: 0.7607 - val_loss: 0.2415 - val_acc: 0.5384
Epoch 4/6
 - 63s - loss: 0.1640 - acc: 0.7774 - val_loss: 0.1981 - val_acc: 0.6540
Epoch 5/6
 - 62s - loss: 0.1568 - acc: 0.7942 - val_loss: 0.1482 - val_acc: 0.8061
Epoch 6/6
 - 62s - loss: 0.1508 - acc: 0.8072 - val_loss: 0.2079 - val_acc: 0.5983
Test accuracy:0.652
current auc_score ------------------> 0.934
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:17:46.787497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:17:46.787710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:17:46.787748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:17:46.787769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:17:46.787786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:17:46.788244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:17:46.788444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2382 - acc: 0.6464 - val_loss: 0.2339 - val_acc: 0.5383
Epoch 2/6
 - 62s - loss: 0.1886 - acc: 0.7357 - val_loss: 0.2734 - val_acc: 0.5065
Epoch 3/6
 - 62s - loss: 0.1733 - acc: 0.7624 - val_loss: 0.2036 - val_acc: 0.6598
Epoch 4/6
 - 62s - loss: 0.1646 - acc: 0.7790 - val_loss: 0.1883 - val_acc: 0.6915
Epoch 5/6
 - 62s - loss: 0.1574 - acc: 0.7943 - val_loss: 0.2135 - val_acc: 0.5766
Epoch 6/6
 - 62s - loss: 0.1508 - acc: 0.8118 - val_loss: 0.1668 - val_acc: 0.7538
Test accuracy:0.784
current auc_score ------------------> 0.935
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:24:19.880378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:24:19.880614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:24:19.880658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:24:19.880677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:24:19.880691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:24:19.881084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:24:19.881289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2370 - acc: 0.6474 - val_loss: 0.3126 - val_acc: 0.5036
Epoch 2/6
 - 61s - loss: 0.1876 - acc: 0.7393 - val_loss: 0.2681 - val_acc: 0.5197
Epoch 3/6
 - 61s - loss: 0.1727 - acc: 0.7659 - val_loss: 0.2023 - val_acc: 0.6600
Epoch 4/6
 - 60s - loss: 0.1630 - acc: 0.7803 - val_loss: 0.2968 - val_acc: 0.5035
Epoch 5/6
 - 61s - loss: 0.1557 - acc: 0.7953 - val_loss: 0.1923 - val_acc: 0.6677
Epoch 6/6
 - 62s - loss: 0.1503 - acc: 0.8142 - val_loss: 0.1616 - val_acc: 0.7558
Test accuracy:0.744
current auc_score ------------------> 0.898
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:30:50.438092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:30:50.438330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:30:50.438372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:30:50.438411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:30:50.438431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:30:50.438888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:30:50.439112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2376 - acc: 0.6517 - val_loss: 0.2816 - val_acc: 0.5059
Epoch 2/6
 - 62s - loss: 0.1870 - acc: 0.7386 - val_loss: 0.2396 - val_acc: 0.5264
Epoch 3/6
 - 62s - loss: 0.1730 - acc: 0.7629 - val_loss: 0.2367 - val_acc: 0.5192
Epoch 4/6
 - 63s - loss: 0.1638 - acc: 0.7757 - val_loss: 0.2204 - val_acc: 0.5655
Epoch 5/6
 - 62s - loss: 0.1565 - acc: 0.7903 - val_loss: 0.2800 - val_acc: 0.5050
Epoch 6/6
 - 62s - loss: 0.1501 - acc: 0.8091 - val_loss: 0.1843 - val_acc: 0.6846
Test accuracy:0.750
current auc_score ------------------> 0.885
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:37:26.916968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:37:26.917199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:37:26.917242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:37:26.917265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:37:26.917284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:37:26.917697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:37:26.917891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2384 - acc: 0.6430 - val_loss: 0.2725 - val_acc: 0.5045
Epoch 2/6
 - 62s - loss: 0.1882 - acc: 0.7351 - val_loss: 0.2660 - val_acc: 0.5190
Epoch 3/6
 - 62s - loss: 0.1730 - acc: 0.7621 - val_loss: 0.2659 - val_acc: 0.5323
Epoch 4/6
 - 62s - loss: 0.1636 - acc: 0.7790 - val_loss: 0.1850 - val_acc: 0.7043
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7938 - val_loss: 0.1915 - val_acc: 0.6605
Epoch 6/6
 - 62s - loss: 0.1495 - acc: 0.8133 - val_loss: 0.1595 - val_acc: 0.7614
Test accuracy:0.815
current auc_score ------------------> 0.918
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:44:02.568052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:44:02.568281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:44:02.568324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:44:02.568469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:44:02.568498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:44:02.569018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:44:02.569231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2391 - acc: 0.6454 - val_loss: 0.3003 - val_acc: 0.5036
Epoch 2/6
 - 62s - loss: 0.1886 - acc: 0.7357 - val_loss: 0.2666 - val_acc: 0.5046
Epoch 3/6
 - 63s - loss: 0.1744 - acc: 0.7581 - val_loss: 0.2274 - val_acc: 0.5439
Epoch 4/6
 - 62s - loss: 0.1644 - acc: 0.7759 - val_loss: 0.2611 - val_acc: 0.5251
Epoch 5/6
 - 62s - loss: 0.1571 - acc: 0.7902 - val_loss: 0.1979 - val_acc: 0.6798
Epoch 6/6
 - 63s - loss: 0.1510 - acc: 0.8074 - val_loss: 0.2191 - val_acc: 0.6130
Test accuracy:0.647
current auc_score ------------------> 0.888
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:50:38.032098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:50:38.032270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:50:38.032297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:50:38.032313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:50:38.032334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:50:38.032698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:50:38.032856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2377 - acc: 0.6467 - val_loss: 0.3021 - val_acc: 0.5038
Epoch 2/6
 - 62s - loss: 0.1861 - acc: 0.7426 - val_loss: 0.2546 - val_acc: 0.5136
Epoch 3/6
 - 62s - loss: 0.1729 - acc: 0.7661 - val_loss: 0.2156 - val_acc: 0.5858
Epoch 4/6
 - 62s - loss: 0.1635 - acc: 0.7807 - val_loss: 0.2392 - val_acc: 0.5297
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7965 - val_loss: 0.1931 - val_acc: 0.6747
Epoch 6/6
 - 62s - loss: 0.1497 - acc: 0.8159 - val_loss: 0.1420 - val_acc: 0.8017
Test accuracy:0.806
current auc_score ------------------> 0.892
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:57:10.507211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:57:10.507436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:57:10.507467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:57:10.507489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:57:10.507505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:57:10.507924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:57:10.508139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2355 - acc: 0.6529 - val_loss: 0.2436 - val_acc: 0.5261
Epoch 2/6
 - 62s - loss: 0.1868 - acc: 0.7396 - val_loss: 0.2397 - val_acc: 0.5591
Epoch 3/6
 - 62s - loss: 0.1724 - acc: 0.7679 - val_loss: 0.2211 - val_acc: 0.5625
Epoch 4/6
 - 62s - loss: 0.1637 - acc: 0.7811 - val_loss: 0.1853 - val_acc: 0.7201
Epoch 5/6
 - 62s - loss: 0.1570 - acc: 0.7944 - val_loss: 0.1658 - val_acc: 0.7622
Epoch 6/6
 - 62s - loss: 0.1494 - acc: 0.8144 - val_loss: 0.1362 - val_acc: 0.8469
Test accuracy:0.848
current auc_score ------------------> 0.927
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 06:03:47.151620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:03:47.151845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:03:47.151886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:03:47.151907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:03:47.151924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:03:47.152372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:03:47.152642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2363 - acc: 0.6509 - val_loss: 0.2773 - val_acc: 0.5045
Epoch 2/6
 - 62s - loss: 0.1880 - acc: 0.7367 - val_loss: 0.2683 - val_acc: 0.5065
Epoch 3/6
 - 62s - loss: 0.1738 - acc: 0.7612 - val_loss: 0.1777 - val_acc: 0.7371
Epoch 4/6
 - 62s - loss: 0.1643 - acc: 0.7771 - val_loss: 0.2267 - val_acc: 0.5472
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7948 - val_loss: 0.2084 - val_acc: 0.6254
Epoch 6/6
 - 62s - loss: 0.1502 - acc: 0.8113 - val_loss: 0.2033 - val_acc: 0.6143

Epoch 00006: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Test accuracy:0.626
current auc_score ------------------> 0.894
accuracies:  [0.738, 0.652, 0.784, 0.744, 0.75, 0.815, 0.647, 0.806, 0.848, 0.626]
aucs:  [0.918, 0.934, 0.935, 0.898, 0.885, 0.918, 0.888, 0.892, 0.927, 0.894]
mean and std AUC:  0.909+/-0.019  max:   0.935
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:10:27.093272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:10:27.093507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:10:27.093557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:10:27.093579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:10:27.093596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:10:27.094063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:10:27.094298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2625 - acc: 0.6110 - val_loss: 0.2322 - val_acc: 0.5434
Epoch 2/10
 - 58s - loss: 0.1999 - acc: 0.7129 - val_loss: 0.2831 - val_acc: 0.5051
Epoch 3/10
 - 58s - loss: 0.1862 - acc: 0.7413 - val_loss: 0.2920 - val_acc: 0.5068
Epoch 4/10
 - 58s - loss: 0.1764 - acc: 0.7579 - val_loss: 0.2571 - val_acc: 0.5275

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1701 - acc: 0.7695 - val_loss: 0.2668 - val_acc: 0.5296
Epoch 00005: early stopping
Test accuracy:0.514
current auc_score ------------------> 0.861
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:15:40.483335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:15:40.483472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:15:40.483495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:15:40.483509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:15:40.483520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:15:40.483834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:15:40.483969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2646 - acc: 0.6076 - val_loss: 0.2561 - val_acc: 0.5098
Epoch 2/10
 - 58s - loss: 0.2012 - acc: 0.7134 - val_loss: 0.2708 - val_acc: 0.5074
Epoch 3/10
 - 58s - loss: 0.1876 - acc: 0.7388 - val_loss: 0.2900 - val_acc: 0.5127
Epoch 4/10
 - 58s - loss: 0.1770 - acc: 0.7564 - val_loss: 0.2951 - val_acc: 0.5097

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1710 - acc: 0.7669 - val_loss: 0.2820 - val_acc: 0.5051
Epoch 6/10
 - 58s - loss: 0.1687 - acc: 0.7697 - val_loss: 0.2779 - val_acc: 0.5068
Epoch 7/10
 - 59s - loss: 0.1666 - acc: 0.7735 - val_loss: 0.2687 - val_acc: 0.5093

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.99999983430526e-07.
Epoch 00007: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.853
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:22:50.544572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:22:50.544779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:22:50.544841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:22:50.544860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:22:50.544874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:22:50.545323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:22:50.545519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2660 - acc: 0.6086 - val_loss: 0.2628 - val_acc: 0.5053
Epoch 2/10
 - 58s - loss: 0.2019 - acc: 0.7083 - val_loss: 0.2737 - val_acc: 0.5053
Epoch 3/10
 - 58s - loss: 0.1875 - acc: 0.7381 - val_loss: 0.2864 - val_acc: 0.5061
Epoch 4/10
 - 58s - loss: 0.1775 - acc: 0.7561 - val_loss: 0.2889 - val_acc: 0.5063

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1717 - acc: 0.7676 - val_loss: 0.2941 - val_acc: 0.5044
Epoch 6/10
 - 58s - loss: 0.1687 - acc: 0.7716 - val_loss: 0.2712 - val_acc: 0.5051
Epoch 7/10
 - 58s - loss: 0.1663 - acc: 0.7777 - val_loss: 0.2150 - val_acc: 0.6098
Epoch 8/10
 - 58s - loss: 0.1642 - acc: 0.7820 - val_loss: 0.2791 - val_acc: 0.5038
Epoch 9/10
 - 58s - loss: 0.1623 - acc: 0.7847 - val_loss: 0.1976 - val_acc: 0.6708
Epoch 10/10
 - 58s - loss: 0.1605 - acc: 0.7855 - val_loss: 0.2996 - val_acc: 0.5035
Test accuracy:0.500
current auc_score ------------------> 0.789
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:32:53.169220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:32:53.169451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:32:53.169493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:32:53.169511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:32:53.169526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:32:53.169937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:32:53.170151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2635 - acc: 0.6118 - val_loss: 0.2510 - val_acc: 0.5133
Epoch 2/10
 - 58s - loss: 0.2002 - acc: 0.7143 - val_loss: 0.2802 - val_acc: 0.5068
Epoch 3/10
 - 58s - loss: 0.1867 - acc: 0.7456 - val_loss: 0.2812 - val_acc: 0.5075
Epoch 4/10
 - 58s - loss: 0.1772 - acc: 0.7580 - val_loss: 0.2793 - val_acc: 0.5099

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1705 - acc: 0.7689 - val_loss: 0.2761 - val_acc: 0.5049
Epoch 00005: early stopping
Test accuracy:0.508
current auc_score ------------------> 0.901
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:38:06.432433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:38:06.432639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:38:06.432676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:38:06.432696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:38:06.432712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:38:06.433149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:38:06.433339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2625 - acc: 0.6094 - val_loss: 0.2514 - val_acc: 0.5131
Epoch 2/10
 - 58s - loss: 0.1994 - acc: 0.7138 - val_loss: 0.2774 - val_acc: 0.5049
Epoch 3/10
 - 58s - loss: 0.1857 - acc: 0.7429 - val_loss: 0.2810 - val_acc: 0.5109
Epoch 4/10
 - 58s - loss: 0.1761 - acc: 0.7611 - val_loss: 0.2590 - val_acc: 0.5173

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1704 - acc: 0.7705 - val_loss: 0.2570 - val_acc: 0.5237
Epoch 6/10
 - 58s - loss: 0.1676 - acc: 0.7740 - val_loss: 0.2338 - val_acc: 0.5365
Epoch 7/10
 - 58s - loss: 0.1653 - acc: 0.7764 - val_loss: 0.2397 - val_acc: 0.5207
Epoch 8/10
 - 58s - loss: 0.1631 - acc: 0.7834 - val_loss: 0.2464 - val_acc: 0.5157
Epoch 9/10
 - 58s - loss: 0.1612 - acc: 0.7840 - val_loss: 0.2299 - val_acc: 0.5419
Epoch 10/10
 - 58s - loss: 0.1590 - acc: 0.7911 - val_loss: 0.1782 - val_acc: 0.7057
Test accuracy:0.726
current auc_score ------------------> 0.914
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:48:11.528393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:48:11.528602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:48:11.528641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:48:11.528662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:48:11.528679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:48:11.529133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:48:11.529350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2616 - acc: 0.6063 - val_loss: 0.2600 - val_acc: 0.5113
Epoch 2/10
 - 58s - loss: 0.2001 - acc: 0.7098 - val_loss: 0.2801 - val_acc: 0.5055
Epoch 3/10
 - 58s - loss: 0.1861 - acc: 0.7406 - val_loss: 0.2552 - val_acc: 0.5144
Epoch 4/10
 - 58s - loss: 0.1764 - acc: 0.7611 - val_loss: 0.2376 - val_acc: 0.5439
Epoch 5/10
 - 58s - loss: 0.1693 - acc: 0.7718 - val_loss: 0.2667 - val_acc: 0.5250
Epoch 6/10
 - 58s - loss: 0.1641 - acc: 0.7809 - val_loss: 0.2912 - val_acc: 0.5154
Epoch 7/10
 - 58s - loss: 0.1587 - acc: 0.7924 - val_loss: 0.2944 - val_acc: 0.5035

Epoch 00007: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 8/10
 - 58s - loss: 0.1546 - acc: 0.7989 - val_loss: 0.2387 - val_acc: 0.5359
Epoch 00008: early stopping
Test accuracy:0.508
current auc_score ------------------> 0.897
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:56:20.378759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:56:20.379009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:56:20.379054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:56:20.379072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:56:20.379094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:56:20.379517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:56:20.379744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2674 - acc: 0.6018 - val_loss: 0.2663 - val_acc: 0.5055
Epoch 2/10
 - 58s - loss: 0.2022 - acc: 0.7081 - val_loss: 0.2953 - val_acc: 0.5040
Epoch 3/10
 - 58s - loss: 0.1874 - acc: 0.7400 - val_loss: 0.2896 - val_acc: 0.5126
Epoch 4/10
 - 58s - loss: 0.1770 - acc: 0.7563 - val_loss: 0.2824 - val_acc: 0.5262

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1705 - acc: 0.7679 - val_loss: 0.2837 - val_acc: 0.5088
Epoch 6/10
 - 58s - loss: 0.1677 - acc: 0.7709 - val_loss: 0.2670 - val_acc: 0.5080
Epoch 7/10
 - 58s - loss: 0.1657 - acc: 0.7767 - val_loss: 0.2496 - val_acc: 0.5237
Epoch 8/10
 - 58s - loss: 0.1638 - acc: 0.7800 - val_loss: 0.2618 - val_acc: 0.5080
Epoch 00008: early stopping
Test accuracy:0.507
current auc_score ------------------> 0.877
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:04:26.972924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:04:26.973129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:04:26.973161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:04:26.973181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:04:26.973196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:04:26.973587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:04:26.973758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2638 - acc: 0.6076 - val_loss: 0.2777 - val_acc: 0.5036
Epoch 2/10
 - 58s - loss: 0.2009 - acc: 0.7107 - val_loss: 0.3364 - val_acc: 0.5035
Epoch 3/10
 - 58s - loss: 0.1863 - acc: 0.7433 - val_loss: 0.3218 - val_acc: 0.5036
Epoch 4/10
 - 58s - loss: 0.1759 - acc: 0.7645 - val_loss: 0.2725 - val_acc: 0.5177
Epoch 5/10
 - 58s - loss: 0.1686 - acc: 0.7721 - val_loss: 0.2995 - val_acc: 0.5082
Epoch 6/10
 - 58s - loss: 0.1628 - acc: 0.7848 - val_loss: 0.2988 - val_acc: 0.5035
Epoch 7/10
 - 58s - loss: 0.1576 - acc: 0.7964 - val_loss: 0.2667 - val_acc: 0.5046
Epoch 8/10
 - 58s - loss: 0.1537 - acc: 0.8057 - val_loss: 0.2386 - val_acc: 0.5533
Epoch 9/10
 - 58s - loss: 0.1498 - acc: 0.8181 - val_loss: 0.1768 - val_acc: 0.7102
Epoch 10/10
 - 58s - loss: 0.1458 - acc: 0.8293 - val_loss: 0.2702 - val_acc: 0.5038
Test accuracy:0.500
current auc_score ------------------> 0.887
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:14:29.065409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:14:29.065642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:14:29.065680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:14:29.065699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:14:29.065716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:14:29.066180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:14:29.066389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2680 - acc: 0.6027 - val_loss: 0.2496 - val_acc: 0.5190
Epoch 2/10
 - 57s - loss: 0.2021 - acc: 0.7053 - val_loss: 0.3291 - val_acc: 0.5036
Epoch 3/10
 - 57s - loss: 0.1879 - acc: 0.7377 - val_loss: 0.2672 - val_acc: 0.5128
Epoch 4/10
 - 58s - loss: 0.1775 - acc: 0.7523 - val_loss: 0.3034 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1712 - acc: 0.7653 - val_loss: 0.2879 - val_acc: 0.5113
Epoch 00005: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.845
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:19:37.685595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:19:37.685808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:19:37.685848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:19:37.685867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:19:37.685882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:19:37.686315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:19:37.686566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2650 - acc: 0.6073 - val_loss: 0.2704 - val_acc: 0.5039
Epoch 2/10
 - 58s - loss: 0.2015 - acc: 0.7120 - val_loss: 0.2993 - val_acc: 0.5043
Epoch 3/10
 - 59s - loss: 0.1872 - acc: 0.7421 - val_loss: 0.3285 - val_acc: 0.5038
Epoch 4/10
 - 58s - loss: 0.1774 - acc: 0.7599 - val_loss: 0.2891 - val_acc: 0.5122

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1709 - acc: 0.7706 - val_loss: 0.2944 - val_acc: 0.5089
Epoch 6/10
 - 58s - loss: 0.1683 - acc: 0.7746 - val_loss: 0.2477 - val_acc: 0.5316
Epoch 7/10
 - 58s - loss: 0.1665 - acc: 0.7777 - val_loss: 0.2904 - val_acc: 0.5050
Epoch 8/10
 - 58s - loss: 0.1641 - acc: 0.7826 - val_loss: 0.2916 - val_acc: 0.5039
Epoch 9/10
 - 58s - loss: 0.1616 - acc: 0.7864 - val_loss: 0.2428 - val_acc: 0.5215
Epoch 10/10
 - 58s - loss: 0.1600 - acc: 0.7907 - val_loss: 0.2405 - val_acc: 0.5324
Test accuracy:0.524
current auc_score ------------------> 0.902
accuracies:  [0.514, 0.501, 0.5, 0.508, 0.726, 0.508, 0.507, 0.5, 0.501, 0.524]
aucs:  [0.861, 0.853, 0.789, 0.901, 0.914, 0.897, 0.877, 0.887, 0.845, 0.902]
mean and std AUC:  0.873+/-0.035  max:   0.914
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:29:47.856518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:29:47.856698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:29:47.856733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:29:47.856748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:29:47.856760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:29:47.857099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:29:47.857304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.3078 - acc: 0.5581 - val_loss: 0.2165 - val_acc: 0.6437
Epoch 2/12
 - 56s - loss: 0.2149 - acc: 0.6773 - val_loss: 0.2565 - val_acc: 0.5085
Epoch 3/12
 - 56s - loss: 0.2010 - acc: 0.7191 - val_loss: 0.3053 - val_acc: 0.5038
Epoch 4/12
 - 56s - loss: 0.1927 - acc: 0.7346 - val_loss: 0.2862 - val_acc: 0.5055

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1864 - acc: 0.7473 - val_loss: 0.3084 - val_acc: 0.5035
Epoch 00005: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.801
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:34:55.805381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:34:55.805590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:34:55.805628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:34:55.805659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:34:55.805677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:34:55.806102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:34:55.806286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 59s - loss: 0.3095 - acc: 0.5566 - val_loss: 0.2094 - val_acc: 0.6883
Epoch 2/12
 - 56s - loss: 0.2157 - acc: 0.6724 - val_loss: 0.2616 - val_acc: 0.5061
Epoch 3/12
 - 56s - loss: 0.2024 - acc: 0.7090 - val_loss: 0.2929 - val_acc: 0.5046
Epoch 4/12
 - 56s - loss: 0.1934 - acc: 0.7292 - val_loss: 0.2940 - val_acc: 0.5113

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1873 - acc: 0.7417 - val_loss: 0.2876 - val_acc: 0.5113
Epoch 00005: early stopping
Test accuracy:0.512
current auc_score ------------------> 0.854
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:39:57.933213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:39:57.933446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:39:57.933489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:39:57.933509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:39:57.933525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:39:57.933945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:39:57.934184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3102 - acc: 0.5531 - val_loss: 0.2067 - val_acc: 0.7071
Epoch 2/12
 - 56s - loss: 0.2160 - acc: 0.6717 - val_loss: 0.2581 - val_acc: 0.5072
Epoch 3/12
 - 56s - loss: 0.2024 - acc: 0.7120 - val_loss: 0.2813 - val_acc: 0.5055
Epoch 4/12
 - 56s - loss: 0.1925 - acc: 0.7347 - val_loss: 0.3064 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1865 - acc: 0.7423 - val_loss: 0.3112 - val_acc: 0.5044
Epoch 00005: early stopping
Test accuracy:0.504
current auc_score ------------------> 0.844
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:45:00.423342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:45:00.423555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:45:00.423592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:45:00.423609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:45:00.423623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:45:00.424059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:45:00.424263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3042 - acc: 0.5589 - val_loss: 0.2169 - val_acc: 0.6441
Epoch 2/12
 - 56s - loss: 0.2140 - acc: 0.6752 - val_loss: 0.2706 - val_acc: 0.5064
Epoch 3/12
 - 56s - loss: 0.2005 - acc: 0.7115 - val_loss: 0.3078 - val_acc: 0.5049
Epoch 4/12
 - 56s - loss: 0.1914 - acc: 0.7368 - val_loss: 0.3047 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1864 - acc: 0.7426 - val_loss: 0.3086 - val_acc: 0.5048
Epoch 00005: early stopping
Test accuracy:0.505
current auc_score ------------------> 0.828
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:50:01.729623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:50:01.729844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:50:01.729878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:50:01.729900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:50:01.729915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:50:01.730367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:50:01.730573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 59s - loss: 0.3088 - acc: 0.5556 - val_loss: 0.2109 - val_acc: 0.6699
Epoch 2/12
 - 56s - loss: 0.2158 - acc: 0.6706 - val_loss: 0.2594 - val_acc: 0.5107
Epoch 3/12
 - 56s - loss: 0.2017 - acc: 0.7105 - val_loss: 0.2864 - val_acc: 0.5048
Epoch 4/12
 - 56s - loss: 0.1924 - acc: 0.7304 - val_loss: 0.3006 - val_acc: 0.5044

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1868 - acc: 0.7426 - val_loss: 0.2974 - val_acc: 0.5043
Epoch 00005: early stopping
Test accuracy:0.511
current auc_score ------------------> 0.832
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:55:03.467268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:55:03.467462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:55:03.467482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:55:03.467496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:55:03.467524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:55:03.467925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:55:03.468138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3062 - acc: 0.5610 - val_loss: 0.2206 - val_acc: 0.6305
Epoch 2/12
 - 56s - loss: 0.2156 - acc: 0.6684 - val_loss: 0.2599 - val_acc: 0.5093
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7044 - val_loss: 0.2962 - val_acc: 0.5045
Epoch 4/12
 - 56s - loss: 0.1934 - acc: 0.7282 - val_loss: 0.2957 - val_acc: 0.5056

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1873 - acc: 0.7409 - val_loss: 0.3070 - val_acc: 0.5050
Epoch 00005: early stopping
Test accuracy:0.507
current auc_score ------------------> 0.856
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:00:06.861985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:00:06.862219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:00:06.862263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:00:06.862285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:00:06.862302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:00:06.862712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:00:06.862936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3096 - acc: 0.5557 - val_loss: 0.2098 - val_acc: 0.6773
Epoch 2/12
 - 56s - loss: 0.2140 - acc: 0.6746 - val_loss: 0.2498 - val_acc: 0.5097
Epoch 3/12
 - 56s - loss: 0.2012 - acc: 0.7129 - val_loss: 0.3080 - val_acc: 0.5039
Epoch 4/12
 - 56s - loss: 0.1925 - acc: 0.7343 - val_loss: 0.3006 - val_acc: 0.5039

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1871 - acc: 0.7447 - val_loss: 0.3149 - val_acc: 0.5036
Epoch 00005: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.798
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:05:07.522023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:05:07.522180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:05:07.522203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:05:07.522217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:05:07.522229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:05:07.522555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:05:07.522691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 58s - loss: 0.3081 - acc: 0.5588 - val_loss: 0.2066 - val_acc: 0.6969
Epoch 2/12
 - 56s - loss: 0.2144 - acc: 0.6742 - val_loss: 0.2393 - val_acc: 0.5261
Epoch 3/12
 - 56s - loss: 0.2009 - acc: 0.7148 - val_loss: 0.2955 - val_acc: 0.5043
Epoch 4/12
 - 56s - loss: 0.1923 - acc: 0.7341 - val_loss: 0.2794 - val_acc: 0.5110

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1872 - acc: 0.7426 - val_loss: 0.2800 - val_acc: 0.5120
Epoch 00005: early stopping
Test accuracy:0.530
current auc_score ------------------> 0.856
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:10:06.790699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:10:06.790948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:10:06.791000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:10:06.791023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:10:06.791041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:10:06.791483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:10:06.791689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3117 - acc: 0.5519 - val_loss: 0.2192 - val_acc: 0.6409
Epoch 2/12
 - 56s - loss: 0.2166 - acc: 0.6649 - val_loss: 0.2659 - val_acc: 0.5063
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7090 - val_loss: 0.3195 - val_acc: 0.5035
Epoch 4/12
 - 56s - loss: 0.1933 - acc: 0.7309 - val_loss: 0.3245 - val_acc: 0.5036

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1884 - acc: 0.7421 - val_loss: 0.3363 - val_acc: 0.5035
Epoch 00005: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.734
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:15:10.055956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:15:10.056198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:15:10.056241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:15:10.056262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:15:10.056278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:15:10.056750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:15:10.056953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3100 - acc: 0.5558 - val_loss: 0.2156 - val_acc: 0.6525
Epoch 2/12
 - 56s - loss: 0.2162 - acc: 0.6681 - val_loss: 0.2919 - val_acc: 0.5044
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7109 - val_loss: 0.3045 - val_acc: 0.5041
Epoch 4/12
 - 56s - loss: 0.1931 - acc: 0.7292 - val_loss: 0.3043 - val_acc: 0.5053

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1872 - acc: 0.7422 - val_loss: 0.3076 - val_acc: 0.5048
Epoch 00005: early stopping
Test accuracy:0.503
current auc_score ------------------> 0.816
accuracies:  [0.5, 0.512, 0.504, 0.505, 0.511, 0.507, 0.501, 0.53, 0.5, 0.503]
aucs:  [0.801, 0.854, 0.844, 0.828, 0.832, 0.856, 0.798, 0.856, 0.734, 0.816]
mean and std AUC:  0.822+/-0.036  max:   0.856
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '32', 'adam', '0.00001', '4', 'contrastive'], '0.901+/-0.015', 0.931)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '128', 'adam', '0.00001', '6', 'contrastive'], '0.909+/-0.019', 0.935)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '256', 'adam', '0.00001', '10', 'contrastive'], '0.873+/-0.035', 0.914)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '512', 'adam', '0.00001', '12', 'contrastive'], '0.822+/-0.036', 0.856)(anime) [amalli2s@wr14 contrastive_loss]$ python custom_gridsearch_contrastive_loss_vgg_bn1.py
Using TensorFlow backend.
Column names are conv2d_filters, kernel_sizes, initialization, layers, dense_filter1, dense_filter2, dense_filter3, dropout1, dropout2, dropout3, use_bn, batch_size, optimizer, lr, epochs, loss
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
2018-12-03 03:56:10.733954: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-12-03 03:56:11.017644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-12-03 03:56:11.218252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.92GiB freeMemory: 11.85GiB
2018-12-03 03:56:11.220933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 03:56:12.854987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 03:56:12.855091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 03:56:12.855116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 03:56:12.855134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 03:56:12.855857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 03:56:13.017980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
 - 101s - loss: 0.2096 - acc: 0.6914 - val_loss: 0.1692 - val_acc: 0.7840
Epoch 2/4
 - 96s - loss: 0.1734 - acc: 0.7603 - val_loss: 0.1488 - val_acc: 0.8291
Epoch 3/4
 - 96s - loss: 0.1599 - acc: 0.7859 - val_loss: 0.1690 - val_acc: 0.7812
Epoch 4/4
 - 97s - loss: 0.1500 - acc: 0.8117 - val_loss: 0.1365 - val_acc: 0.8523
Test accuracy:0.821
current auc_score ------------------> 0.902
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:03:07.106182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:03:07.106408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:03:07.106444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:03:07.106464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:03:07.106482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:03:07.106977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:03:07.107234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2101 - acc: 0.6924 - val_loss: 0.1912 - val_acc: 0.7154
Epoch 2/4
 - 97s - loss: 0.1720 - acc: 0.7673 - val_loss: 0.1565 - val_acc: 0.8035
Epoch 3/4
 - 97s - loss: 0.1588 - acc: 0.7919 - val_loss: 0.1670 - val_acc: 0.7703
Epoch 4/4
 - 97s - loss: 0.1495 - acc: 0.8182 - val_loss: 0.1376 - val_acc: 0.8612
Test accuracy:0.799
current auc_score ------------------> 0.893
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:09:58.435711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:09:58.435947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:09:58.436001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:09:58.436023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:09:58.436038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:09:58.436531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:09:58.436792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2087 - acc: 0.6948 - val_loss: 0.1898 - val_acc: 0.7321
Epoch 2/4
 - 97s - loss: 0.1728 - acc: 0.7616 - val_loss: 0.1640 - val_acc: 0.7971
Epoch 3/4
 - 97s - loss: 0.1574 - acc: 0.7917 - val_loss: 0.1560 - val_acc: 0.7888
Epoch 4/4
 - 97s - loss: 0.1479 - acc: 0.8165 - val_loss: 0.1312 - val_acc: 0.8576
Test accuracy:0.815
current auc_score ------------------> 0.902
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:16:44.458335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:16:44.458460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:16:44.458483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:16:44.458498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:16:44.458513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:16:44.458802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:16:44.458933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 100s - loss: 0.2085 - acc: 0.6966 - val_loss: 0.1973 - val_acc: 0.6916
Epoch 2/4
 - 97s - loss: 0.1739 - acc: 0.7590 - val_loss: 0.1541 - val_acc: 0.8048
Epoch 3/4
 - 96s - loss: 0.1616 - acc: 0.7818 - val_loss: 0.1411 - val_acc: 0.8466
Epoch 4/4
 - 97s - loss: 0.1516 - acc: 0.8077 - val_loss: 0.1505 - val_acc: 0.8076
Test accuracy:0.655
current auc_score ------------------> 0.875
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:23:33.026145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:23:33.026384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:23:33.026434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:23:33.026463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:23:33.026480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:23:33.026964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:23:33.027188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 102s - loss: 0.2074 - acc: 0.7011 - val_loss: 0.1848 - val_acc: 0.7280
Epoch 2/4
 - 97s - loss: 0.1717 - acc: 0.7653 - val_loss: 0.1601 - val_acc: 0.7844
Epoch 3/4
 - 97s - loss: 0.1578 - acc: 0.7923 - val_loss: 0.1518 - val_acc: 0.8028
Epoch 4/4
 - 98s - loss: 0.1482 - acc: 0.8181 - val_loss: 0.1484 - val_acc: 0.8099
Test accuracy:0.638
current auc_score ------------------> 0.881
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:30:25.699707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:30:25.699935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:30:25.699980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:30:25.700012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:30:25.700030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:30:25.700538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:30:25.700780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2078 - acc: 0.6979 - val_loss: 0.2190 - val_acc: 0.5866
Epoch 2/4
 - 97s - loss: 0.1713 - acc: 0.7646 - val_loss: 0.1698 - val_acc: 0.7600
Epoch 3/4
 - 97s - loss: 0.1577 - acc: 0.7895 - val_loss: 0.1529 - val_acc: 0.8107
Epoch 4/4
 - 97s - loss: 0.1499 - acc: 0.8109 - val_loss: 0.1306 - val_acc: 0.8642
Test accuracy:0.771
current auc_score ------------------> 0.899
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:37:17.638817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:37:17.639077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:37:17.639112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:37:17.639135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:37:17.639154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:37:17.639632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:37:17.639866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2072 - acc: 0.7002 - val_loss: 0.2114 - val_acc: 0.6205
Epoch 2/4
 - 97s - loss: 0.1734 - acc: 0.7595 - val_loss: 0.1561 - val_acc: 0.8074
Epoch 3/4
 - 96s - loss: 0.1610 - acc: 0.7836 - val_loss: 0.2270 - val_acc: 0.5344
Epoch 4/4
 - 96s - loss: 0.1500 - acc: 0.8107 - val_loss: 0.1266 - val_acc: 0.8813
Test accuracy:0.845
current auc_score ------------------> 0.931
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:44:05.847110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:44:05.847334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:44:05.847488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:44:05.847535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:44:05.847547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:44:05.847986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:44:05.848187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2092 - acc: 0.6936 - val_loss: 0.1675 - val_acc: 0.7939
Epoch 2/4
 - 96s - loss: 0.1742 - acc: 0.7573 - val_loss: 0.1819 - val_acc: 0.7401
Epoch 3/4
 - 95s - loss: 0.1615 - acc: 0.7801 - val_loss: 0.1440 - val_acc: 0.8128
Epoch 4/4
 - 96s - loss: 0.1515 - acc: 0.8003 - val_loss: 0.1674 - val_acc: 0.7523
Test accuracy:0.796
current auc_score ------------------> 0.905
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:50:52.636278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:50:52.636528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:50:52.636572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:50:52.636591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:50:52.636606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:50:52.637029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:50:52.637233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 101s - loss: 0.2083 - acc: 0.6941 - val_loss: 0.1990 - val_acc: 0.6930
Epoch 2/4
 - 96s - loss: 0.1734 - acc: 0.7567 - val_loss: 0.2167 - val_acc: 0.5723
Epoch 3/4
 - 96s - loss: 0.1609 - acc: 0.7806 - val_loss: 0.1493 - val_acc: 0.8337
Epoch 4/4
 - 96s - loss: 0.1516 - acc: 0.8049 - val_loss: 0.1411 - val_acc: 0.8385
Test accuracy:0.777
current auc_score ------------------> 0.912
batch_size:  32  opt:  adam  lr:  1e-05  epochs:  4  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/4
2018-12-03 04:57:40.985841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 04:57:40.986090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 04:57:40.986135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 04:57:40.986166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 04:57:40.986183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 04:57:40.986634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 04:57:40.986854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 100s - loss: 0.2090 - acc: 0.6969 - val_loss: 0.1918 - val_acc: 0.6954
Epoch 2/4
 - 96s - loss: 0.1738 - acc: 0.7577 - val_loss: 0.1802 - val_acc: 0.7327
Epoch 3/4
 - 96s - loss: 0.1614 - acc: 0.7832 - val_loss: 0.1503 - val_acc: 0.8282
Epoch 4/4
 - 96s - loss: 0.1512 - acc: 0.8075 - val_loss: 0.1296 - val_acc: 0.8583
Test accuracy:0.834
current auc_score ------------------> 0.913
accuracies:  [0.821, 0.799, 0.815, 0.655, 0.638, 0.771, 0.845, 0.796, 0.777, 0.834]
aucs:  [0.902, 0.893, 0.902, 0.875, 0.881, 0.899, 0.931, 0.905, 0.912, 0.913]
mean and std AUC:  0.901+/-0.015  max:   0.931
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:04:31.400838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:04:31.401079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:04:31.401146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:04:31.401168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:04:31.401182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:04:31.401647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:04:31.401874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 68s - loss: 0.2413 - acc: 0.6416 - val_loss: 0.2816 - val_acc: 0.5036
Epoch 2/6
 - 62s - loss: 0.1882 - acc: 0.7377 - val_loss: 0.2834 - val_acc: 0.5068
Epoch 3/6
 - 62s - loss: 0.1747 - acc: 0.7607 - val_loss: 0.2623 - val_acc: 0.5243
Epoch 4/6
 - 62s - loss: 0.1645 - acc: 0.7758 - val_loss: 0.2836 - val_acc: 0.5050
Epoch 5/6
 - 62s - loss: 0.1576 - acc: 0.7948 - val_loss: 0.1881 - val_acc: 0.6795
Epoch 6/6
 - 62s - loss: 0.1521 - acc: 0.8068 - val_loss: 0.2004 - val_acc: 0.6189
Test accuracy:0.738
current auc_score ------------------> 0.918
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:11:09.761563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:11:09.761815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:11:09.761847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:11:09.761876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:11:09.761892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:11:09.762349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:11:09.762578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2357 - acc: 0.6554 - val_loss: 0.2770 - val_acc: 0.5059
Epoch 2/6
 - 62s - loss: 0.1874 - acc: 0.7405 - val_loss: 0.2495 - val_acc: 0.5344
Epoch 3/6
 - 62s - loss: 0.1731 - acc: 0.7607 - val_loss: 0.2415 - val_acc: 0.5384
Epoch 4/6
 - 63s - loss: 0.1640 - acc: 0.7774 - val_loss: 0.1981 - val_acc: 0.6540
Epoch 5/6
 - 62s - loss: 0.1568 - acc: 0.7942 - val_loss: 0.1482 - val_acc: 0.8061
Epoch 6/6
 - 62s - loss: 0.1508 - acc: 0.8072 - val_loss: 0.2079 - val_acc: 0.5983
Test accuracy:0.652
current auc_score ------------------> 0.934
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:17:46.787497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:17:46.787710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:17:46.787748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:17:46.787769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:17:46.787786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:17:46.788244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:17:46.788444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2382 - acc: 0.6464 - val_loss: 0.2339 - val_acc: 0.5383
Epoch 2/6
 - 62s - loss: 0.1886 - acc: 0.7357 - val_loss: 0.2734 - val_acc: 0.5065
Epoch 3/6
 - 62s - loss: 0.1733 - acc: 0.7624 - val_loss: 0.2036 - val_acc: 0.6598
Epoch 4/6
 - 62s - loss: 0.1646 - acc: 0.7790 - val_loss: 0.1883 - val_acc: 0.6915
Epoch 5/6
 - 62s - loss: 0.1574 - acc: 0.7943 - val_loss: 0.2135 - val_acc: 0.5766
Epoch 6/6
 - 62s - loss: 0.1508 - acc: 0.8118 - val_loss: 0.1668 - val_acc: 0.7538
Test accuracy:0.784
current auc_score ------------------> 0.935
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:24:19.880378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:24:19.880614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:24:19.880658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:24:19.880677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:24:19.880691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:24:19.881084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:24:19.881289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2370 - acc: 0.6474 - val_loss: 0.3126 - val_acc: 0.5036
Epoch 2/6
 - 61s - loss: 0.1876 - acc: 0.7393 - val_loss: 0.2681 - val_acc: 0.5197
Epoch 3/6
 - 61s - loss: 0.1727 - acc: 0.7659 - val_loss: 0.2023 - val_acc: 0.6600
Epoch 4/6
 - 60s - loss: 0.1630 - acc: 0.7803 - val_loss: 0.2968 - val_acc: 0.5035
Epoch 5/6
 - 61s - loss: 0.1557 - acc: 0.7953 - val_loss: 0.1923 - val_acc: 0.6677
Epoch 6/6
 - 62s - loss: 0.1503 - acc: 0.8142 - val_loss: 0.1616 - val_acc: 0.7558
Test accuracy:0.744
current auc_score ------------------> 0.898
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:30:50.438092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:30:50.438330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:30:50.438372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:30:50.438411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:30:50.438431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:30:50.438888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:30:50.439112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2376 - acc: 0.6517 - val_loss: 0.2816 - val_acc: 0.5059
Epoch 2/6
 - 62s - loss: 0.1870 - acc: 0.7386 - val_loss: 0.2396 - val_acc: 0.5264
Epoch 3/6
 - 62s - loss: 0.1730 - acc: 0.7629 - val_loss: 0.2367 - val_acc: 0.5192
Epoch 4/6
 - 63s - loss: 0.1638 - acc: 0.7757 - val_loss: 0.2204 - val_acc: 0.5655
Epoch 5/6
 - 62s - loss: 0.1565 - acc: 0.7903 - val_loss: 0.2800 - val_acc: 0.5050
Epoch 6/6
 - 62s - loss: 0.1501 - acc: 0.8091 - val_loss: 0.1843 - val_acc: 0.6846
Test accuracy:0.750
current auc_score ------------------> 0.885
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:37:26.916968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:37:26.917199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:37:26.917242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:37:26.917265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:37:26.917284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:37:26.917697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:37:26.917891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2384 - acc: 0.6430 - val_loss: 0.2725 - val_acc: 0.5045
Epoch 2/6
 - 62s - loss: 0.1882 - acc: 0.7351 - val_loss: 0.2660 - val_acc: 0.5190
Epoch 3/6
 - 62s - loss: 0.1730 - acc: 0.7621 - val_loss: 0.2659 - val_acc: 0.5323
Epoch 4/6
 - 62s - loss: 0.1636 - acc: 0.7790 - val_loss: 0.1850 - val_acc: 0.7043
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7938 - val_loss: 0.1915 - val_acc: 0.6605
Epoch 6/6
 - 62s - loss: 0.1495 - acc: 0.8133 - val_loss: 0.1595 - val_acc: 0.7614
Test accuracy:0.815
current auc_score ------------------> 0.918
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:44:02.568052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:44:02.568281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:44:02.568324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:44:02.568469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:44:02.568498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:44:02.569018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:44:02.569231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 66s - loss: 0.2391 - acc: 0.6454 - val_loss: 0.3003 - val_acc: 0.5036
Epoch 2/6
 - 62s - loss: 0.1886 - acc: 0.7357 - val_loss: 0.2666 - val_acc: 0.5046
Epoch 3/6
 - 63s - loss: 0.1744 - acc: 0.7581 - val_loss: 0.2274 - val_acc: 0.5439
Epoch 4/6
 - 62s - loss: 0.1644 - acc: 0.7759 - val_loss: 0.2611 - val_acc: 0.5251
Epoch 5/6
 - 62s - loss: 0.1571 - acc: 0.7902 - val_loss: 0.1979 - val_acc: 0.6798
Epoch 6/6
 - 63s - loss: 0.1510 - acc: 0.8074 - val_loss: 0.2191 - val_acc: 0.6130
Test accuracy:0.647
current auc_score ------------------> 0.888
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:50:38.032098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:50:38.032270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:50:38.032297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:50:38.032313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:50:38.032334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:50:38.032698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:50:38.032856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2377 - acc: 0.6467 - val_loss: 0.3021 - val_acc: 0.5038
Epoch 2/6
 - 62s - loss: 0.1861 - acc: 0.7426 - val_loss: 0.2546 - val_acc: 0.5136
Epoch 3/6
 - 62s - loss: 0.1729 - acc: 0.7661 - val_loss: 0.2156 - val_acc: 0.5858
Epoch 4/6
 - 62s - loss: 0.1635 - acc: 0.7807 - val_loss: 0.2392 - val_acc: 0.5297
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7965 - val_loss: 0.1931 - val_acc: 0.6747
Epoch 6/6
 - 62s - loss: 0.1497 - acc: 0.8159 - val_loss: 0.1420 - val_acc: 0.8017
Test accuracy:0.806
current auc_score ------------------> 0.892
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 05:57:10.507211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 05:57:10.507436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 05:57:10.507467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 05:57:10.507489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 05:57:10.507505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 05:57:10.507924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 05:57:10.508139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2355 - acc: 0.6529 - val_loss: 0.2436 - val_acc: 0.5261
Epoch 2/6
 - 62s - loss: 0.1868 - acc: 0.7396 - val_loss: 0.2397 - val_acc: 0.5591
Epoch 3/6
 - 62s - loss: 0.1724 - acc: 0.7679 - val_loss: 0.2211 - val_acc: 0.5625
Epoch 4/6
 - 62s - loss: 0.1637 - acc: 0.7811 - val_loss: 0.1853 - val_acc: 0.7201
Epoch 5/6
 - 62s - loss: 0.1570 - acc: 0.7944 - val_loss: 0.1658 - val_acc: 0.7622
Epoch 6/6
 - 62s - loss: 0.1494 - acc: 0.8144 - val_loss: 0.1362 - val_acc: 0.8469
Test accuracy:0.848
current auc_score ------------------> 0.927
batch_size:  128  opt:  adam  lr:  1e-05  epochs:  6  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/6
2018-12-03 06:03:47.151620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:03:47.151845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:03:47.151886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:03:47.151907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:03:47.151924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:03:47.152372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:03:47.152642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 67s - loss: 0.2363 - acc: 0.6509 - val_loss: 0.2773 - val_acc: 0.5045
Epoch 2/6
 - 62s - loss: 0.1880 - acc: 0.7367 - val_loss: 0.2683 - val_acc: 0.5065
Epoch 3/6
 - 62s - loss: 0.1738 - acc: 0.7612 - val_loss: 0.1777 - val_acc: 0.7371
Epoch 4/6
 - 62s - loss: 0.1643 - acc: 0.7771 - val_loss: 0.2267 - val_acc: 0.5472
Epoch 5/6
 - 62s - loss: 0.1562 - acc: 0.7948 - val_loss: 0.2084 - val_acc: 0.6254
Epoch 6/6
 - 62s - loss: 0.1502 - acc: 0.8113 - val_loss: 0.2033 - val_acc: 0.6143

Epoch 00006: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Test accuracy:0.626
current auc_score ------------------> 0.894
accuracies:  [0.738, 0.652, 0.784, 0.744, 0.75, 0.815, 0.647, 0.806, 0.848, 0.626]
aucs:  [0.918, 0.934, 0.935, 0.898, 0.885, 0.918, 0.888, 0.892, 0.927, 0.894]
mean and std AUC:  0.909+/-0.019  max:   0.935
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:10:27.093272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:10:27.093507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:10:27.093557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:10:27.093579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:10:27.093596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:10:27.094063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:10:27.094298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.2625 - acc: 0.6110 - val_loss: 0.2322 - val_acc: 0.5434
Epoch 2/10
 - 58s - loss: 0.1999 - acc: 0.7129 - val_loss: 0.2831 - val_acc: 0.5051
Epoch 3/10
 - 58s - loss: 0.1862 - acc: 0.7413 - val_loss: 0.2920 - val_acc: 0.5068
Epoch 4/10
 - 58s - loss: 0.1764 - acc: 0.7579 - val_loss: 0.2571 - val_acc: 0.5275

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1701 - acc: 0.7695 - val_loss: 0.2668 - val_acc: 0.5296
Epoch 00005: early stopping
Test accuracy:0.514
current auc_score ------------------> 0.861
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:15:40.483335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:15:40.483472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:15:40.483495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:15:40.483509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:15:40.483520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:15:40.483834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:15:40.483969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2646 - acc: 0.6076 - val_loss: 0.2561 - val_acc: 0.5098
Epoch 2/10
 - 58s - loss: 0.2012 - acc: 0.7134 - val_loss: 0.2708 - val_acc: 0.5074
Epoch 3/10
 - 58s - loss: 0.1876 - acc: 0.7388 - val_loss: 0.2900 - val_acc: 0.5127
Epoch 4/10
 - 58s - loss: 0.1770 - acc: 0.7564 - val_loss: 0.2951 - val_acc: 0.5097

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1710 - acc: 0.7669 - val_loss: 0.2820 - val_acc: 0.5051
Epoch 6/10
 - 58s - loss: 0.1687 - acc: 0.7697 - val_loss: 0.2779 - val_acc: 0.5068
Epoch 7/10
 - 59s - loss: 0.1666 - acc: 0.7735 - val_loss: 0.2687 - val_acc: 0.5093

Epoch 00007: ReduceLROnPlateau reducing learning rate to 9.99999983430526e-07.
Epoch 00007: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.853
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:22:50.544572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:22:50.544779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:22:50.544841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:22:50.544860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:22:50.544874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:22:50.545323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:22:50.545519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2660 - acc: 0.6086 - val_loss: 0.2628 - val_acc: 0.5053
Epoch 2/10
 - 58s - loss: 0.2019 - acc: 0.7083 - val_loss: 0.2737 - val_acc: 0.5053
Epoch 3/10
 - 58s - loss: 0.1875 - acc: 0.7381 - val_loss: 0.2864 - val_acc: 0.5061
Epoch 4/10
 - 58s - loss: 0.1775 - acc: 0.7561 - val_loss: 0.2889 - val_acc: 0.5063

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1717 - acc: 0.7676 - val_loss: 0.2941 - val_acc: 0.5044
Epoch 6/10
 - 58s - loss: 0.1687 - acc: 0.7716 - val_loss: 0.2712 - val_acc: 0.5051
Epoch 7/10
 - 58s - loss: 0.1663 - acc: 0.7777 - val_loss: 0.2150 - val_acc: 0.6098
Epoch 8/10
 - 58s - loss: 0.1642 - acc: 0.7820 - val_loss: 0.2791 - val_acc: 0.5038
Epoch 9/10
 - 58s - loss: 0.1623 - acc: 0.7847 - val_loss: 0.1976 - val_acc: 0.6708
Epoch 10/10
 - 58s - loss: 0.1605 - acc: 0.7855 - val_loss: 0.2996 - val_acc: 0.5035
Test accuracy:0.500
current auc_score ------------------> 0.789
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:32:53.169220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:32:53.169451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:32:53.169493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:32:53.169511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:32:53.169526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:32:53.169937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:32:53.170151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2635 - acc: 0.6118 - val_loss: 0.2510 - val_acc: 0.5133
Epoch 2/10
 - 58s - loss: 0.2002 - acc: 0.7143 - val_loss: 0.2802 - val_acc: 0.5068
Epoch 3/10
 - 58s - loss: 0.1867 - acc: 0.7456 - val_loss: 0.2812 - val_acc: 0.5075
Epoch 4/10
 - 58s - loss: 0.1772 - acc: 0.7580 - val_loss: 0.2793 - val_acc: 0.5099

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1705 - acc: 0.7689 - val_loss: 0.2761 - val_acc: 0.5049
Epoch 00005: early stopping
Test accuracy:0.508
current auc_score ------------------> 0.901
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:38:06.432433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:38:06.432639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:38:06.432676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:38:06.432696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:38:06.432712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:38:06.433149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:38:06.433339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2625 - acc: 0.6094 - val_loss: 0.2514 - val_acc: 0.5131
Epoch 2/10
 - 58s - loss: 0.1994 - acc: 0.7138 - val_loss: 0.2774 - val_acc: 0.5049
Epoch 3/10
 - 58s - loss: 0.1857 - acc: 0.7429 - val_loss: 0.2810 - val_acc: 0.5109
Epoch 4/10
 - 58s - loss: 0.1761 - acc: 0.7611 - val_loss: 0.2590 - val_acc: 0.5173

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1704 - acc: 0.7705 - val_loss: 0.2570 - val_acc: 0.5237
Epoch 6/10
 - 58s - loss: 0.1676 - acc: 0.7740 - val_loss: 0.2338 - val_acc: 0.5365
Epoch 7/10
 - 58s - loss: 0.1653 - acc: 0.7764 - val_loss: 0.2397 - val_acc: 0.5207
Epoch 8/10
 - 58s - loss: 0.1631 - acc: 0.7834 - val_loss: 0.2464 - val_acc: 0.5157
Epoch 9/10
 - 58s - loss: 0.1612 - acc: 0.7840 - val_loss: 0.2299 - val_acc: 0.5419
Epoch 10/10
 - 58s - loss: 0.1590 - acc: 0.7911 - val_loss: 0.1782 - val_acc: 0.7057
Test accuracy:0.726
current auc_score ------------------> 0.914
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:48:11.528393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:48:11.528602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:48:11.528641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:48:11.528662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:48:11.528679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:48:11.529133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:48:11.529350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2616 - acc: 0.6063 - val_loss: 0.2600 - val_acc: 0.5113
Epoch 2/10
 - 58s - loss: 0.2001 - acc: 0.7098 - val_loss: 0.2801 - val_acc: 0.5055
Epoch 3/10
 - 58s - loss: 0.1861 - acc: 0.7406 - val_loss: 0.2552 - val_acc: 0.5144
Epoch 4/10
 - 58s - loss: 0.1764 - acc: 0.7611 - val_loss: 0.2376 - val_acc: 0.5439
Epoch 5/10
 - 58s - loss: 0.1693 - acc: 0.7718 - val_loss: 0.2667 - val_acc: 0.5250
Epoch 6/10
 - 58s - loss: 0.1641 - acc: 0.7809 - val_loss: 0.2912 - val_acc: 0.5154
Epoch 7/10
 - 58s - loss: 0.1587 - acc: 0.7924 - val_loss: 0.2944 - val_acc: 0.5035

Epoch 00007: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 8/10
 - 58s - loss: 0.1546 - acc: 0.7989 - val_loss: 0.2387 - val_acc: 0.5359
Epoch 00008: early stopping
Test accuracy:0.508
current auc_score ------------------> 0.897
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 06:56:20.378759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 06:56:20.379009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 06:56:20.379054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 06:56:20.379072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 06:56:20.379094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 06:56:20.379517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 06:56:20.379744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2674 - acc: 0.6018 - val_loss: 0.2663 - val_acc: 0.5055
Epoch 2/10
 - 58s - loss: 0.2022 - acc: 0.7081 - val_loss: 0.2953 - val_acc: 0.5040
Epoch 3/10
 - 58s - loss: 0.1874 - acc: 0.7400 - val_loss: 0.2896 - val_acc: 0.5126
Epoch 4/10
 - 58s - loss: 0.1770 - acc: 0.7563 - val_loss: 0.2824 - val_acc: 0.5262

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1705 - acc: 0.7679 - val_loss: 0.2837 - val_acc: 0.5088
Epoch 6/10
 - 58s - loss: 0.1677 - acc: 0.7709 - val_loss: 0.2670 - val_acc: 0.5080
Epoch 7/10
 - 58s - loss: 0.1657 - acc: 0.7767 - val_loss: 0.2496 - val_acc: 0.5237
Epoch 8/10
 - 58s - loss: 0.1638 - acc: 0.7800 - val_loss: 0.2618 - val_acc: 0.5080
Epoch 00008: early stopping
Test accuracy:0.507
current auc_score ------------------> 0.877
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:04:26.972924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:04:26.973129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:04:26.973161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:04:26.973181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:04:26.973196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:04:26.973587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:04:26.973758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2638 - acc: 0.6076 - val_loss: 0.2777 - val_acc: 0.5036
Epoch 2/10
 - 58s - loss: 0.2009 - acc: 0.7107 - val_loss: 0.3364 - val_acc: 0.5035
Epoch 3/10
 - 58s - loss: 0.1863 - acc: 0.7433 - val_loss: 0.3218 - val_acc: 0.5036
Epoch 4/10
 - 58s - loss: 0.1759 - acc: 0.7645 - val_loss: 0.2725 - val_acc: 0.5177
Epoch 5/10
 - 58s - loss: 0.1686 - acc: 0.7721 - val_loss: 0.2995 - val_acc: 0.5082
Epoch 6/10
 - 58s - loss: 0.1628 - acc: 0.7848 - val_loss: 0.2988 - val_acc: 0.5035
Epoch 7/10
 - 58s - loss: 0.1576 - acc: 0.7964 - val_loss: 0.2667 - val_acc: 0.5046
Epoch 8/10
 - 58s - loss: 0.1537 - acc: 0.8057 - val_loss: 0.2386 - val_acc: 0.5533
Epoch 9/10
 - 58s - loss: 0.1498 - acc: 0.8181 - val_loss: 0.1768 - val_acc: 0.7102
Epoch 10/10
 - 58s - loss: 0.1458 - acc: 0.8293 - val_loss: 0.2702 - val_acc: 0.5038
Test accuracy:0.500
current auc_score ------------------> 0.887
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:14:29.065409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:14:29.065642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:14:29.065680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:14:29.065699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:14:29.065716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:14:29.066180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:14:29.066389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 61s - loss: 0.2680 - acc: 0.6027 - val_loss: 0.2496 - val_acc: 0.5190
Epoch 2/10
 - 57s - loss: 0.2021 - acc: 0.7053 - val_loss: 0.3291 - val_acc: 0.5036
Epoch 3/10
 - 57s - loss: 0.1879 - acc: 0.7377 - val_loss: 0.2672 - val_acc: 0.5128
Epoch 4/10
 - 58s - loss: 0.1775 - acc: 0.7523 - val_loss: 0.3034 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1712 - acc: 0.7653 - val_loss: 0.2879 - val_acc: 0.5113
Epoch 00005: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.845
batch_size:  256  opt:  adam  lr:  1e-05  epochs:  10  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/10
2018-12-03 07:19:37.685595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:19:37.685808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:19:37.685848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:19:37.685867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:19:37.685882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:19:37.686315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:19:37.686566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 62s - loss: 0.2650 - acc: 0.6073 - val_loss: 0.2704 - val_acc: 0.5039
Epoch 2/10
 - 58s - loss: 0.2015 - acc: 0.7120 - val_loss: 0.2993 - val_acc: 0.5043
Epoch 3/10
 - 59s - loss: 0.1872 - acc: 0.7421 - val_loss: 0.3285 - val_acc: 0.5038
Epoch 4/10
 - 58s - loss: 0.1774 - acc: 0.7599 - val_loss: 0.2891 - val_acc: 0.5122

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/10
 - 58s - loss: 0.1709 - acc: 0.7706 - val_loss: 0.2944 - val_acc: 0.5089
Epoch 6/10
 - 58s - loss: 0.1683 - acc: 0.7746 - val_loss: 0.2477 - val_acc: 0.5316
Epoch 7/10
 - 58s - loss: 0.1665 - acc: 0.7777 - val_loss: 0.2904 - val_acc: 0.5050
Epoch 8/10
 - 58s - loss: 0.1641 - acc: 0.7826 - val_loss: 0.2916 - val_acc: 0.5039
Epoch 9/10
 - 58s - loss: 0.1616 - acc: 0.7864 - val_loss: 0.2428 - val_acc: 0.5215
Epoch 10/10
 - 58s - loss: 0.1600 - acc: 0.7907 - val_loss: 0.2405 - val_acc: 0.5324
Test accuracy:0.524
current auc_score ------------------> 0.902
accuracies:  [0.514, 0.501, 0.5, 0.508, 0.726, 0.508, 0.507, 0.5, 0.501, 0.524]
aucs:  [0.861, 0.853, 0.789, 0.901, 0.914, 0.897, 0.877, 0.887, 0.845, 0.902]
mean and std AUC:  0.873+/-0.035  max:   0.914
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:29:47.856518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:29:47.856698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:29:47.856733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:29:47.856748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:29:47.856760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:29:47.857099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:29:47.857304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 65s - loss: 0.3078 - acc: 0.5581 - val_loss: 0.2165 - val_acc: 0.6437
Epoch 2/12
 - 56s - loss: 0.2149 - acc: 0.6773 - val_loss: 0.2565 - val_acc: 0.5085
Epoch 3/12
 - 56s - loss: 0.2010 - acc: 0.7191 - val_loss: 0.3053 - val_acc: 0.5038
Epoch 4/12
 - 56s - loss: 0.1927 - acc: 0.7346 - val_loss: 0.2862 - val_acc: 0.5055

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1864 - acc: 0.7473 - val_loss: 0.3084 - val_acc: 0.5035
Epoch 00005: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.801
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:34:55.805381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:34:55.805590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:34:55.805628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:34:55.805659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:34:55.805677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:34:55.806102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:34:55.806286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 59s - loss: 0.3095 - acc: 0.5566 - val_loss: 0.2094 - val_acc: 0.6883
Epoch 2/12
 - 56s - loss: 0.2157 - acc: 0.6724 - val_loss: 0.2616 - val_acc: 0.5061
Epoch 3/12
 - 56s - loss: 0.2024 - acc: 0.7090 - val_loss: 0.2929 - val_acc: 0.5046
Epoch 4/12
 - 56s - loss: 0.1934 - acc: 0.7292 - val_loss: 0.2940 - val_acc: 0.5113

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1873 - acc: 0.7417 - val_loss: 0.2876 - val_acc: 0.5113
Epoch 00005: early stopping
Test accuracy:0.512
current auc_score ------------------> 0.854
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:39:57.933213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:39:57.933446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:39:57.933489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:39:57.933509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:39:57.933525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:39:57.933945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:39:57.934184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3102 - acc: 0.5531 - val_loss: 0.2067 - val_acc: 0.7071
Epoch 2/12
 - 56s - loss: 0.2160 - acc: 0.6717 - val_loss: 0.2581 - val_acc: 0.5072
Epoch 3/12
 - 56s - loss: 0.2024 - acc: 0.7120 - val_loss: 0.2813 - val_acc: 0.5055
Epoch 4/12
 - 56s - loss: 0.1925 - acc: 0.7347 - val_loss: 0.3064 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1865 - acc: 0.7423 - val_loss: 0.3112 - val_acc: 0.5044
Epoch 00005: early stopping
Test accuracy:0.504
current auc_score ------------------> 0.844
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:45:00.423342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:45:00.423555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:45:00.423592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:45:00.423609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:45:00.423623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:45:00.424059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:45:00.424263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3042 - acc: 0.5589 - val_loss: 0.2169 - val_acc: 0.6441
Epoch 2/12
 - 56s - loss: 0.2140 - acc: 0.6752 - val_loss: 0.2706 - val_acc: 0.5064
Epoch 3/12
 - 56s - loss: 0.2005 - acc: 0.7115 - val_loss: 0.3078 - val_acc: 0.5049
Epoch 4/12
 - 56s - loss: 0.1914 - acc: 0.7368 - val_loss: 0.3047 - val_acc: 0.5046

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1864 - acc: 0.7426 - val_loss: 0.3086 - val_acc: 0.5048
Epoch 00005: early stopping
Test accuracy:0.505
current auc_score ------------------> 0.828
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:50:01.729623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:50:01.729844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:50:01.729878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:50:01.729900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:50:01.729915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:50:01.730367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:50:01.730573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 59s - loss: 0.3088 - acc: 0.5556 - val_loss: 0.2109 - val_acc: 0.6699
Epoch 2/12
 - 56s - loss: 0.2158 - acc: 0.6706 - val_loss: 0.2594 - val_acc: 0.5107
Epoch 3/12
 - 56s - loss: 0.2017 - acc: 0.7105 - val_loss: 0.2864 - val_acc: 0.5048
Epoch 4/12
 - 56s - loss: 0.1924 - acc: 0.7304 - val_loss: 0.3006 - val_acc: 0.5044

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1868 - acc: 0.7426 - val_loss: 0.2974 - val_acc: 0.5043
Epoch 00005: early stopping
Test accuracy:0.511
current auc_score ------------------> 0.832
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 07:55:03.467268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 07:55:03.467462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 07:55:03.467482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 07:55:03.467496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 07:55:03.467524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 07:55:03.467925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 07:55:03.468138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3062 - acc: 0.5610 - val_loss: 0.2206 - val_acc: 0.6305
Epoch 2/12
 - 56s - loss: 0.2156 - acc: 0.6684 - val_loss: 0.2599 - val_acc: 0.5093
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7044 - val_loss: 0.2962 - val_acc: 0.5045
Epoch 4/12
 - 56s - loss: 0.1934 - acc: 0.7282 - val_loss: 0.2957 - val_acc: 0.5056

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1873 - acc: 0.7409 - val_loss: 0.3070 - val_acc: 0.5050
Epoch 00005: early stopping
Test accuracy:0.507
current auc_score ------------------> 0.856
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:00:06.861985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:00:06.862219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:00:06.862263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:00:06.862285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:00:06.862302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:00:06.862712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:00:06.862936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3096 - acc: 0.5557 - val_loss: 0.2098 - val_acc: 0.6773
Epoch 2/12
 - 56s - loss: 0.2140 - acc: 0.6746 - val_loss: 0.2498 - val_acc: 0.5097
Epoch 3/12
 - 56s - loss: 0.2012 - acc: 0.7129 - val_loss: 0.3080 - val_acc: 0.5039
Epoch 4/12
 - 56s - loss: 0.1925 - acc: 0.7343 - val_loss: 0.3006 - val_acc: 0.5039

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1871 - acc: 0.7447 - val_loss: 0.3149 - val_acc: 0.5036
Epoch 00005: early stopping
Test accuracy:0.501
current auc_score ------------------> 0.798
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:05:07.522023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:05:07.522180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:05:07.522203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:05:07.522217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:05:07.522229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:05:07.522555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:05:07.522691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 58s - loss: 0.3081 - acc: 0.5588 - val_loss: 0.2066 - val_acc: 0.6969
Epoch 2/12
 - 56s - loss: 0.2144 - acc: 0.6742 - val_loss: 0.2393 - val_acc: 0.5261
Epoch 3/12
 - 56s - loss: 0.2009 - acc: 0.7148 - val_loss: 0.2955 - val_acc: 0.5043
Epoch 4/12
 - 56s - loss: 0.1923 - acc: 0.7341 - val_loss: 0.2794 - val_acc: 0.5110

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1872 - acc: 0.7426 - val_loss: 0.2800 - val_acc: 0.5120
Epoch 00005: early stopping
Test accuracy:0.530
current auc_score ------------------> 0.856
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:10:06.790699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:10:06.790948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:10:06.791000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:10:06.791023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:10:06.791041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:10:06.791483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:10:06.791689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3117 - acc: 0.5519 - val_loss: 0.2192 - val_acc: 0.6409
Epoch 2/12
 - 56s - loss: 0.2166 - acc: 0.6649 - val_loss: 0.2659 - val_acc: 0.5063
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7090 - val_loss: 0.3195 - val_acc: 0.5035
Epoch 4/12
 - 56s - loss: 0.1933 - acc: 0.7309 - val_loss: 0.3245 - val_acc: 0.5036

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1884 - acc: 0.7421 - val_loss: 0.3363 - val_acc: 0.5035
Epoch 00005: early stopping
Test accuracy:0.500
current auc_score ------------------> 0.734
batch_size:  512  opt:  adam  lr:  1e-05  epochs:  12  loss:  contrastive
conv2d_filters:  [16, 16, 32, 32]  kernel_sizes:  3  initialization:  random  layers:  single
dense_filter1:  128  dense_filters2:  0  dense_filters3:  0
dropout1:  0.2  dropout2:  0.0  dropout3:  0.0  use_bn:  True
------------------------	  end of configs        -------------------------
keras_contrastive_loss_19Nov
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 1, 96, 96)    0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 128)          1068592     input_2[0][0]                    
                                                                 input_3[0][0]                    
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 1)            0           model_1[1][0]                    
                                                                 model_1[2][0]                    
==================================================================================================
Total params: 1,068,592
Trainable params: 1,068,336
Non-trainable params: 256
__________________________________________________________________________________________________
Train on 31872 samples, validate on 7968 samples
Epoch 1/12
2018-12-03 08:15:10.055956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1
2018-12-03 08:15:10.056198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-03 08:15:10.056241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 
2018-12-03 08:15:10.056262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y 
2018-12-03 08:15:10.056278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N 
2018-12-03 08:15:10.056750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11486 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-12-03 08:15:10.056953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11486 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
 - 60s - loss: 0.3100 - acc: 0.5558 - val_loss: 0.2156 - val_acc: 0.6525
Epoch 2/12
 - 56s - loss: 0.2162 - acc: 0.6681 - val_loss: 0.2919 - val_acc: 0.5044
Epoch 3/12
 - 56s - loss: 0.2028 - acc: 0.7109 - val_loss: 0.3045 - val_acc: 0.5041
Epoch 4/12
 - 56s - loss: 0.1931 - acc: 0.7292 - val_loss: 0.3043 - val_acc: 0.5053

Epoch 00004: ReduceLROnPlateau reducing learning rate to 3.1622775802825263e-06.
Epoch 5/12
 - 56s - loss: 0.1872 - acc: 0.7422 - val_loss: 0.3076 - val_acc: 0.5048
Epoch 00005: early stopping
Test accuracy:0.503
current auc_score ------------------> 0.816
accuracies:  [0.5, 0.512, 0.504, 0.505, 0.511, 0.507, 0.501, 0.53, 0.5, 0.503]
aucs:  [0.801, 0.854, 0.844, 0.828, 0.832, 0.856, 0.798, 0.856, 0.734, 0.816]
mean and std AUC:  0.822+/-0.036  max:   0.856
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '32', 'adam', '0.00001', '4', 'contrastive'], '0.901+/-0.015', 0.931)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '128', 'adam', '0.00001', '6', 'contrastive'], '0.909+/-0.019', 0.935)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '256', 'adam', '0.00001', '10', 'contrastive'], '0.873+/-0.035', 0.914)
(['16-16-32-32', '3', 'random', 'single', '128', '0', '0', '0.2', '0', '0', 'TRUE', '512', 'adam', '0.00001', '12', 'contrastive'], '0.822+/-0.036', 0.856)
